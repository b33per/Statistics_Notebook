<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Statistics Notebook</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.11.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Statistics Notebook</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Paige's Notes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Paige-sNotes.html">Intermediate Statistics (MATH 325)</a>
    </li>
    <li>
      <a href="326PaigesNotes.html">Experimental Design (MATH 326)</a>
    </li>
    <li>
      <a href="425PaigesNotes.html">Applied Linear Regression (MATH 425)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    R Help
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="RCommands.html">R Commands</a>
    </li>
    <li>
      <a href="RMarkdownHints.html">R Markdown Hints</a>
    </li>
    <li>
      <a href="DataSources.html">Data Sources</a>
    </li>
    <li class="dropdown-header">Example Analyses</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Describing Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="GraphicalSummaries.html">Graphical Summaries</a>
    </li>
    <li>
      <a href="NumericalSummaries.html">Numerical Summaries</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Making Inference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="MakingInference.html">Overview</a>
    </li>
    <li>
      <a href="tTests.html">t Tests</a>
    </li>
    <li>
      <a href="WilcoxonTests.html">Wilcoxon Tests</a>
    </li>
    <li>
      <a href="Kruskal.html">Kruskal-Wallis Test</a>
    </li>
    <li>
      <a href="ANOVA.html">ANOVA</a>
    </li>
    <li>
      <a href="LinearRegression.html">Linear Regression</a>
    </li>
    <li>
      <a href="LogisticRegression.html">Logistic Regression</a>
    </li>
    <li>
      <a href="ChiSquaredTests.html">Chi-Squared Tests</a>
    </li>
    <li>
      <a href="PermutationTests.html">Randomization</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Analyses
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">325 Analyses</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./325Analyses/StudentHousing.html">Good Example Analysis</a>
        </li>
        <li>
          <a href="./325Analyses/StudentHousingPOOR.html">Poor Example Analysis</a>
        </li>
        <li>
          <a href="./325Analyses/Rent.html">Rent</a>
        </li>
        <li>
          <a href="./325Analyses/Stephanie.html">Stephanie</a>
        </li>
        <li>
          <a href="./325Analyses/tTests/HighSchoolSeniors.html">High School Seniors (Independent Samples t-Test)</a>
        </li>
        <li>
          <a href="./325Analyses/WilcoxonTests/RecallingWords.html">Recalling Words (Wilcoxon Test)</a>
        </li>
        <li>
          <a href="./325Analyses/ANOVA/MyTwoWayANOVA.html">My Two-way ANOVA</a>
        </li>
        <li>
          <a href="./325Analyses/Kruskal-Wallis%20Test/Food.html">Food (Kruskal-Wallis Test)</a>
        </li>
        <li>
          <a href="./325Analyses/LinearRegression/MySimpleLinearRegression.html">My Simple Linear Regression</a>
        </li>
        <li>
          <a href="./325Analyses/LinearRegression/Weather.html">Weather (Multiple Linear Regression)</a>
        </li>
        <li>
          <a href="./325Analyses/LogisticRegression/MyLogisticRegression.html">My Logistic Regression</a>
        </li>
        <li>
          <a href="./325Analyses/ChiSquaredTests/MyChiSquaredTest.html">My Chi-squared Test</a>
        </li>
        <li>
          <a href="./325Analyses/TestingCenter.html">Testing Center (Consulting Project)</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">425 Analyses</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./425Analyses/PredictingWeather.html">Predicting Rexburg, Idaho Weather</a>
        </li>
        <li>
          <a href="./425Analyses/ResidualsSumsofSquaresRSquared.html">Residuals, Sums of Squares, and R-Squared</a>
        </li>
        <li>
          <a href="./425Analyses/CarSelling.html">Acura TL Selling Prices</a>
        </li>
        <li>
          <a href="./425Analyses/PredictingGrades.html">Predicting Grades</a>
        </li>
        <li>
          <a href="./425Analyses/HouseSellingPrices.html">House Selling Prices</a>
        </li>
        <li>
          <a href="./425Analyses/OutlierTheoryAssignment.html">Outlier Theory Assignment</a>
        </li>
        <li>
          <a href="./425Analyses/homeworkfocus.html">Homework Focus</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Statistics Notebook</h1>

</div>


<p>This page, and all pages of this notebook, are meant to be customized
to become a useful <em>Guide to Statistical Analysis</em> in R for your
<em>current</em> and <em>future</em> self.</p>
<script type="text/javascript">
 function showhide(id) {
    var e = document.getElementById(id);
    e.style.display = (e.style.display == 'block') ? 'none' : 'block';
 }
 
 function openTab(evt, tabName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += " active";
}
 
</script>
<hr />
<div id="sections" class="section level2">
<h2>Sections</h2>
<ul>
<li><p><strong>Paige’s Notes</strong> : Notes taken throughout different
statistic based classes.</p></li>
<li><p><strong>R Help</strong> : R Studio commands, structuring tips,
and tricks.</p></li>
<li><p><strong>Describing Data</strong> : R Studio commands for
graphically and numerically describing data.</p></li>
<li><p><strong>Making Inference</strong> : Deep dives into the different
statistical tests.</p></li>
<li><p><strong>Analyses</strong> : Statistical analyses that utilizes
the tools of collecting, analyzing, and interpreting data to result in
informed decision-making.</p></li>
</ul>
<script type="text/javascript">
 function showhide(id) {
    var e = document.getElementById(id);
    e.style.display = (e.style.display == 'block') ? 'none' : 'block';
 }
 
 function openTab(evt, tabName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += " active";
 }
</script>
<hr />
</div>
<div id="search-bar" class="section level2">
<h2>Search Bar</h2>
</div>
<div id="search-bar-1" class="section level2">
<h2>Search Bar</h2>
<div id="search-ui">
<form id="search-form" onsubmit="return false;">
<input id="q" type="text" placeholder="Search the whole site…"
           style="width:100%;padding:10px;border:1px solid #ccc;border-radius:8px;" />
</form>
<p id="status" style="margin-top:8px;color:#777;">
Loading index…
</p>
<ul id="results" style="list-style:none;padding:0;">
</ul>
</div>
<!-- MiniSearch -->
<script src="https://unpkg.com/minisearch@6.3.0/dist/umd/index.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
  const INDEX_URL = "search-index.json";  // Simple path since it's in same directory
  
  const qEl = document.getElementById('q');
  const statusEl = document.getElementById('status');
  const resultsEl = document.getElementById('results');
  
  let miniSearch = null;
  
  function render(results) {
    if (!results || results.length === 0) {
      resultsEl.innerHTML = '';
      statusEl.textContent = qEl.value.trim() ? 'No matches found' : 'Type to search...';
      return;
    }
    
    resultsEl.innerHTML = results.slice(0, 8).map(r => `
      <li style="margin:10px 0;padding:8px;border:1px solid #ddd;border-radius:4px;">
        <a href="${r.url}" style="font-weight:bold;color:#0066cc;">${r.title}</a><br/>
        <small style="color:#666;">${r.url}</small>
      </li>`).join('');
    
    statusEl.textContent = `${results.length} result(s) found`;
  }
  
  async function loadIndex() {
    try {
      const response = await fetch(INDEX_URL);
      if (!response.ok) throw new Error(`HTTP ${response.status}`);
      
      const docs = await response.json();
      
      miniSearch = new MiniSearch({
        fields: ["title", "content"],
        storeFields: ["title", "url"]
      });
      
      miniSearch.addAll(docs.map((d, i) => ({
        id: i,
        title: d.title || "",
        url: d.url,
        content: d.content || ""
      })));
      
      statusEl.textContent = `Ready to search ${docs.length} pages`;
      
    } catch (e) {
      statusEl.textContent = `Error: ${e.message}`;
      console.error("Search index error:", e);
    }
  }
  
  function doSearch() {
    const query = qEl.value.trim();
    if (!miniSearch || !query) {
      render([]);
      return;
    }
    
    const results = miniSearch.search(query, { prefix: true, fuzzy: 0.2 });
    render(results);
  }
  
  qEl.addEventListener('input', doSearch);
  loadIndex();
});
</script>
<hr />
</div>
<div id="table-of-contents" class="section level2">
<h2>Table of Contents</h2>
<p>These are the statistical tools used to explore and interpret
different data types.</p>
</div>
<div id="section" class="section level2 tabset tabset-pills">
<h2 class="tabset tabset-pills"></h2>
<hr />
<div id="one-quantitative-response-variable-y"
class="section level3 tabset tabset-fade">
<h3 class="tabset tabset-fade">One Quantitative Response Variable Y</h3>
<div id="graphics" class="section level4">
<h4>Graphics</h4>
<div class="tooltipimage" style="float:left;width:125px;"
align="center">
<p><img src="Images/QuantY.png" width=35px;> <span
class="tooltipimagetext">Y is a single quantitative variable of
interest. This would be like “heights” of BYU-Idaho students.</span></p>
</div>
<div style="padding-left:125px;color:black;">
<!-- Add your customizations in the area below: -->
<p><strong>Test(s) used for this category:</strong></p>
<ul>
<li><p>One Sample T-test</p></li>
<li><p>Paired Sample T-test</p></li>
<li><p>Wilcoxon Signed- Rank Test</p></li>
</ul>
<p><br></p>
<p><strong>Used for one quantitative variable. Pretty simple
tbh.</strong></p>
<ul>
<li><p>Questions that this answers:</p>
<ul>
<li><p>How long are 4th grader’s feet?</p></li>
<li><p>What is the average length of feet in the KidsFeet
dataset?</p></li>
</ul></li>
</ul>
<hr />
<p>These are the best graphics to use:</p>
<p><a href="GraphicalSummaries.html#histogram">
<img class="myhover" src="Images/histogram.png" alt="Histogram" title="Histogram">
</a> <a href="GraphicalSummaries.html#dot-plots">
<img class="myhover" src="Images/dotplotsingle.png" alt="Dot Plot" title="Dot Plot">
</a> <a href="GraphicalSummaries.html#boxplots">
<img class="myhover" src="Images/boxplotsingle.png" alt="Boxplot" title="Boxplot">
</a></p>
<p><br></p>
<p><em>Examples :</em></p>
<ul>
<li>What is the mean temperature at Airport? (<strong>One
Sample</strong>)
<ul>
<li>can be done with histogram or dot plot!</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">plot_ly</span>(airquality, <span class="at">x=</span><span class="sc">~</span>Temp,</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>        <span class="at">type=</span><span class="st">&quot;histogram&quot;</span>,</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>        <span class="at">marker=</span><span class="fu">list</span>(<span class="at">color=</span><span class="st">&quot;skyblue&quot;</span>,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>                    <span class="at">line=</span><span class="fu">list</span>(<span class="at">color=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">width=</span><span class="dv">10</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title=</span><span class="st">&quot;La Guardia Airport Daily Mean Temperatures&quot;</span>, <span class="at">xaxis=</span><span class="fu">list</span>(<span class="at">title=</span><span class="st">&quot;Temperature in Degrees F&quot;</span>))</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-df572bffbb8cdeb34950" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-df572bffbb8cdeb34950">{"x":{"visdat":{"30a81ac66a5f":["function () ","plotlyVisDat"]},"cur_data":"30a81ac66a5f","attrs":{"30a81ac66a5f":{"x":{},"marker":{"color":"skyblue","line":{"color":"darkgray","width":10}},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"histogram"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"La Guardia Airport Daily Mean Temperatures","xaxis":{"domain":[0,1],"automargin":true,"title":"Temperature in Degrees F"},"yaxis":{"domain":[0,1],"automargin":true},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[67,72,74,62,56,66,65,59,61,69,74,69,66,68,58,64,66,57,68,62,59,73,61,61,57,58,57,67,81,79,76,78,74,67,84,85,79,82,87,90,87,93,92,82,80,79,77,72,65,73,76,77,76,76,76,75,78,73,80,77,83,84,85,81,84,83,83,88,92,92,89,82,73,81,91,80,81,82,84,87,85,74,81,82,86,85,82,86,88,86,83,81,81,81,82,86,85,87,89,90,90,92,86,86,82,80,79,77,79,76,78,78,77,72,75,79,81,86,88,97,94,96,94,91,92,93,93,87,84,80,78,75,73,81,76,77,71,71,78,67,76,68,82,64,71,81,69,63,70,77,75,76,68],"marker":{"color":"skyblue","line":{"color":"darkgray","width":10}},"type":"histogram","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">stripchart</span>(airquality<span class="sc">$</span>Temp, <span class="at">method=</span><span class="st">&quot;stack&quot;</span>, <span class="at">xlab=</span> <span class="st">&quot;Temperature (F)&quot;</span>, <span class="at">main=</span><span class="st">&quot;La Guardia Airport Daily Mean Temperature&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<ul>
<li>You can change the method to “overplot”, “jitter”, or “stack”</li>
</ul>
<p><br></p>
<hr />
<ul>
<li>What is the median temperature of La Guardia Airport? (<strong>One
Sample</strong>)</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">boxplot</span> (airquality<span class="sc">$</span>Temp, <span class="at">ylab=</span><span class="st">&quot;Temperature (F)&quot;</span>, <span class="at">main=</span><span class="st">&quot;La Guardia Airport Temperature Median&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p><br></p>
<hr />
<!--- End your notes before here.  ------------------>
</div>
</div>
<div id="tests" class="section level4">
<h4>Tests</h4>
<div style="padding-left:125px;color:black;">
<div id="one-sample-t-test"
class="section level5 tabset tabset-fade tabset-pills">
<h5 class="tabset tabset-fade tabset-pills">One Sample t Test</h5>
<div style="float:left;width:125px;" align="center">
<p><a href="index.html#one-quantitative-response-variable-y"><img src="Images/QuantY.png" width=35px;></a></p>
</div>
<p>A one sample t test is <strong>used when there is a hypothesized
value for the population mean <span class="math inline">\(\mu\)</span>
of a single quantitative variable.</strong></p>
<div id="overview" class="section level6">
<h6>Overview</h6>
<div style="padding-left:125px;">
<p><strong>Questions</strong></p>
<p>The one sample t test can be used to answer questions like:</p>
<ul>
<li>How long does it take to drive from Rexburg, ID to Salt Lake City,
UT <span style="background-color:yellow;">on average</span>?</li>
<li>Is human body temperature really 98.6&amp;deg; F <span
style="background-color:yellow;">on average</span>?</li>
<li>Do I spend less than $3 a day,<span
style="background-color:yellow;">on average</span>, purchasing
snacks?</li>
</ul>
<p><strong>Requirements</strong></p>
<p>This test is only appropriate when both of the following are
satisfied.</p>
<ol style="list-style-type: decimal">
<li><p>The sample is <strong>representative</strong> of the population.
(Having a simple random sample is the best way to do this.)</p></li>
<li><p>The sampling distribution of the sample mean <span
class="math inline">\(\bar{x}\)</span> <em>can be assumed to be
normal</em>. This is a safe assumption when either:</p></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>the population data can be assumed to be <strong>normally
distributed</strong> using a Q-Q Plot</li>
</ol>
<div style="text-align: center;">
<p><strong>OR</strong></p>
</div>
<ol start="2" style="list-style-type: lower-alpha">
<li>the <strong>size of the sample (n) that was taken from the
population is large</strong> (at least n &gt; 30, but “large” really
depends on how badly the data is skewed).</li>
</ol>
<p><br></p>
<ul>
<li>If the requirements listed above <strong>are satisfied</strong>,
then the results of the test can be trusted to give meaningful inference
about the population.</li>
<li>If the requirements <strong>are not</strong> met, then that doesn’t
mean the results of the test are necessarily bad, but there is
<strong>no guarantee that they are good.</strong></li>
</ul>
<p><strong>Hypotheses</strong></p>
<div style="padding-left:15px;">
<div
style="float:right;font-size:.8em;background-color:lightgray;padding:5px;border-radius:4px;">
<a style="color:darkgray;" href="javascript:showhide('onesampletlatex')">Math
Code</a>
</div>
<div id="onesampletlatex" style="display:none;">
<pre><code>$$
  H_0: \mu = 5.2
$$

$$
  H_a: \mu \neq 5.2
$$</code></pre>
</div>
<p><span class="math inline">\(H_0: \mu = \text{some
number}\)</span></p>
<p><span class="math inline">\(H_a: \mu \
\left\{\underset{&lt;}{\stackrel{&gt;}{\neq}}\right\} \ \text{some
number}\)</span></p>
</div>
<p><strong>Examples</strong>: <a
href="./Analyses/t%20Tests/Examples/Math325AnalysisResubmits.html">analysis
resubmits</a></p>
</div>
<hr />
</div>
<div id="r-instructions" class="section level6">
<h6>R Instructions</h6>
<div style="padding-left:125px;">
<p><strong>Console</strong> Help Command: <code>?t.test()</code></p>
<p><code>t.test(NameOfYourData$Y, mu = YourNull, alternative = YourAlternative, conf.level = 0.95)</code></p>
<ul>
<li><code>NameOfYourData</code> is the name of your data set, like
<code>mtcars</code> or <code>KidsFeet</code>.</li>
<li><code>Y</code> must be a “numeric” vector of quantitative data.</li>
<li><code>YourNull</code> is the numeric value from your null hypothesis
for <span class="math inline">\(\mu\)</span>.</li>
<li><code>YourAlternative</code> is one of the three options:
<code>"two.sided"</code>, <code>"greater"</code>, <code>"less"</code>
and should correspond to your alternative hypothesis.</li>
<li>The value for <code>conf.level = 0.95</code> can be changed to any
desired confidence level, like 0.90 or 0.99. It should correspond to
<span class="math inline">\(1-\alpha\)</span>.</li>
</ul>
<p>Testing Assumptions</p>
<p><code>library(car)</code></p>
<p><code>qqPlot(NameOfYourData$Y)</code></p>
<p><br></p>
<p><strong>Example Code</strong></p>
<p>Hover your mouse over the example codes to learn more.</p>
<a href="javascript:showhide('tTest')">
<div class="hoverchunk">
<p><span class="tooltipr"> t.test( <span class="tooltiprtext">‘t.test’
is an R function that performs one and two sample t-tests.</span>
</span><span class="tooltipr"> mtcars <span
class="tooltiprtext">‘mtcars’ is a dataset. Type ‘View(mtcars)’ in R to
view the dataset.</span> </span><span class="tooltipr"> $ <span
class="tooltiprtext">The $ allows us to access any variable from the
mtcars dataset.</span> </span><span class="tooltipr"> mpg,  <span
class="tooltiprtext">‘mpg’ is Y, a quantitative variable (numeric
vector) from the mtcars dataset.</span> </span><span class="tooltipr">
mu = 20,  <span class="tooltiprtext"> The numeric value from the null
hypothesis is 20 meaning <span class="math inline">\(\mu=20\)</span>.
</span> </span><span class="tooltipr"> alternative = “two.sided”,  <span
class="tooltiprtext"> The alternative hypothesis is “two.sided” meaning
the alternative hypothesis is <span
class="math inline">\(\mu\neq20\)</span>.</span> </span><span
class="tooltipr"> conf.level = 0.95) <span class="tooltiprtext">This
test has a 0.95 confidence level which corresponds to 1−α. </span>
</span><span class="tooltipr">     <br />
<span class="tooltiprtext">Press Enter to run the code if you have typed
it in yourself. You can also click here to view the output.</span>
</span><span class="tooltipr" style="float:right;font-size:.8em;">
 Click to Show Output  <span class="tooltiprtext">Click to View
Output.</span> </span></p>
</div>
<p></a></p>
<div id="tTest" style="display:none;">
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> One Sample t-test <span
class="tooltiprouttext">EXPLANATION.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> data: mtcars$mpg <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> t = 0.08506, <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
<td>
<span class="tooltiprout">  df = 31, <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
<td>
<span class="tooltiprout">  p-value = 0.9328 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> alternative hypothesis: true mean is not
equal to 20 <span class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> 95 percent confidence interval: <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout">  17.91768 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
<td align="left">
<span class="tooltiprout">  22.26357 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> sample estimates: <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> mean of x <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout">  20.09062 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
</table>
</div>
<a href="javascript:showhide('onesampleQQplot')">
<div class="hoverchunk">
<p><span class="tooltipr"> qqPlot( <span class="tooltiprtext">‘qqPlot’
is a R function from library(car) that creates a qqPlot.</span>
</span><span class="tooltipr"> mtcars <span
class="tooltiprtext">‘mtcars’ is a dataset. Type ‘View(mtcars)’ in R to
view the dataset.</span> </span><span class="tooltipr"> $ <span
class="tooltiprtext">The $ allows us to access any variable from the
mtcars dataset.</span> </span><span class="tooltipr"> mpg) <span
class="tooltiprtext">‘mpg’ is a quantitative variable (numeric vector)
from the mtcars dataset.</span> </span><span class="tooltipr"
style="float:right;font-size:.8em;">  Click to Show Output  <span
class="tooltiprtext">Click to View Output.</span> </span></p>
</div>
</a>
<div id="onesampleQQplot" style="display:none;">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre><code>## [1] 20 18</code></pre>
</div>
</div>
<hr />
</div>
<div id="explanation" class="section level6">
<h6>Explanation</h6>
<div style="padding-left:125px;">
<p>When we want to check if a claim about the average of a
group(population mean <span class="math inline">\(\mu\)</span>) is true,
we often use a test called the “one sample t test”. This test works well
when we can assume that <strong>the data follows a normal pattern and
that we’ve picked our sample randomly</strong> from the bigger group
we’re interested in.</p>
<hr />
<p>In the figure below, the null hypothesis <span
class="math inline">\(H_0: \mu = \mu_0\)</span> is represented by the
normal distribution (gray) centered at <span
class="math inline">\(\mu_0\)</span>. - Note that <span
class="math inline">\(\mu_0\)</span> is just some specified number. -
This shows how the null hypothesis represents <strong>the
assumption</strong> about the center of the distribution of the
data.</p>
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>After a hypothesis (null) is established and an alternative
hypothesis similarly declared, <strong>a simple random sample of data of
size <span class="math inline">\(n\)</span> is obtained from the
population of interest.</strong> - In the plot above, this is depicted
by the points (blue dots) which are centered around their sample mean
<span class="math inline">\(\bar{x}\)</span>.</p>
<p>Above the points (blue dots) is another bell-shaped curve (blue
dashed line). This curve shows that <strong>the alternative hypothesis
might fit the data better than the null hypothesis.</strong></p>
<p>The role of the one sample t test is to <strong>measure the
probability of a sample mean being as extreme or more extreme from the
hypothesized value of <span class="math inline">\(\mu_0\)</span> than
the one observed</strong> assuming the null hypothesis is true. - This
probability is of course the p-value of the test. - This works because
<strong>the sampling distribution of the sample mean has been assumed to
be normal</strong>.</p>
<hr />
<p>In this case, the distribution of the test statistic t, <span
class="math display">\[
  t = \frac{\bar{x}-\mu}{s/\sqrt{n}}
\]</span><br />
is known to follow a t distribution with <span
class="math inline">\(n-1\)</span> degrees of freedom.</p>
<p>*The mathematics that provide this result are phenominal! You can
consult any advanced statistical textbook for the details.</p>
<hr />
<p>The p-value of the one sample t test represents <strong>the
probability that the test statistic <span
class="math inline">\(t\)</span> is as extreme or more extreme than the
one observed</strong> according to a t-distribution with <span
class="math inline">\(n-1\)</span> degrees of freedom.</p>
<ul>
<li>If the probability (the p-value) is close enough to zero (smaller
than <span class="math inline">\(\alpha\)</span>), then it is determined
that the most <em>plausible</em> hypothesis is the alternative
hypothesis, and thus the null is “rejected” in favor of the
alternative.</li>
</ul>
</div>
<hr />
</div>
</div>
<div id="paired-samples-t-test"
class="section level5 tabset tabset-fade tabset-pills">
<h5 class="tabset tabset-fade tabset-pills">Paired Samples t Test</h5>
<div style="float:left;width:125px;" align="center">
<p><a href="index.html#one-quantitative-response-variable-y"><img src="Images/QuantY.png" width=35px;></a></p>
</div>
<p>The paired samples t test is used when a value is hypothesized for
the popluation mean of the differences, <span
class="math inline">\(\mu_d\)</span>, obtained from paired
observations.</p>
<div id="overview-1" class="section level6">
<h6>Overview</h6>
<div style="padding-left:125px;">
<p><strong>Questions</strong></p>
<p>The Paired Samples t Test can be used to answer questions like:</p>
<ul>
<li>From pre-test to post-test is there an improvement on average in the
subjects?</li>
<li>How much taller are husbands than their wives, on average?</li>
<li>Do hospital patients that are <em>carefully matched</em> together
according to reason for being in the hospital, age, gender, ethnicity,
height, and weight show increased stay times in the hospital when
infected with a nosocomial infection compared to those who were not
infected?</li>
</ul>
<p><strong>Requirements</strong></p>
<p>The test is only appropriate when both of the following are
satisfied.</p>
<ol style="list-style-type: decimal">
<li><p>The sample of differences is representative of the population
differences.</p></li>
<li><p>The sampling distribution of the sample mean of the differences
<span class="math inline">\(\bar{d}\)</span> (<span
class="math inline">\(\bar{x}\)</span> of the differences) can be
assumed to be normal. (This second requirement can be assumed to be
satisfied when (a) the differences themselves can be assumed to be
normal from a Q-Q Plot, or (b) when the sample size <span
class="math inline">\(n\)</span> of the differences is large.)</p></li>
</ol>
<p><strong>Hypotheses</strong></p>
<div style="padding-left:15px;">
<div
style="float:right;font-size:.8em;background-color:lightgray;padding:5px;border-radius:4px;">
<a style="color:darkgray;" href="javascript:showhide('pairedsampletlatex')">Math
Code</a>
</div>
<div id="pairedsampletlatex" style="display:none;">
<pre><code>$$
  H_0: \mu_d = 0
$$

$$
  H_a: \mu_d \neq 0
$$</code></pre>
</div>
<p><span class="math inline">\(H_0: \mu_d = \text{some number, but
typically 0}\)</span><br />
<span class="math inline">\(H_a: \mu_d \
\left\{\underset{&lt;}{\stackrel{&gt;}{\neq}}\right\} \ \text{some
number, but typically 0}\)</span></p>
</div>
<p><strong>Examples</strong>: <a
href="./Analyses/t%20Tests/Examples/SleepPairedt.html">sleepPaired</a>
<a
href="./Analyses/t%20Tests/Examples/Student1Paired.html">studentPaired</a></p>
</div>
<hr />
</div>
<div id="r-instructions-1" class="section level6">
<h6>R Instructions</h6>
<div style="padding-left:125px;">
<p><strong>Console</strong> Help Command: <code>?t.test()</code></p>
<p><strong>Option 1:</strong></p>
<p><code>t.test(NameOfYourData$Y1, NameOfYourData$Y2, paired = TRUE, mu = YourNull, alternative = YourAlternative, conf.level = 0.95)</code></p>
<ul>
<li><code>NameOfYourData</code> is the name of your data set like
<code>sleep</code> or <code>mtcars</code> or <code>KidsFeet</code>.</li>
<li><code>Y1</code> must be a “numeric” vector that represents the
quantitative data from the first sample of data.</li>
<li><code>Y2</code> must be a “numeric” vector that represents the
quantitative data from the second sample of data. This vector must be in
the same order as the first sample so that the pairing can take
place.</li>
<li><code>YourNull</code> is the numeric value from your null hypothesis
for <span class="math inline">\(\mu_d\)</span>.</li>
<li><code>YourAlternative</code> is one of the three options:
<code>"two.sided"</code>, <code>"greater"</code>, <code>"less"</code>
and should correspond to your alternative hypothesis.</li>
<li>The value for <code>conf.level = 0.95</code> can be changed to any
desired confidence level, like 0.90 or 0.99. It should correspond to
<span class="math inline">\(1-\alpha\)</span>.</li>
</ul>
<p>Testing Assumptions</p>
<p><code>library(car)</code></p>
<p><code>qqPlot(Y1 - Y2)</code></p>
<p><strong>Example Code</strong></p>
<p>Hover your mouse over the example codes to learn more.</p>
<a href="javascript:showhide('tTestPaired')">
<div class="hoverchunk">
<p><span class="tooltipr"> sleep1 &lt;- filter(sleep, group==1) <span
class="tooltiprtext">This splits out the “group1” data from the sleep
data set.</span> </span><br/><span class="tooltipr"> sleep2 &lt;-
filter(sleep, group==2) <span class="tooltiprtext">This splits out the
“group2” data from the sleep data set</span> </span><br/><span
class="tooltipr"> t.test( <span class="tooltiprtext">‘t.test’ is an R
function that performs one and two sample t-tests.</span> </span><span
class="tooltipr"> sleep2$extra,  <span class="tooltiprtext">A numeric
vector that represents the hours of extra sleep that the group had with
drug 2.</span> </span><span class="tooltipr"> sleep1$extra,  <span
class="tooltiprtext">A numeric vector that represents the hours of extra
sleep that the same group had with drug 1.</span> </span><br><span
class="tooltipr"> paired=TRUE,  <span class="tooltiprtext">Indicates
that this is a paired t-Test. This will cause the subtraction of
sleep2$extra - sleep1$extra to be performed to obtain the paired
differences. To cause the subtraction to occur in the other order,
reverse the order sleep1$extra, sleep2$extra occur in the t.test(…)
function.</span> </span><span class="tooltipr"> mu = 0,  <span
class="tooltiprtext">The numeric value from the null hypothesis 0
meaning the null hypothesis is <span
class="math inline">\(\mu_d=0\)</span>.</span> </span><span
class="tooltipr"> alternative = “two.sided”,  <span
class="tooltiprtext">The alternative hypothesis is “two.sided” meaning
the alternative hypothesis is <span
class="math inline">\(\mu_d\neq0\)</span>.</span> </span><span
class="tooltipr"> conf.level = 0.95) <span class="tooltiprtext">This
test has a 0.95 confidence level which corresponds to 1 - <span
class="math inline">\(\alpha\)</span>.</span> </span><span
class="tooltipr">     <br />
<span class="tooltiprtext">Press Enter to run the code if you have typed
it in yourself. You can also click here to view the output.</span>
</span><span class="tooltipr" style="float:right;font-size:.8em;">
 Click to Show Output  <span class="tooltiprtext">Click to View
Output.</span> </span></p>
</div>
</a>
<div id="tTestPaired" style="display:none;">
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Paired t-test <span
class="tooltiprouttext">EXPLANATION.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> data: sleep2$extra and sleep1$extra <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> t = 4.0621, <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
<td>
<span class="tooltiprout">  df = 9, <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
<td>
<span class="tooltiprout">  p-value = 0.002833 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> alternative hypothesis: true mean is not
equal to 0 <span class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> 95 percent confidence interval: <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout">  0.7001142 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
<td align="left">
<span class="tooltiprout">  2.4598858 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> sample estimates: <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> mean of the differences <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td align="right">
<span class="tooltiprout">   1.58 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
</table>
</div>
<a href="javascript:showhide('pairedQQplot')">
<div class="hoverchunk">
<p><span class="tooltipr"> qqPlot( <span class="tooltiprtext">‘qqPlot’
is a R function from library(car) that creates a qqPlot.</span>
</span><span class="tooltipr"> sleep2$extra <span
class="tooltiprtext">The hours of extra sleep that the group had with
drug 2.</span> </span><span class="tooltipr">  -  <span
class="tooltiprtext">Subtract the hours of extra sleep with drug 1 from
the hours of extra sleep with drug 2 to get the difference.</span>
</span><span class="tooltipr"> sleep1$extra <span
class="tooltiprtext">The hours of extra sleep that the same group had
with drug 1.</span> </span><span class="tooltipr"> ) <span
class="tooltiprtext">Closing parenthesis for qqPlot(…) function.</span>
</span><span class="tooltipr" style="float:right;font-size:.8em;">
 Click to Show Output  <span class="tooltiprtext">Click to View
Output.</span> </span></p>
</div>
</a>
<div id="pairedQQplot" style="display:none;">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre><code>## [1] 9 5</code></pre>
</div>
<p><br /></p>
<p><br></p>
<p><strong>Option 2:</strong></p>
<p>Compute the differences yourself instead of using
<code>paired=TRUE</code>.</p>
<p><code>differences = NameOfYourData$Y1 - NameOfYourData$Y2</code></p>
<p><code>t.test(differences, mu = YourNull, alternative = YourAlternative, conf.level = 0.95)</code></p>
<ul>
<li><code>NameOfYourData</code> is the name of your data set.</li>
<li><code>Y1</code> must be a “numeric” vector that represents the
quantitative data from the first sample of data.</li>
<li><code>Y2</code> must be a “numeric” vector that represents the
quantitative data from the second sample of data. This vector must be in
the same order as the first sample so that the pairing can take
place.</li>
<li><code>differences</code> are the resulting differences obtained from
subtracting <code>Y1 - Y2</code>.</li>
<li><code>YourNull</code> is the numeric value from your null hypothesis
for <span class="math inline">\(\mu_d\)</span>.</li>
<li><code>YourAlternative</code> is one of the three options:
<code>"two.sided"</code>, <code>"greater"</code>, <code>"less"</code>
and should correspond to your alternative hypothesis.</li>
<li>The value for <code>conf.level = 0.95</code> can be changed to any
desired confidence level, like 0.90 or 0.99. It should correspond to
<span class="math inline">\(1-\alpha\)</span>.</li>
</ul>
<p>Testing Assumptions</p>
<p><code>library(car)</code></p>
<p><code>qqPlot(differences)</code></p>
<p><strong>Example Code</strong></p>
<p>Hover your mouse over the example codes to learn more.</p>
<a href="javascript:showhide('tTestPaired2')">
<div class="hoverchunk">
<p><span class="tooltipr"> sleep1 &lt;- filter(sleep, group==1) <span
class="tooltiprtext">This splits out the “group1” data from the sleep
data set.</span> </span><br/><span class="tooltipr"> sleep2 &lt;-
filter(sleep, group==2) <span class="tooltiprtext">This splits out the
“group2” data from the sleep data set</span> </span><br/><span
class="tooltipr"> differences &lt;-  <span class="tooltiprtext"> Saved
the computed differences to an object called ‘differences’.</span>
</span><span class="tooltipr"> sleep2$extra <span
class="tooltiprtext">The hours of extra sleep that the group had with
drug 2.</span> </span><span class="tooltipr">  -  <span
class="tooltiprtext">Subtract the hours of extra sleep with drug 1 from
the hours of extra sleep with drug 2 to get the difference.</span>
</span><span class="tooltipr"> sleep1$extra <span
class="tooltiprtext">The hours of extra sleep that the same group had
with drug 1.</span> </span><br><span class="tooltipr"> t.test( <span
class="tooltiprtext">‘t.test’ is an R function that performs one and two
sample t-tests.</span> </span><span class="tooltipr"> differences, 
<span class="tooltiprtext">‘differences’ are the resulting differences
of the hours of extra sleep with drug 1 and the hours of extra sleep
with drug 2.</span> </span><span class="tooltipr"> mu = 0,  <span
class="tooltiprtext">The numeric value from the null hypothesis 0
meaning the null hypothesis is <span
class="math inline">\(\mu_d=0\)</span>.</span> </span><span
class="tooltipr"> alternative = “two.sided”,  <span
class="tooltiprtext">The alternative hypothesis is “two.sided” meaning
the alternative hypothesis is <span
class="math inline">\(\mu_d\neq0\)</span>.</span> </span><span
class="tooltipr"> conf.level = 0.95) <span class="tooltiprtext">This
test has a 0.95 confidence level which corresponds to 1 - <span
class="math inline">\(\alpha\)</span>.</span> </span><span
class="tooltipr">     <br />
<span class="tooltiprtext">Press Enter to run the code if you have typed
it in yourself. You can also click here to view the output.</span>
</span><span class="tooltipr" style="float:right;font-size:.8em;">
 Click to Show Output  <span class="tooltiprtext">Click to View
Output.</span> </span></p>
</div>
</a>
<div id="tTestPaired2" style="display:none;">
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> One Sample t-test <span
class="tooltiprouttext">EXPLANATION.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> data: differences <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> t = 4.0621, <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
<td>
<span class="tooltiprout">  df = 9, <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
<td>
<span class="tooltiprout">  p-value = 0.002833 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> alternative hypothesis: true mean is not
equal to 0 <span class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> 95 percent confidence interval: <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout">  0.7001142 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
<td align="left">
<span class="tooltiprout">  2.4598858 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> sample estimates: <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> mean of x <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td align="right">
<span class="tooltiprout">   1.58 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
</table>
</div>
<a href="javascript:showhide('pairedQQplot2')">
<div class="hoverchunk">
<p><span class="tooltipr"> qqPlot( <span class="tooltiprtext">‘qqPlot’
is a R function from library(car) that creates a qqPlot.</span>
</span><span class="tooltipr"> differences) <span
class="tooltiprtext">‘differences’ are the resulting differences of the
hours of extra sleep with drug 1 and the hours of extra sleep with drug
2.</span> </span><span class="tooltipr"
style="float:right;font-size:.8em;">  Click to Show Output  <span
class="tooltiprtext">Click to View Output.</span> </span></p>
</div>
</a>
<div id="pairedQQplot2" style="display:none;">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre><code>## [1] 9 5</code></pre>
</div>
</div>
<hr />
</div>
<div id="explanation-1" class="section level6">
<h6>Explanation</h6>
<div style="padding-left:125px;">
<p>The paired samples t test considers the single mean of all the
differences from the paired values. Thus, the paired samples t test
essentially becomes a one sample t test on the differences between
paired observations. Hence the requirement is that the sampling
distribution of the sample mean of the differences, <span
class="math inline">\(\bar{d}\)</span>, can be assumed to be normally
distributed. (It is also required that the obtained differences
represent a simple random sample of the full population of possible
differences.)</p>
<p>The paired samples t test is similar to the independent samples t
test scenario, except that there is extra information that allows values
from one sample to be paired with a value from the other sample. This
pairing of values allows for a more direct analysis of the change or
difference individuals experience between the two samples.</p>
<p>The points in the plot below demonstrate how points are paired
together, and the only thing of interest are the differences between the
paired points.</p>
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" width="672" /><img src="index_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
</div>
<hr />
</div>
</div>
<div id="wilcoxon-signed-rank-test"
class="section level5 tabset tabset-fade tabset-pills">
<h5 class="tabset tabset-fade tabset-pills">Wilcoxon Signed-Rank
Test</h5>
<div style="float:left;width:125px;" align="center">
<p><img src="Images/QuantY.png" width=35px;></p>
</div>
<p>For testing hypotheses about <strong>the value of the median</strong>
of:</p>
<ol style="list-style-type: decimal">
<li><p>one sample of <strong>quantitative data</strong> or</p></li>
<li><p>one <strong>set of differences</strong> from paired
data.</p></li>
</ol>
<ul>
<li>Box plots + Dot plots are great to show off this kind of data
(because it shows the median!)
<ul>
<li>Median line closer to the <strong>bottom</strong> of the box plot =
<strong>Right Skewed</strong></li>
<li>Median line is closer to the <strong>top</strong> of the box plot =
<strong>Left Skewed</strong></li>
</ul></li>
</ul>
<div id="overview-2" class="section level6">
<h6>Overview</h6>
<div style="padding-left:125px;">
<p>The <strong>nonparametric equivalent</strong> of the paired-samples t
test as well as the one-sample t test.</p>
<ul>
<li><strong>Best for smaller sample sizes</strong> where the
distribution of <strong>the data is not normal</strong>
<ul>
<li>The t test is more appropriate when the data is normal or when the
<strong>sample size is large.</strong></li>
</ul></li>
</ul>
<p>While the test will work in most scenarios it suffers slightly when
ties (repeated values) are present in the data. If <em>many</em> ties
are present in the data, the test is not appropriate. If only a few ties
are present, the test is still appropriate.</p>
<p>This test is similar to the paired-samples t test and the one-sample
t test, but it doesn’t assume the data follows a normal distribution
(<strong>nonparametric equivalent</strong>)</p>
<p><u>It works best when:</u> - You have a small number of samples -
Your data doesn’t follow a normal distribution</p>
<p>** The t test is better when your data is normal or when you have a
lot of samples.This test usually works fine, but it can have problems if
you have <strong>many repeated values in your data</strong>. If there
are just a few repeated values, it’s still okay to use.</p>
<p><strong>Hypotheses</strong></p>
<p>Originally created to test hypotheses about <strong>the value of the
median</strong></p>
<ul>
<li>works as well for the mean when the distribution of the data is
symmetrical.</li>
</ul>
<div style="padding-left:15px;">
<p><strong>One Sample of Data</strong></p>
<div
style="float:right;font-size:.8em;background-color:lightgray;padding:5px;border-radius:4px;">
<a style="color:darkgray;" href="javascript:showhide('wilcoxonsignedranklatex')">Math
Code</a>
</div>
<div id="wilcoxonsignedranklatex" style="display:none;">
<pre><code>$$
  H_0: \text{Median} = \text{(Some Number)}
$$

$$
  H_a: \text{Median} \neq \text{(Same Number)}
$$</code></pre>
</div>
<p><span class="math inline">\(H_0: \text{Median} = \text{(Some
Number)}\)</span></p>
<p><span class="math inline">\(H_a: \text{Median} \
\left\{\underset{&lt;}{\stackrel{&gt;}{\neq}}\right\} \ \text{(Some
Number)}\)</span></p>
<p><br/></p>
<p><strong>Paired Samples of Data</strong></p>
<div
style="float:right;font-size:.8em;background-color:lightgray;padding:5px;border-radius:4px;">
<a style="color:darkgray;" href="javascript:showhide('wilcoxonsignedranklatexpaired')">Math
Code</a>
</div>
<div id="wilcoxonsignedranklatexpaired" style="display:none;">
<pre><code>$$
  H_0: \text{median of differences} = 0
$$

$$
  H_a: \text{median of differences} \neq 0
$$</code></pre>
</div>
<p><span class="math inline">\(H_0: \text{median of differences} =
0\)</span></p>
<p><span class="math inline">\(H_a: \text{median of differences} \
\left\{\underset{&lt;}{\stackrel{&gt;}{\neq}}\right\} \ 0\)</span></p>
</div>
<p><strong>Examples</strong>: <a
href="./Analyses/Wilcoxon%20Tests/Examples/SleepPairedWilcoxon.html">sleep</a>,
<a
href="./Analyses/Wilcoxon%20Tests/Examples/CornHeightsPairedWilcoxon.html">CornHeights</a></p>
</div>
<hr />
</div>
<div id="r-instructions-2" class="section level6">
<h6>R Instructions</h6>
<div style="padding-left:125px;">
<p><strong>Console</strong> Help Command:
<code>?wilcox.test()</code></p>
<p><strong><em>Paired Data</em></strong></p>
<p><code>wilcox.test(Y1, Y2, mu = YourNull, alternative = YourAlternative, paired = TRUE, conf.level = 0.95)</code></p>
<ul>
<li><code>Y1</code> must be a “numeric” vector. One set of measurements
from the pair.</li>
<li><code>Y2</code> also a “numeric” vector. Other set of measurements
from the pair.</li>
<li><code>YourNull</code> is the numeric value from your null hypothesis
for the median of differences from the paired data. Usually zero.</li>
<li><code>YourAlternative</code> is one of the three options:
<code>"two.sided"</code>, <code>"greater"</code>, <code>"less"</code>
and should correspond to your alternative hypothesis.</li>
<li>The value for <code>conf.level = 0.95</code> can be changed to any
desired confidence level, like 0.90 or 0.99. It should correspond to
<span class="math inline">\(1-\alpha\)</span>.</li>
</ul>
<p><strong>Example Code</strong></p>
<p>Hover your mouse over the example codes to learn more.</p>
<a href="javascript:showhide('wilcoxonSignedRank')">
<div class="hoverchunk">
<p><span class="tooltipr"> wilcox.test( <span
class="tooltiprtext">‘wilcox.test’ is a function for non-parametric one
and two sample tests.</span> </span><span class="tooltipr">
sleep$extra[sleep$group==1],  <span class="tooltiprtext">The hours of
extra sleep that the group had with drug 2.</span> </span><span
class="tooltipr"> sleep$extra[sleep$group==2],  <span
class="tooltiprtext">The hours of extra sleep that the same group had
with drug 1.</span> </span><span class="tooltipr"> mu = 0,  <span
class="tooltiprtext">The numeric value from the null hypothesis for the
median of differences from the paired data is 0 meaning the null
hypothesis is <span class="math inline">\(\text{median of differences} =
0\)</span>.</span> </span><span class="tooltipr"> paired=TRUE,  <span
class="tooltiprtext">This command forces a “paired” samples test to be
performed.</span> </span><span class="tooltipr"> alternative =
“two.sided”,  <span class="tooltiprtext">The alternative hypothesis is
“two.sided” meaning the alternative hypothesis is <span
class="math inline">\(\text{median of differences}
\neq0\)</span>.</span> </span><span class="tooltipr"> conf.level = 0.95)
<span class="tooltiprtext">This test has a 0.95 confidence level which
corresponds to 1 - <span class="math inline">\(\alpha\)</span>.</span>
</span><span class="tooltipr">     <br />
<span class="tooltiprtext">Press Enter to run the code if you have typed
it in yourself. You can also click here to view the output.</span>
</span><span class="tooltipr" style="float:right;">  …  <span
class="tooltiprtext">Click to View Output.</span> </span></p>
</div>
<p></a></p>
<div id="wilcoxonSignedRank" style="display:none;">
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Wilcoxon signed rank test with continuity
correction <span class="tooltiprouttext">The phrase “with continuity
correction” implies that instead of using the “exact” distribution of
the test statistic a “normal approximation” was used instead to compute
the p-value. Further, a small correction was made to allow for the
change from the “discrete” exact distribution to the “continuous normal
distribution” when calculating the p-value.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> data: sleep$extra[sleep$group == 1] and
sleep$extra[sleep$group == 2] <span class="tooltiprouttext">This
statement of the output just reminds you of the code you used to perform
the test. The important thing is recognizing that the first group listed
is “Group 1” and the second group listed is “Group 2.” This is
especially important when using alternative hypotheses of “less” or
“greater” as the order is always “Group 1” is “less” than “Group 2” or
“Group 1” is “greater” than “Group 2.”</span>
</td>
<td>
<span class="tooltiprout"> V = 0, <span class="tooltiprouttext">This is
the test statistic of the test, i.e., the sum of the ranks from the
positive group minus the minimum sum of ranks possible.</span>
</td>
<td>
<span class="tooltiprout">  p-value = 0.009091 <span
class="tooltiprouttext">This is the p-value of the test. If no warning
is displayed when the test is run, then this is the “exact” p-value from
the non-parametric Wilcoxon Test Statistic distribution. Sometimes a
message will appear stating “Cannot compute exact p-value with ties” or
other similar messages. In those cases, the p-value is still considered
valid even though it is obtained through a normal approximation to the
exact distribution.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> alternative hypothesis: true location shift
is not equal to 0 <span class="tooltiprouttext">This reports that the
alternative hypothesis was “two-sided.” If the alternative had been
“less” or “greater” the wording would change accordingly.</span>
</td>
</tr>
</table>
</div>
<p><br></p>
<hr />
<p><strong><em>One Sample</em></strong></p>
<p><code>wilcox.test(object, mu = YourNull, alternative = YourAlternative, conf.level = 0.95)</code></p>
<ul>
<li><code>object</code> must be a “numeric” vector.</li>
<li><code>YourNull</code> is the numeric value from your null hypothesis
for the median (even though it says “mu”).</li>
<li><code>YourAlternative</code> is one of the three options:
<code>"two.sided"</code>, <code>"greater"</code>, <code>"less"</code>
and should correspond to your alternative hypothesis.</li>
<li>The value for <code>conf.level = 0.95</code> can be changed to any
desired confidence level, like 0.90 or 0.99. It should correspond to
<span class="math inline">\(1-\alpha\)</span>.</li>
</ul>
<p><strong>Example Code</strong></p>
<p>Hover your mouse over the example codes to learn more.</p>
<a href="javascript:showhide('wilcoxOneSample')">
<div class="hoverchunk">
<p><span class="tooltipr"> wilcox.test( <span
class="tooltiprtext">‘wilcox.test’ is a function for non-parametric one
and two sample tests.</span> </span><span class="tooltipr"> mtcars <span
class="tooltiprtext">‘mtcars’ is a dataset. Type ‘View(mtcars)’ in R to
view the dataset.</span> </span><span class="tooltipr"> $ <span
class="tooltiprtext">The $ allows us to access any variable from the
mtcars dataset.</span> </span><span class="tooltipr"> mpg,  <span
class="tooltiprtext">‘mpg’ is a quantitative variable (numeric vector)
from the mtcars dataset.</span> </span><span class="tooltipr"> mu = 20, 
<span class="tooltiprtext"> The numeric value from the null hypothesis
is 20 meaning <span class="math inline">\(\mu = 20\)</span>. </span>
</span><span class="tooltipr"> alternative = “two.sided”,  <span
class="tooltiprtext"> The alternative is “two.sided” meaning the
alternative hypothesis is <span
class="math inline">\(\mu\neq20\)</span>.</span> </span><span
class="tooltipr"> conf.level = 0.95) <span class="tooltiprtext">This
test has a 0.95 confidence level which corresponds to 1−α. </span>
</span><span class="tooltipr">     <br />
<span class="tooltiprtext">Press Enter to run the code if you have typed
it in yourself. You can also click here to view the output.</span>
</span><span class="tooltipr" style="float:right;">  …  <span
class="tooltiprtext">Click to View Output.</span> </span></p>
</div>
<p></a></p>
<div id="wilcoxOneSample" style="display:none;">
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Wilcoxon signed rank test with continuity
correction <span class="tooltiprouttext">This reports on the type of
test performed. The phrase “with continuity correction” implies the
normal approximation was used when calculating the p-value of the
test.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> data: mtcars$mpg <span
class="tooltiprouttext">This print-out reminds us that the mpg column of
the mtcars data was used as “Y” in the test.</span>
</td>
<td>
<span class="tooltiprout"> V = 249, <span class="tooltiprouttext">The
test statistic of the test.</span>
</td>
<td>
<span class="tooltiprout">  p-value = 0.7863 <span
class="tooltiprouttext">The p-value of the test.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> alternative hypothesis: true location is not
equal to 20 <span class="tooltiprouttext">The words “not equal” tell us
this was a two-sided test. Had it been a one-sided test, either the word
“less” or the word “greater” would have appeared instead of “not
equal.”</span>
</td>
</tr>
</table>
</div>
</div>
<hr />
</div>
<div id="explanation-2" class="section level6">
<h6>Explanation</h6>
<div style="padding-left:125px;">
<p>In many cases it is of interest to perform a hypothesis test about
<strong>the location of the center of a distribution of data</strong>.
The Wilcoxon Signed Rank Test allows a nonparametric approach to doing
this.</p>
<p><u>The Wilcoxon Signed-Rank Test covers two important
scenarios:</u></p>
<ol style="list-style-type: decimal">
<li><strong>One sample</strong> of data from a population. (Not very
common.)</li>
<li>The differences obtained from <strong>paired data</strong>. (Very
common.)</li>
</ol>
<p><br></p>
<p>The Wilcoxon methods are most easily explained through examples,
beginning with the paired data for which the method was originally
created.</p>
<p>** Scroll down for the <a href="#one">One Sample Example</a> if that
is what you are really interested in. However, it is still recommended
that you read the paired data example first.</p>
<hr />
<p><strong><em>Paired Data Example</em></strong></p>
<div style="padding-left:15px;">
<div style="color:#a8a8a8;">
<p>Note: the data for this example comes from the original 1945 paper <a
href="http://sci2s.ugr.es/keel/pdf/algorithm/articulo/wilcoxon1945.pdf">Individual
Comparison by Ranking Methods</a> by Frank Wilcoxon.</p>
</div>
<hr />
<p><strong><em>Background</em></strong></p>
<p>Height differences “between cross- and self- fertilized corn plants
of the same pair” were collected. The experiment hypothesized that the
center of the distribution of the height differences would be zero, with
the alternative being that the center was not zero. The result of the
data collection was 15 height differences:</p>
<div style="padding-left:15px;">
<p><strong>Differences</strong>: 14, 56, 60, 16, 6, 8, -48, 49, 24, 28,
29, 41, -67, 23, 75</p>
</div>
<hr />
<p><strong><em>Step 1</em></strong></p>
<p>The first step of the Wilcoxon Signed Rank Test is to order the
differences from smallest <em>magnitude</em> to largest
<em>magnitude</em>. Negative signs are essentially ignored at this point
and only magnitudes of the numbers matter.</p>
<div style="padding-left:15px;">
<p><strong>Sorted Differences</strong>: 6, 8, 14, 16, 23, 24, 28, 29,
41, -48, 49, 56, 60, -67, 75</p>
</div>
<hr />
<p><strong><em>Step 2</em></strong></p>
<p>The next step is to rank the ordered values. Negative signs are
attached to the ranks corresponding to negative numbers.</p>
<div style="padding-left:15px;">
<table style="width:100%;">
<colgroup>
<col width="27%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="6%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="6%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="6%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th> </th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Differences</strong>:</td>
<td>6</td>
<td>8</td>
<td>14</td>
<td>16</td>
<td>23</td>
<td>24</td>
<td>28</td>
<td>29</td>
<td>41</td>
<td>-48</td>
<td>49</td>
<td>56</td>
<td>60</td>
<td>-67</td>
<td>75</td>
</tr>
<tr class="even">
<td><strong>Ranks</strong>:</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>-10</td>
<td>11</td>
<td>12</td>
<td>13</td>
<td>-14</td>
<td>15</td>
</tr>
</tbody>
</table>
</div>
<p>Note that the ranks will always be of the form <span
class="math inline">\(1, 2, \ldots, n\)</span>. In this case, <span
class="math inline">\(n=15\)</span>.</p>
<hr />
<p><strong><em>Step 3</em></strong></p>
<p>The ranks are then put into two groups.</p>
<table>
<thead>
<tr class="header">
<th>Negative Ranks</th>
<th>Positive Ranks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>-10, -14</td>
<td>1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 15</td>
</tr>
</tbody>
</table>
<hr />
<p><strong><em>Step 4</em></strong></p>
<p>One of the groups is summed, usually the group with the fewest
observations. Only the absolute values of the ranks are summed.</p>
<div style="padding-left:15px;">
<p><strong>Sum of Negative Ranks</strong>: <span
class="math inline">\(\left|-10\right| + \left|-14\right| =
24\)</span></p>
<p>The sum of the ranks becomes the <em>test statistic</em> of the
Wilcoxon Test. The test statistic is sometimes called <span
class="math inline">\(W\)</span> or <span
class="math inline">\(V\)</span> or <span
class="math inline">\(U\)</span>.</p>
</div>
<hr />
<p><strong><em>Step 5</em></strong></p>
<p>The <span class="math inline">\(p\)</span>-value of the test is then
obtained by computing the probability of the test statistic being as
extreme or more extreme than the one obtained. This is done by first
computing the probability of all possible values the test statistic
could have obtained using mathematical counting techniques. This is a
very tedious process that only a mathematician would enjoy pursuing.
However, the end result is fairly easily understood. If you are
interested, read the details.</p>
<div style="padding-left:30px; padding-right:15px;">
<p><a href="javascript:showhide('uniquename')"><strong>Details</strong></a></p>
<div id="uniquename" style="display:none;">
<p>When there are <span class="math inline">\(n=15\)</span> ranks, the
possible sums of ranks range from 0 to 120 and hit every integer in
between, i.e., <span class="math inline">\(1, 2, 3, \ldots,
120\)</span>. (Note, if summing the negative ranks these sums would
technically all be negative.)</p>
<p>To verify that <span class="math inline">\(120\)</span> is the
largest sum possible for <span class="math inline">\(n=15\)</span>
ranks, note that:</p>
<ul>
<li><p><span class="math inline">\(1+15 = 16\)</span>,</p></li>
<li><p><span class="math inline">\(2 + 14 = 16\)</span>,</p></li>
<li><p><span class="math inline">\(3+13 = 16\)</span>,</p></li>
<li><p><span class="math inline">\(4+12=16\)</span>,</p></li>
<li><p><span class="math inline">\(5+11=16\)</span>,</p></li>
<li><p><span class="math inline">\(6+10=16\)</span>,</p></li>
<li><p><span class="math inline">\(7+9=16\)</span>,</p></li>
<li><p>and finally that <span class="math inline">\(8 =
\frac{16}{2}\)</span>.</p></li>
</ul>
<p>Thus, there are 7 sums of 16 and one sum of <span
class="math inline">\(\frac{16}{2}\)</span>. This could be said in a
mathematically equivalent way by stating there are <span
class="math inline">\(\frac{14}{2}\)</span> sums of 16 and one sum of
<span class="math inline">\(\frac{16}{2}\)</span>. By multiplication
this gives <span class="math display">\[
      \frac{14}{2}\cdot\frac{16}{1} + \frac{1}{1}\cdot\frac{16}{2} =
\frac{14\cdot16 + 1\cdot16}{2} = \frac{15\cdot16}{2} = \frac{n(n+1)}{2}
= 120
\]</span></p>
<p>The probability of each sum occurring is computed by counting all of
the ways a certain sum can occur (combinations) and dividing by the
total number of sums possible. (There are 32,768 total different groups
of ranks possible when there are <span
class="math inline">\(n=15\)</span> ranks.)</p>
<p>For example, a sum of 1 can happen only one way, only the rank of 1
is in the group. A sum of 2 can also only happen 1 way. The sum of 3
however, can happen two ways: we could have the ranks of 1 and 2 in the
group, or just the rank of 3 in the group. A similar counting technique
is then implemented for each possible sum. After all the calculations
are performed, the distribution of possible sums looks like what is
shown in the following plot, where the red bars show those sums that are
as extreme or more extreme than a sum of <span
class="math inline">\(24\)</span> (or its opposite of <span
class="math inline">\(120-24=96\)</span>).</p>
</div>
</div>
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Computing the probabilities of all possible sums creates a
distribution of the test statistic (shown in the plot above). Note that
the test statistic is obtained in Step 4 (above) by taking the sum of
the ranks. Once the distribution of the test statistic is established,
the <span class="math inline">\(p\)</span>-value of the test can be
calculated as the combined probability of possible sums that are as
extreme or more extreme than the one observed.</p>
<p>For this example, it turns out that the probability of getting a sum
of (the absolute value of) negative ranks as extreme or more extreme
than <span class="math inline">\(24\)</span> is <span
class="math inline">\(p=0.04126\)</span> (the sum of the probabilities
of the red bars in the plot above). Thus, at the <span
class="math inline">\(\alpha=0.05\)</span> level we would reject the
null hypothesis that the center of the distribution of differences is
zero. We conclude that the center of the distribution is greater than
zero because the sum of negative ranks is much smaller than we expected
under the zero center hypothesis (the null). Thus, there is sufficient
evidence to conclude that the centers of the distributions of “cross-
and self-fertilized corn plants” heights are not equal. One is greater
than the other. Notice how the following dot plot shows that the
differences are in favor of the cross-fertilized plants (the first group
in the subtraction) being taller. This is true even though two
self-fertilized plants were much taller than their cross-fertilized
counterpart (the two negative differences).</p>
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<hr />
<p><strong><em>Comment</em></strong></p>
<p>If the distribution of differences is symmetric, then the hypotheses
can be written as <span class="math display">\[
  H_0: \mu = 0
\]</span> <span class="math display">\[
  H_a: \mu \neq 0
\]</span></p>
<p>If the distribution is skewed, then the hypotheses technically refer
to the median instead of the mean and should be written as</p>
<p><span class="math display">\[
      H_0: \text{median} = 0
\]</span> <span class="math display">\[
      H_a: \text{median} \neq 0
\]</span></p>
</div>
<hr />
<p><strong><em>One Sample Example {#one}</em></strong></p>
<div style="padding-left:15px;">
<p>The idea behind the one sample Wilcoxon Signed Rank test is nearly
identical to the paired data. The only change is that the median must be
subtracted from all observed values to obtain the <em>differences</em>.
Note that the mean is equal to the median when data is symmetric.</p>
<hr />
<p><strong><em>Background</em></strong></p>
<p>Suppose we are interested in testing to see if the median hourly wage
of BYU-Idaho students during their off-track employment is equal to the
minimum wage in Idaho, $7.25 an hour as of January 1st, 2015. Five
randomly sampled hourly wages from BYU-Idaho Math 221B students provides
the following data.</p>
<div style="padding-left:15px;">
<p><strong>Wages</strong>: $6.00, $9.00, $8.10, $18.00, $10.45</p>
</div>
<p>The differences are then obtained by subtracting the hypothesized
value for the median (or mean if the data is symmetric) from all
observations.</p>
<div style="padding-left:15px;">
<p><strong>Differences</strong>: -1.25, 1.75, 0.85, 10.75, 3.20</p>
<div style="color:#a8a8a8;">
<p>Note: from this point down, the wording of this example is identical
to the paired data example (above) with the numbers changed to match
<span class="math inline">\(n=5\)</span>. It is useful to continue
reading to reinforce the idea of the Wilcoxon Signed Rank Test, but no
new knowledge will be presented.</p>
</div>
</div>
<hr />
<p><strong><em>Step 1</em></strong></p>
<p>The first step of the Wilcoxon Signed Rank Test is to order the
differences from smallest <em>magnitude</em> to largest
<em>magnitude</em>. Negative signs are essentially ignored at this point
and only magnitudes of the numbers matter.</p>
<div style="padding-left:15px;">
<p><strong>Sorted Differences</strong>: 0.85, -1.25, 1.75, 3.20,
10.75</p>
</div>
<hr />
<p><strong><em>Step 2</em></strong></p>
<p>The next step is to rank the ordered values. Negative signs are
attached to the ranks corresponding to negative numbers.</p>
<div style="padding-left:15px;">
<p><strong>Ranks</strong>: 1, -2, 3, 4, 5</p>
</div>
<p>Note that the ranks will always be of the form <span
class="math inline">\(1, 2, \ldots, n\)</span>. In this case, <span
class="math inline">\(n=5\)</span>.</p>
<hr />
<p><strong><em>Step 3</em></strong></p>
<p>The ranks are then put into two groups.</p>
<table>
<thead>
<tr class="header">
<th>Negative Ranks</th>
<th>Positive Ranks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>-2</td>
<td>1, 3, 4, 5</td>
</tr>
</tbody>
</table>
<hr />
<p><strong><em>Step 4</em></strong></p>
<p>One of the groups is summed, usually the group with the fewest
observations.</p>
<div style="padding-left:15px;">
<p><strong>Sum of Negative Ranks</strong>: <span
class="math inline">\(\left|-2\right| = 2\)</span></p>
</div>
<hr />
<p><strong><em>Step 5</em></strong></p>
<p>The <span class="math inline">\(p\)</span>-value of the test is then
obtained by computing the probabilities of all possible sums using
mathematical counting techniques. This is a very tedious process that
only a mathematician would enjoy pursuing. However, the end result is
fairly easily understood. If you are interested, read the details.</p>
<div style="padding-left:30px; padding-right:15px;">
<p><strong>Details</strong></p>
<p>When there are <span class="math inline">\(n=5\)</span> ranks, the
possible sums of ranks range from 0 to 15 and hit every integer in
between, i.e., <span class="math inline">\(1, 2, 3, \ldots, 15\)</span>.
(Note, if summing the negative ranks these sums would technically all be
negative.)</p>
<p>To verify that <span class="math inline">\(15\)</span> is the largest
sum possible for <span class="math inline">\(n=5\)</span> ranks, note
that:</p>
<ul>
<li><p><span class="math inline">\(1+5 = 6\)</span>,</p></li>
<li><p><span class="math inline">\(2 + 4 = 6\)</span>,</p></li>
<li><p>and finally <span class="math inline">\(3 =
\frac{6}{2}\)</span>.</p></li>
</ul>
<p>Thus, there are 2 sums of 6 and one sum of <span
class="math inline">\(\frac{6}{2}\)</span>. This could be said in a
mathematically equivalent way by stating there are <span
class="math inline">\(\frac{4}{2}\)</span> sums of 6 and one sum of
<span class="math inline">\(\frac{6}{2}\)</span>. By multiplication this
gives <span class="math display">\[
  \frac{4}{2}\cdot\frac{6}{1} + \frac{1}{1}\cdot\frac{6}{2} =
\frac{4\cdot6 + 1\cdot6}{2} = \frac{5\cdot6}{2} = \frac{n(n+1)}{2} = 15
\]</span></p>
<p>The probability of each sum occurring is computed by counting all of
the ways a certain sum can occur (combinations) and dividing by the
total number of sums possible. (There are 32 total different groups of
ranks possible when there are <span class="math inline">\(n=5\)</span>
ranks.)</p>
<p>For example, a sum of 1 can happen only one way, only the rank of 1
is in the group. A sum of 2 can also only happen 1 way. The sum of 3
however, can happen two ways: we could have the ranks of 1 and 2 in the
group, or just the rank of 3 in the group. A similar counting technique
is then implemented for each possible sum. After all the calculations
are performed, the distribution of possible sums looks like what is
shown in the following plot, where the red bars show those sums that are
as extreme or more extreme than a sum of <span
class="math inline">\(2\)</span> (or its opposite of <span
class="math inline">\(15-2=13\)</span>).</p>
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Computing the probabilities of all possible sums creates a
distribution of the test statistic (shown in the plot above). Note that
the test statistic is obtained in Step 4 (above) by taking the sum of
the ranks. Once the distribution of the test statistic is established,
the <span class="math inline">\(p\)</span>-value of the test can be
calculated as the combined probability of possible sums that are as
extreme or more extreme than the one observed.</p>
</div>
<p>For this example, it turns out that the probability of getting a sum
of negative ranks as extreme or more extreme than <span
class="math inline">\(-2\)</span> is <span
class="math inline">\(p=0.1875\)</span> (the sum of the probabilities of
the red bars in the plot above). Thus, at the <span
class="math inline">\(\alpha=0.05\)</span> level we would fail to reject
the null hypothesis that the center of the distribution of differences
is zero. We will continue to assume the null hypothesis was true, that
the median off-track hourly wage of BYU-Idaho students is the same as
the Idaho minimum wage.</p>
<hr />
<p><strong><em>Final Comment</em></strong></p>
<p>Notice that when the sample size is large the distribution of the
test statistic can be approximated by a normal distribution. Most
software applications use this approximation when the sample size is
over <span class="math inline">\(50\)</span>, i.e., for <span
class="math inline">\(n\geq50\)</span> because computing all the
possible sums of ranks becomes incredibly time consuming. Thus, for
large sample sizes the results will be almost identical whether the
Wilcoxon Tests or a t Test is used.</p>
</div>
<!-- Content Ends here! -->
<hr />
<div id="quantitative-y-categorical-x-2-groups"
class="section level3 tabset tabset-fade">
<h3 class="tabset tabset-fade">Quantitative Y | Categorical X (2
Groups)</h3>
<div id="graphics-1" class="section level4">
<h4>Graphics</h4>
<div class="tooltipimage" style="float:left;width:125px;"
align="center">
<p><img src="Images/QuantYQualXg2.png" width=59px;> <span
class="tooltipimagetext">Y is a single quantitative variable of
interest. This would be like “heights” of BYU-Idaho students. X is a
qualitative (categorical) variable of interest like “gender” that has
just two groups “A” and “B”. So this logo represents situtations where
we would want to compare heights of male (group A) and female (group B)
students.</span></p>
</div>
<div style="padding-left:125px;color:black
;">
<p><strong>Test(s) used for this category:</strong></p>
<ul>
<li><p>Independent Samples T-test</p>
<ul>
<li>Analysis : <a
href="file:///C:/Users/paige/OneDrive/Documents/Fall%20Semester%202024/MATH%20325/Statistics-Notebook-master/Analyses/t%20Tests/HighSchoolSeniors.html">High
School Seniors t Test</a></li>
</ul></li>
<li><p>Wilcoxon Rank Sum (Mann- Whitney Test)</p>
<ul>
<li>Analysis : <a
href="file:///C:/Users/paige/OneDrive/Documents/Fall%20Semester%202024/MATH%20325/Statistics-Notebook-master/Analyses/Wilcoxon%20Tests/RecallingWords.html">The
Benefits of Word Recall Strategies</a></li>
</ul></li>
</ul>
<p><br></p>
<p><strong>Used for the comparison of two groups, Quantitative Y (ex.
height, weight, money, distance) and Categorical X (ex. gender, birth
month, phone number)</strong></p>
<ul>
<li><p>Questions that this answers:</p>
<ul>
<li><p>How long are boys feet and how long are girls feet?</p></li>
<li><p>Do boys (B) or girls (G) have longer feet, on average, in the
KidsFeet dataset?</p></li>
</ul></li>
</ul>
<hr />
<p>These are the best graphics to use:</p>
<p><a href="GraphicalSummaries.html#boxplots">
<img class="myhover" src="Images/boxplot.png" alt="Side-by-side Boxplots" title="Side-by-side Boxplots">
</a> <a href="GraphicalSummaries.html#dot-plots">
<img class="myhover" src="Images/dotplotdouble.png" alt="Dot Plot" title="Side-by-side Dot Plots">
</a></p>
<p><br></p>
<p><em>Examples:</em></p>
<ul>
<li><p>How long are boys feet and how long are girls feet?
(<strong>Independent Sample</strong>)</p>
<ul>
<li>Can use box or dot plot!</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">plot_ly</span>(KidsFeet, <span class="at">y=</span><span class="sc">~</span>length, <span class="at">x=</span><span class="sc">~</span><span class="fu">as.factor</span>(sex),<span class="at">type=</span><span class="st">&quot;box&quot;</span>,<span class="at">color=</span><span class="sc">~</span>sex, <span class="at">colors=</span><span class="fu">c</span>(<span class="st">&quot;lightblue&quot;</span>,<span class="st">&quot;pink&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">layout</span>( <span class="at">title=</span><span class="st">&quot;4th Grader&#39;s Average Foot Size&quot;</span>,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>          <span class="at">xaxis=</span><span class="fu">list</span>(<span class="at">title=</span><span class="st">&quot;Gender&quot;</span>),<span class="at">yaxis=</span><span class="fu">list</span>(<span class="at">title=</span><span class="st">&quot;Length (cm)&quot;</span>))</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-d82a546690334dc89278" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-d82a546690334dc89278">{"x":{"visdat":{"30a864405640":["function () ","plotlyVisDat"]},"cur_data":"30a864405640","attrs":{"30a864405640":{"y":{},"x":{},"color":{},"colors":["lightblue","pink"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"4th Grader's Average Foot Size","xaxis":{"domain":[0,1],"automargin":true,"title":"Gender","type":"category","categoryorder":"array","categoryarray":["B","G"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Length (cm)"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(173,216,230,0.5)","y":[24.399999999999999,25.399999999999999,24.5,25.199999999999999,25.100000000000001,25.699999999999999,26.100000000000001,22.899999999999999,27.5,24.800000000000001,26.100000000000001,27,24,24.399999999999999,27.100000000000001,25.5,24.199999999999999,23.899999999999999,23.600000000000001,24.699999999999999],"x":["B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B"],"type":"box","name":"B","marker":{"color":"rgba(173,216,230,1)","line":{"color":"rgba(173,216,230,1)"}},"line":{"color":"rgba(173,216,230,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(255,192,203,0.5)","y":[23,23.600000000000001,26,23.699999999999999,24,24.699999999999999,26.699999999999999,25.5,24,24.5,24.199999999999999,26.100000000000001,24,22.5,24.5,22.899999999999999,26,21.600000000000001,24.600000000000001],"x":["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],"type":"box","name":"G","marker":{"color":"rgba(255,192,203,1)","line":{"color":"rgba(255,192,203,1)"}},"line":{"color":"rgba(255,192,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">ggplot</span>(KidsFeet, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(sex),<span class="at">y=</span>length, <span class="at">fill=</span>sex)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis=</span><span class="st">&quot;y&quot;</span>,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>               <span class="at">stackdir=</span><span class="st">&quot;up&quot;</span>,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>               <span class="at">position=</span><span class="st">&quot;dodge&quot;</span>,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>               <span class="at">dotsize=</span><span class="fl">0.45</span>,</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>               <span class="at">binwidth=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;B&quot;</span><span class="ot">=</span><span class="st">&quot;lightblue&quot;</span>,<span class="st">&quot;G&quot;</span><span class="ot">=</span><span class="st">&quot;pink&quot;</span>)) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">&quot;Kennedy 4th Grader&#39;s Foot Size&quot;</span>, <span class="at">x=</span><span class="st">&quot;Length (cm)&quot;</span>, <span class="at">y=</span><span class="st">&quot;Gender&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p><br></p>
<hr />
<ul>
<li><p>Does the Meshed or Before approach have any positive benefits on
memory recall when it comes to remembering content? (<strong>Wilcoxon
Rank Sum Test</strong>)</p>
<ul>
<li>Dot plot over box plot shows the distribution and the individuals
within each distribution</li>
</ul></li>
</ul>
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<!--- End of Add content area.  ------------------>
</div>
</div>
<div id="tests-1" class="section level4">
<h4>Tests</h4>
<div style="padding-left:125px;color:black;">
<!-- Add your customizations in the area below: -->
<div id="independent-samples-t-test"
class="section level5 tabset tabset-fade tabset-pills">
<h5 class="tabset tabset-fade tabset-pills">Independent Samples t
Test</h5>
<div style="float:left;width:125px;" align="center">
<p><a href="index.html#quantitative-y-categorical-x-2-groups"><img src="Images/QuantYQualXg2.png" width=62px;></a></p>
</div>
<p>The independent samples t test is used <strong>when a value is
hypothesized for the difference between two (possibly) different
population means, <span class="math inline">\(\mu_1 -
\mu_2\)</span>.</strong></p>
<ul>
<li>finds the mean of each data set, then subtracts those means for
their difference
<ul>
<li>two groups don’t depend on each other’s results</li>
</ul></li>
</ul>
<div id="overview-3" class="section level6">
<h6>Overview</h6>
<div style="padding-left:125px;">
<p><strong>Questions</strong></p>
<p>The Independent Samples t Test can be used to answer questions
like:</p>
<ul>
<li>Are <span style="background-color:yellow;">boys taller than
girls</span> on average?</li>
<li>Do students who <span style="background-color:yellow;">show up to
class everyday</span> get higher scores on average than <span
style="background-color:yellow;">those who don’t</span>?</li>
<li>Do you take more steps on average <span
style="background-color:yellow;">on weekdays or on weekends</span>?</li>
</ul>
<p><strong>Requirements</strong></p>
<p>The test is only appropriate when both of the following are
satisfied.</p>
<ol style="list-style-type: decimal">
<li><p>Both samples are <strong>representative</strong> of the
population. (Simple random samples are the best way to do
this.)</p></li>
<li><p>The sampling distribution of the difference of the sample means
<span class="math inline">\((\bar{x}_1 - \bar{x}_2)\)</span> <em>can be
assumed to be normal</em>.</p></li>
</ol>
<ul>
<li>This is a safe assumption when the sample size of each group is
<span class="math inline">\(30\)</span> or greater or when the
population data from each group can be assumed to be normal with a Q-Q
Plot.</li>
</ul>
<p><strong>Hypotheses</strong></p>
<div style="padding-left:15px;">
<div
style="float:right;font-size:.8em;background-color:lightgray;padding:5px;border-radius:4px;">
<a style="color:darkgray;" href="javascript:showhide('independentsampletlatex')">Math
Code</a>
</div>
<div id="independentsampletlatex" style="display:none;">
<pre><code>$$
  H_0: \mu_\text{label 1} - \mu_\text{label 2} = 13.2
$$

$$
  H_a: \mu_\text{label 1} - \mu_\text{label 2} \neq 13.2
$$</code></pre>
</div>
<p><span class="math inline">\(H_0: \mu_1 - \mu_2 = \text{some number,
but typically 0}\)</span></p>
<p><span class="math inline">\(H_a: \mu_1 - \mu_2 \
\left\{\underset{&lt;}{\stackrel{&gt;}{\neq}}\right\} \ \text{some
number, but typically 0}\)</span></p>
</div>
<p><strong>Examples</strong>: <a
href="./Analyses/t%20Tests/Examples/SleepIndependentt.html">sleepInd</a>
<a
href="./Analyses/t%20Tests/Examples/Student1Independent.html">student1</a>
<a
href="./Analyses/t%20Tests/Examples/Student2Independent.html">student2</a></p>
</div>
<hr />
</div>
<div id="r-instructions-3" class="section level6">
<h6>R Instructions</h6>
<div style="padding-left:125px;">
<p><strong>Console</strong> Help Command: <code>?t.test()</code></p>
<p>There are two ways to perform the test.</p>
<p><strong>Option 1:</strong></p>
<p><code>t.test(Y ~ X, data = YourData, mu = YourNull, alternative = YourAlternative, conf.level = 0.95)</code></p>
<ul>
<li><code>Y</code> must be a “numeric” vector from <code>YourData</code>
that represents the data for both samples.</li>
<li><code>X</code> must be a “factor” or “character” vector from
<code>YourData</code> that represents the group assignment for each
observation. There can only be two groups specified in this column of
data.</li>
<li><code>YourNull</code> is the numeric value from your null hypothesis
for <span class="math inline">\(\mu_1-\mu_2\)</span>.</li>
<li><code>YourAlternative</code> is one of the three options:
<code>"two.sided"</code>, <code>"greater"</code>, <code>"less"</code>
and should correspond to your alternative hypothesis.</li>
<li>The value for <code>conf.level = 0.95</code> can be changed to any
desired confidence level, like 0.90 or 0.99. It should correspond to
<span class="math inline">\(1-\alpha\)</span>.</li>
</ul>
<p>Testing Assumptions</p>
<p><code>library(car)</code></p>
<p><code>qqPlot(Y ~ X, data=YourData)</code></p>
<p><strong>Example Code</strong></p>
<p>Hover your mouse over the example codes to learn more.</p>
<a href="javascript:showhide('indptTest1')">
<div class="hoverchunk">
<p><span class="tooltipr"> t.test( <span class="tooltiprtext">‘t.test’
is an R function that performs one and two sample t-tests.</span>
</span><span class="tooltipr"> length  <span
class="tooltiprtext">‘length’ is a quantitative variable (numeric
vector).</span> </span><span class="tooltipr"> ~  <span
class="tooltiprtext">‘~’ is the tilde symbol.</span> </span><span
class="tooltipr"> sex,  <span class="tooltiprtext">‘sex’ is a ‘factor’
or ‘character’ vector that represents the group assignment for each
observation. There are two groups.</span> </span><span class="tooltipr">
data=KidsFeet,  <span class="tooltiprtext">‘KidsFeet’ is a dataset in
library(mosaic). Type View(KidsFeet) to view it.</span> </span><span
class="tooltipr"> mu = 0,  <span class="tooltiprtext">The numeric value
from the null hypothesis for μ1-μ2 is 0 meaning the null hypothesis is
<span class="math inline">\(\mu1-\mu2 = 0\)</span></span> </span><span
class="tooltipr"> alternative = “two.sided”,  <span
class="tooltiprtext"> The alternative is “two-sided” meaning the
alternative hypothesis is <span class="math inline">\(\mu1-\mu2 \neq
0\)</span>.</span> </span><span class="tooltipr"> conf.level = 0.95)
<span class="tooltiprtext">This test has a 0.95 confidence level which
corresponds to <span class="math inline">\(1-\alpha\)</span></span>
</span><span class="tooltipr">     <br />
<span class="tooltiprtext">Press Enter to run the code if you have typed
it in yourself. You can also click here to view the output.</span>
</span><span class="tooltipr" style="float:right;font-size:.8em;">
 Click to Show Output  <span class="tooltiprtext">Click to View
Output.</span> </span></p>
</div>
<p></a></p>
<div id="indptTest1" style="display:none;">
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Welch Two Sample t-test <span
class="tooltiprouttext">EXPLANATION.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> data: length by sex <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> t = 1.9174, <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
<td>
<span class="tooltiprout">  df = 36.275, <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
<td>
<span class="tooltiprout">  p-value = 0.06308 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> alternative hypothesis: true difference in
means is not equal to 0 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> 95 percent confidence interval: <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout">  -0.04502067 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
<td align="left">
<span class="tooltiprout">  1.61291541 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> sample estimates: <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> mean in group B mean in group G <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout">   25.10500 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
<td align="left">
<span class="tooltiprout">   24.32105 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
</table>
</div>
<a href="javascript:showhide('indptTest1qqPlot')">
<div class="hoverchunk">
<p><span class="tooltipr"> qqPlot( <span class="tooltiprtext">‘qqPlot’
is a R function from library(car) that creates a qqPlot.</span>
</span><span class="tooltipr"> length  <span
class="tooltiprtext">‘length’ is a quantitative variable (numeric
vector).</span> </span><span class="tooltipr"> ~  <span
class="tooltiprtext">‘~’ is the tilde symbol.</span> </span><span
class="tooltipr"> sex,  <span class="tooltiprtext">‘sex’ is a “factor”
or “character” vector that represents the group assignment for each
observation. There are two groups.</span> </span><span class="tooltipr">
data=KidsFeet) <span class="tooltiprtext">‘KidsFeet’ is a dataset in
library(mosaic). Type View(KidsFeet) to view it.</span> </span><span
class="tooltipr" style="float:right;font-size:.8em;">  Click to Show
Output  <span class="tooltiprtext">Click to View Output.</span>
</span></p>
</div>
</a>
<div id="indptTest1qqPlot" style="display:none;">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<p><br /></p>
<p><strong>Option 2:</strong></p>
<p><code>t.test(NameOfYourData$Y1, NameOfYourData$Y2, mu = YourNull, alternative = YourAlternative, conf.level = 0.95)</code></p>
<ul>
<li><code>NameOfYourData</code> is the name of your data set.</li>
<li><code>Y1</code> must be a “numeric” vector that represents the
quantitative data from the first sample.</li>
<li><code>Y2</code> must be a “numeric” vector that represents the
quantitative data from the second sample.</li>
<li><code>YourNull</code> is the numeric value from your null hypothesis
for the difference of <span class="math inline">\(\mu_1-\mu_2\)</span>.
This is typically zero.</li>
<li><code>YourAlternative</code> is one of the three options:
<code>"two.sided"</code>, <code>"greater"</code>, <code>"less"</code>
and should correspond to your alternative hypothesis.</li>
<li>The value for <code>conf.level = 0.95</code> can be changed to any
desired confidence level, like 0.90 or 0.99. It should correspond to
<span class="math inline">\(1-\alpha\)</span>.</li>
</ul>
<p>Testing Assumptions</p>
<p><code>library(car)</code></p>
<p><code>par(mfrow=c(1,2))</code></p>
<p><code>qqPlot(NameOfYourData$Y1)</code></p>
<p><code>qqPlot(NameOfYourData$Y2)</code></p>
<p><strong>Example Code</strong></p>
<p>Hover your mouse over the example codes to learn more.</p>
<a href="javascript:showhide('indptTest2')">
<div class="hoverchunk">
<p><span class="tooltipr"> t.test( <span class="tooltiprtext">‘t.test’
is an R function that performs one and two sample t-tests.</span>
</span><span class="tooltipr"> KidsFeet$length[KidsFeet$sex == “B”], 
<span class="tooltiprtext">A numeric vector that represents the
quantitative data or the foot length for the first sample of data which
in this case is the boys.</span> </span><span class="tooltipr">
KidsFeet$length[KidsFeet$sex == “G”],  <span class="tooltiprtext">A
numeric vector that represents the quantitative data or the foot length
for the second sample of data which in this case is the girls.</span>
</span><span class="tooltipr"> mu = 0,  <span class="tooltiprtext">The
numeric value from the null hypothesis for μ1-μ2 is 0 meaning the null
hypothesis is <span class="math inline">\(\mu1-\mu2 = 0\)</span></span>
</span><span class="tooltipr"> alternative = “two.sided”,  <span
class="tooltiprtext"> The alternative is “two-sided” meaning the
alternative hypothesis is <span class="math inline">\(\mu1-\mu2 \neq
0\)</span>.</span> </span><span class="tooltipr"> conf.level = 0.95)
<span class="tooltiprtext">This test has a 0.95 confidence level which
corresponds to <span class="math inline">\(1-\alpha\)</span></span>
</span><span class="tooltipr">     <br />
<span class="tooltiprtext">Press Enter to run the code if you have typed
it in yourself. You can also click here to view the output.</span>
</span><span class="tooltipr" style="float:right;">  …  <span
class="tooltiprtext">Click to View Output.</span> </span></p>
</div>
<p></a></p>
<div id="indptTest2" style="display:none;">
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Welch Two Sample t-test <span
class="tooltiprouttext">EXPLANATION.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> data: KidsFeet$length[KidsFeet$sex == “B”]
and KidsFeet$length[KidsFeet$sex == “G”] <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> t = 1.9174, <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
<td>
<span class="tooltiprout">  df = 36.275, <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
<td>
<span class="tooltiprout">  p-value = 0.06308 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> alternative hypothesis: true difference in
means is not equal to 0 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> 95 percent confidence interval: <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout">  -0.04502067 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
<td align="left">
<span class="tooltiprout">  1.61291541 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> sample estimates: <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> mean of x mean of y <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout">   25.10500 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
<td align="left">
<span class="tooltiprout">   24.32105 <span
class="tooltiprouttext">EXPLANATION.</span>
</td>
</tr>
</table>
</div>
<a href="javascript:showhide('indptTest2qqPlot')">
<div class="hoverchunk">
<p><span class="tooltipr"> par( <span class="tooltiprtext">‘par’ is a R
function that can be used to set or query graphical parameters.</span>
</span><span class="tooltipr"> mfrow=c(1,2)) <span
class="tooltiprtext">Parameter is being set. The first item inside the
combine function c() is the number of rows and the second is the number
of columns. </span> </span><br><span class="tooltipr"> qqPlot( <span
class="tooltiprtext">‘qqPlot’ is a R function from library(car) that
creates a qqPlot.</span> </span><span class="tooltipr">
KidsFeet$length[KidsFeet$sex == “B”]) <span class="tooltiprtext">A
numeric vector that represents the quantitative data or the foot length
for the first sample of data which in this case is the boys.</span>
</span><br><span class="tooltipr"> qqPlot( <span
class="tooltiprtext">‘qqPlot’ is a R function from library(car) that
creates a qqPlot.</span> </span><span class="tooltipr">
KidsFeet$length[KidsFeet$sex == “G”]) <span class="tooltiprtext">A
numeric vector that represents the quantitative data or the foot length
for the second sample of data which in this case is the girls.</span>
</span><span class="tooltipr" style="float:right;">  …  <span
class="tooltiprtext">Click to View Output.</span> </span></p>
</div>
</a>
<div id="indptTest2qqPlot" style="display:none;">
<pre><code>## [1] 9 8</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<pre><code>## [1] 18  7</code></pre>
</div>
</div>
<hr />
</div>
<div id="explanation-3" class="section level6">
<h6>Explanation</h6>
<div style="padding-left:125px;">
<p>The first figure below depicts the scenario where the difference in
means of two separate normal distributions is non-zero. - In other
words, the two distributions have different means, <span
class="math inline">\(\mu_1\)</span> and <span
class="math inline">\(\mu_2\)</span>, respectively. - It is worth
emphasizing that the values of <span
class="math inline">\(\mu_1\)</span> and <span
class="math inline">\(\mu_2\)</span> are unknown to the researcher.</p>
<p>The only thing observed are two separate samples of data (blue dots)
of sizes <span class="math inline">\(n_1\)</span> and <span
class="math inline">\(n_2\)</span>, respectively.</p>
<p>For the scenario depicted, the null hypothesis that <span
class="math inline">\(H_0: \mu_1 - \mu_2 = 0\)</span> (i.e., that <span
class="math inline">\(\mu_1=\mu_2\)</span>) is rejected in favor of the
alternative that <span class="math inline">\(H_a: \mu_1 - \mu_2 \neq
0\)</span> based on the sample data observed. - This dicision would be
correct as the true difference in means, <span
class="math inline">\(\mu_1-\mu_2\)</span> is non-zero in this case.</p>
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<hr />
<p>When the <strong>null hypothesis is true</strong>, that <span
class="math inline">\(H_0: \mu_1 - \mu_2 = 0\)</span> : - the test
statistic <span class="math inline">\(t\)</span> that is obtained by
measuring the distance between the two sample means, <span
class="math inline">\(\bar{x}_1-\bar{x}_2\)</span> - appropriately
standardizing the result follows a <span
class="math inline">\(t\)</span> distribution with degrees of freedom
less than or equal to <span class="math inline">\(n_1+n_2-2\)</span>. -
Thus, the <span class="math inline">\(p\)</span>-value of the
independent samples <span class="math inline">\(t\)</span> test is
obtained by using this <span class="math inline">\(t\)</span>
distribution to calculate the probability of a test statistic <span
class="math inline">\(t\)</span> being as extreme or more extreme than
the one observed assuming the null hypothesis is true. <span
class="math display">\[
  t = \frac{(\bar{x}_1 - \bar{x}_2) - (\mu_1 -
\mu_2)}{\sqrt{s_1/n_1+s_2/n_2 }}
\]</span></p>
</div>
<hr />
</div>
</div>
<div id="wilcoxon-rank-sum-mann-whitney-test"
class="section level5 tabset tabset-fade tabset-pills">
<h5 class="tabset tabset-fade tabset-pills">Wilcoxon Rank Sum
(Mann-Whitney) Test</h5>
<div style="float:left;width:125px;" align="center">
<p><img src="Images/QuantYQualXg2.png" width=58px;></p>
</div>
<p>For testing the equality of the medians of two (possibly different)
distributions of a quantitative variable.</p>
<ul>
<li>Box plots + Dot plots are great to show off this kind of data
(because it shows the median!)
<ul>
<li>Median line closer to the <strong>bottom</strong> of the box plot =
<strong>Right Skewed</strong></li>
<li>Median line is closer to the <strong>top</strong> of the box plot =
<strong>Left Skewed</strong></li>
</ul></li>
</ul>
<div id="overview-4" class="section level6">
<h6>Overview</h6>
<div style="padding-left:125px;">
<p>The <strong>nonparametric equivalent</strong> of the Independent
Samples t Test. Can also be used when data is ordered (ordinal) but does
not have an exact measurement. For example, first place, second place,
and so on.</p>
<p>The Independent Samples t Test is more appropriate when the
distributions are normal, or when the sample size for each sample is
large.</p>
<p>The test is negatively affected when there are ties (repeated values)
present in the data, but the results are still useful if there are
relatively few ties.</p>
<p><strong>Hypotheses</strong></p>
<p>Originally designed to test for the equality of medians from two
identically shaped distributions.</p>
<div style="padding-left:15px;">
<div
style="float:right;font-size:.8em;background-color:lightgray;padding:5px;border-radius:4px;">
<a style="color:darkgray;" href="javascript:showhide('wilcoxonranksumlatex')">Math
Code</a>
</div>
<div id="wilcoxonranksumlatex" style="display:none;">
<pre><code>$$
  H_0: \text{difference in medians} = 0
$$

$$
  H_a: \text{difference in medians} \neq 0
$$</code></pre>
</div>
<p><span class="math inline">\(H_0: \text{difference in medians} =
0\)</span></p>
<p><span class="math inline">\(H_a: \text{difference in medians} \neq
0\)</span></p>
</div>
<p>However, the test also allows for the more general hypotheses that
one distribution is <em>stochastically greater</em> than the other.</p>
<div style="padding-left:15px;">
<p><span class="math inline">\(H_0: \text{the distributions are
stochastically equal}\)</span></p>
<p><span class="math inline">\(H_a: \text{one distribution is
stochastically greater than the other}\)</span></p>
</div>
<p>If these hypotheses are used, then the distributions do not have to
be identically distributed.</p>
<p>(Note: Men’s heights are <em>stochastically greater</em> than women’s
heights because men are generally taller than women, but not all men are
taller than all women.)</p>
<p><strong>Examples</strong>: <a
href="./Analyses/Wilcoxon%20Tests/Examples/BugSprayWilcoxonRankSum.html">BugSpray</a>,
<a
href="./Analyses/Wilcoxon%20Tests/Examples/MoralIntegration.html">MoralIntegration</a></p>
</div>
<hr />
</div>
<div id="r-instructions-4" class="section level6">
<h6>R Instructions</h6>
<div style="padding-left:125px;">
<p><strong>Console</strong> Help Command:
<code>?wilcox.test()</code></p>
<p>There are two ways to perform the test.</p>
<p><strong>Option 1:</strong></p>
<p><code>wilcox.test(Y ~ X, data = YourData, mu = YourNull, alternative = YourAlternative, conf.level = 0.95)</code></p>
<ul>
<li><code>Y</code> must be a “numeric” vector from <code>YourData</code>
that represents the data for both samples.</li>
<li><code>X</code> must be a “factor” or “character” vector from
<code>YourData</code> that represents the group assignment for each
observation. There can only be two groups specified in this column of
data.</li>
<li><code>YourNull</code> is the numeric value from your null hypothesis
for the difference in medians from the two groups.</li>
<li><code>YourAlternative</code> is one of the three options:
<code>"two.sided"</code>, <code>"greater"</code>, <code>"less"</code>
and should correspond to your alternative hypothesis.</li>
<li>The value for <code>conf.level = 0.95</code> can be changed to any
desired confidence level, like 0.90 or 0.99. It should correspond to
<span class="math inline">\(1-\alpha\)</span>.</li>
</ul>
<p><strong>Example Code</strong></p>
<p>Hover your mouse over the example codes to learn more.</p>
<a href="javascript:showhide('wilcoxonRankSum')">
<div class="hoverchunk">
<p><span class="tooltipr"> wilcox.test( <span
class="tooltiprtext">‘wilcox.test’ is a function for non-parametric one
and two sample tests.</span> </span><span class="tooltipr"> length 
<span class="tooltiprtext">‘length’ is a quantitative variable (numeric
vector).</span> </span><span class="tooltipr"> ~  <span
class="tooltiprtext">‘~’ is the tilde symbol.</span> </span><span
class="tooltipr"> sex,  <span class="tooltiprtext">‘sex’ is a ‘factor’
or ‘character’ vector that represents the group assignment for each
observation. There are two groups.</span> </span><span class="tooltipr">
data=KidsFeet,  <span class="tooltiprtext">‘KidsFeet’ is a dataset in
library(mosaic). Type View(KidsFeet) to view it.</span> </span><span
class="tooltipr"> mu = 0,  <span class="tooltiprtext">The numeric value
from the null hypothesis for the difference in medians from the two
groups is 0 meaning the null hypothesis is <span
class="math inline">\(\text{difference in medians} = 0\)</span></span>
</span><span class="tooltipr"> alternative = “two.sided”,  <span
class="tooltiprtext"> The alternative is “two-sided” meaning the
alternative hypothesis is <span class="math inline">\(\text{difference
in medians} \neq 0\)</span>.</span> </span><span class="tooltipr">
conf.level = 0.95) <span class="tooltiprtext">This test has a 0.95
confidence level which corresponds to <span
class="math inline">\(1-\alpha\)</span></span> </span><span
class="tooltipr">     <br />
<span class="tooltiprtext">Press Enter to run the code if you have typed
it in yourself. You can also click here to view the output.</span>
</span><span class="tooltipr" style="float:right;">  …  <span
class="tooltiprtext">Click to View Output.</span> </span></p>
</div>
<p></a></p>
<div id="wilcoxonRankSum" style="display:none;">
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Wilcoxon rank sum test with continuity
correction <span class="tooltiprouttext">This states the test that was
performed and that a normal approximation to the test statistic was used
instead of the exact distribution.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> data: length by sex <span
class="tooltiprouttext">This states that the length column was split
into the two groups found in the “sex” column. Unfortunately, it forgets
to remind us that the test used the KidsFeet data set.</span>
</td>
<td>
<span class="tooltiprout"> V = 252, <span class="tooltiprouttext">The
test statistic of the test. In this case, the sum of the ranks from the
alphabetically first group minus the minimum sum of ranks
possible.</span>
</td>
<td>
<span class="tooltiprout">  p-value = 0.0836 <span
class="tooltiprouttext">The p-value of the test.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> alternative hypothesis: true location shift
is not equal to 0 <span class="tooltiprouttext">This reports that the
test used an alternative hypothesis of “not equal” (a two-sided test).
Further, the phrase “true location shift” emphasizes that the Wilcoxon
Rank Sum Test is testing to see if one distribution is shifted higher or
lower than the other.</span>
</td>
</tr>
</table>
</div>
<p><br></p>
<p><strong>Option 2:</strong></p>
<p><code>wilcox.test(object1, object2, mu = YourNull, alternative = YourAlternative, conf.level = 0.95)</code></p>
<ul>
<li><code>object1</code> must be a “numeric” vector that represents the
first sample of data.</li>
<li><code>obejct2</code> must be a “numeric” vector that represents the
second sample of data.</li>
<li><code>YourNull</code> is the numeric value from your null hypothesis
for the difference in medians from the two groups.</li>
<li><code>YourAlternative</code> is one of the three options:
<code>"two.sided"</code>, <code>"greater"</code>, <code>"less"</code>
and should correspond to your alternative hypothesis.</li>
<li>The value for <code>conf.level = 0.95</code> can be changed to any
desired confidence level, like 0.90 or 0.99. It should correspond to
<span class="math inline">\(1-\alpha\)</span>.</li>
</ul>
<p><strong>Example Code</strong></p>
<a href="javascript:showhide('wilcoxonRankSum2')">
<div class="hoverchunk">
<p><span class="tooltipr"> wilcox.test( <span
class="tooltiprtext">‘wilcox.test’ is a function for non-parametric one
and two sample tests.</span> </span><span class="tooltipr">
KidsFeet$length[KidsFeet$sex == “B”],  <span class="tooltiprtext">A
numeric vector of foot length for the first sample of data or for the
group of boys.</span> </span><span class="tooltipr">
KidsFeet$length[KidsFeet$sex == “G”],  <span class="tooltiprtext">A
numeric vector of foot length for the second sample of data or for the
group of girls.</span> </span><span class="tooltipr"> mu = 0,  <span
class="tooltiprtext">The numeric value from the null hypothesis for the
difference in medians from the two groups is 0 meaning the null
hypothesis is <span class="math inline">\(\text{difference in medians} =
0\)</span></span> </span><span class="tooltipr"> alternative =
“two.sided”,  <span class="tooltiprtext"> The alternative is “two-sided”
meaning the alternative hypothesis is <span
class="math inline">\(\text{difference in medians} \neq
0\)</span>.</span> </span><span class="tooltipr"> conf.level = 0.95)
<span class="tooltiprtext">This test has a 0.95 confidence level which
corresponds to <span class="math inline">\(1-\alpha\)</span></span>
</span><span class="tooltipr">     <br />
<span class="tooltiprtext">Press Enter to run the code if you have typed
it in yourself. You can also click here to view the output.</span>
</span><span class="tooltipr" style="float:right;">  …  <span
class="tooltiprtext">Click to View Output.</span> </span></p>
</div>
<p></a></p>
<div id="wilcoxonRankSum2" style="display:none;">
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Wilcoxon rank sum test with continuity
correction <span class="tooltiprouttext">This states the type of test
performed.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> data: KidsFeet$length[KidsFeet$sex == “B”]
and KidsFeet$length[KidsFeet$sex == “G”] <span
class="tooltiprouttext">Reminds you what data was used for the test and
points out that the first set of data listed is “Group 1” and the second
set of data listed is “Group 2.”</span>
</td>
<td>
<span class="tooltiprout"> V = 252, <span class="tooltiprouttext">The
test statistic of the test.</span>
</td>
<td>
<span class="tooltiprout">  p-value = 0.0836 <span
class="tooltiprouttext">The p-value of the test.</span>
</td>
</tr>
<tr>
<td>
<span class="tooltiprout"> alternative hypothesis: true location shift
is not equal to 0 <span class="tooltiprouttext">The alternative
hypothesis of the test. The phrase “not equal” implies a “two-sided”
alternative was used.</span>
</td>
</tr>
</table>
</div>
<p><img src="index_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<hr />
</div>
<div id="explanation-4" class="section level6">
<h6>Explanation</h6>
<div style="padding-left:125px;">
<p>In many cases it is of interest to perform a hypothesis test
concerning the equality of the centers of two (possibly different)
distributions. In other words, an independent samples test. The Wilcoxon
Rank Sum Test allows a nonparametric approach to doing this. It is often
considered the nonparametric equivalent of the independent samples t
test.</p>
<p>The method is most easily explained through an example. The theory
behind it is very similar to the theory behind the Wilcoxon Signed-Rank
Test.</p>
<p><br /></p>
<p><strong><em>Independent Samples Data Example</em></strong></p>
<div style="padding-left:15px;">
<div style="color:#a8a8a8;">
<p>Note: the data for this example comes from the original 1945 paper <a
href="http://sci2s.ugr.es/keel/pdf/algorithm/articulo/wilcoxon1945.pdf">Individual
Comparison by Ranking Methods</a> by Frank Wilcoxon.</p>
</div>
<hr />
<p><strong><em>Background</em></strong></p>
<p>The percent of flies (bugs) killed from two different concentrations
of a certain spray were recorded from 16 different trials, 8 trials per
treatment concentration. The experiment hypothesized that the center of
the distributions of the percent killed by either concentration were the
same. In other words, that both treatments were equally effective. The
alternative hypothesis was that the treatments differed in their
effectiveness.</p>
<div style="padding-left:15px;">
<table>
<thead>
<tr class="header">
<th>Spray Concentration</th>
<th>Percent Killed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>68, 68, 59, 72, 64, 67, 70, 74</td>
</tr>
<tr class="even">
<td>B</td>
<td>60, 67, 61, 62, 67, 63, 56, 58</td>
</tr>
</tbody>
</table>
</div>
<hr />
<p><strong><em>Step 1</em></strong></p>
<p>The first step of the Wilcoxon Rank Sum Test is to order all the data
from smallest <em>magnitude</em> to largest <em>magnitude</em>, while
keeping track of the group.</p>
<div style="padding-left:15px;">
<table style="width:100%;">
<colgroup>
<col width="44%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
</colgroup>
<thead>
<tr class="header">
<th>Sorted Data</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Percent Killed</td>
<td>56</td>
<td>58</td>
<td>59</td>
<td>60</td>
<td>61</td>
<td>62</td>
<td>63</td>
<td>64</td>
<td>67</td>
<td>67</td>
<td>67</td>
<td>68</td>
<td>68</td>
<td>70</td>
<td>72</td>
<td>74</td>
</tr>
<tr class="even">
<td>Concentration</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>B</td>
<td>B</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>A</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<hr />
<p><strong><em>Step 2</em></strong></p>
<p>The next step is to rank the ordered values.</p>
<div style="padding-left:15px;">
<table style="width:100%;">
<colgroup>
<col width="44%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
</colgroup>
<thead>
<tr class="header">
<th>Sorted Data</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Percent Killed</td>
<td>56</td>
<td>58</td>
<td>59</td>
<td>60</td>
<td>61</td>
<td>62</td>
<td>63</td>
<td>64</td>
<td>67</td>
<td>67</td>
<td>67</td>
<td>68</td>
<td>68</td>
<td>70</td>
<td>72</td>
<td>74</td>
</tr>
<tr class="even">
<td>Concentration</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>B</td>
<td>B</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>A</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
</tr>
<tr class="odd">
<td>Rank</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
<td>13</td>
<td>14</td>
<td>15</td>
<td>16</td>
</tr>
</tbody>
</table>
</div>
<p>Note that the ranks will always be of the form <span
class="math inline">\(1, 2, \ldots, n\)</span>. In this case, <span
class="math inline">\(n=16\)</span>.</p>
<p>Any ranks that are tied need to have the average rank assigned to
each of those that are tied.</p>
<table style="width:100%;">
<colgroup>
<col width="44%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
</colgroup>
<thead>
<tr class="header">
<th>Sorted Data</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Percent Killed</td>
<td>56</td>
<td>58</td>
<td>59</td>
<td>60</td>
<td>61</td>
<td>62</td>
<td>63</td>
<td>64</td>
<td><span style="color:#B22222;">67</span></td>
<td><span style="color:#B22222;">67</span></td>
<td><span style="color:#B22222;">67</span></td>
<td><span style="color:#7EC0EE;">68</span></td>
<td><span style="color:#7EC0EE;">68</span></td>
<td>70</td>
<td>72</td>
<td>74</td>
</tr>
<tr class="even">
<td>Concentration</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>B</td>
<td>B</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>A</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
</tr>
<tr class="odd">
<td>Rank</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td><span style="color:#B22222;">10</span></td>
<td><span style="color:#B22222;">10</span></td>
<td><span style="color:#B22222;">10</span></td>
<td><span style="color:#7EC0EE;">12.5</span></td>
<td><span style="color:#7EC0EE;">12.5</span></td>
<td>14</td>
<td>15</td>
<td>16</td>
</tr>
</tbody>
</table>
<hr />
<p><strong><em>Step 3</em></strong></p>
<p>The ranks are then returned to their original groups.</p>
<table>
<thead>
<tr class="header">
<th>Ranks of Spray A</th>
<th>Ranks of Spray B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>3, 8, 10, 12.5, 12.5, 14, 15, 16</td>
<td>1, 2, 4, 5, 6, 7, 10, 10</td>
</tr>
</tbody>
</table>
<hr />
<p><strong><em>Step 4</em></strong></p>
<p>The ranks are summed for one of the groups. (It does not matter which
group.)</p>
<div style="padding-left:15px;">
<p><strong>Sum of Ranks for Spray A</strong>: <span
class="math display">\[
3+8+10+12.5+12.5+14+15+16 = 91
\]</span></p>
</div>
<hr />
<p><strong><em>Step 5</em></strong></p>
<p>The <span class="math inline">\(p\)</span>-value of the test is then
obtained by computing the probabilities of all possible sums that one
group can achieve using mathematical counting techniques. This is a very
tedious process that only a mathematician would enjoy pursuing. However,
the end result is fairly easily understood. If you are interested, read
the details.</p>
<div style="padding-left:30px; padding-right:15px;">
<hr />
<p><strong>Details</strong></p>
<p>When there are <span class="math inline">\(n=16\)</span> ranks, with
just <span class="math inline">\(8\)</span> of the ranks assigned to one
group, the possible sums of ranks range from <span
class="math inline">\(36\)</span> to <span
class="math inline">\(100\)</span> and include every integer in between,
i.e., <span class="math inline">\(36, 37, 38, \ldots, 100\)</span>.</p>
<p>Note that the smallest sum would be obtained if the ranks 1-8 were in
the group. The largest sum would be obtained if the ranks 9-16 were in
the group.</p>
<p>The probability of each possible sum occurring is computed by
counting all of the ways a certain sum can occur (combinations) and
dividing by the total number of sums possible. (There are 12,870 total
different sets of ranks possible when there are <span
class="math inline">\(n=16\)</span> ranks and <span
class="math inline">\(8\)</span> are assigned to one group.)</p>
<p>The distribution of possible sums looks like what is shown in the
following plot, where the red bars show those sums that are as extreme
or more extreme than a sum of <span class="math inline">\(91\)</span>
(or its opposite of <span class="math inline">\(136-91=45\)</span>).</p>
<p><img src="index_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Computing the probabilities of all possible sums creates a
distribution of the test statistic (shown in the plot above). Note that
the test statistic is obtained in Step 4 (above) by taking the sum of
the ranks. Once the distribution of the test statistic is established,
the <span class="math inline">\(p\)</span>-value of the test can be
calculated as the combined probability of possible sums that are as
extreme or more extreme than the one observed.</p>
<hr />
</div>
<p>For this example, it turns out that the probability of getting a sum
of negative ranks as extreme or more extreme than <span
class="math inline">\(91\)</span> is <span
class="math inline">\(p=0.01476\)</span> (the sum of the probabilities
of the red bars in the plot above). Thus, at the <span
class="math inline">\(\alpha=0.05\)</span> level we would reject the
null hypothesis that the difference in the center of the distributions
is zero. We conclude that the Spray Concentration A is more effective at
killing flies (bugs).</p>
<hr />
<p><strong><em>Comment</em></strong></p>
<p>The hypotheses for the Wilcoxon Rank Sum Test are difficult to write
out in simple mathematical statements. The test is often referred to as
a test of medians, but goes deeper than this. Technically, it allows us
to determine if one distribution is stochastically larger than another.
In other words, if one distribution typically gives larger values than
does another distribution. If the distributions are identically shaped
and have the same spread, then this implies the medians (and means) are
different.</p>
<p>Thus, the hypotheses for the test can be written mathematically as
<span class="math display">\[
  H_0: \text{difference in medians} = 0
\]</span> <span class="math display">\[
  H_a: \text{difference in medians} \neq 0
\]</span> or even as <span class="math display">\[
  H_0: \mu_1-\mu_2 = 0
\]</span> <span class="math display">\[
  H_a: \mu_1-\mu_2 \neq 0
\]</span></p>
<p>However, it is important to remember that the estimated difference in
location parameters that results from the test does not provide a
measurement on either of these things. However, the <span
class="math inline">\(p\)</span>-value can lead us to determine whether
to reject, or fail to reject the null, whichever of the above hypotheses
is used.</p>
<p>As stated in the R help file for this test
<code>?wilcox.test()</code> “the estimator for the difference in
location parameters does not estimate the difference in medians (a
common misconception) but rather the median of the difference between a
sample from [the first population] and a sample from [the second
population].” These are technical details that most people ignore
without encountering too much difficulty. However, it does remind us
that the t test is more easily interpreted whenever it is appropriate to
use that test.</p>
</div>
<p><br /></p>
<hr />
<p><strong><em>Final Comment</em></strong></p>
<p>Notice that when the sample size is large the distribution of the
test statistic can be approximated by a normal distribution. Most
software applications use this approximation when the sample size is
over <span class="math inline">\(50\)</span>, i.e., for <span
class="math inline">\(n\geq50\)</span> because computing all the
possible sums of ranks becomes incredibly time consuming. Thus, for
large sample sizes the results will be almost identical whether the
Wilcoxon Tests or a t Test is used.</p>
</div>
<!--- End of Add content area.  ------------------>
</div>
</div>
</div>
</div>
</div>
<div id="section-1" class="section level2">
<h2></h2>
<div style="clear:both;">

</div>
<div id="quantitative-y-categorical-x-3-groups"
class="section level3 tabset tabset-fade">
<h3 class="tabset tabset-fade">Quantitative Y | Categorical X (3+
Groups)</h3>
<div id="graphics-2" class="section level4">
<h4>Graphics</h4>
<div class="tooltipimage" style="float:left;width:125px;"
align="center">
<p><img src="Images/QuantYQualXg3plus.png" width=59px;> <span
class="tooltipimagetext">Y is a single quantitative variable of
interest, like “heights” of BYU-Idaho students. X is a categorical
(qualitative) variable like which Math 221 you took, 221A, 221B, or
221C. In other words, X has three or more groups. So “Classrank” could
be X, with groups “Freshman”, “Sophomore”, “Junior”, and
“Senior”.</span></p>
</div>
<div style="padding-left:125px;color:black;">
<!-- Add your customizations in the area below: -->
<p><strong>Test(s) used for this category:</strong></p>
<ul>
<li><p>One-Way ANOVA (means)</p></li>
<li><p>Block Design</p></li>
<li><p>Kruskal-Wallis Rank Sum Test (distributions)</p>
<ul>
<li>Analysis : <a
href="file:///C:/Users/paige/OneDrive/Documents/Fall%20Semester%202024/MATH%20325/Statistics-Notebook-master/Analyses/Kruskal-Wallis%20Test/Food.html">College
Student’s Food Perception</a></li>
</ul></li>
</ul>
<p><br></p>
<p><strong>Used comparing several groups based on means or
distributions:</strong></p>
<ul>
<li><p>How long are their feet based of width and gender?</p></li>
<li><p>Are there certain months of the year that are associated with
children having longer feet, on average, than others?</p></li>
</ul>
<hr />
<p><a href="GraphicalSummaries.html#boxplots">
<img class="myhover" src="Images/boxplotthree.png" alt="Side-by-side Boxplots" title="Side-by-side Boxplots 3+ Groups">
</a> <a href="GraphicalSummaries.html#dot-plots">
<img class="myhover" src="Images/dotplottriple.png" alt="Side-by-side Dot Plots" title="Side-by-side Dot Plots 3+ Groups">
</a></p>
<p><br></p>
<ul>
<li>Does a college student’s perception of food result in a change in
their weight? (<strong>Kruskal-Wallis Rank Sum Test</strong>)</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Read data</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>food <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;C:/Users/paige/OneDrive/Documents/Fall Semester 2024/MATH 325/Statistics-Notebook-master/Data/food.csv&quot;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co"># Data transformation and cleaning</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>food_cleaned <span class="ot">&lt;-</span> food <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  <span class="co"># Convert weight to numeric right away</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight =</span> <span class="fu">as.numeric</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>  <span class="co"># Remove rows with NA weight or missing drink values</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(weight) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(drink)) <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>  <span class="co"># Create a new column `Food Perception Score`</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Food Perception Score</span><span class="st">`</span> <span class="ot">=</span> </span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>           <span class="fu">ifelse</span>(breakfast <span class="sc">==</span> <span class="st">&quot;Cereal&quot;</span>, <span class="dv">0</span>, </span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>           <span class="fu">ifelse</span>(breakfast <span class="sc">==</span> <span class="st">&quot;Donut&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>           <span class="fu">ifelse</span>(fries <span class="sc">==</span> <span class="st">&quot;1&quot;</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(fries <span class="sc">==</span> <span class="st">&quot;2&quot;</span>, <span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>           <span class="fu">ifelse</span>(drink <span class="sc">==</span> <span class="st">&quot;orange juice&quot;</span>, <span class="dv">0</span>, <span class="fu">ifelse</span>(drink <span class="sc">==</span> <span class="st">&quot;soda&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>           <span class="fu">ifelse</span>(soup <span class="sc">==</span> <span class="st">&quot;1&quot;</span>, <span class="dv">0</span>, <span class="fu">ifelse</span>(soup <span class="sc">==</span> <span class="st">&quot;2&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co"># Create plots</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="fu">boxplot</span>(weight <span class="sc">~</span> <span class="st">`</span><span class="at">Food Perception Score</span><span class="st">`</span>, <span class="at">data=</span>food_cleaned, </span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>        <span class="at">col=</span><span class="st">&quot;lightgreen&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Food Perception Score&quot;</span>, <span class="at">main=</span><span class="st">&quot;Weight of College Students&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Weight (lbs)&quot;</span>)</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="fu">stripchart</span>(weight <span class="sc">~</span> <span class="st">`</span><span class="at">Food Perception Score</span><span class="st">`</span>, <span class="at">data=</span>food_cleaned, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">vertical=</span><span class="cn">TRUE</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;palegreen4&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<!--- End of Add content area.  ------------------>
</div>
</div>
<div id="tests-2" class="section level4">
<h4>Tests</h4>
<div style="padding-left:125px;color:black;">
<!-- Add your customizations in the area below: -->
<div id="one-way-anova"
class="section level5 tabset tabset-fade tabset-pills">
<h5 class="tabset tabset-fade tabset-pills">One-way ANOVA</h5>
<div style="float:left;width:125px;" align="center">
<p><img src="Images/QuantYQualXg3plus.png" width=58px;></p>
</div>
<p>Each experimental unit is assigned to exactly one factor-level
combination. Another way to say this is “one measurement per individual”
(no repeated measures) and “equal numbers of individuals per group”.</p>
<div id="overview-5" class="section level6">
<h6>Overview</h6>
<div style="padding-left:125px;">
<p>An ANOVA is only appropriate when all of the following are
satisfied.</p>
<ol style="list-style-type: decimal">
<li><p>The sample(s) of data can be considered to be representative of
their population(s).</p></li>
<li><p>The data is normally distributed in each group. (This can safely
be assumed to be satisfied when the <em>residuals</em> from the ANOVA
can be assumed to be normally distributed when seen in a Q-Q
Plot.)</p></li>
<li><p>The population variance of each group can be assumed to be the
same. (This can be safely assumed to be satisfied when the
<em>residuals</em> from the ANOVA show constant variance, i.e., are
similarly vertically spread out in a Residuals versus fitted-values
plot.)</p></li>
</ol>
<ul>
<li>comparing <strong><em>means</em></strong></li>
</ul>
<p><br></p>
<p><strong>Hypotheses</strong></p>
<p>For a One-way ANOVA</p>
<p><span class="math display">\[
  H_0: \mu_1 = \mu_2 = \ldots = \mu
\]</span> <span class="math display">\[
  H_a: \mu_i \neq \mu \ \text{for at least one} \ i
\]</span></p>
<p><strong>Mathematical Model</strong></p>
<p>A typical model for a one-way ANOVA is of the form <span
class="math display">\[
  Y_{ij} = \mu_i + \epsilon_{ij}
\]</span> where <span class="math inline">\(\mu_i\)</span> is the mean
for level (group) <span class="math inline">\(i\)</span>, and <span
class="math inline">\(\epsilon_{ij} \sim N(0,\sigma^2)\)</span> is the
error term for each point <span class="math inline">\(j\)</span> within
level (group) <span class="math inline">\(i\)</span>.</p>
<hr />
</div>
</div>
<div id="r-instructions-5" class="section level6">
<h6>R Instructions</h6>
<div style="padding-left:125px;">
<p><strong>Console</strong> Help Command: <code>?aov()</code></p>
<ul>
<li><code>myaov</code> is some name you come up with to store the
results of the <code>aov()</code> test.</li>
<li><code>Y</code> must be a “numeric” vector of the quantitative
response variable.</li>
<li><code>X</code> is a qualitative variable (should have
<code>class(X)</code> equal to <code>factor</code> or
<code>character</code>. If it does not, use <code>as.factor(X)</code>
inside the <code>aov(Y ~ as.factor(X),...)</code> command.</li>
<li><code>YourDataSet</code> is the name of your data set.</li>
</ul>
<p><strong>Perform the ANOVA</strong></p>
<p><code>myaov &lt;- aov(Y ~ X, data=YourDataSet)</code></p>
<p><code>summary(myaov)</code></p>
<p><strong>Diagnose ANOVA Assumptions</strong></p>
<p><code>par(mfrow=c(1,2))</code></p>
<p><code>plot(myaov, which=1:2)</code></p>
<p><br/></p>
<p><strong>Example Code</strong></p>
<p>Hover your mouse over the example codes to learn more.</p>
<p><em>Perform the ANOVA</em></p>
<a href="javascript:showhide('oneWayAnova')">
<div class="hoverchunk">
<p><span class="tooltipr"> chick.aov &lt;-  <span class="tooltiprtext">
Saves the results of the ANOVA test as an object named
‘chick.aov’.</span> </span><span class="tooltipr"> aov( <span
class="tooltiprtext">‘aov()’ is a function in R used to perform the
ANOVA.</span> </span><span class="tooltipr"> weight <span
class="tooltiprtext">Y is ‘weight’, which is a numeric variable from the
chickwts dataset.</span> </span><span class="tooltipr">  ~  <span
class="tooltiprtext">‘~’ is the tilde symbol used to separate the Y and
X in a model formula.</span> </span><span class="tooltipr"> feed, <span
class="tooltiprtext">X is ‘feed’, which is a qualitative variable in the
chickwts dataset, or more specifically, a factor with six levels:
“casein”, “horsebean”, and so on… Use str(chickwts) to see this. </span>
</span><span class="tooltipr">  data = chickwts) <span
class="tooltiprtext"> ‘chickwts’ is a dataset in R.</span>
</span><br><span class="tooltipr"> summary( <span class="tooltiprtext">
‘summary()’ shows the results of the ANOVA.</span> </span><span
class="tooltipr"> chick.aov) <span class="tooltiprtext"> ‘chick.aov’ is
the name of the ANOVA.</span> </span><span class="tooltipr">     <br />
<span class="tooltiprtext">Press Enter to run the code if you have typed
it in yourself. You can also click here to view the output.</span>
</span><span class="tooltipr" style="float:right;font-size:.8em;">
 Click to View Output  <span class="tooltiprtext">Click to View
Output.</span> </span></p>
</div>
</a>
<div id="oneWayAnova" style="display:none;">
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)
## feed         5 231129   46226   15.37 5.94e-10
## Residuals   65 195556    3009                 
##                
## feed        ***
## Residuals      
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<p><br/></p>
<p><em>Diagnose the ANOVA</em></p>
<a href="javascript:showhide('oneWayAnovaCheck')">
<div class="hoverchunk">
<p><span class="tooltipr"> par( <span class="tooltiprtext">‘par’ is a R
function that can be used to set or query graphical parameters.</span>
</span><span class="tooltipr"> mfrow = c(1,2)) <span
class="tooltiprtext">The <code>mfrow</code> parameter controls “multiple
frames on a row”. In this case, the c(1,2) specifies 1 row of 2 plots.
This will cause the two diagnostic plots to be placed side-by-side.
</span> </span><br><span class="tooltipr"> plot( <span
class="tooltiprtext">‘plot’ is a R function for the plotting of R
objects.</span> </span><span class="tooltipr"> chick.aov, <span
class="tooltiprtext">‘chick.aov’ is the name of the ANOVA.</span>
</span><span class="tooltipr">  which = 1:2) <span
class="tooltiprtext">The <code>which=1:2</code> selects “which” of 6
available plots we want to have graphed. In this case, 1 shows the
Residuals vs Fitted, and 2 shows the Normal QQ-plot. Both are needed to
check the ANOVA assumptions.</span> </span><span class="tooltipr"
style="float:right;font-size:.8em;">  Click to View Output  <span
class="tooltiprtext">Click to View Output.</span> </span></p>
</div>
</a>
<div id="oneWayAnovaCheck" style="display:none;">
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<hr />
</div>
</div>
<div id="explanation-5" class="section level6">
<h6>Explanation</h6>
<div style="padding-left:125px;">
<p>Analysis of variance (ANOVA) is often applied to the scenario of
testing for the equality of three or more means from (possibly) separate
normal distributions of data. The normality assumption is required. No
matter the sample size. If the distributions are skewed then a
nonparametric test should be applied instead of ANOVA.</p>
<p><br /></p>
<p><strong><em>One-Way ANOVA</em></strong></p>
<p>One-way ANOVA is when a completely randomized design is used with a
single factor of interest. A typical mathematical model for a one-way
ANOVA is of the form <span class="math display">\[
  Y_{ik} = \mu_i + \epsilon_{ik} \quad (\text{sometimes written}\ Y_{ik}
= \mu + \alpha_i + \epsilon_{ik})
\]</span> where <span class="math inline">\(\mu_i\)</span> is the mean
of each group (or level) <span class="math inline">\(i\)</span> of a
factor, and <span class="math inline">\(\epsilon_{ik}\sim
N(0,\sigma^2)\)</span> is the error term. The plot below demonstrates
what these symbols represent. Note that the notation <span
class="math inline">\(\epsilon_{ik}\sim N(0,\sigma^2)\)</span> states
that we are assuming the error term <span
class="math inline">\(\epsilon_{ik}\)</span> is normally distributed
with a mean of 0 and a standard deviation of <span
class="math inline">\(\sigma\)</span>.</p>
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p><strong>Hypotheses</strong></p>
<p>The aim of ANOVA is to determine which hypothesis is more plausible,
that the means of the different distributions are all equal (the null),
or that at least one group mean differs (the alternative).
Mathematically, <span class="math display">\[
  H_0: \mu_1 = \mu_2 = \ldots = \mu_m = \mu
\]</span> <span class="math display">\[
  H_a: \mu_i \neq \mu \quad \text{for at least one}\ i\in\{1,\ldots,m\}.
\]</span> In other words, the goal is to determine if it is more
plausible that each of the <span class="math inline">\(m\)</span>
different samples (where each sample is of size <span
class="math inline">\(n\)</span>) came from the same normal distribution
(this is what the null hypothesis claims) or that at least one of the
samples (and possibly several or all) come from different normal
distributions (this is what the alternative hypothesis claims).</p>
<p><strong>Visualizing the Hypotheses</strong></p>
<p>The first figure below demonstrates what a given scenario might look
like when all <span class="math inline">\(m=3\)</span> samples of data
are from the same normal distribution. In this case, the null hypothesis
<span class="math inline">\(H_0\)</span> is true. Notice that the
variability of the sample means is smaller than the variability of the
points.</p>
<p><img src="index_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>The figure below shows what a given scenario might look like for
<span class="math inline">\(m=3\)</span> samples of data from three
different normal distributions. In this case, the alternative hypothesis
<span class="math inline">\(H_a\)</span> is true. Notice that the
variability of the sample means, i.e., <span
class="math inline">\((\bar{x}_1,\bar{x}_2,\bar{x}_3)\)</span>, is
greater than the variability of the points.</p>
<p><img src="index_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p><strong>Explaining the Name</strong></p>
<p>The above plots are useful in understanding the mathematical details
behind ANOVA and why it is called <em>analysis of variance</em>. Recall
that variance is a measure of the spread of data. When data is very
spread out, the variance is large. When the data is close together, the
variance is small. ANOVA utilizes two important variances, the between
groups variance and the within groups variance.</p>
<ul>
<li><p><strong>Between groups variance</strong>–a measure of the
variability in the sample means, the <span
class="math inline">\(\bar{x}\)</span>’s.</p></li>
<li><p><strong>Within groups variance</strong>–a combined measure of the
variability of the points within each sample.</p></li>
</ul>
<p>The plot below combines the information from the previous plots for
ease of reference. It emphasizes the fact that when the null hypothesis
is true, the points should have a large variance (be really spread out)
while the sample means are relatively close together. On the other hand,
when the points are relative close together <em>within</em> each sample
and the sample means have a large variance (are really spread out) then
the alternative hypothesis is true. This is the theory behind analysis
of variance, or ANOVA.</p>
<p><img src="index_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p><strong>Calculating the Test Statistic, <span
class="math inline">\(F\)</span></strong></p>
<p>The ratio of the “between groups variation” to the “within groups
variation” provides the test statistic for ANOVA. Note that the test
statistic of ANOVA is an <span class="math inline">\(F\)</span>
statistic.</p>
<p><span class="math display">\[
  F = \frac{\text{Between groups variation}}{\text{Within groups
variation}}
\]</span></p>
<p>It would be good to take a minute and <a
href="MakingInference.html#fdist">review the <span
class="math inline">\(F\)</span> distribution</a>. The <span
class="math inline">\(p\)</span>-value for ANOVA thus comes from an
<span class="math inline">\(F\)</span> distribution with parameters
<span class="math inline">\(p_1 = m-1\)</span> and <span
class="math inline">\(p_2 = n-m\)</span> where <span
class="math inline">\(m\)</span> is the number of samples and <span
class="math inline">\(n\)</span> is the total number of data points.</p>
<p><br /></p>
<p><strong>A Deeper Look at Variance</strong></p>
<p>It is useful to take a few minutes and explain the word
<em>variance</em> as well as mathematically define the terms “<em>within
group variance</em>” and “<em>between groups variance</em>.”</p>
<p>Variance is a statistical measure of the <em>variability</em> in
data. The square root of the variance is called the <em>standard
deviation</em> and is by far the more typical measure of spread. This is
because standard deviation is easier to interpret. However,
mathematically speaking, the variance is the more important
measurement.</p>
<p>As mentioned previously, the variance turns out to be the key to
determining which hypothesis is the most plausible, <span
class="math inline">\(H_0\)</span> or <span
class="math inline">\(H_a\)</span>, when several means are under
consideration. There are two variances that are important for ANOVA, the
“within groups variance” and the “between groups variance.”</p>
<p>Recall that the formula for computing a <a
href="NumericalSummaries.html#variance">sample variance</a> is given by
<span class="math display">\[
  s^2 = \frac{\sum_{i=1}^n(x_i - \bar{x})^2}{n-1} \quad\leftarrow
\frac{\text{sum of squares}}{\text{degrees of freedom}}
\]</span> This formula has a couple of important pieces that are so
important they have been given special names. The <span
class="math inline">\(n-1\)</span> in the denominator of the formula is
called the “degrees of freedom.” The other important part of this
formula is the <span class="math inline">\(\sum_{i=1}^n(x_i -
\bar{x})^2\)</span>, which is called the “sum of squared errors” or
sometimes just the “sum of squares” or “SS” for short. Thus, the sample
variance is calculated by computing a “sum of squares” and dividing this
by the “degrees of freedom.”</p>
<p>It turns out that this general approach works for many different
contexts. Specifically, it allows us to compute the “within groups
variance” and the “between groups variance.” To introduce the
mathematical definitions of these two variances, we need to introduce
some new notation.</p>
<div style="padding-left:15px;">
<p>Let <span class="math inline">\(\bar{y}_{i\bullet}\)</span> represent
the sample mean of group <span class="math inline">\(i\)</span> for
<span class="math inline">\(i=1,\ldots,m\)</span>.</p>
<p>Let <span class="math inline">\(n_i\)</span> denote the sample size
in group <span class="math inline">\(i\)</span>.</p>
<p>Let <span class="math inline">\(\bar{y}_{\bullet\bullet}\)</span>
represent the sample mean of all <span class="math inline">\(n =
n_1+n_2+\cdots+n_m\)</span> data points.</p>
</div>
<p>The mathematical calculations for each of these variances is given as
follows. <span class="math display">\[
  \text{Between groups variance} = \frac{\sum_{i=1}^m
(\bar{y}_{i\bullet}-\bar{y}_{\bullet\bullet})^2}{m-1} \leftarrow
\frac{\text{Between groups sum of squares}}{\text{Between groups degrees
of freedom}}
\]</span> <span class="math display">\[
  \text{Within groups variance} =
\frac{\sum_{i=1}^m\sum_{k=1}^{n_i}(y_{ik}-\bar{y}_{i\bullet})^2}{n-m}
\leftarrow \frac{\text{Within groups sum of squares}}{\text{Within
groups degrees of freedom}}
\]</span></p>
<p><br /></p>
<p><strong>A Fabricated Example</strong></p>
<p>The following table provides three samples of data:
<strong>A</strong>, <strong>B</strong>, and <strong>C</strong>. These
samples were randomly generated from normal distributions using a
computer. The true means <span class="math inline">\(\mu_1,
\mu_2\)</span>, and <span class="math inline">\(\mu_3\)</span> of the
normal distributions are thus known, but withheld from you at this point
of the example.</p>
<table>
<thead>
<tr class="header">
<th align="right">A</th>
<th align="right">B</th>
<th align="right">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">13.15457</td>
<td align="right">13.17463</td>
<td align="right">16.66831</td>
</tr>
<tr class="even">
<td align="right">12.65225</td>
<td align="right">12.16277</td>
<td align="right">15.54719</td>
</tr>
<tr class="odd">
<td align="right">13.73061</td>
<td align="right">12.76905</td>
<td align="right">16.63074</td>
</tr>
<tr class="even">
<td align="right">14.43471</td>
<td align="right">13.38524</td>
<td align="right">15.06726</td>
</tr>
<tr class="odd">
<td align="right">13.79728</td>
<td align="right">12.02690</td>
<td align="right">15.57534</td>
</tr>
<tr class="even">
<td align="right">13.88599</td>
<td align="right">13.24651</td>
<td align="right">15.99915</td>
</tr>
<tr class="odd">
<td align="right">12.77753</td>
<td align="right">12.58386</td>
<td align="right">15.58995</td>
</tr>
<tr class="even">
<td align="right">13.81536</td>
<td align="right">12.64615</td>
<td align="right">16.99429</td>
</tr>
<tr class="odd">
<td align="right">13.03635</td>
<td align="right">12.52055</td>
<td align="right">15.47153</td>
</tr>
<tr class="even">
<td align="right">14.26062</td>
<td align="right">14.03566</td>
<td align="right">16.13330</td>
</tr>
</tbody>
</table>
<p>An ANOVA will be performed with the sample data to determine which
hypothesis is more plausible: <span class="math display">\[
  H_0: \mu_1 = \mu_2 = \mu_3 = \mu
\]</span> <span class="math display">\[
  H_a: \mu_i \neq \mu \ \text{for at least one} \ i \in \{1,\ldots,m\}
\]</span></p>
<p>To perform an ANOVA, we must compute the between groups variance and
the within groups variance. This requires the Between groups sums of
squares, within groups sums of squares, between groups degrees of
freedom, and the within groups degrees of freedom. Note that to get the
sums of squares, we first had to calculate <span
class="math inline">\(\bar{y}_{1\bullet}\)</span>, <span
class="math inline">\(\bar{y}_{2\bullet}\)</span>, <span
class="math inline">\(\bar{y}_{3\bullet}\)</span>, and <span
class="math inline">\(\bar{y}_{\bullet\bullet}\)</span> where the 1, 2,
3 corresponds to Samples A, B, and C, respectively. After some work, we
find these values to be <span class="math display">\[
  \bar{y}_{1\bullet} = 13.55, \quad \bar{y}_{2\bullet} = 12.86 \quad
\bar{y}_{3\bullet} = 15.97
\]</span> and <span class="math display">\[
  \bar{y}_{\bullet\bullet} = \frac{13.55+12.86+15.97}{3} = 14.13
\]</span> Using these values we can then compute the between groups sum
of squares and the within groups sum of squares according to the
formulas stated previously. This process is very tedious and will not be
demonstrated. Only the results are shown in the following table which
summarizes all the important information.</p>
<table>
<colgroup>
<col width="11%" />
<col width="27%" />
<col width="22%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th> </th>
<th>Degrees of Freedom</th>
<th>Sum of Squares</th>
<th>Variance</th>
<th>F-value</th>
<th>p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Between groups</td>
<td>2</td>
<td>53.3</td>
<td>26.67</td>
<td>70.2</td>
<td>2e-11</td>
</tr>
<tr class="even">
<td>Within groups</td>
<td>27</td>
<td>10.3</td>
<td>0.38</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><strong><em>ANOVA Table</em></strong></p>
<p>In general, the ANOVA table is created by</p>
<table>
<colgroup>
<col width="11%" />
<col width="27%" />
<col width="22%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th> </th>
<th>Degrees of Freedom</th>
<th>Sum of Squares</th>
<th>Variance</th>
<th>F-value</th>
<th>p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Between groups</td>
<td><span class="math inline">\(m-1\)</span></td>
<td><span class="math inline">\(\sum_{i=1}^m
n_i(\bar{y}_{i\bullet}-\bar{y}_{\bullet\bullet})^2\)</span></td>
<td><span class="math inline">\(\frac{\text{sum of
squares}}{\text{degrees of freedom}}\)</span></td>
<td><span class="math inline">\(\frac{\text{Between groups
variance}}{\text{Within groups variance}}\)</span></td>
<td><span class="math inline">\(F\)</span>-distribution tail
probability</td>
</tr>
<tr class="even">
<td>Within groups</td>
<td><span class="math inline">\(n-m\)</span></td>
<td><span
class="math inline">\(\sum_{i=1}^m\sum_{k=1}^{n_i}(y_{ik}-\bar{y}_{i\bullet})^2\)</span></td>
<td><span class="math inline">\(\frac{\text{sum of
squares}}{\text{degrees of freedom}}\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><br /></p>
<p><strong><em>ANOVA Assumptions{#residuals}</em></strong></p>
<p>The requirements for an analysis of variance (the assumptions of the
test) are two-fold and concern only the error terms, the <span
class="math inline">\(\epsilon_{ik}\)</span>.</p>
<ol style="list-style-type: decimal">
<li><p>The errors are normally distributed.</p></li>
<li><p>The variance of the errors is constant.</p></li>
</ol>
<p>Both of these assumptions were stated in the mathematical model where
we assumed that <span class="math inline">\(\epsilon_{ik}\sim
N(0,\sigma^2)\)</span>.</p>
<p><strong>Checking ANOVA Assumptions</strong></p>
<p>To check that the ANOVA assumptions are satisfied, it is required to
check the data in each group for normality using QQ-Plots. Also, the
sample variance of each group must be relatively constant. The fastest
way to check these two assumptions is by analyzing the
<em>residuals</em>.</p>
<ul>
<li>An ANOVA <strong>residual</strong> is defined as the difference
between the observed value of <span
class="math inline">\(y_{ik}\)</span> and the mean <span
class="math inline">\(\bar{y}_{i\bullet}\)</span>. Mathematically, <span
class="math display">\[
r_{ik} = y_{ik} - \bar{y}_{i\bullet}
\]</span> One QQ-Plot of the residuals will provide the necessary
evidence to decide if it is reasonable to assume that the error terms
are normally distributed. Also, the constant variance can be checked
visually by using what is known as a residuals versus fitted values
plot. For the <strong>Fabricated Example</strong> above, the QQ-Plot and
residuals versus fitted values plots show the two assumptions of ANOVA
appear to be satisfied.</li>
</ul>
<p><img src="index_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p><br /></p>
<hr />
</div>
<div style="padding-left:125px;">
<p><strong>Examples:</strong> <a
href="./Analyses/ANOVA/Examples/chickwtsOneWayANOVA.html">chickwts</a>
(One-way)</p>
</div>
<hr />
</div>
</div>
<div id="block-design"
class="section level5 tabset tabset-fade tabset-pills">
<h5 class="tabset tabset-fade tabset-pills">Block Design</h5>
<div style="float:left;width:125px;" align="center">
<p><img src="Images/QuantYQualXg3plus.png" width=58px;></p>
</div>
<p>Repeated measures or other factors that group individuals into
similar groups (blocks) are included in the study design.</p>
<div id="overview-6" class="section level6">
<h6>Overview</h6>
<div style="padding-left:125px;">
<p>A typical model for a block design is of the form <span
class="math display">\[
  Y_{lijk} = \mu + B_l + \alpha_i + \beta_j + \alpha\beta_{ij} +
\epsilon_{ijlk}
\]</span> where <span class="math inline">\(\mu\)</span> is the grand
mean, <span class="math inline">\(B_l\)</span> is the blocking factor,
<span class="math inline">\(\alpha_i\)</span> is one factor with at
least two levels, <span class="math inline">\(\beta_j\)</span> is
another factor with at least two levels, <span
class="math inline">\(\alpha\beta_{ij}\)</span> is the interaction of
the two factors, and <span class="math inline">\(\epsilon_{ijlk} \sim
N(0,\sigma^2)\)</span> is the error term.</p>
<p>Only one block and one factor is required. Multiple blocks and
multiple factors are allowed. It is not required to include interaction
terms. The error term is always required.</p>
<hr />
</div>
</div>
<div id="r-instructions-6" class="section level6">
<h6>R Instructions</h6>
<div style="padding-left:125px;">
<p><strong>Console</strong> Help Command: <code>?aov()</code></p>
<p><code>myaov &lt;- aov(Y ~ Block+X1+X2+X1:X2, data=YourDataSet)</code>
<strong>Perform the test</strong></p>
<p><code>summary(myaov)</code> <strong>View the ANOVA
Results</strong></p>
<p><code>plot(myaov, which=1:2)</code> <strong>Check ANOVA
assumptions</strong></p>
<ul>
<li><code>myaov</code> is some name you come up with to store the
results of the <code>aov()</code> test.</li>
<li><code>Y</code> must be a “numeric” vector of the quantitative
response variable.</li>
<li><code>Block</code> is a qualitative variable that is not of direct
interest, but is included in the model to account for variability in the
data. It should have <code>class(Block)</code> equal to either factor or
character. Use <code>as.factor()</code> if it does not.</li>
<li><code>X1</code> is a qualitative variable (should have
<code>class(X1)</code> equal to <code>factor</code> or
<code>character</code>. If it does not, use <code>as.factor(X1)</code>
inside the <code>aov()</code> command.</li>
<li><code>X2</code> is a second qualitative variable that should also be
either a <code>factor</code> or a <code>character</code> vector. If it
does not, use <code>as.factor(X2)</code>.</li>
<li>Note that factors <code>C</code>, <code>D</code>, and so on could
also be added <code>+</code> to the model if desired.</li>
<li><code>X1:X2</code> denotes the interaction of the factors
<code>X1</code> and <code>X2</code>. It is not required and should only
be included if the interaction term is of interest.</li>
<li><code>YourDataSet</code> is the name of your data set.</li>
</ul>
<hr />
<div style="padding-left:125px;">
<p><strong>Examples</strong>: <a
href="./Analyses/ANOVA/Examples/ChickWeightANOVABlock.html">ChickWeight</a></p>
</div>
</div>
<hr />
</div>
</div>
<div id="kruskal-wallis-rank-sum-test"
class="section level5 tabset tabset-fade tabset-pills">
<h5 class="tabset tabset-fade tabset-pills">Kruskal-Wallis Rank Sum
Test</h5>
<div style="float:left;width:125px;" align="center">
<p><img src="Images/QuantYQualXg3plus.png" width=58px;></p>
</div>
<p>Allows for deciding if several samples come from the same population
or if at least one sample comes from a different population.</p>
<div id="overview-7" class="section level6">
<h6>Overview</h6>
<div style="padding-left:125px;">
<p>It is assumed that the various populations are of approximately the
same form, but are shifted or translated.</p>
<p>Can also be used when data is ordered (ordinal) but does not have an
exact measurement.</p>
<p><strong>Best used when the distribution of the data is not normal.
ANOVA is appropriate when the data is normal.</strong></p>
<ul>
<li>comparing <strong><em>distributions</em></strong></li>
</ul>
<p><br></p>
<p><strong>Hypotheses</strong></p>
<p>Typically, the hypotheses of the Kruskal-Wallis test are:</p>
<p><span class="math display">\[
  H_0: \text{All samples are from the same distribution.}
\]</span> <span class="math display">\[
  H_a: \text{At least one sample&#39;s distribution is stochastically
different.}
\]</span></p>
<p>However, according to the original authors, what the alternative to
the Kruskal-Wallis test really is, “is a tendency for observations in at
least one of the populations to be larger (or smaller) than all the
observations together, when paired randomly. In many cases, this is
practically equivalent to the mean of at least one population differing
from the others.” Thus, it could also be appropriate to use the ANOVA
style hypotheses</p>
<p><span class="math display">\[
  H_0: \mu_1 = \mu_2 = \ldots = \mu
\]</span> <span class="math display">\[
  H_a: \mu_i \neq \mu \ \text{for at least one} \ i
\]</span></p>
<hr />
</div>
</div>
<div id="r-instructions-7" class="section level6">
<h6>R Instructions</h6>
<div style="padding-left:125px;">
<p><strong>Console</strong> Help Command:
<code>?kruskal.test()</code></p>
<div style="padding-left:15px;">
<p><code>kruskal.test(x ~ g, data=YourDataSet)</code></p>
<ul>
<li><code>x</code> is a numeric vector of data values that represents
the quantatitive response variable.</li>
<li><code>g</code> is a qualitative grouping variable defining which
groups each value in <code>x</code> belongs to. It must either be a
character vector or a factor vector.</li>
<li><code>YourDataSet</code> is the name of your data set.</li>
</ul>
<p><strong>Example Code</strong></p>
<p>Hover your mouse over the example codes to learn more.</p>
<a href="javascript:showhide('kruskal')">
<div class="hoverchunk">
<p><span class="tooltipr"> kruskal.test( <span class="tooltiprtext">The
function that performs a Kruskal-Wallis rank sum test.</span>
</span><span class="tooltipr"> weight <span
class="tooltiprtext">‘weight’ is a numeric variable from the chickwts
dataset that represents the quantatitive response variable.</span>
</span><span class="tooltipr">  ~  <span class="tooltiprtext">‘~’ is the
tilde symbol used to separate the left- and right-hand side in a model
formula.</span> </span><span class="tooltipr"> feed, <span
class="tooltiprtext"> ‘feed’ is a qualitative grouping variable in the
chickwts dataset. </span> </span><span class="tooltipr">
 data = chickwts) <span class="tooltiprtext"> ‘chickwts’ is a dataset in
R.</span> </span><span class="tooltipr">     <br />
<span class="tooltiprtext">Press Enter to run the code if you have typed
it in yourself. You can also click here to view the output.</span>
</span><span class="tooltipr" style="float:right;font-size:.8em;">
 Click to View Output  <span class="tooltiprtext">Click to View
Output.</span> </span></p>
</div>
</a>
<div id="kruskal" style="display:none;">
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  weight by feed
## Kruskal-Wallis chi-squared = 37.343, df = 5,
## p-value = 5.113e-07</code></pre>
</div>
<p><br></p>
<p>Alternatively, you could use the following approach as well.</p>
<p><code>kruskal.test(list(x, y, z))</code></p>
<ul>
<li><code>x</code> is a numeric vector of data values that represents
the quantatitive response variable for the first group.</li>
<li><code>y</code> is a numeric vector of data values that represents
the quantatitive response variable for the second group.</li>
<li><code>z</code> is a numeric vector of data values that represents
the quantatitive response variable for the third group.</li>
<li>Note that more than three vectors of data could be included inside
of <code>list()</code>.</li>
</ul>
<p><strong>Example Code</strong></p>
<p>Hover your mouse over the example codes to learn more.</p>
<a href="javascript:showhide('kruskal2')">
<div class="hoverchunk">
<p><span class="tooltipr"> feed1 &lt;- filter(chickwts, feed ==
“horsebean”) <span class="tooltiprtext"> This splits out the first group
of feed (horsebean) from the chickwts dataset. </span> </span><br><span
class="tooltipr"> feed2 &lt;- filter(chickwts, feed == “linseed”) <span
class="tooltiprtext"> This splits out the second group of feed (linseed)
from the chickwts dataset. </span> </span><br><span class="tooltipr">
feed3 &lt;- filter(chickwts, feed == “soybean”) <span
class="tooltiprtext"> This splits out the third group of feed (soybean)
from the chickwts dataset. </span> </span><br><span class="tooltipr">
feed4 &lt;- filter(chickwts, feed == “sunflower”) <span
class="tooltiprtext"> This splits out the fourth group of feed
(sunflower) from the chickwts dataset. </span> </span><br><span
class="tooltipr"> feed5 &lt;- filter(chickwts, feed == “meatmeal”) <span
class="tooltiprtext"> This splits out the fifth group of feed (meatmeal)
from the chickwts dataset. </span> </span><br><span class="tooltipr">
feed6 &lt;- filter(chickwts, feed == “casein”) <span
class="tooltiprtext"> This splits out the sixth group of feed (casein)
from the chickwts dataset. </span> </span><br><span class="tooltipr">
kruskal.test( <span class="tooltiprtext">The function that performs a
Kruskal-Wallis rank sum test.</span> </span><span class="tooltipr">
list(feed1$weight,feed2$weight,feed3$weight,feed4$weight,feed5$weight,feed6$weight))
<span class="tooltiprtext">A list of numeric vecotrs that represent the
quantitative response variable for each group.</span> </span>
</span><span class="tooltipr" style="float:right;font-size:.8em;">
 Click to View Output  <span class="tooltiprtext">Click to View Output.
Load library(tidyverse) to run this code in R.</span> </span></p>
</div>
</a>
<div id="kruskal2" style="display:none;">
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  list(feed1$weight, feed2$weight, feed3$weight, feed4$weight, feed5$weight, feed6$weight)
## Kruskal-Wallis chi-squared = 37.343, df = 5,
## p-value = 5.113e-07</code></pre>
</div>
<hr />
</div>
<div id="explanation-6" class="section level6">
<h6>Explanation</h6>
<div style="padding-left:125px;">
<p>In many cases it is of interest to perform a hypothesis test about
whether or not several samples come from the same population.</p>
<p>The Kruskal-Wallis Rank Sum Test allows for this by extending the
idea behind the Wilcoxon Rank Sum Test to allow for more than two
samples.</p>
<p>The following explanation of how the test works comes mainly from the
original 1952 article, <a
href="http://www.jstor.org/stable/2280779?seq=1#page_scan_tab_contents">Use
of Ranks in One-Criterion Variance Analysis, 1952</a>, but is expanded
here for increased clarity.</p>
<div id="calculating-the-test-statistic" class="section level6">
<h6>Calculating the Test Statistic</h6>
<p>The following artificial data will be used to demonstrate how the
Kruskal-Wallis Test statistic is calculated. (Taken from the original
article.)</p>
<div style="color:#a8a8a8;">
<center>
<p><strong>Daily Bottle-Cap Production of Three Machines</strong></p>
<p>(Artificial data.)</p>
<table>
<thead>
<tr class="header">
<th>Standard</th>
<th>Modification1</th>
<th>Modification2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>340</td>
<td>339</td>
<td>347</td>
</tr>
<tr class="even">
<td>345</td>
<td>333</td>
<td>343</td>
</tr>
<tr class="odd">
<td>330</td>
<td>344</td>
<td>349</td>
</tr>
<tr class="even">
<td>342</td>
<td></td>
<td>355</td>
</tr>
<tr class="odd">
<td>338</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</center>
</div>
<p><strong>Step 1</strong>: Obtain <span
class="math inline">\(C\)</span> samples, each of size <span
class="math inline">\(n_i\)</span>. Note that the notation <span
class="math inline">\(n_i\)</span> allows for each sample to be a
different size.</p>
<div style="padding-left:30px; color:#a8a8a8;">
<p>In the bottle-cap data, <span class="math inline">\(C=3\)</span> and
<span class="math inline">\(n_1 = 5\)</span>, <span
class="math inline">\(n_2 = 3\)</span>, and <span
class="math inline">\(n_3 = 4\)</span>.</p>
</div>
<p><strong>Step 2</strong>: Order the <span class="math inline">\(N=n_1
+ \cdots + n_C\)</span> values from all samples from smallest to
largest. Rank the values from smallest to largest with the ranks <span
class="math inline">\(1,\ldots,N\)</span>. Award any tied values the
average of the ranks of those values that are tied.</p>
<div style="padding-left:30px; color:#a8a8a8;">
<p>In the bottle-cap data we have the following.</p>
<table>
<colgroup>
<col width="12%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="2%" />
</colgroup>
<thead>
<tr class="header">
<th>Rank</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
<th align="right">5</th>
<th align="right">6</th>
<th align="right">7</th>
<th align="right">8</th>
<th align="right">9</th>
<th align="right">10</th>
<th align="right">11</th>
<th align="right">12</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Value</td>
<td align="right">330</td>
<td align="right">333</td>
<td align="right">338</td>
<td align="right">339</td>
<td align="right">340</td>
<td align="right">342</td>
<td align="right">343</td>
<td align="right">344</td>
<td align="right">345</td>
<td align="right">347</td>
<td align="right">349</td>
<td align="right">355</td>
<td></td>
</tr>
<tr class="even">
<td>Machine</td>
<td align="right">S</td>
<td align="right">M1</td>
<td align="right">S</td>
<td align="right">M1</td>
<td align="right">S</td>
<td align="right">S</td>
<td align="right">M2</td>
<td align="right">M1</td>
<td align="right">S</td>
<td align="right">M2</td>
<td align="right">M2</td>
<td align="right">M2</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Step 3</strong>: Sum the ranks for each sample. Denote the
sum of the ranks for sample <span class="math inline">\(i\)</span> by
<span class="math inline">\(R_i\)</span>.</p>
<div style="padding-left:30px; color:#a8a8a8;">
<p>In the bottle-cap data,</p>
<p><span class="math inline">\(R_1 = 1 + 3 + 5 + 6 + 9 = 24\)</span></p>
<p><span class="math inline">\(R_2 = 2 + 4 + 8 = 14\)</span></p>
<p><span class="math inline">\(R_3 = 7 + 10 + 11 + 12 = 40\)</span></p>
</div>
<p><strong>Step 4</strong>: Compute the mean rank for each sample, <span
class="math inline">\(\bar{R_i} = \frac{R_i}{n_i}\)</span>.</p>
<div style="padding-left:30px; color:#a8a8a8;">
<p>In the bottle-cap data,</p>
<p><span class="math inline">\(\bar{R}_1 = \frac{R_1}{n_1} =
\frac{24}{5} = 4.8\)</span></p>
<p><span class="math inline">\(\bar{R}_2 = \frac{R_2}{n_2} =
\frac{14}{3} = 4.667\)</span></p>
<p><span class="math inline">\(\bar{R}_3 = \frac{R_3}{n_3} =
\frac{40}{4} = 10.0\)</span></p>
</div>
<p><strong>Step 5</strong>: If there are no ties, calculate the test
statistic <span class="math inline">\(H\)</span> by the formula <span
class="math display">\[
  H = \frac{N-1}{N}\sum_{i=1}^C
\frac{n_i[\bar{R}_i-\frac{1}{2}(N+1)]^2}{\frac{1}{12}(N^2-1)}
\]</span></p>
<p>See the original article for the formula to use when there are ties
present in the data.</p>
<div style="padding-left:30px; color:#a8a8a8;">
<p>In the bottle-cap data, <span class="math inline">\(H =
5.656\)</span>.</p>
</div>
<p>To understand the logic behind the test statistic <span
class="math inline">\(H\)</span>, note that the null hypothesis assumes
that each of the <span class="math inline">\(C\)</span> samples are
taken from the same population. Under this assumption, the ranks
assigned to each sample should represent a uniform sample of the ranks
<span class="math inline">\(1,\ldots,N\)</span>. If the null hypothesis
were true, we would expect the average of the ranks from each group, the
<span class="math inline">\(\bar{R}_i\)</span>, to be roughly about the
same. More precisely, using the properties of the <em>discrete uniform
distribution</em> (<a
href="https://en.wikipedia.org/wiki/Uniform_distribution_(discrete)">see
wikipedia</a>), we expect each <span
class="math inline">\(\bar{R}_i\)</span> to be close to <span
class="math inline">\(\frac{1}{2}(N+1)\)</span>, which is the mean of
the discrete uniform distribution. That <span
class="math inline">\(\bar{R}_i\)</span> should be close to this value
comes from the fact that the mean of a distribution of means is equal to
the population mean. Further, the variance of <span
class="math inline">\(\bar{R}_i\)</span> is given by the population
variance, <span class="math inline">\(\frac{1}{12}(N^2-1)\)</span> in
this case, divided by the sample size <span
class="math inline">\(n_i\)</span>. Finally, the <span
class="math inline">\(\frac{N-1}{N}\)</span> is a correction factor that
will not be explained here. The full article explains the details about
how a multivariate normal distribution is used to uncover the formula
for <span class="math inline">\(H\)</span>. Thus, understanding <span
class="math inline">\(H\)</span> completely will require an advanced
degree in statistical theory. However, the short story is that the
distribution of the test statistic <span
class="math inline">\(H\)</span> is approximately a chi squared
distribution with <span class="math inline">\(C-1\)</span> degrees of
freedom and has the form of a sum of values consisting of the (observed
mean - expected mean)^2/(variance of the observed mean).</p>
<p><strong>Step 6</strong>: Calculate the p-value of <span
class="math inline">\(H\)</span> using a <a
href="MakingInference.html#chisquared">chi squared distribution</a> with
<span class="math inline">\(C-1\)</span> degrees of freedom. <span
class="math display">\[
  H = \frac{N-1}{N}\sum_{i=1}^C
\frac{n_i[\bar{R}_i-\frac{1}{2}(N+1)]^2}{\frac{1}{12}(N^2-1)}
\]</span></p>
<div style="padding-left:30px; color:#a8a8a8;">
<p>In the bottle-cap data, <span class="math inline">\(p =
0.059\)</span>, which represents the probability of <span
class="math inline">\(H\)</span> being as extreme or more extreme than
the observed value of 5.656, assuming the null hypothesis is true.</p>
</div>
<hr />
<div style="padding-left:125px;">
<p><strong>Examples:</strong> <a
href="./Analyses/Kruskal-Wallis%20Test/Examples/wagesKruskal.html">wages</a>,
<a
href="./Analyses/Kruskal-Wallis%20Test/Examples/pigweightsKruskal.html">pigweights</a></p>
</div>
<hr />
</div>
<div id="quantitative-y-multiple-categorical-x"
class="section level3 tabset tabset-fade">
<h3 class="tabset tabset-fade">Quantitative Y | Multiple Categorical
X</h3>
<div id="graphics-3" class="section level4">
<h4>Graphics</h4>
<div class="tooltipimage" style="float:left;width:125px;"
align="center">
<p><img src="Images/QuantYMultQualX.png" width=80px;> <span
class="tooltipimagetext">Y is a single quantitative variable of
interest, like “heights” of BYU-Idaho students. X1 is a categorical
(qualitative) variable like gender, with levels “boy” and “girl.” X2 is
another categorical (qualitative) variable like “Classrank” with levels
“Freshman”, “Sophomore”, and “Junior”. Of course, both X1 and X2 can
have as many levels as you want to work with, but must have at least two
levels each.</span></p>
</div>
<div style="padding-left:125px;color:black;">
<p><strong>Test(s) used for this category:</strong></p>
<ul>
<li>Two-Way ANOVA (means)</li>
</ul>
<p><br></p>
<p><strong>Used to answer THREE questions:</strong></p>
<ol style="list-style-type: decimal">
<li><p>the effects of factor 1 on the quantitative variable</p></li>
<li><p>the effects of factor 2 on the quantitative variable</p></li>
<li><p>the interaction between the two factors</p></li>
</ol>
<ul>
<li><p>best paired with numerical summary looking at
<strong><em>mean</em></strong></p></li>
<li><p>Analysis : <a
href="file:///C:/Users/paige/OneDrive/Documents/Fall%20Semester%202024/MATH%20325/Statistics-Notebook-master/Analyses/ANOVA/MyTwoWayANOVA.html">Two-way
ANOVA: Final Beginning Algebra Grades</a></p></li>
</ul>
<p><br></p>
<hr />
<p><a href="GraphicalSummaries.html#boxplots">
<img class="myhover" src="Images/boxplotthree.png" alt="Side-by-side Boxplots" title="Side-by-side Boxplots 3+ Groups">
</a> <a href="GraphicalSummaries.html#dot-plots">
<img class="myhover" src="Images/dotplottriple.png" alt="Side-by-side Dot Plots" title="Side-by-side Dot Plots 3+ Groups">
</a></p>
<p><br></p>
<p>Question Examples:</p>
<ul>
<li>Based on your p-values and these graphs, which of the following is a
correct conclusion to reach?</li>
</ul>
<div style="display: flex; justify-content: space-around;">
<div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">xyplot</span>(length <span class="sc">~</span> domhand, <span class="at">data=</span>KidsFeet, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;p&quot;</span>,<span class="st">&quot;a&quot;</span>), <span class="at">main=</span><span class="st">&quot;4th Grade Students&quot;</span>, <span class="at">col=</span><span class="st">&#39;dodgerblue&#39;</span>, <span class="at">xlab=</span><span class="st">&quot;Child&#39;s Dominant Hand&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Length of Child&#39;s Longest Foot&quot;</span>) </span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
</div>
<div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">xyplot</span>(length <span class="sc">~</span> sex, <span class="at">data=</span>KidsFeet, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;p&quot;</span>,<span class="st">&quot;a&quot;</span>), <span class="at">main=</span><span class="st">&quot;4th Grade Students&quot;</span>, <span class="at">col=</span><span class="st">&#39;dodgerblue&#39;</span>, <span class="at">xlab=</span><span class="st">&quot;Child&#39;s Gender&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Length of Child&#39;s Longest Foot&quot;</span>) </span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
</div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">xyplot</span>(length <span class="sc">~</span> sex, <span class="at">data=</span>KidsFeet, <span class="at">groups=</span>domhand, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;p&quot;</span>,<span class="st">&quot;a&quot;</span>), <span class="at">main=</span><span class="st">&quot;4th Grade Students&quot;</span>, <span class="at">auto.key=</span><span class="fu">list</span>(<span class="at">corner=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<ul>
<li><strong>ANSWER : Among fourth graders, right handed boys have longer
feet on average than left handed boys while the opposite is true for
girls.</strong></li>
</ul>
<p><br></p>
<hr />
<ol style="list-style-type: decimal">
<li><p>Does the amount a student <strong>participates</strong> in the
course affect the average final Beginning Algebra grades?</p></li>
<li><p>Does the <strong>semester</strong> in which a student takes
Beginning Algebra affect their average final grade?</p></li>
<li><p>Does a student’s <strong>participation</strong> level vary
depending on the <strong>semester</strong>? (Alternatively, does the
<strong>semester</strong> influence a student’s
<strong>participation</strong>?)</p></li>
</ol>
<div style="display: flex; justify-content: space-around;">
<div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>BAFinalGrades <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;C:/Users/paige/OneDrive/Documents/Fall Semester 2024/MATH 325/Statistics-Notebook-master/Data/BeginningAlgebraFinalGrades.csv&quot;</span>)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>BAFinalGrades<span class="sc">$</span>Semester <span class="ot">&lt;-</span> <span class="fu">factor</span>(BAFinalGrades<span class="sc">$</span>Semester, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Fall&quot;</span>,<span class="st">&quot;Winter&quot;</span>,<span class="st">&quot;Spring&quot;</span>))</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="fu">ggplot</span>(BAFinalGrades, <span class="fu">aes</span>(<span class="at">x=</span>Semester, <span class="at">y=</span>FinalGrade, <span class="at">group=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;firebrick1&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="at">geom=</span><span class="st">&quot;line&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Spring Semester Seems to Have Higher Final Grades&quot;</span>, <span class="at">x=</span><span class="st">&quot;Semester&quot;</span>, <span class="at">y=</span><span class="st">&quot;Beginning Algebra Final Grades&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
</div>
<div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>BAFinalGrades<span class="sc">$</span>Participation <span class="ot">&lt;-</span> <span class="fu">factor</span>(BAFinalGrades<span class="sc">$</span>Participation, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Low&quot;</span>,<span class="st">&quot;Moderate&quot;</span>,<span class="st">&quot;High&quot;</span>))</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="fu">ggplot</span>(BAFinalGrades, <span class="fu">aes</span>(<span class="at">x=</span>Participation, <span class="at">y=</span>FinalGrade, <span class="at">group=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="at">geom=</span><span class="st">&quot;line&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Higher Participation Seems to Lead to Higher Grades&quot;</span>, <span class="at">x=</span><span class="st">&quot;Participation&quot;</span>, <span class="at">y=</span><span class="st">&quot;Beginning Algebra Final Grades&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
</div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">ggplot</span>(BAFinalGrades, <span class="fu">aes</span>(<span class="at">x=</span>Semester, <span class="at">y=</span>FinalGrade, <span class="at">group=</span>Participation, <span class="at">color=</span>Participation)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="at">geom=</span><span class="st">&quot;line&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Beginning Algebra Seems Better during the Spring Semester&quot;</span>, <span class="at">x=</span><span class="st">&quot;BYU-Idaho Semesters&quot;</span>, <span class="at">y=</span><span class="st">&quot;Beginning Algebra Final Grades&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<!--- End of Add content area.  ------------------>
</div>
</div>
<div id="tests-3" class="section level4">
<h4>Tests</h4>
<div style="padding-left:125px;color:black;">
<!-- Add your customizations in the area below: -->
<div id="two-way-anova"
class="section level5 tabset tabset-fade tabset-pills">
<h5 class="tabset tabset-fade tabset-pills">Two-way ANOVA</h5>
<div style="float:left;width:125px;" align="center">
<p><img src="Images/QuantYMultQualX.png" width=80px;></p>
</div>
<div id="overview-8" class="section level6">
<h6>Overview</h6>
<div style="padding-left:125px;">
<p>A two-way ANOVA is only appropriate when all of the following are
satisfied.</p>
<ol style="list-style-type: decimal">
<li><p>The sample(s) of data can be considered to be representative of
their population(s).</p></li>
<li><p>The data is normally distributed in each group. (This can safely
be assumed to be satisfied when the <em>residuals</em> from the ANOVA
are normally distributed.)</p></li>
<li><p>The population variance of each group can be assumed to be the
same. (This can be safely assumed to be satisfied when the
<em>residuals</em> from the ANOVA show constant variance, i.e., are
similarly vertically spread out.)</p></li>
</ol>
<p><strong>Hypotheses</strong></p>
<p>With a two-way ANOVA there are three sets of hypotheses. Writing out
the hypotheses can be very involved depending on whether you use the
official “effects model” notation (very mathematically correct) or a
simplified “means model” notation (which isn’t very mathematically
correct, but gets the idea across in an acceptable way).</p>
<div class="tab">
<p><button class="tablinks" onclick="openTab(event, 'meansModel')">Means
Model</button>
<button class="tablinks" onclick="openTab(event, 'effectsModel')">Effects
Model</button></p>
</div>
<div id="meansModel" class="tabcontent" style="display:block;">
<p>
<ol style="list-style-type: decimal">
<li>The first set of hypotheses are a “one-way” set of hypotheses for
the first <em>factor</em> of the ANOVA. Factor: <code>X1</code> with
say, levels <span class="math inline">\(A\)</span> and <span
class="math inline">\(B\)</span>.</li>
</ol>
<p><span class="math display">\[
  H_0: \mu_A = \mu_B = \mu
\]</span> <span class="math display">\[
  H_a: \mu_A \neq \mu_B
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li><p>The second set of hypotheses are also a “one-way” set of
hypotheses, but for the second <em>factor</em> of the ANOVA. Factor:
<code>X2</code> with say, levels <span class="math inline">\(C\)</span>,
<span class="math inline">\(D\)</span>, and <span
class="math inline">\(E\)</span>. <span class="math display">\[
  H_0: \mu_C = \mu_D = \mu_E = \mu
\]</span> <span class="math display">\[
  H_a: \mu_i \neq \mu \ \text{for at least one}\ i\in\{1=C,2=D,3=E\}
\]</span></p></li>
<li><p>The third set of hypotheses are the most interesting hypotheses
in a two-way ANOVA. These are called the <em>interaction
hypotheses</em>. They test to see if the levels of one of the factors,
say <span class="math inline">\(X1\)</span>, impact <span
class="math inline">\(Y\)</span> differently for the differing levels of
the other factor, <span class="math inline">\(X2\)</span>. The
hypotheses read formally as</p></li>
</ol>
<p><span class="math display">\[
  H_0: \text{The effect of the first factor on Y} \\ \text{is the same
for all levels of the second factor.}
\]</span> <span class="math display">\[
  H_a: \text{The effect of the first factor on Y is not the same} \\
\text{for all levels of the second factor.}
\]</span></p>
</p>
</div>
<div id="effectsModel" class="tabcontent">
<p>
<p>A mathematically correct way to state the two-way ANOVA model is with
the equation <span class="math display">\[
  Y_{ijk} = \mu + \alpha_i + \beta_j + \alpha\beta_{ij} + \epsilon_{ijk}
\]</span> In this model, <span class="math inline">\(\mu\)</span> is the
grand mean (which is the average Y-value ignoring all information
contained in the factors); <span class="math inline">\(\alpha_i\)</span>
is the first factor <span class="math inline">\(X1\)</span> with levels
<span class="math inline">\(A\)</span> and <span
class="math inline">\(B\)</span> (though there could be more levels in
<span class="math inline">\(X1\)</span> depending on your data); <span
class="math inline">\(\beta_j\)</span> is the second factor with levels
<span class="math inline">\(C\)</span>, <span
class="math inline">\(D\)</span>, and <span
class="math inline">\(E\)</span> (though there could be fewer or more
levels to this factor depending on your data); <span
class="math inline">\(\alpha\beta_{ij}\)</span> is the interaction of
the two factors which has <span
class="math inline">\(2\times3=6\)</span> (may differ for your data)
levels; and <span class="math inline">\(\epsilon_{ijk} \sim
N(0,\sigma^2)\)</span> is the normally distributed error term for each
point <span class="math inline">\(k\)</span> found within level <span
class="math inline">\(i\)</span> of <span
class="math inline">\(X1\)</span> and level <span
class="math inline">\(j\)</span> of <span
class="math inline">\(X2\)</span>.</p>
<p>This model allows us to more formally state the hypotheses as</p>
<ol style="list-style-type: decimal">
<li><p>First factor <span class="math inline">\(X1\)</span> having say,
levels <span class="math inline">\(A\)</span> and <span
class="math inline">\(B\)</span>. <span class="math display">\[
  H_0: \alpha_A = \alpha_B = 0
\]</span> <span class="math display">\[
  H_a: \alpha_i \neq 0 \ \text{for at least one}\ i\in\{1=A,2=B\}
\]</span></p></li>
<li><p>Second factor <span class="math inline">\(X2\)</span> with say,
levels <span class="math inline">\(C\)</span>, <span
class="math inline">\(D\)</span>, and <span
class="math inline">\(E\)</span>. <span class="math display">\[
  H_0: \beta_C = \beta_D = \beta_E = 0
\]</span> <span class="math display">\[
  H_a: \beta_j \neq 0 \ \text{for at least one}\ j\in\{1=C,2=D,3=E\}
\]</span></p></li>
<li><p>Does the effect of the first factor (<span
class="math inline">\(X1\)</span>) change for the different levels of
the second factor (<span class="math inline">\(X2\)</span>)? In other
words, is there an interaction between the two factors <span
class="math inline">\(X1\)</span> and <span
class="math inline">\(X2\)</span>?</p></li>
</ol>
<p><span class="math display">\[
  H_0: \alpha\beta_{ij} = 0 \ \text{for all } i,j
\]</span> <span class="math display">\[
  H_a: \alpha\beta_{ij} \neq 0 \ \text{for at least one } i,j
\]</span></p>
</p>
</div>
<hr />
</div>
</div>
<div id="r-instructions-8" class="section level6">
<h6>R Instructions</h6>
<div style="padding-left:125px;">
<p><strong>Console</strong> Help Command: <code>?aov()</code></p>
<p><code>myaov &lt;- aov(Y ~ X1+X2+X1:X2, data=YourDataSet)</code>
<strong>Perform the ANOVA</strong></p>
<p><code>summary(myaov)</code> <strong>View the ANOVA
Results</strong></p>
<p><code>plot(myaov, which=1:2)</code> <strong>Check ANOVA
assumptions</strong></p>
<ul>
<li><code>myaov</code> is some name you come up with to store the
results of the <code>aov()</code> test.</li>
<li><code>Y</code> must be a “numeric” vector of the quantitative
response variable.</li>
<li><code>X1</code> is a qualitative variable (should have
<code>class(X1)</code> equal to <code>factor</code> or
<code>character</code>. If it does not, use <code>as.factor(X1)</code>
inside the <code>aov()</code> command.</li>
<li><code>X2</code> is a second qualitative variable that should also be
either a <code>factor</code> or a <code>character</code> vector.</li>
<li>Note that factors <code>X3</code>, <code>X4</code>, and so on could
also be added <code>+</code> to the model if desired, but this would
create a three-way, or four-way ANOVA model, and so on.</li>
<li><code>X1:X2</code> denotes the interaction of the factors
<code>X1</code> and <code>X2</code>. It is not required, but is usually
included.</li>
<li><code>YourDataSet</code> is the name of your data set.</li>
</ul>
<p><strong>Example Code</strong></p>
<p>Hover your mouse over the example codes to learn more.</p>
<a href="javascript:showhide('twoWayAnova')">
<div class="hoverchunk">
<p><span class="tooltipr"> warp.aov &lt;-  <span class="tooltiprtext">
Saves the results of the ANOVA test as an object named
‘warp.aov’.</span> </span><span class="tooltipr"> aov( <span
class="tooltiprtext">‘aov()’ is a function in R used to perform the
ANOVA.</span> </span><span class="tooltipr"> breaks <span
class="tooltiprtext"><span class="math inline">\(Y\)</span> is ‘breaks’,
which is a numeric variable from the warpbreaks dataset.</span>
</span><span class="tooltipr">  ~  <span class="tooltiprtext">‘~’ is the
tilde symbol used to separate the left- and right-hand side in a model
formula.</span> </span><span class="tooltipr"> wool  <span
class="tooltiprtext">The first factor <span
class="math inline">\(X1\)</span> is ‘wool’, which is a qualitative
variable in the warpbreaks dataset. In this case, <code>wool</code> is a
factor with two levels. Use str(warpbreaks) to see this. </span>
</span><span class="tooltipr"> + tension  <span class="tooltiprtext">The
second factor <span class="math inline">\(X2\)</span> is ‘tension’,
which is another qualitative variable in the warpbreaks dataset. In this
case, <code>tension</code> is a factor with three levels. Use
str(warpbreaks) to see this.</span> </span><span class="tooltipr">
+ wool:tension, <span class="tooltiprtext"> The interaction of the two
factors: wool and tension. </span> </span><span class="tooltipr">
 data = warpbreaks) <span class="tooltiprtext"> ‘warpbreaks’ is a
dataset in R.</span> </span><br><span class="tooltipr"> summary( <span
class="tooltiprtext"> ‘summary()’ shows the results of the ANOVA.</span>
</span><span class="tooltipr"> warp.aov) <span class="tooltiprtext">
‘warp.aov’ is the name of the ANOVA.</span> </span><span
class="tooltipr">     <br />
<span class="tooltiprtext">Press Enter to run the code if you have typed
it in yourself. You can also click here to view the output.</span>
</span><span class="tooltipr" style="float:right;font-size:.8em;">
 Click to View Output  <span class="tooltiprtext">Click to View
Output.</span> </span></p>
</div>
</a>
<div id="twoWayAnova" style="display:none;">
<pre><code>##              Df Sum Sq Mean Sq F value   Pr(&gt;F)
## wool          1    451   450.7   3.765 0.058213
## tension       2   2034  1017.1   8.498 0.000693
## wool:tension  2   1003   501.4   4.189 0.021044
## Residuals    48   5745   119.7                 
##                 
## wool         .  
## tension      ***
## wool:tension *  
## Residuals       
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<a href="javascript:showhide('twoWayAnovaCheck')">
<div class="hoverchunk">
<p><span class="tooltipr"> par( <span class="tooltiprtext">‘par’ is a R
function that can be used to set or query graphical parameters.</span>
</span><span class="tooltipr"> mfrow = c(1,2)) <span
class="tooltiprtext">Parameter is being set. The first item inside the
combine function c() is the number of rows and the second is the number
of columns. </span> </span><br><span class="tooltipr"> plot( <span
class="tooltiprtext">‘plot’ is a R function for the plotting of R
objects.</span> </span><span class="tooltipr"> warp.aov, <span
class="tooltiprtext">‘warp.aov’ is the name of the ANOVA.</span>
</span><span class="tooltipr">  which = 1:2) <span
class="tooltiprtext">Will show the Residuals vs Fitted and the Normal
QQ-plot to check the ANOVA assumptions.</span> </span><span
class="tooltipr" style="float:right;font-size:.8em;">  Click to View
Output  <span class="tooltiprtext">Click to View Output.</span>
</span></p>
</div>
</a>
<div id="twoWayAnovaCheck" style="display:none;">
<p><img src="index_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
</div>
<hr />
</div>
</div>
<div id="explanation-7" class="section level6">
<h6>Explanation</h6>
<div style="padding-left:125px;">
<p><strong><em>Hypotheses in Two-way ANOVA</em></strong></p>
<p>The hypotheses that can be tested in a two-way ANOVA that includes an
interaction term are three-fold.</p>
<p>Hypotheses about <span class="math inline">\(\alpha\)</span> where
<span class="math inline">\(\alpha\)</span> has <span
class="math inline">\(m\)</span> levels. <span class="math display">\[
  H_0: \alpha_1 = \alpha_2 = \ldots = \alpha_m = 0
\]</span> <span class="math display">\[
  H_a: \alpha_i \neq 0\ \text{for at least one}\ i\in\{1,\ldots,m\}
\]</span></p>
<p>Hypotheses about <span class="math inline">\(\beta\)</span> where
<span class="math inline">\(\beta\)</span> has <span
class="math inline">\(q\)</span> levels. <span class="math display">\[
  H_0: \beta_1 = \beta_2 = \ldots = \beta_q = 0
\]</span> <span class="math display">\[
  H_a: \beta_j \neq 0\ \text{for at least one}\ i\in\{1,\ldots,q\}
\]</span></p>
<p>Hypotheses about the interaction term <span
class="math inline">\(\alpha\beta\)</span>. <span
class="math display">\[
  H_0: \text{the effect of one factor is the same across all levels of
the other factor}
\]</span> <span class="math display">\[
  H_a: \text{the effect of one factor differs for at least one level of
the other factor}
\]</span></p>
<hr />
<p><strong><em>Expanding the ANOVA Model{#expanding}</em></strong></p>
<p>It turns out that more can be done with ANOVA than simply checking to
see if the means of several groups differ. Reconsider the mathematical
model of two-way ANOVA. <span class="math display">\[
  Y_{ijk} = \mu + \alpha_i + \beta_j + \alpha\beta_{ij} + \epsilon_{ijk}
\]</span> This model could be expanded to include any number of new
terms in the model. The power of this approach is in the several
questions (hypotheses) that can be posed to data simultaneously.</p>
<hr />
<p><strong><em>What happens if your ANOVA fails both requirement
tests?</em></strong></p>
<p><u>Example:</u></p>
<center>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>BAFinalGrades <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;C:/Users/paige/OneDrive/Documents/Fall Semester 2024/MATH 325/Statistics-Notebook-master/Data/BeginningAlgebraFinalGrades.csv&quot;</span>) </span></code></pre></div>
<pre><code>## Rows: 204 Columns: 3
## ── Column specification ──────────────────────────
## Delimiter: &quot;,&quot;
## chr (2): Semester, Participation
## dbl (1): FinalGrade
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>BAanova <span class="ot">&lt;-</span> <span class="fu">aov</span>(FinalGrade <span class="sc">~</span> Semester <span class="sc">+</span> Participation <span class="sc">+</span> Semester<span class="sc">:</span>Participation, <span class="at">data=</span>BAFinalGrades)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="fu">plot</span>(BAanova, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
</center>
<div style="display: flex; space-between: space-around;">
<div style="padding, 10px;flex: 1;">
<center>
<p>The <strong>residual plot</strong> shows that the <em>constant
(equal) variance</em> assumption raises some concern as the points
within each group have varying spread. The spread of each group seems to
gets closer and closer as we go from left to right as well as some
straying point from the more clustered groups. Thus, showing <strong>the
variance of the residuals are not constant and do not accurately show a
relationship between each variable</strong>.</p>
</center>
</div>
<div
style="border-left: 2px solid black; height: 100%; margin: 0 10px;">

</div>
<div style="padding; 10px;flex: 1;">
<center>
<p>For the <strong>Q-Q plot</strong>, it shows that the <em>residuals of
the data</em> is not quite normally distributed. There are visible
points at the lower and upper ends of the graph deviating away form the
diagonal line, which represents a normal distribution. Thus, showing us
that <strong>the residuals of the data are not normal
distributed</strong>.</p>
</center>
</div>
</div>
<p><br></p>
<p>Although both graphs indicate that the data fails to meet both
requirements, <strong>this primarily means our findings may be less
reliable due to the abnormalities in the data</strong>. As a result, we
should interpret the results cautiously as we proceed with our Two-Way
ANOVA test!</p>
</div>
<div style="padding-left:125px;">
<p><strong>Examples:</strong> <a
href="./Analyses/ANOVA/Examples/warpbreaksTwoWayANOVA.html">warpbreaks</a>
(Two-way), <a
href="./Analyses/ANOVA/Examples/CO2ThreeWayANOVA.html">CO2</a>
(three-way)</p>
</div>
<hr />
<!--- End of Add content area.  ------------------>
</div>
</div>
</div>
</div>
</div>
<div id="section-2" class="section level1">
<h1></h1>
<div style="clear:both;">

</div>
<hr />
<div id="quantitative-y-quantitative-x"
class="section level3 tabset tabset-fade">
<h3 class="tabset tabset-fade">Quantitative Y | Quantitative X</h3>
<div id="graphics-4" class="section level4">
<h4>Graphics</h4>
<div class="tooltipimage" style="float:left;width:125px;"
align="center">
<p><img src="Images/QuantYQuantX.png" width=59px;> <span
class="tooltipimagetext">Y is a single quantitative variable of
interest, like “height”. X is another single quantitative variable of
interest, like “shoe-size”. This would imply we are using “shoe-size”
(X) to explain “height” (Y).</span></p>
</div>
<div style="padding-left:125px;color:black;">
<p><strong>Test(s) used for this category:</strong></p>
<ul>
<li><p>Simple Linear Regression</p>
<ul>
<li>Analysis : <a
href="file:///C:/Users/paige/OneDrive/Documents/Fall%20Semester%202024/MATH%20325/Statistics-Notebook-master/Analyses/Linear%20Regression/MySimpleLinearRegression.html">Simple
Linear Regression: BYU-Idaho Math Tutoring</a></li>
</ul></li>
</ul>
<p><br></p>
<p><strong>Used to find the relationship between one independent
variable (predictor) and one dependent variable(outcome):</strong></p>
<ul>
<li>Is there a relationship between the length of children’s feet and
the width of their foot?</li>
</ul>
<p><a href="GraphicalSummaries.html#scatterplots">
<img class="myhover" src="Images/scatterplot.png" alt="Scatterplot" title="Scatterplot">
</a></p>
<p><br></p>
<p><em>Example:</em></p>
<ul>
<li>Does the amount of tutoring a student receives correlate with their
chapter exam scores? (<strong>Simple Linear Regression</strong>)</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>ExamsTutor <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;C:/Users/paige/OneDrive/Documents/Fall Semester 2024/MATH 325/Statistics-Notebook-master/Data/ExamsTutor.csv&quot;</span>)</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>TTExams <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ExamsTutor, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">Tutoring Final Score</span><span class="st">`</span>, <span class="at">y=</span> <span class="st">`</span><span class="at">Exams Final Score</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">&quot;darkolivegreen&quot;</span>, <span class="at">alpha =</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">formula=</span> y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">size=</span> <span class="fl">0.5</span>, <span class="at">color=</span><span class="st">&quot;darkgreen&quot;</span>)<span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;BYU-Idaho&#39;s 100B Students Tutoring Effects on Chapter Tests&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a><span class="fu">ggplotly</span>(TTExams)</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-a052dd0f973ae062b937" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-a052dd0f973ae062b937">{"x":{"data":[{"x":[96.150000000000006,76.920000000000002,96.150000000000006,100,96.150000000000006,100,84.620000000000005,76.920000000000002,96.150000000000006,100,96.150000000000006,100,19.23,15.380000000000001,96.150000000000006,100,100,50,92.310000000000002,69.230000000000004,92.310000000000002,100,88.459999999999994,100,92.310000000000002,100,100,57.689999999999998,100,96.150000000000006,100,100,100,65.379999999999995,92.310000000000002,100,96.150000000000006,11.539999999999999,100,100,23.079999999999998,80.769999999999996,100,96.150000000000006,100,76.920000000000002,100,96.150000000000006,76.920000000000002,100,100,96.150000000000006,88.459999999999994,84.620000000000005,100,100,100,88.459999999999994,26.920000000000002,100,92.310000000000002,57.689999999999998,96.150000000000006,100,65.379999999999995,96.150000000000006,96.150000000000006,100,100,26.920000000000002,100],"y":[94.430000000000007,89.430000000000007,99.430000000000007,96.859999999999999,84.290000000000006,93.569999999999993,83.569999999999993,92,84.290000000000006,94.140000000000001,88,95.290000000000006,90.709999999999994,10.289999999999999,85.709999999999994,77.430000000000007,90.430000000000007,91.859999999999999,79.140000000000001,81.430000000000007,92.859999999999999,96.290000000000006,72.859999999999999,98.859999999999999,81.290000000000006,77.430000000000007,93.140000000000001,78.290000000000006,84.569999999999993,83.430000000000007,95,97.290000000000006,91.430000000000007,66.290000000000006,76.569999999999993,85.569999999999993,93.290000000000006,64.859999999999999,86.569999999999993,89,85.290000000000006,87.140000000000001,88.290000000000006,94.709999999999994,95.430000000000007,92.709999999999994,98.859999999999999,91.290000000000006,78.569999999999993,91.569999999999993,92.290000000000006,93.140000000000001,97.859999999999999,89,97.140000000000001,97.859999999999999,95,96.709999999999994,76.569999999999993,97.859999999999999,86.859999999999999,73.140000000000001,92.430000000000007,93.859999999999999,70.290000000000006,91,85.709999999999994,100,93.569999999999993,60,96.290000000000006],"text":["Tutoring Final Score:  96.15<br />Exams Final Score:  94.43","Tutoring Final Score:  76.92<br />Exams Final Score:  89.43","Tutoring Final Score:  96.15<br />Exams Final Score:  99.43","Tutoring Final Score: 100.00<br />Exams Final Score:  96.86","Tutoring Final Score:  96.15<br />Exams Final Score:  84.29","Tutoring Final Score: 100.00<br />Exams Final Score:  93.57","Tutoring Final Score:  84.62<br />Exams Final Score:  83.57","Tutoring Final Score:  76.92<br />Exams Final Score:  92.00","Tutoring Final Score:  96.15<br />Exams Final Score:  84.29","Tutoring Final Score: 100.00<br />Exams Final Score:  94.14","Tutoring Final Score:  96.15<br />Exams Final Score:  88.00","Tutoring Final Score: 100.00<br />Exams Final Score:  95.29","Tutoring Final Score:  19.23<br />Exams Final Score:  90.71","Tutoring Final Score:  15.38<br />Exams Final Score:  10.29","Tutoring Final Score:  96.15<br />Exams Final Score:  85.71","Tutoring Final Score: 100.00<br />Exams Final Score:  77.43","Tutoring Final Score: 100.00<br />Exams Final Score:  90.43","Tutoring Final Score:  50.00<br />Exams Final Score:  91.86","Tutoring Final Score:  92.31<br />Exams Final Score:  79.14","Tutoring Final Score:  69.23<br />Exams Final Score:  81.43","Tutoring Final Score:  92.31<br />Exams Final Score:  92.86","Tutoring Final Score: 100.00<br />Exams Final Score:  96.29","Tutoring Final Score:  88.46<br />Exams Final Score:  72.86","Tutoring Final Score: 100.00<br />Exams Final Score:  98.86","Tutoring Final Score:  92.31<br />Exams Final Score:  81.29","Tutoring Final Score: 100.00<br />Exams Final Score:  77.43","Tutoring Final Score: 100.00<br />Exams Final Score:  93.14","Tutoring Final Score:  57.69<br />Exams Final Score:  78.29","Tutoring Final Score: 100.00<br />Exams Final Score:  84.57","Tutoring Final Score:  96.15<br />Exams Final Score:  83.43","Tutoring Final Score: 100.00<br />Exams Final Score:  95.00","Tutoring Final Score: 100.00<br />Exams Final Score:  97.29","Tutoring Final Score: 100.00<br />Exams Final Score:  91.43","Tutoring Final Score:  65.38<br />Exams Final Score:  66.29","Tutoring Final Score:  92.31<br />Exams Final Score:  76.57","Tutoring Final Score: 100.00<br />Exams Final Score:  85.57","Tutoring Final Score:  96.15<br />Exams Final Score:  93.29","Tutoring Final Score:  11.54<br />Exams Final Score:  64.86","Tutoring Final Score: 100.00<br />Exams Final Score:  86.57","Tutoring Final Score: 100.00<br />Exams Final Score:  89.00","Tutoring Final Score:  23.08<br />Exams Final Score:  85.29","Tutoring Final Score:  80.77<br />Exams Final Score:  87.14","Tutoring Final Score: 100.00<br />Exams Final Score:  88.29","Tutoring Final Score:  96.15<br />Exams Final Score:  94.71","Tutoring Final Score: 100.00<br />Exams Final Score:  95.43","Tutoring Final Score:  76.92<br />Exams Final Score:  92.71","Tutoring Final Score: 100.00<br />Exams Final Score:  98.86","Tutoring Final Score:  96.15<br />Exams Final Score:  91.29","Tutoring Final Score:  76.92<br />Exams Final Score:  78.57","Tutoring Final Score: 100.00<br />Exams Final Score:  91.57","Tutoring Final Score: 100.00<br />Exams Final Score:  92.29","Tutoring Final Score:  96.15<br />Exams Final Score:  93.14","Tutoring Final Score:  88.46<br />Exams Final Score:  97.86","Tutoring Final Score:  84.62<br />Exams Final Score:  89.00","Tutoring Final Score: 100.00<br />Exams Final Score:  97.14","Tutoring Final Score: 100.00<br />Exams Final Score:  97.86","Tutoring Final Score: 100.00<br />Exams Final Score:  95.00","Tutoring Final Score:  88.46<br />Exams Final Score:  96.71","Tutoring Final Score:  26.92<br />Exams Final Score:  76.57","Tutoring Final Score: 100.00<br />Exams Final Score:  97.86","Tutoring Final Score:  92.31<br />Exams Final Score:  86.86","Tutoring Final Score:  57.69<br />Exams Final Score:  73.14","Tutoring Final Score:  96.15<br />Exams Final Score:  92.43","Tutoring Final Score: 100.00<br />Exams Final Score:  93.86","Tutoring Final Score:  65.38<br />Exams Final Score:  70.29","Tutoring Final Score:  96.15<br />Exams Final Score:  91.00","Tutoring Final Score:  96.15<br />Exams Final Score:  85.71","Tutoring Final Score: 100.00<br />Exams Final Score: 100.00","Tutoring Final Score: 100.00<br />Exams Final Score:  93.57","Tutoring Final Score:  26.92<br />Exams Final Score:  60.00","Tutoring Final Score: 100.00<br />Exams Final Score:  96.29"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(85,107,47,1)","opacity":0.5,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(85,107,47,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[11.539999999999999,12.659746835443038,13.779493670886076,14.899240506329113,16.018987341772153,17.138734177215191,18.258481012658226,19.378227848101265,20.497974683544303,21.617721518987342,22.73746835443038,23.857215189873415,24.976962025316453,26.096708860759492,27.21645569620253,28.336202531645569,29.455949367088607,30.575696202531645,31.695443037974684,32.815189873417722,33.934936708860761,35.054683544303799,36.174430379746838,37.294177215189876,38.413924050632914,39.533670886075953,40.653417721518991,41.77316455696203,42.892911392405061,44.0126582278481,45.132405063291138,46.252151898734176,47.371898734177215,48.491645569620253,49.611392405063292,50.73113924050633,51.850886075949369,52.970632911392407,54.090379746835445,55.210126582278484,56.329873417721522,57.449620253164554,58.569367088607592,59.689113924050631,60.808860759493669,61.928607594936707,63.048354430379746,64.168101265822784,65.287848101265823,66.407594936708861,67.5273417721519,68.647088607594938,69.766835443037976,70.886582278481015,72.006329113924053,73.126075949367092,74.245822784810116,75.365569620253154,76.485316455696193,77.605063291139231,78.72481012658227,79.844556962025308,80.964303797468347,82.084050632911385,83.203797468354423,84.323544303797462,85.4432911392405,86.563037974683539,87.682784810126577,88.802531645569616,89.922278481012654,91.042025316455693,92.161772151898731,93.281518987341769,94.401265822784808,95.521012658227846,96.640759493670885,97.760506329113923,98.880253164556962,100],"y":[61.214856891890953,61.603902936667964,61.992948981444968,62.381995026221972,62.771041070998983,63.160087115775987,63.549133160552998,63.938179205330002,64.327225250107006,64.71627129488401,65.105317339661028,65.494363384438032,65.883409429215035,66.272455473992039,66.661501518769043,67.050547563546061,67.439593608323065,67.828639653100069,68.217685697877073,68.606731742654077,68.995777787431095,69.384823832208099,69.773869876985103,70.162915921762107,70.55196196653911,70.941008011316129,71.330054056093132,71.719100100870136,72.10814614564714,72.497192190424144,72.886238235201148,73.275284279978166,73.66433032475517,74.053376369532174,74.442422414309178,74.831468459086182,75.2205145038632,75.609560548640204,75.998606593417207,76.387652638194211,76.776698682971215,77.165744727748233,77.554790772525237,77.943836817302241,78.332882862079245,78.721928906856249,79.110974951633267,79.500020996410271,79.889067041187275,80.278113085964279,80.667159130741283,81.056205175518301,81.445251220295305,81.834297265072308,82.223343309849312,82.612389354626316,83.00143539940332,83.390481444180324,83.779527488957342,84.168573533734346,84.55761957851135,84.946665623288354,85.335711668065358,85.724757712842376,86.11380375761938,86.502849802396383,86.891895847173387,87.280941891950391,87.669987936727409,88.059033981504413,88.448080026281417,88.837126071058421,89.226172115835425,89.615218160612443,90.004264205389447,90.393310250166451,90.782356294943469,91.171402339720458,91.560448384497477,91.94949442927448],"text":["Tutoring Final Score:  11.54000<br />Exams Final Score: 61.21486","Tutoring Final Score:  12.65975<br />Exams Final Score: 61.60390","Tutoring Final Score:  13.77949<br />Exams Final Score: 61.99295","Tutoring Final Score:  14.89924<br />Exams Final Score: 62.38200","Tutoring Final Score:  16.01899<br />Exams Final Score: 62.77104","Tutoring Final Score:  17.13873<br />Exams Final Score: 63.16009","Tutoring Final Score:  18.25848<br />Exams Final Score: 63.54913","Tutoring Final Score:  19.37823<br />Exams Final Score: 63.93818","Tutoring Final Score:  20.49797<br />Exams Final Score: 64.32723","Tutoring Final Score:  21.61772<br />Exams Final Score: 64.71627","Tutoring Final Score:  22.73747<br />Exams Final Score: 65.10532","Tutoring Final Score:  23.85722<br />Exams Final Score: 65.49436","Tutoring Final Score:  24.97696<br />Exams Final Score: 65.88341","Tutoring Final Score:  26.09671<br />Exams Final Score: 66.27246","Tutoring Final Score:  27.21646<br />Exams Final Score: 66.66150","Tutoring Final Score:  28.33620<br />Exams Final Score: 67.05055","Tutoring Final Score:  29.45595<br />Exams Final Score: 67.43959","Tutoring Final Score:  30.57570<br />Exams Final Score: 67.82864","Tutoring Final Score:  31.69544<br />Exams Final Score: 68.21769","Tutoring Final Score:  32.81519<br />Exams Final Score: 68.60673","Tutoring Final Score:  33.93494<br />Exams Final Score: 68.99578","Tutoring Final Score:  35.05468<br />Exams Final Score: 69.38482","Tutoring Final Score:  36.17443<br />Exams Final Score: 69.77387","Tutoring Final Score:  37.29418<br />Exams Final Score: 70.16292","Tutoring Final Score:  38.41392<br />Exams Final Score: 70.55196","Tutoring Final Score:  39.53367<br />Exams Final Score: 70.94101","Tutoring Final Score:  40.65342<br />Exams Final Score: 71.33005","Tutoring Final Score:  41.77316<br />Exams Final Score: 71.71910","Tutoring Final Score:  42.89291<br />Exams Final Score: 72.10815","Tutoring Final Score:  44.01266<br />Exams Final Score: 72.49719","Tutoring Final Score:  45.13241<br />Exams Final Score: 72.88624","Tutoring Final Score:  46.25215<br />Exams Final Score: 73.27528","Tutoring Final Score:  47.37190<br />Exams Final Score: 73.66433","Tutoring Final Score:  48.49165<br />Exams Final Score: 74.05338","Tutoring Final Score:  49.61139<br />Exams Final Score: 74.44242","Tutoring Final Score:  50.73114<br />Exams Final Score: 74.83147","Tutoring Final Score:  51.85089<br />Exams Final Score: 75.22051","Tutoring Final Score:  52.97063<br />Exams Final Score: 75.60956","Tutoring Final Score:  54.09038<br />Exams Final Score: 75.99861","Tutoring Final Score:  55.21013<br />Exams Final Score: 76.38765","Tutoring Final Score:  56.32987<br />Exams Final Score: 76.77670","Tutoring Final Score:  57.44962<br />Exams Final Score: 77.16574","Tutoring Final Score:  58.56937<br />Exams Final Score: 77.55479","Tutoring Final Score:  59.68911<br />Exams Final Score: 77.94384","Tutoring Final Score:  60.80886<br />Exams Final Score: 78.33288","Tutoring Final Score:  61.92861<br />Exams Final Score: 78.72193","Tutoring Final Score:  63.04835<br />Exams Final Score: 79.11097","Tutoring Final Score:  64.16810<br />Exams Final Score: 79.50002","Tutoring Final Score:  65.28785<br />Exams Final Score: 79.88907","Tutoring Final Score:  66.40759<br />Exams Final Score: 80.27811","Tutoring Final Score:  67.52734<br />Exams Final Score: 80.66716","Tutoring Final Score:  68.64709<br />Exams Final Score: 81.05621","Tutoring Final Score:  69.76684<br />Exams Final Score: 81.44525","Tutoring Final Score:  70.88658<br />Exams Final Score: 81.83430","Tutoring Final Score:  72.00633<br />Exams Final Score: 82.22334","Tutoring Final Score:  73.12608<br />Exams Final Score: 82.61239","Tutoring Final Score:  74.24582<br />Exams Final Score: 83.00144","Tutoring Final Score:  75.36557<br />Exams Final Score: 83.39048","Tutoring Final Score:  76.48532<br />Exams Final Score: 83.77953","Tutoring Final Score:  77.60506<br />Exams Final Score: 84.16857","Tutoring Final Score:  78.72481<br />Exams Final Score: 84.55762","Tutoring Final Score:  79.84456<br />Exams Final Score: 84.94667","Tutoring Final Score:  80.96430<br />Exams Final Score: 85.33571","Tutoring Final Score:  82.08405<br />Exams Final Score: 85.72476","Tutoring Final Score:  83.20380<br />Exams Final Score: 86.11380","Tutoring Final Score:  84.32354<br />Exams Final Score: 86.50285","Tutoring Final Score:  85.44329<br />Exams Final Score: 86.89190","Tutoring Final Score:  86.56304<br />Exams Final Score: 87.28094","Tutoring Final Score:  87.68278<br />Exams Final Score: 87.66999","Tutoring Final Score:  88.80253<br />Exams Final Score: 88.05903","Tutoring Final Score:  89.92228<br />Exams Final Score: 88.44808","Tutoring Final Score:  91.04203<br />Exams Final Score: 88.83713","Tutoring Final Score:  92.16177<br />Exams Final Score: 89.22617","Tutoring Final Score:  93.28152<br />Exams Final Score: 89.61522","Tutoring Final Score:  94.40127<br />Exams Final Score: 90.00426","Tutoring Final Score:  95.52101<br />Exams Final Score: 90.39331","Tutoring Final Score:  96.64076<br />Exams Final Score: 90.78236","Tutoring Final Score:  97.76051<br />Exams Final Score: 91.17140","Tutoring Final Score:  98.88025<br />Exams Final Score: 91.56045","Tutoring Final Score: 100.00000<br />Exams Final Score: 91.94949"],"type":"scatter","mode":"lines","name":"fitted values","line":{"width":1.8897637795275593,"color":"rgba(0,100,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"BYU-Idaho's 100B Students Tutoring Effects on Chapter Tests","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[7.1169999999999982,104.423],"tickmode":"array","ticktext":["25","50","75","100"],"tickvals":[25,50,75,100],"categoryorder":"array","categoryarray":["25","50","75","100"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Tutoring Final Score","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[5.8044999999999982,104.4855],"tickmode":"array","ticktext":["25","50","75","100"],"tickvals":[25,50,75,100],"categoryorder":"array","categoryarray":["25","50","75","100"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Exams Final Score","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"30a85fd438f7":{"x":{},"y":{},"type":"scatter"},"30a889d3b6a":{"x":{},"y":{}}},"cur_data":"30a85fd438f7","visdat":{"30a85fd438f7":["function (y) ","x"],"30a889d3b6a":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<!--- End of Add content area.  ------------------>
</div>
</div>
<div id="tests-4" class="section level4">
<h4>Tests</h4>
<div style="padding-left:125px;color:black;">
<!-- Add your customizations in the area below: -->
<hr />
<div id="simple-linear-regression"
class="section level5 tabset tabset-fade tabset-pills">
<h5 class="tabset tabset-fade tabset-pills">Simple Linear
Regression</h5>
<div style="float:left;width:125px;" align="center">
<p><img src="Images/QuantYQuantX.png" width=58px;></p>
</div>
<p>Simple linear regression is a good analysis technique when the data
consists of a single quantitative response variable <span
class="math inline">\(Y\)</span> and a single quantitative explanatory
variable <span class="math inline">\(X\)</span>.</p>
<div id="overview-9" class="section level6 tabset">
<h6 class="tabset">Overview</h6>
<div style="padding-left:125px;">
<p><strong>Mathematical Model</strong></p>
<p>The true regression model assumed by a regression analysis is given
by</p>
<div
style="float:right;font-size:.8em;background-color:lightgray;padding:5px;border-radius:4px;">
<a style="color:darkgray;" href="javascript:showhide('simplelinearlatexrcode')">Math
Code</a>
</div>
<div id="simplelinearlatexrcode" style="display:none;">
<pre><code>$$\underbrace{Y_i}_\text{Some Label} = \overbrace{\beta_0}^\text{y-int} + \overbrace{\beta_1}^\text{slope} \underbrace{X_i}_\text{Some Label} + \epsilon_i \quad \text{where} \ \epsilon_i \sim N(0, \sigma^2)$$</code></pre>
</div>
<center>
<span class="tooltipr"> <span class="math inline">\(Y_i\)</span> <span
class="tooltiprtext">The response variable. The “i” denotes that this is
the y-value for individual “i”, where “i” is 1, 2, 3,… and so on up to
<span class="math inline">\(n\)</span>, the sample size.</span>
</span><span class="tooltipr"> <span class="math inline">\(=\)</span>
<span class="tooltiprtext">This states that we are assuming <span
class="math inline">\(Y_i\)</span> was created, or is “equal to” the
formula that will follow on the right-hand-side of the equation.</span>
</span><span class="tooltipr"> <span
class="math inline">\(\underbrace{\overbrace{\beta_0}^\text{y-intercept}
+ \overbrace{\beta_1}^\text{slope} X_i \ }_\text{true regression
relation}\)</span> <span class="tooltiprtext">The true regression
relation is a line, a line that is typically unknown in real life. It
can be likened to “God’s Law” or “Natural Law”. Something that governs
the way the data behaves, but is unkown to us.</span> </span><span
class="tooltipr"> <span class="math inline">\(+\)</span> <span
class="tooltiprtext">This plus sign emphasizes that the actual data, the
<span class="math inline">\(Y_i\)</span>, is created by adding together
the value from the true line <span class="math inline">\(\beta_0 +
\beta_1 X_i\)</span> and an individual error term <span
class="math inline">\(\epsilon_i\)</span>, which allows each dot in the
regression to be off of the line by a certain amount called <span
class="math inline">\(\epsilon_i\)</span>.</span> </span><span
class="tooltipr"> <span
class="math inline">\(\overbrace{\epsilon_i}^\text{error term}\)</span>
<span class="tooltiprtext">Error term for each individual <span
class="math inline">\(i\)</span>. The error terms are “random” and
unique for each individual. This provides the statistical relationship
of the regression. It is what allows each dot to be different, while
still coming from the same line, or underlying law.</span> </span><span
class="tooltipr"> <span class="math inline">\(\quad
\text{where}\)</span> <span class="tooltiprtext">Some extra comments are
needed about <span class="math inline">\(\epsilon_i\)</span>…</span>
</span><span class="tooltipr"> <span class="math inline">\(\
\overbrace{\epsilon_i \sim N(0, \sigma^2)}^\text{error term normally
distributed}\)</span> <span class="tooltiprtext">The error terms <span
class="math inline">\(\epsilon_i\)</span> are assumed to be normally
distributed with constant variance. Pay special note that the <span
class="math inline">\(\sigma\)</span> does not have an <span
class="math inline">\(i\)</span> in it, so it is the same for each
individual. In other words, the variance is constant. The mean of the
errors is zero, which causes the dots to be spread out symmetrically
both above and below the line.</span> </span>
</center>
<p><br/></p>
<p>The estimated regression line obtained from a regression analysis,
pronounced “y-hat”, is written as</p>
<div
style="float:right;font-size:.8em;background-color:lightgray;padding:5px;border-radius:4px;">
<a style="color:darkgray;" href="javascript:showhide('simplelinearlatexrcodeyhat')">Math
Code</a>
</div>
<div id="simplelinearlatexrcodeyhat" style="display:none;">
<pre><code>$$
  \underbrace{\hat{Y}_i}_\text{Some Label} = \overbrace{b_0}^\text{est. y-int} + \overbrace{b_1}^\text{est. slope} \underbrace{X_i}_\text{Some Label}
$$</code></pre>
</div>
<center>
<span class="tooltipr"> <span class="math inline">\(\hat{Y}_i\)</span>
<span class="tooltiprtext">The estimated average y-value for individual
<span class="math inline">\(i\)</span> is denoted by <span
class="math inline">\(\hat{Y}_i\)</span>. It is important to recognize
that <span class="math inline">\(Y_i\)</span> is the actual value for
individual <span class="math inline">\(i\)</span>, and <span
class="math inline">\(\hat{Y}_i\)</span> is the average y-value for all
individuals with the same <span class="math inline">\(X_i\)</span>
value.</span> </span><span class="tooltipr"> <span
class="math inline">\(=\)</span> <span class="tooltiprtext">The formula
for the average y-value, <span class="math inline">\(\hat{Y}_i\)</span>
is equal to what follows…</span> </span><span class="tooltipr"> <span
class="math inline">\(\underbrace{\overbrace{\ b_0 \
}^\text{y-intercept} + \overbrace{b_1}^\text{slope} X_i \
}_\text{estimated regression relation}\)</span> <span
class="tooltiprtext">Two things are important to notice about this
equation. First, it uses <span class="math inline">\(b_0\)</span> and
<span class="math inline">\(b_1\)</span> instead of <span
class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span>. This is because <span
class="math inline">\(b_0\)</span> and <span
class="math inline">\(b_1\)</span> are the estimated y-intercept and
slope, respectively, not the true y-intercept <span
class="math inline">\(\beta_0\)</span> and true slope <span
class="math inline">\(\beta_1\)</span>. Second, this equation does not
include <span class="math inline">\(\epsilon_i\)</span>. In other words,
it is the estimated regression line, so it only describes the average
y-values, not the actual y-values.</span> </span>
</center>
<p><br/></p>
<div style="font-size:0.8em;">
<p>Note: see the <strong>Explanation</strong> tab <strong>The
Mathematical Model</strong> for details about these equations.</p>
</div>
<p><strong>Hypotheses</strong></p>
<div
style="float:right;font-size:.8em;background-color:lightgray;padding:5px;border-radius:4px;">
<a style="color:darkgray;" href="javascript:showhide('simplelinearhypecodeslope')">Math
Code</a>
</div>
<div id="simplelinearhypecodeslope" style="display:none;">
<pre><code>$$
\left.\begin{array}{ll}
H_0: \beta_1 = 0 \\  
H_a: \beta_1 \neq 0
\end{array}
\right\} \ \text{Slope Hypotheses}
$$

$$
\left.\begin{array}{ll}
H_0: \beta_0 = 0 \\  
H_a: \beta_0 \neq 0
\end{array}
\right\} \ \text{Intercept Hypotheses}
$$</code></pre>
</div>
<div style="clear:right;">

</div>
<p><span class="math display">\[
\left.\begin{array}{ll}
H_0: \beta_1 = 0 \\  
H_a: \beta_1 \neq 0
\end{array}
\right\} \ \text{Slope Hypotheses}^{\quad \text{(most
common)}}\quad\quad
\]</span></p>
<p><span class="math display">\[
\left.\begin{array}{ll}
H_0: \beta_0 = 0 \\  
H_a: \beta_0 \neq 0
\end{array}
\right\} \ \text{Intercept Hypotheses}^{\quad\text{(sometimes useful)}}
\]</span></p>
<p><br/></p>
<p>If <span class="math inline">\(\beta_1 = 0\)</span>, then the model
reduces to <span class="math inline">\(Y_i = \beta_0 +
\epsilon_i\)</span>, which is a flat line. This means <span
class="math inline">\(X\)</span> does not improve our understanding of
the mean of <span class="math inline">\(Y\)</span> if the null
hypothesis is true.</p>
<p>If <span class="math inline">\(\beta_0 = 0\)</span>, then the model
reduces to <span class="math inline">\(Y_i = \beta_1 X +
\epsilon_i\)</span>, a line going through the origin. This means the
average <span class="math inline">\(Y\)</span>-value is <span
class="math inline">\(0\)</span> when <span
class="math inline">\(X=0\)</span> if the null hypothesis is true.</p>
<p><strong>Assumptions</strong></p>
<p>This regression model is appropriate for the data when five
assumptions can be made.</p>
<ol style="list-style-type: decimal">
<li><p><strong>Linear Relation</strong>: the true regression relation
between <span class="math inline">\(Y\)</span> and <span
class="math inline">\(X\)</span> is linear.</p></li>
<li><p><strong>Normal Errors</strong>: the error terms <span
class="math inline">\(\epsilon_i\)</span> are normally distributed with
a mean of zero.</p></li>
<li><p><strong>Constant Variance</strong>: the variance <span
class="math inline">\(\sigma^2\)</span> of the error terms is constant
(the same) over all <span class="math inline">\(X_i\)</span>
values.</p></li>
<li><p><strong>Fixed X</strong>: the <span
class="math inline">\(X_i\)</span> values can be considered fixed and
measured without error.</p></li>
<li><p><strong>Independent Errors</strong>: the error terms <span
class="math inline">\(\epsilon_i\)</span> are independent.</p></li>
</ol>
<div style="font-size:0.8em;">
<p>Note: see the <strong>Explanation</strong> tab <strong>Residual Plots
&amp; Regression Assumptions</strong> for details about checking the
regression assumptions.</p>
</div>
<p><strong>Interpretation</strong></p>
<p>The slope is interpreted as, “the change in the average y-value for a
one unit change in the x-value.” It <strong>is not</strong> the average
change in y. <strong>It is</strong> the change in the average
y-value.</p>
<p>The y-intercept is interpreted as, “the average y-value when x is
zero.” It is often not meaningful, but is sometimes useful. It just
depends if x being zero is meaningful or not within the context of your
analysis. For example, knowing the average price of a car with zero
miles is useful. However, pretending to know the average height of adult
males that weigh zero pounds, is not useful.</p>
<hr />
</div>
</div>
<div id="r-instructions-9" class="section level6">
<h6>R Instructions</h6>
<div style="padding-left:125px;">
<p><strong>Console</strong> Help Command: <code>?lm()</code></p>
<p><strong>Perform the Regression</strong></p>
<a href="javascript:showhide('simplelinearrcode')">
<div class="hoverchunk">
<p><span class="tooltipr"> mylm <span class="tooltiprtext">This is some
name you come up with that will become the R object that stores the
results of your linear regression <code>lm(...)</code> command.</span>
</span><span class="tooltipr">  &lt;-  <span class="tooltiprtext">This
is the “left arrow” assignment operator that stores the results of your
<code>lm()</code> code into <code>mylm</code> name.</span> </span><span
class="tooltipr"> lm( <span class="tooltiprtext">lm(…) is an R function
that stands for “Linear Model”. It performs a linear regression analysis
for Y ~ X.</span> </span><span class="tooltipr"> Y  <span
class="tooltiprtext">Y is your quantitative response variable. It is the
name of one of the columns in your data set.</span> </span><span
class="tooltipr"> ~  <span class="tooltiprtext">The tilde symbol ~ is
used to tell R that Y should be treated as the response variable that is
being explained by the explanatory variable X.</span> </span><span
class="tooltipr"> X, <span class="tooltiprtext">X is the quantitative
explanatory variable (at least it is typically quantitative but could be
qualitative) that will be used to explain the average Y-value.</span>
</span><span class="tooltipr">  data = NameOfYourDataset <span
class="tooltiprtext">NameOfYourDataset is the name of the dataset that
contains Y and X. In other words, one column of your dataset would be
your response variable Y and another column would be your explanatory
variable X.</span> </span><span class="tooltipr"> ) <span
class="tooltiprtext">Closing parenthesis for the lm(…) function.</span>
</span><br/><span class="tooltipr"> summary(mylm) <span
class="tooltiprtext">The <code>summary</code> command allows you to
print the results of your linear regression that were previously saved
in <code>mylm</code> name.</span> </span><span class="tooltipr"
style="float:right;font-size:.8em;">  Click to Show Output  <span
class="tooltiprtext">Click to View Output.</span> </span></p>
</div>
<p></a></p>
<div id="simplelinearrcode" style="display:none;">
<p>Example output from a regression. Hover each piece to learn more.</p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Call:<br/> lm(formula = dist ~ speed, data =
cars) <span class="tooltiprouttext">This is simply a statement of your
original lm(…) “call” that you made when performing your regression. It
allows you to verify that you ran what you thought you ran in the
lm(…).</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td colspan="2">
<span class="tooltiprout"> Residuals: <span
class="tooltiprouttext">Residuals are the vertical difference between
each point and the line, <span class="math inline">\(Y_i -
\hat{Y}_i\)</span>. The residuals are supposed to be normally
distributed, so a quick glance at their five-number summary can give us
insight about any skew present in the residuals. </span>
</td>
</tr>
<tr>
<td align="right">
<span class="tooltiprout"> min<br/>   -29.069 <span
class="tooltiprouttext">“min” gives the value of the residual that is
furthest below the regression line. Ideally, the magnitude of this value
would be about equal to the magnitude of the largest positive residual
(the max) because the hope is that the residuals are normally
distributed around the line.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 1Q<br/>   -9.525 <span
class="tooltiprouttext">“1Q” gives the first quartile of the residuals,
which will always be negative, and ideally would be about equal in
magnitude to the third quartile.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> Median<br/>   -2.272 <span
class="tooltiprouttext">“Median” gives the median of the residuals,
which would ideally would be about equal to zero. Note that because the
regression line is the least squares line, the mean of the residuals
will ALWAYS be zero, so it is never included in the output summary. This
particular median value of -2.272 is a little smaller than zero than we
would hope for and suggests a right skew in the data because the mean
(0) is greater than the median (-2.272) witnessing the residuals are
right skewed. This can also be seen in the maximum being much larger in
magnitude than the minimum.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 3Q<br/>   9.215 <span
class="tooltiprouttext">“3Q” gives the third quartile of the residuals,
which would ideally would be about equal in magnitude to the first
quartile. In this case, it is pretty close, which helps us see that the
first quartile of residuals on either side of the line is behaving
fairly normally.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> Max</br>   43.201 <span
class="tooltiprouttext">“Max” gives the maximum positive residuals,
which would ideally would be about equal in magnitude to the minimum
residual. In this case, it is much larger than the minimum, which helps
us see that the residuals are likely right skewed.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td colspan="2">
<span class="tooltiprout"> Coefficients: <span
class="tooltiprouttext">Notice that in your lm(…) you used only <span
class="math inline">\(Y\)</span> and <span
class="math inline">\(X\)</span>. You did type out any coefficients,
i.e., the <span class="math inline">\(\beta_0\)</span> or <span
class="math inline">\(\beta_1\)</span> of the regression model. These
coefficients are estimated by the lm(…) function and displayed in this
part of the output along with standard errors, t-values, and
p-values.</span> </span>
</td>
</tr>
<tr>
<td align="left">
</td>
<td align="right">
<span class="tooltiprout">   Estimate <span class="tooltiprouttext">To
learn more about the “Estimates” of the “Coefficients” see the
“Explanation” tab, “Estimating the Model Parameters” section for
details.</span>
</td>
<td align="right">
<span class="tooltiprout">   Std. Error <span class="tooltiprouttext">To
learn more about the “Standard Errors” of the “Coefficients” see the
“Explanation” tab, “Inference for the Model Parameters” section.</span>
</span>
</td>
<td align="right">
<span class="tooltiprout">   t value <span class="tooltiprouttext">To
learn more about the “t value” of the “Coefficients” see the
“Explanation” tab, “Inference for the Model Parameters” section.</span>
</span>
</td>
<td align="right">
<span class="tooltiprout">   Pr(&gt;|t|) <span
class="tooltiprouttext">The “Pr” stands for “Probability” and the “(&gt;
|t|)” stands for “more extreme than the observed t-value”. Thus, this is
the p-value for the hypothesis test of each coefficient being zero.<br/>
To learn more about the “p-value” of the “Coefficients” see the
“Explanation” tab, “Inference for the Model Parameters” section. </span>
</span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> (Intercept) <span
class="tooltiprouttext">This always says “Intercept” for any lm(…) you
run in R. That is because R always assumes there is a y-intercept for
your regression function.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   -17.5791 <span class="tooltiprouttext">This
is the estimate of the y-intercept, <span
class="math inline">\(\beta_0\)</span>. It is called <span
class="math inline">\(b_0\)</span>. It is the average y-value when X is
zero.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   6.7584 <span class="tooltiprouttext">This
is the standard error of <span class="math inline">\(b_0\)</span>. It
tells you how much <span class="math inline">\(b_0\)</span> varies from
sample to sample. The closer to zero, the better.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> -2.601 <span class="tooltiprouttext">This is
the test statistic t for the test of <span class="math inline">\(\beta_0
= 0\)</span>. It is calculated by dividing the “Estimate” of the
intercept (-17.5791) by its standard error (6.7584). It gives the
“number of standard errors” away from zero that the “estimate” has
landed. In this case, the estimate of -17.5791 is -2.601 standard errors
(6.7584) from zero, which is a fairly surprising distance as shown by
the p-value.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 0.0123 <span class="tooltiprouttext">This is
the p-value of the test of the hypothesis that <span
class="math inline">\(\beta_0 = 0\)</span>. It measures the probability
of observing a t-value as extreme as the one observed. To compute it
yourself in R, use
<code>pt(-abs(your t-value), df of your regression)*2</code>.</span>
</span>
</td>
<td align="left">
<span class="tooltiprout"> * <span class="tooltiprouttext">This is
called a “star”. One star means significant at the 0.1 level of <span
class="math inline">\(\alpha\)</span>.</span> </span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> speed <span class="tooltiprouttext">This is
always the name of your X-variable in your lm(Y ~ X, …).</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   3.9324 <span class="tooltiprouttext">This
is the estimate of the slope, <span
class="math inline">\(\beta_1\)</span>. It is called <span
class="math inline">\(b_1\)</span>. It is the change in the average
y-value as X is increased by 1 unit.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   0.4155 <span class="tooltiprouttext">This
is the standard error of <span class="math inline">\(b_1\)</span>. It
tells you how much <span class="math inline">\(b_1\)</span> varies from
sample to sample. The closer to zero, the better.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 9.464 <span class="tooltiprouttext">This is
the test statistic t for the test of <span class="math inline">\(\beta_1
= 0\)</span>. It is calculated by dividing the “Estimate” of the slope
(3.9324) by its standard error (0.4155). It gives the “number of
standard errors” away from zero that the “estimate” has landed. In this
case, the estimate of 3.9324 is 9.464 standard errors (0.4155) from
zero, which is a really surprising distance as shown by the smallness of
the p-value.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 1.49e-12 <span class="tooltiprouttext">This
is the p-value of the test of the hypothesis that <span
class="math inline">\(\beta_1 = 0\)</span>. To compute it yourself in R,
use <code>pt(-abs(your t-value), df of your regression)*2</code></span>
</span>
</td>
<td align="left">
<span class="tooltiprout"> *** <span class="tooltiprouttext">This is
called a “star”. Three stars means significant at the 0.01 level of
<span class="math inline">\(\alpha\)</span>.</span> </span>
</td>
</tr>
</table>
<table class="rconsole">
<tr>
<td>
<span> --- </span>
</td>
</tr>
</table>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ’*’
0.05 ‘.’ 0.1 ‘ ’ 1 <span class="tooltiprouttext">These “codes” explain
what significance level the p-value is smaller than based on how many
“stars” * the p-value is labeled with in the Coefficients table
above.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Residual standard error: <span
class="tooltiprouttext">This is the estimate of <span
class="math inline">\(\sigma\)</span> in the regression model <span
class="math inline">\(Y_i = \beta_0 + \beta_1 X_i + \epsilon_i\)</span>
where <span class="math inline">\(\epsilon_i \sim
N(0,\sigma^2)\)</span>. It is the square root of the MSE.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  15.38 <span class="tooltiprouttext">For this
particular regression, the estimate of <span
class="math inline">\(\sigma\)</span> is 15.38. Squaring this number
gives you the MSE, which is the estimate of <span
class="math inline">\(\sigma^2\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  on 48 degrees of freedom <span
class="tooltiprouttext">This is <span class="math inline">\(n-p\)</span>
where <span class="math inline">\(n\)</span> is the sample size and
<span class="math inline">\(p\)</span> is the number of parameters in
the regression model. In this case, there is a sample size of 50 and two
parameters, <span class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span>, so 50-2 = 48.</span> </span>
</td>
</tr>
</table>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Multiple R-squared: <span
class="tooltiprouttext">This is <span
class="math inline">\(R^2\)</span>, the percentage of variation in <span
class="math inline">\(Y\)</span> that is explained by the regression
model. It is equal to the SSR/SSTO or, equivalently, 1 -
SSE/SSTO.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  0.6511, <span class="tooltiprouttext">In
this particular regression, 65.11% of the variation in stopping distance
<code>dist</code> is explained by the regression model using speed of
the car.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  Adjusted R-squared: <span
class="tooltiprouttext">The adjusted R-squared will always be at least
slightly smaller than <span class="math inline">\(R^2\)</span>. The
closer to R-squared that it is, the better. When it differs dramatically
from <span class="math inline">\(R^2\)</span>, it is a sign that the
regression model is over-fitting the data.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  0.6438 <span class="tooltiprouttext">In this
case, the value of 0.6438 is quite close to the original <span
class="math inline">\(R^2\)</span> value, so there is no fear of
over-fitting with this particular model. That is good.</span> </span>
</td>
</tr>
</table>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> F-statistic: <span
class="tooltiprouttext">The F-statistic is found as the ratio of the
MSR/MSE where MSR = SSR/(p-1) and MSE = SSE/(n-p) where n is the sample
size and p is the number of parameters in the regression model.</span>
</span>
</td>
<td align="right">
<span class="tooltiprout">  89.57 <span class="tooltiprouttext">This is
the value of the F-statistic for the lm(dist ~ speed, data=cars)
regression. Note that SSE = sum( cars.lm$res^2 ) = 11353.52 with n - p =
50 - 2 = 48 degrees of freedom for this data. Further, SSR = sum(
(cars.lm$fit - mean(cars$dist))^2 ) = 21185.46 with p - 1 = 1 degree of
freedom. So MSR = 21185.46 and MSE = 11353.52 / 48 = 236.5317. So MSR /
MSE = 21185.46 / 236.5317 = 89.56711.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  on 1 and 48 DF, <span
class="tooltiprouttext">The 1 degree of freedom is the SSR degrees of
freedom (p-1). The 48 is the SSE degrees of freedom (n-p).</span>
</span>
</td>
<td align="right">
<span class="tooltiprout">  p-value: 1.49e-12 <span
class="tooltiprouttext">The p-value for an F-statistic is found by the
code pf(89.56711, 1, 48, lower.tail=FALSE), which gives the probability
of being more extreme than the observed F-statistic in an F distribution
with 1 and 48 degrees of freedom.</span> </span>
</td>
</tr>
</table>
</div>
<p><br/></p>
<p><strong>Check Assumptions 1, 2, 3, and 5</strong></p>
<p><br></p>
<ul>
<li><p>When making it in an r chunk make your height 3!</p>
<ul>
<li>{ r, fig.height = 3 }</li>
</ul></li>
</ul>
<p><br></p>
<a href="javascript:showhide('assumptionplots')">
<div class="hoverchunk">
<p><span class="tooltipr"> par( <span class="tooltiprtext">The par(…)
command stands for “Graphical PARameters”. It allows you to control
various aspects of graphics in Base R.</span> </span><span
class="tooltipr"> mfrow= <span class="tooltiprtext">This stands for
“multiple frames filled by row”, which means, put lots of plots on the
same row, starting with the plot on the left, then working towards the
right as more plots are created.</span> </span><span class="tooltipr">
c( <span class="tooltiprtext">The combine function c(…) is used to
specify how many rows and columns of graphics should be placed
together.</span> </span><span class="tooltipr"> 1, <span
class="tooltiprtext">This specifies that 1 row of graphics should be
produced.</span> </span><span class="tooltipr"> 3 <span
class="tooltiprtext">This states that 3 columns of graphics should be
produced.</span> </span><span class="tooltipr"> ) <span
class="tooltiprtext">Closing parenthesis for c(…) function.</span>
</span><span class="tooltipr"> ) <span class="tooltiprtext">Closing
parenthesis for par(…) function.</span> </span><br/><span
class="tooltipr"> plot( <span class="tooltiprtext">This version of
plot(…) will actually create several regression diagnostic plots by
default.</span> </span><span class="tooltipr"> mylm, <span
class="tooltiprtext">This is the name of an lm object that you created
previously.</span> </span><span class="tooltipr"> which= <span
class="tooltiprtext">This allows you to select “which” regression
diagnostic plots should be drawn.</span> </span><span class="tooltipr">
1 <span class="tooltiprtext">Selecting 1, would give the residuals
vs. fitted values plot only.</span> </span><span class="tooltipr"> :
<span class="tooltiprtext">The colon allows you to select more than just
one plot.</span> </span><span class="tooltipr"> 2 <span
class="tooltiprtext">Selecting 2 also gives the Q-Q Plot of residuals.
If you wanted to instead you could just use which=1 to get the residuals
vs fitted values plot, then you could use qqPlot(mylm$residuals) to
create a fancier Q-Q Plot of the residuals.</span> </span><span
class="tooltipr"> ) <span class="tooltiprtext">Closing parenthesis for
plot(…) function.</span> </span><br/><span class="tooltipr"> plot( <span
class="tooltiprtext">This version of plot(…) will be used to create a
time-ordered plot of the residuals. The order of the residuals is the
original order of the x-values in the original data set. If the original
data set doesn’t have an order, then this plot is not
interesting.</span> </span><span class="tooltipr"> mylm <span
class="tooltiprtext">The lm object that you created previously.</span>
</span><span class="tooltipr"> $ <span class="tooltiprtext">This allows
you to access various elements from the regression that was
performed.</span> </span><span class="tooltipr"> residuals <span
class="tooltiprtext">This grabs the residuals for each observation in
the regression.</span> </span><span class="tooltipr"> ) <span
class="tooltiprtext">Closing parenthesis for plot(…) function.</span>
</span><span class="tooltipr" style="float:right;font-size:.8em;">
 Click to Show Output  <span class="tooltiprtext">Click to View
Output.</span> </span></p>
</div>
<p></a></p>
<div id="assumptionplots" style="display:none;">
<p><img src="index_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
</div>
<ol style="list-style-type: decimal">
<li>Which regression assumption(s) does the <strong>residuals versus
fitted values plot</strong> diagnose?</li>
</ol>
<ul>
<li><p>Linear Relation</p></li>
<li><p>Constance Variance</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Which regression assumption(s) does the <strong>Q-Q Plot of the
residuals</strong> diagnose?</li>
</ol>
<ul>
<li>Normal Errors</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Which regression assumption(s) does the <strong>Residuals versus
Order plot</strong> diagnose? <em>(Remember, this plot can only be
created when the data was collected in a specific order.)</em></li>
</ol>
<ul>
<li>Independent Errors</li>
</ul>
<p><br/></p>
<p><strong>Plotting the Regression Line</strong></p>
<div class="tab">
<p><button class="tablinks" onclick="openTab(event, 'BaseScatterplot')">Base
R</button>
<button class="tablinks" onclick="openTab(event, 'ggplotScatterplot')">ggplot2</button></p>
</div>
<div id="BaseScatterplot" class="tabcontent">
<p>
<p>To add the regression line to a scatterplot use the
<code>abline(...)</code> command:</p>
<a href="javascript:showhide('regressionline')">
<div class="hoverchunk">
<p><span class="tooltipr"> plot( <span class="tooltiprtext">The plot(…)
function is used to create a scatterplot with a y-axis (the vertical
axis) and an x-axis (the horizontal axis).</span> </span><span
class="tooltipr"> Y  <span class="tooltiprtext">This is the “response
variable” of your regression. The thing you are interested in
predicting. This is the name of a “numeric” column of data from the data
set called YourDataSet.</span> </span><span class="tooltipr"> ~  <span
class="tooltiprtext">The tilde “~” is used to relate Y to X and can be
found on the top-left key of your keyboard.</span> </span><span
class="tooltipr"> X,  <span class="tooltiprtext">This is the explanatory
variable of your regression. It is the name of a “numeric” column of
data from YourDataSet. .</span> </span><span class="tooltipr"> data=
<span class="tooltiprtext">The data= statement is used to specify the
name of the data set where the columns of “X” and “Y” are
located.</span> </span><span class="tooltipr"> YourDataSet <span
class="tooltiprtext">This is the name of your data set, like KidsFeet or
cars or airquality.</span> </span><span class="tooltipr"> ) <span
class="tooltiprtext">Closing parenthesis for plot(…) function.</span>
</span><br/><span class="tooltipr"> abline( <span
class="tooltiprtext">This stands for “a” (intercept) “b” (slope) line.
It is a function that allows you to add a line to a plot by specifying
just the intercept and slope of the line.</span> </span><span
class="tooltipr"> mylm <span class="tooltiprtext">This is the name of an
lm(…) that you created previoiusly. Since mylm contains the slope and
intercept of the estimated line, the abline(…) function will locate
these two values from within mylm and use them to add a line to your
current plot(…).</span> </span><span class="tooltipr"> ) <span
class="tooltiprtext">Closing parenthesis for abline(…) function.</span>
</span><span class="tooltipr" style="float:right;font-size:.8em;">
 Click to Show Output  <span class="tooltiprtext">Click to View
Output.</span> </span></p>
</div>
<p></a></p>
<div id="regressionline" style="display:none;">
<pre><code>mylm &lt;- lm(dist ~ speed, data = cars)
plot(dist ~ speed, data = cars)
abline(mylm)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
</div>
<p>You can customize the look of the regression line with</p>
<a href="javascript:showhide('regressionlinecolor')">
<div class="hoverchunk">
<p><span class="tooltipr"> abline( <span class="tooltiprtext">This
stands for “a” (intercept) “b” (slope) line. It is a function that
allows you to add a line to a plot by specifying just the intercept and
slope of the line.</span> </span><span class="tooltipr"> mylm, <span
class="tooltiprtext">This is the name of an lm(…) that you created
previoiusly. Since mylm contains the slope and intercept of the
estimated line, the abline(…) function will locate these two values from
within mylm and use them to add a line to your current plot(…).</span>
</span><span class="tooltipr"> lty= <span class="tooltiprtext">The lty=
stands for “line type” and allows you to select between 0=blank, 1=solid
(default), 2=dashed, 3=dotted, 4=dotdash, 5=longdash, 6=twodash.</span>
</span><span class="tooltipr"> 1, <span class="tooltiprtext">This
creates a solid line. Remember, other options include: 0=blank, 1=solid
(default), 2=dashed, 3=dotted, 4=dotdash, 5=longdash, 6=twodash.</span>
</span><span class="tooltipr"> lwd= <span class="tooltiprtext">The lwd=
allows you to specify the width of the line. The default width is 1.
Using lwd=2 would double the thickness, and so on. Any positive value is
allowed.</span> </span><span class="tooltipr"> 1, <span
class="tooltiprtext">Default line width. To make a thicker line, us 2 or
3… To make a thinner line, try 0.5, but 1 is already pretty thin.</span>
</span><span class="tooltipr"> col= <span class="tooltiprtext">This
allows you to specify the color of the line using either a name of a
color or rgb(.5,.2,.3,.2) where the format is rgb(percentage red,
percentage green, percentage blue, percent opaque).</span> </span><span
class="tooltipr"> “someColor” <span class="tooltiprtext">Type colors()
in R for options.</span> </span><span class="tooltipr"> ) <span
class="tooltiprtext">Closing parenthesis for abline(…) function.</span>
</span><span class="tooltipr" style="float:right;font-size:.8em;">
 Click to Show Output  <span class="tooltiprtext">Click to View
Output.</span> </span></p>
</div>
<p></a></p>
<div id="regressionlinecolor" style="display:none;">
<pre><code>mylm &lt;- lm(dist ~ speed, data = cars)
plot(dist ~ speed, data = cars)
abline(mylm, lty=1, lwd=1, col=&quot;firebrick&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
</div>
<p>You can add points to the regression with…</p>
<a href="javascript:showhide('regressionaddpoints')">
<div class="hoverchunk">
<p><span class="tooltipr"> points( <span class="tooltiprtext">This is
like plot(…) but adds points to the current plot(…) instead of creating
a new plot.</span> </span><span class="tooltipr"> newY  <span
class="tooltiprtext">newY should be a column of values from some data
set. Or, use points(newX, newY) to add a single point to a graph.</span>
</span><span class="tooltipr"> ~  <span class="tooltiprtext">This links
Y to X in the plot.</span> </span><span class="tooltipr"> newX,  <span
class="tooltiprtext">newX should be a column of values from some data
set. It should be the same length as newY. If just a single value, use
points(newX, newY) instead.</span> </span><span class="tooltipr">
data=YourDataSet,  <span class="tooltiprtext">If newY and newX come from
a dataset, then use data= to tell the points(…) function what data set
they come from. If newY and newX are just single values, then data= is
not needed.</span> </span><span class="tooltipr"> col=“skyblue”, <span
class="tooltiprtext">This allows you to specify the color of the points
using either a name of a color or rgb(.5,.2,.3,.2) where the format is
rgb(percentage red, percentage green, percentage blue, percent
opaque).</span> </span><span class="tooltipr"> pch=16 <span
class="tooltiprtext">This allows you to specify the type of plotting
symbol to be used for the points. Type ?pch and scroll half way down in
the help file that appears to learn about other possible symbols.</span>
</span><span class="tooltipr"> ) <span class="tooltiprtext">Closing
parenthesis for points(…) function.</span> </span><span class="tooltipr"
style="float:right;font-size:.8em;">  Click to Show Output  <span
class="tooltiprtext">Click to View Output.</span> </span></p>
</div>
<p></a></p>
<div id="regressionaddpoints" style="display:none;">
<pre><code>mylm &lt;- lm(dist ~ speed, data = cars)
plot(dist ~ speed, data = cars)
points(7,40, pch=16, col=&quot;skyblue&quot;, cex=2)
text(7,40, &quot;New Dot&quot;, pos=3, cex=0.5)
points(dist ~ speed, data=filter(cars, mylm$res &gt; 2), cex=.8, col=&quot;red&quot;)
abline(mylm, lty=1, lwd=1, col=&quot;firebrick&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
</div>
</p>
</div>
<div id="ggplotScatterplot" class="tabcontent">
<p>
<p>To add the regression line to a scatterplot using the ggplot2
approach, first ensure:</p>
<p><code>library(ggplot2)</code> or <code>library(tidyverse)</code></p>
<p>is loaded. Then, use the <code>geom_smooth(method = lm)</code>
command:</p>
<a href="javascript:showhide('ggplot')">
<div class="hoverchunk">
<p><span class="tooltipr"> ggplot( <span class="tooltiprtext">Every
ggplot2 graphic begins with the ggplot() command, which creates a
framework, or coordinate system, that you can add layers to. Without
adding any layers, ggplot() produces a blank graphic.</span>
</span><span class="tooltipr"> YourDataSet,  <span
class="tooltiprtext">This is simply the name of your data set, like
KidsFeet or starwars.</span> </span><span class="tooltipr"> aes( <span
class="tooltiprtext">aes stands for aesthetic. Inside of aes(), you
place elements that you want to map to the coordinate system, like x and
y variables.</span> </span><span class="tooltipr"> x =  <span
class="tooltiprtext">“x = ” declares which variable will become the
x-axis of the graphic, your explanatory variable. Both “x= ” and “y= ”
are optional phrasesin the ggplot2 syntax.</span> </span><span
class="tooltipr"> X, <span class="tooltiprtext">This is the explanatory
variable of the regression: the variable used to <em>explain</em> the
mean of y. It is the name of the “numeric” column of YourDataSet.</span>
</span><span class="tooltipr">  y =  <span class="tooltiprtext">“y= ”
declares which variable will become the y-axis of the graphic.</span>
</span><span class="tooltipr"> Y <span class="tooltiprtext">This is the
response variable of the regression: the variable that you are
interested in predicting. It is the name of a “numeric” column of
YourDataSet.</span> </span><span class="tooltipr"> ) <span
class="tooltiprtext">Closing parenthesis for aes(…) function.</span>
</span><span class="tooltipr"> ) <span class="tooltiprtext">Closing
parenthesis for ggplot(…) function.</span> </span><span
class="tooltipr"> + <span class="tooltiprtext">The + allows you to add
more layers to the framework provided by ggplot(). In this case, you use
+ to add a geom_point() layer on the next line.</span> </span><br/><span
class="tooltipr">   geom_point() <span class="tooltiprtext">geom_point()
allows you to add a layer of points, a scatterplot, over the ggplot()
framework. The x and y coordinates are received from the previously
specified x and y variables declared in the ggplot() aesthetic.</span>
</span><span class="tooltipr"> + <span class="tooltiprtext">Here the +
is used to add yet another layer to ggplot().</span> </span><br/><span
class="tooltipr">   geom_smooth( <span
class="tooltiprtext">geom_smooth() is a smoothing function that you can
use to add different lines or curves to ggplot(). In this case, you will
use it to add the least-squares regression line to the
scatterplot.</span> </span><span class="tooltipr"> method =  <span
class="tooltiprtext">Use “method = ” to tell geom_smooth() that you are
going to declare a specific smoothing function, or method, to alter the
line or curve..</span> </span><span class="tooltipr"> “lm”, <span
class="tooltiprtext">lm stands for linear model. Using method = “lm”
tells geom_smooth() to fit a least-squares regression line onto the
graphic. The regression line is modeled using y ~ x, which variables
were declared in the initial ggplot() aesthetic. There are several other
methods that could be used here.</span> </span><span class="tooltipr">
 formula = y~x, <span class="tooltiprtext">This tells geom_smooth to
place a simple linear regression line on the plot. Other formula
statements can be used in the same way as lm(…) to place more
complicated models on the plot.</span> </span><span class="tooltipr">
 se = FALSE <span class="tooltiprtext">se stands for “standard error”.
Specifying FALSE turns this feature off. When TRUE, a gray band showing
the “confidence band” for the regression is shown. Unless you know how
to interpret this confidence band, leave it turned off.</span>
</span><span class="tooltipr"> ) <span class="tooltiprtext">Closing
parenthesis for the geom_smooth() function.</span> </span><span
class="tooltipr" style="float:right;font-size:.8em;">  Click to Show
Output  <span class="tooltiprtext">Click to View Output.</span>
</span></p>
</div>
<p></a></p>
<div id="ggplot" style="display:none;">
<pre><code>ggplot(cars, aes(x = speed, y = dist)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, formula=y~x, se=FALSE)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
</div>
<p>There are a number of ways to customize the appearance of the
regression line:</p>
<a href="javascript:showhide('ggplotline')">
<div class="hoverchunk">
<p><span class="tooltipr"> ggplot( <span class="tooltiprtext">Every
ggplot2 graphic begins with the ggplot() command, which creates a
framework, or coordinate system, that you can add layers to. Without
adding any layers, ggplot() produces a blank graphic.</span>
</span><span class="tooltipr"> cars,  <span class="tooltiprtext">This is
simply the name of your data set, like KidsFeet or starwars.</span>
</span><span class="tooltipr"> aes( <span class="tooltiprtext">aes
stands for aesthetic. Inside of aes(), you place elements that you want
to map to the coordinate system, like x and y variables.</span>
</span><span class="tooltipr"> x =  <span class="tooltiprtext">“x = ”
declares which variable will become the x-axis of the graphic, your
explanatory variable. Both “x= ” and “y= ” are optional phrasesin the
ggplot2 syntax.</span> </span><span class="tooltipr"> speed,  <span
class="tooltiprtext">This is the explanatory variable of the regression:
the variable used to <em>explain</em> the mean of y. It is the name of
the “numeric” column of YourDataSet.</span> </span><span
class="tooltipr"> y =  <span class="tooltiprtext">“y= ” declares which
variable will become the y-axis of the grpahic.</span> </span><span
class="tooltipr"> dist <span class="tooltiprtext">This is the response
variable of the regression: the variable that you are interested in
predicting. It is the name of a “numeric” column of YourDataSet.</span>
</span><span class="tooltipr"> ) <span class="tooltiprtext">Closing
parenthesis for aes(…) function.</span> </span><span class="tooltipr"> )
<span class="tooltiprtext">Closing parenthesis for ggplot(…)
function.</span> </span><span class="tooltipr">  + <span
class="tooltiprtext">The + allows you to add more layers to the
framework provided by ggplot(). In this case, you use + to add a
geom_point() layer on the next line.</span> </span><br/><span
class="tooltipr">   geom_point() <span class="tooltiprtext">geom_point()
allows you to add a layer of points, a scatterplot, over the ggplot()
framework. The x and y coordinates are received from the previously
specified x and y variables declared in the ggplot() aesthetic.</span>
</span><span class="tooltipr">  + <span class="tooltiprtext">Here the +
is used to add yet another layer to ggplot().</span> </span><br/><span
class="tooltipr">   geom_smooth( <span
class="tooltiprtext">geom_smooth() is a smoothing function that you can
use to add different lines or curves to ggplot(). In this case, you will
use it to add the least-squares regression line to the
scatterplot.</span> </span><span class="tooltipr"> method =  <span
class="tooltiprtext">Use “method = ” to tell geom_smooth() that you are
going to declare a specific smoothing function, or method, to alter the
line or curve..</span> </span><span class="tooltipr"> “lm”, <span
class="tooltiprtext">lm stands for linear model. Using method = “lm”
tells geom_smooth() to fit a least-squares regression line onto the
graphic. The regression line is modeled using y ~ x, which variables
were declared in the initial ggplot() aesthetic.</span> </span><span
class="tooltipr">  formula = y~x, <span class="tooltiprtext">This tells
geom_smooth to place a simple linear regression line on the plot. Other
formula statements can be used in the same way as lm(…) to place more
complicated models on the plot.</span> </span><span class="tooltipr">
 se = FALSE, <span class="tooltiprtext">se stands for “standard error”.
Specifying FALSE turns this feature off. When TRUE, a gray band showing
the “confidence band” for the regression is shown. Unless you know how
to interpret this confidence band, leave it turned off.</span>
</span><span class="tooltipr">  size = 2, <span class="tooltiprtext">Use
<em>size = 2</em> to adjust the thickness of the line to size 2.</span>
</span><span class="tooltipr">  color = “orange”, <span
class="tooltiprtext">Use <em>color = “orange”</em> to change the color
of the line to orange.</span> </span><br><span class="tooltipr">
  linetype = “dashed” <span class="tooltiprtext">Use <em>linetype =
“dashed”</em> to change the solid line to a dashed line. Some linetype
options include “dashed”, “dotted”, “longdash”, “dotdash”, etc.</span>
</span><span class="tooltipr"> ) <span class="tooltiprtext">Closing
parenthesis for the geom_smooth() function.</span> </span><span
class="tooltipr" style="float:right;font-size:.8em;">  Click to Show
Output  <span class="tooltiprtext">Click to View Output.</span>
</span></p>
</div>
<p></a></p>
<div id="ggplotline" style="display:none;">
<p><img src="index_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
</div>
<p>In addition to customizing the regression line, you can customize the
points, add points, add lines, and much more.</p>
<a href="javascript:showhide('ggplotpoints')">
<div class="hoverchunk">
<p><span class="tooltipr"> ggplot( <span class="tooltiprtext">Every
ggplot2 graphic begins with the ggplot() command, which creates a
framework, or coordinate system, that you can add layers to. Without
adding any layers, ggplot() produces a blank graphic.</span>
</span><span class="tooltipr"> cars,  <span class="tooltiprtext">This is
simply the name of your data set, like KidsFeet or starwars.</span>
</span><span class="tooltipr"> aes( <span class="tooltiprtext">aes
stands for aesthetic. Inside of aes(), you place elements that you want
to map to the coordinate system, like x and y variables.</span>
</span><span class="tooltipr"> x =  <span class="tooltiprtext">“x = ”
declares which variable will become the x-axis of the graphic, your
explanatory variable. Both “x= ” and “y= ” are optional phrasesin the
ggplot2 syntax.</span> </span><span class="tooltipr"> speed,  <span
class="tooltiprtext">This is the explanatory variable of the regression:
the variable used to <em>explain</em> the mean of y. It is the name of
the “numeric” column of YourDataSet.</span> </span><span
class="tooltipr"> y =  <span class="tooltiprtext">“y= ” declares which
variable will become the y-axis of the grpahic.</span> </span><span
class="tooltipr"> dist <span class="tooltiprtext">This is the response
variable of the regression: the variable that you are interested in
predicting. It is the name of a “numeric” column of YourDataSet.</span>
</span><span class="tooltipr"> ) <span class="tooltiprtext">Closing
parenthesis for aes(…) function.</span> </span><span class="tooltipr"> )
<span class="tooltiprtext">Closing parenthesis for ggplot(…)
function.</span> </span><span class="tooltipr">  + <span
class="tooltiprtext">The + allows you to add more layers to the
framework provided by ggplot(). In this case, you use + to add a
geom_point() layer on the next line.</span> </span><br/><span
class="tooltipr">   geom_point( <span class="tooltiprtext">geom_point()
allows you to add a layer of points, a scatterplot, over the ggplot()
framework. The x and y coordinates are received from the previously
specified x and y variables declared in the ggplot() aesthetic.</span>
</span><span class="tooltipr"> size = 1.5, <span
class="tooltiprtext">Use <em>size = 1.5</em> to change the size of the
points.</span> </span><span class="tooltipr">  color = “skyblue” <span
class="tooltiprtext">Use <em>color = “skyblue”</em> to change the color
of the points to Brother Saunders’ favorite color.</span> </span><span
class="tooltipr">  alpha = 0.5 <span class="tooltiprtext">Use <em>alpha
= 0.5</em> to change the transparency of the points to 0.5.</span>
</span><span class="tooltipr"> ) <span class="tooltiprtext">Closing
parenthesis of geom_point() function. </span> </span><span
class="tooltipr">  + <span class="tooltiprtext">The + allows you to add
more layers to the framework provided by ggplot().</span>
</span><br><span class="tooltipr">   geom_smooth( <span
class="tooltiprtext">geom_smooth() is a smoothing function that you can
use to add different lines or curves to ggplot(). In this case, you will
use it to add the least-squares regression line to the
scatterplot.</span> </span><span class="tooltipr"> method =  <span
class="tooltiprtext">Use “method = ” to tell geom_smooth() that you are
going to declare a specific smoothing function, or method, to alter the
line or curve..</span> </span><span class="tooltipr"> “lm”, <span
class="tooltiprtext">lm stands for linear model. Using method = “lm”
tells geom_smooth() to fit a least-squares regression line onto the
graphic.</span> </span><span class="tooltipr">  formula = y~x, <span
class="tooltiprtext">This tells geom_smooth to place a simple linear
regression line on the plot. Other formula statements can be used in
ways similar to lm(…) to place more complicated models on the
plot.</span> </span><span class="tooltipr">  se = FALSE, <span
class="tooltiprtext">se stands for “standard error”. Specifying FALSE
turns this feature off. When TRUE, a gray band showing the “confidence
band” for the regression is shown. Unless you know how to interpret this
confidence band, leave it turned off.</span> </span><span
class="tooltipr">  color = “navy”, <span class="tooltiprtext">Use
<em>color = “navy”</em> to change the color of the line to navy
blue.</span> </span><span class="tooltipr">  size = 1.5 <span
class="tooltiprtext">Use <em>size = 1.5</em> to adjust the thickness of
the line to 1.5.</span> </span><span class="tooltipr"> ) <span
class="tooltiprtext">Closing parenthesis of geom_smooth()
function.</span> </span><span class="tooltipr">  + <span
class="tooltiprtext">The + allows you to add more layers to the
framework provided by ggplot().</span> </span><br><span
class="tooltipr">   geom_hline( <span class="tooltiprtext">Use
geom_hline() to add a horizontal line at a specified y-intercept. You
can also use geom_vline(xintercept = some_number) to add a vertical line
to the graph.</span> </span><span class="tooltipr"> yintercept = <span
class="tooltiprtext">Use “yintercept =” to tell geom_hline() that you
are going to declare a y intercept for the horizontal line.</span>
</span><span class="tooltipr">  75 <span class="tooltiprtext">75 is the
value of the y-intercept.</span> </span><span class="tooltipr"> , color
= “firebrick” <span class="tooltiprtext">Use <em>color =
“firebrick”</em> to change the color of the horizontal line to firebrick
red.</span> </span><span class="tooltipr"> , size = 1, <span
class="tooltiprtext">Use <em>size = 1</em> to adjust the thickness of
the horizontal line to size 1.</span> </span><br><span class="tooltipr">
             linetype = “longdash” <span class="tooltiprtext">Use
<em>linetype = “longdash”</em> to change the solid line to a dashed line
with longer dashes. Some linetype options include “dashed”, “dotted”,
“longdash”, “dotdash”, etc.</span> </span><span class="tooltipr"> ,
alpha = 0.5 <span class="tooltiprtext">Use <em>alpha = 0.5</em> to
change the transparency of the horizontal line to 0.5.</span>
</span><span class="tooltipr"> ) <span class="tooltiprtext">Closing
parenthesis of geom_hline function.</span> </span><span
class="tooltipr">  + <span class="tooltiprtext">The + allows you to add
more layers to the framework provided by ggplot().</span>
</span><br><span class="tooltipr">   geom_segment( <span
class="tooltiprtext">geom_segment() allows you to add a line segment to
ggplot() by using specified start and end points.</span> </span><span
class="tooltipr"> x = <span class="tooltiprtext">“x =” tells
geom_segment() that you are going to declare the x-coordinate for the
starting point of the line segment.</span> </span><span
class="tooltipr">  14, <span class="tooltiprtext">14 is a number on the
x-axis of your graph. It is the x-coordinate of the starting point of
the line segment.</span> </span><span class="tooltipr">  y =<br />
<span class="tooltiprtext">“y =” tells geom_segment() that you are going
to declare the y-coordinate for the starting point of the line
segment.</span> </span><span class="tooltipr">  75, <span
class="tooltiprtext">75 is a number on the y-axis of your graph. It is
the y-coordinate of the starting point of the line segment.</span>
</span><span class="tooltipr">  xend = <span class="tooltiprtext">“xend
=” tells geom_segment() that you are going to declare the x-coordinate
for the end point of the line segment.</span> </span><span
class="tooltipr">  14, <span class="tooltiprtext">14 is a number on the
x-axis of your graph. It is the x-coordinate of the end point of the
line segment.</span> </span><span class="tooltipr">  yend = <span
class="tooltiprtext">“yend =” tells geom_segment() that you are going to
declare the y-coordinate for the end point of the line segment.</span>
</span><span class="tooltipr">  38, <span class="tooltiprtext">38 is a
number on the y-axis of your graph. It is the y-coordinate of the end
point of the line segment.</span> </span><br><span class="tooltipr">
               size = 1 <span class="tooltiprtext">Use <em>size = 1</em>
to adjust the thickness of the line segment.</span> </span><span
class="tooltipr"> , color = “lightgray” <span class="tooltiprtext">Use
<em>color = “lightgray”</em> to change the color of the line segment to
light gray.</span> </span><span class="tooltipr"> , linetype =
“longdash” <span class="tooltiprtext">Use *linetype = “longdash* to
change the solid line segment to a dashed one. Some linetype options
include”dashed”, “dotted”, “longdash”, “dotdash”, etc.</span>
</span><span class="tooltipr"> ) <span class="tooltiprtext">Closing
parenthesis for geom_segment() function.</span> </span><span
class="tooltipr">  + <span class="tooltiprtext">The + allows you to add
more layers to the framework provided by ggplot().</span>
</span><br><span class="tooltipr">   geom_point( <span
class="tooltiprtext">geom_point() can also be used to add individual
points to the graph. Simply declare the x and y coordinates of the point
you want to plot.</span> </span><span class="tooltipr"> x = <span
class="tooltiprtext">“x =” tells geom_point() that you are going to
declare the x-coordinate for the point.</span> </span><span
class="tooltipr">  14, <span class="tooltiprtext">14 is a number on the
x-axis of your graph. It is the x-coordinate of the point.</span>
</span><span class="tooltipr">  y = <span class="tooltiprtext">“y =”
tells geom_point() that you are going to declare the y-coordinate for
the point.</span> </span><span class="tooltipr">  75 <span
class="tooltiprtext">75 is a number on the y-axis of your graph. It is
the y-coordinate of the point.</span> </span><span class="tooltipr"> ,
size = 3 <span class="tooltiprtext">Use <em>size = 3</em> to make the
point stand out more.</span> </span><span class="tooltipr"> , color =
“firebrick” <span class="tooltiprtext">Use <em>color = “firebrick”</em>
to change the color of the point to firebrick red.</span> </span><span
class="tooltipr"> ) <span class="tooltiprtext">Closing parenthesis of
the geom_point() function.</span> </span><span class="tooltipr">  +
<span class="tooltiprtext">The + allows you to add more layers to the
framework provided by ggplot().</span> </span><br><span
class="tooltipr">   geom_text( <span class="tooltiprtext">geom_text()
allows you to add customized text anywhere on the graph. It is very
similar to the base R equivalent, text(…).</span> </span><span
class="tooltipr"> x = <span class="tooltiprtext">“x =” tells geom_text()
that you are going to declare the x-coordinate for the text.</span>
</span><span class="tooltipr">  14, <span class="tooltiprtext">14 is a
number on the x-axis of your graph. It is the x-coordinate of the
text.</span> </span><span class="tooltipr">  y = <span
class="tooltiprtext">“y =” tells geom_text() that you are going to
declare the y-coordinate for the text.</span> </span><span
class="tooltipr">  84, <span class="tooltiprtext">84 is a number on the
y-axis of your graph. It is the y-coordinate of the text.</span>
</span><span class="tooltipr">  label = <span
class="tooltiprtext">“label =” tells geom_text() that you are going to
give it the label.</span> </span><span class="tooltipr">  “My Point (14,
75)”, <span class="tooltiprtext"><em>“My Point (14, 75)”</em> is the
text that will appear on the graph.</span> </span><br><span
class="tooltipr">             color = “navy” <span
class="tooltiprtext">Use <em>color = “navy”</em> to change the color of
the text to navy blue.</span> </span><span class="tooltipr"> , size = 3
<span class="tooltiprtext">Use <em>size = 3</em> to change the size of
the text.</span> </span><span class="tooltipr"> ) <span
class="tooltiprtext">Closing parenthesis of the geom_text()
function.</span> </span><span class="tooltipr">  + <span
class="tooltiprtext">The + allows you to add more layers to the
framework provided by ggplot().</span> </span><br><span
class="tooltipr">   theme_minimal() <span class="tooltiprtext">Add a
minimalistic theme to the graph. There are many other themes that you
can try out.</span> </span><span class="tooltipr"
style="float:right;font-size:.8em;">  Click to Show Output  <span
class="tooltiprtext">Click to View Output.</span> </span></p>
</div>
<p></a></p>
<div id="ggplotpoints" style="display:none;">
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
</p>
</div>
<p><br/></p>
<p><strong>Accessing Parts of the Regression</strong></p>
<p>Finally, note that the <code>mylm</code> object contains the
<code>names(mylm)</code> of</p>
<a href="javascript:showhide('coeff')">
<div class="hoverchunk">
<p><span class="tooltipr"> mylm$coefficients <span
class="tooltiprtext">Contains two values. The first is the estimated
<span class="math inline">\(y\)</span>-intercept. The second is the
estimated slope.</span> </span></p>
</div>
<p></a></p>
<div id="coeff" style="display:none;">
<pre><code>## (Intercept)       speed 
##  -17.579095    3.932409</code></pre>
</div>
<a href="javascript:showhide('resid')">
<div class="hoverchunk">
<p><span class="tooltipr"> mylm$residuals <span
class="tooltiprtext">Contains the residuals from the regression in the
same order as the actual dataset.</span> </span></p>
</div>
<p></a></p>
<div id="resid" style="display:none;">
<pre><code>##          1          2          3          4 
##   3.849460  11.849460  -5.947766  12.052234 
##          5          6          7          8 
##   2.119825  -7.812584  -3.744993   4.255007 
##          9         10         11         12 
##  12.255007  -8.677401   2.322599 -15.609810 
##         13         14         15         16 
##  -9.609810  -5.609810  -1.609810  -7.542219 
##         17         18         19         20 
##   0.457781   0.457781  12.457781 -11.474628 
##         21         22         23         24 
##  -1.474628  22.525372  42.525372 -21.407036 
##         25         26         27         28 
## -15.407036  12.592964 -13.339445  -5.339445 
##         29         30         31         32 
## -17.271854  -9.271854   0.728146 -11.204263 
##         33         34         35         36 
##   2.795737  22.795737  30.795737 -21.136672 
##         37         38         39         40 
## -11.136672  10.863328 -29.069080 -13.069080 
##         41         42         43         44 
##  -9.069080  -5.069080   2.930920  -2.933898 
##         45         46         47         48 
## -18.866307  -6.798715  15.201285  16.201285 
##         49         50 
##  43.201285   4.268876</code></pre>
</div>
<a href="javascript:showhide('fit')">
<div class="hoverchunk">
<p><span class="tooltipr"> mylm$fitted.values <span
class="tooltiprtext">The values of <span
class="math inline">\(\hat{Y}\)</span> in the same order as the original
dataset.</span> </span></p>
</div>
<p></a></p>
<div id="fit" style="display:none;">
<pre><code>##         1         2         3         4         5 
## -1.849460 -1.849460  9.947766  9.947766 13.880175 
##         6         7         8         9        10 
## 17.812584 21.744993 21.744993 21.744993 25.677401 
##        11        12        13        14        15 
## 25.677401 29.609810 29.609810 29.609810 29.609810 
##        16        17        18        19        20 
## 33.542219 33.542219 33.542219 33.542219 37.474628 
##        21        22        23        24        25 
## 37.474628 37.474628 37.474628 41.407036 41.407036 
##        26        27        28        29        30 
## 41.407036 45.339445 45.339445 49.271854 49.271854 
##        31        32        33        34        35 
## 49.271854 53.204263 53.204263 53.204263 53.204263 
##        36        37        38        39        40 
## 57.136672 57.136672 57.136672 61.069080 61.069080 
##        41        42        43        44        45 
## 61.069080 61.069080 61.069080 68.933898 72.866307 
##        46        47        48        49        50 
## 76.798715 76.798715 76.798715 76.798715 80.731124</code></pre>
</div>
<div class="hoverchunk">
<p><span class="tooltipr"> mylm$… <span class="tooltiprtext">several
other things that will not be explained here.</span> </span></p>
</div>
<p><br/></p>
<p><strong>Making Predictions</strong></p>
<a href="javascript:showhide('prediction')">
<div class="hoverchunk">
<p><span class="tooltipr"> predict( <span class="tooltiprtext">The R
function predict(…) allows you to use an lm(…) object to make
predictions for specified x-values.</span> </span><span
class="tooltipr"> mylm, <span class="tooltiprtext">This is the name of a
previously performed lm(…) that was saved into the name
<code>mylm &lt;- lm(...)</code>.</span> </span><span class="tooltipr">
 data.frame( <span class="tooltiprtext">To specify the values of <span
class="math inline">\(x\)</span> that you want to use in the prediction,
you have to put those x-values into a data set, or more specifally, a
data.frame(…).</span> </span><span class="tooltipr"> X= <span
class="tooltiprtext">The value for <code>X=</code> should be whatever
x-variable name was used in the original regression. For example, if
<code>mylm &lt;- lm(dist ~ speed, data=cars)</code> was the original
regression, then this code would read <code>speed =</code> instead of
<code>X=</code>… Further, the value of <span
class="math inline">\(Xh\)</span> should be some specific number, like
<code>speed=12</code> for example.</span> </span><span class="tooltipr">
Xh <span class="tooltiprtext">The value of <span
class="math inline">\(Xh\)</span> should be some specific number, like
<code>12</code>, as in <code>speed=12</code> for example.</span>
</span><span class="tooltipr"> ) <span class="tooltiprtext">Closing
parenthesis for the data.frame(…) function.</span> </span><span
class="tooltipr"> ) <span class="tooltiprtext">Closing parenthesis for
the predict(…) function.</span> </span></p>
</div>
<p></a></p>
<div id="prediction" style="display:none;">
<p><code>mylm &lt;- lm(dist ~ speed, data = cars)</code></p>
<p><code>predict(mylm, data.frame(speed = 12))</code></p>
<table class="rconsole">
<tr>
<td align="right">
<span class="tooltiprout"> 1<br/>   29.60981 <span
class="tooltiprouttext">The value given is the “fitted-value” or
“predicted-value” for the specified x-value. In this case, a car with a
speed of 12 is predicted to have a stopping distance of 29.60981
feet.</span> </span>
</td>
</tr>
</table>
</div>
<a href="javascript:showhide('predictionInterval')">
<div class="hoverchunk">
<p><span class="tooltipr"> predict( <span class="tooltiprtext">The R
function predict(…) allows you to use an lm(…) object to make
predictions for specified x-values.</span> </span><span
class="tooltipr"> mylm, <span class="tooltiprtext">This is the name of a
previously performed lm(…) that was saved into the name
<code>mylm &lt;- lm(...)</code>.</span> </span><span class="tooltipr">
 data.frame( <span class="tooltiprtext">To specify the values of <span
class="math inline">\(x\)</span> that you want to use in the prediction,
you have to put those x-values into a data set, or more specifally, a
data.frame(…).</span> </span><span class="tooltipr"> X= <span
class="tooltiprtext">The value for <code>X=</code> should be whatever
x-variable name was used in the original regression. For example, if
<code>mylm &lt;- lm(dist ~ speed, data=cars)</code> was the original
regression, then this code would read <code>speed =</code> instead of
<code>X=</code>… Further, the value of <span
class="math inline">\(Xh\)</span> should be some specific number, like
<code>speed=12</code> for example.</span> </span><span class="tooltipr">
Xh <span class="tooltiprtext">The value of <span
class="math inline">\(Xh\)</span> should be some specific number, like
<code>12</code>, as in <code>speed=12</code> for example.</span>
</span><span class="tooltipr"> ), <span class="tooltiprtext">Closing
parenthesis for the data.frame(…) function.</span> </span><span
class="tooltipr">  interval= <span class="tooltiprtext">This optional
command allows you to specify if the predicted value should be
accompanied by either a confidence interval or a prediction
interval.</span> </span><span class="tooltipr"> “prediction” <span
class="tooltiprtext">This specifies that a prediction interval will be
included with the predicted value. A prediction interval gives you a 95%
confidence interval that captures 95% of the data, or <span
class="math inline">\(Y_i\)</span> values for the specific <span
class="math inline">\(X\)</span>-value specified in the
prediction.</span> </span><span class="tooltipr"> ) <span
class="tooltiprtext">Closing parenthesis of the predict(…)
function.</span> </span></p>
</div>
<p></a></p>
<div id="predictionInterval" style="display:none;">
<p><code>mylm &lt;- lm(dist ~ speed, data = cars)</code></p>
<p><code>predict(mylm, data.frame(speed = 12), interval = "prediction")</code></p>
<table class="rconsole">
<tr>
<td align="right">
<span class="tooltiprout">   fit <span class="tooltiprouttext">The “fit”
is the predicted value.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   lwr <span class="tooltiprouttext">The “lwr”
is the lower bound.</span>
</td>
<td align="right">
<span class="tooltiprout">   upr <span class="tooltiprouttext">The “upr”
is the upper bound.</span> </span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> 1 29.60981 <span class="tooltiprouttext">In
this case, a car with a speed of 12 mph is predicted to have a stopping
distance of 29.60981 feet. However, we are wise enough to recognize that
the stopping distance for individual cars will vary anywhere from
-1.749529 (or 0 because distance can’t go negative) feet to 60.96915
feet.</span> </span>
</td>
<td align="left">
<span class="tooltiprout"> -1.749529 <span class="tooltiprouttext">This
is the lower bound of the prediction interval. While we predict a
stopping distance of 29.60981 feet, this prediction interval reminds us
the stopping distance could be as quick as -1.749529 feet (or 0 because
distance can’t go negative).</span> </span>
</td>
<td align="left">
<span class="tooltiprout"> 60.96915 <span class="tooltiprouttext">This
is the upper bound of the prediction interval. While we predict a
stopping distance of 29.60981 feet, this prediction interval reminds us
that the actual stopping distance could be as high as 60.96915
feet.</span> </span>
</td>
</tr>
</table>
</div>
<a href="javascript:showhide('predictionConfidence')">
<div class="hoverchunk">
<p><span class="tooltipr"> predict( <span class="tooltiprtext">The R
function predict(…) allows you to use an lm(…) object to make
predictions for specified x-values.</span> </span><span
class="tooltipr"> mylm, <span class="tooltiprtext">This is the name of a
previously performed lm(…) that was saved into the name
<code>mylm &lt;- lm(...)</code>.</span> </span><span class="tooltipr">
 data.frame( <span class="tooltiprtext">To specify the values of <span
class="math inline">\(x\)</span> that you want to use in the prediction,
you have to put those x-values into a data set, or more specifally, a
data.frame(…).</span> </span><span class="tooltipr"> X= <span
class="tooltiprtext">The value for <code>X=</code> should be whatever
x-variable name was used in the original regression. For example, if
<code>mylm &lt;- lm(dist ~ speed, data=cars)</code> was the original
regression, then this code would read <code>speed =</code> instead of
<code>X=</code>… Further, the value of <span
class="math inline">\(Xh\)</span> should be some specific number, like
<code>speed=12</code> for example.</span> </span><span class="tooltipr">
Xh <span class="tooltiprtext">The value of <span
class="math inline">\(Xh\)</span> should be some specific number, like
<code>12</code>, as in <code>speed=12</code> for example.</span>
</span><span class="tooltipr"> ), <span class="tooltiprtext">Closing
parenthesis for the data.frame(…) function.</span> </span><span
class="tooltipr">  interval= <span class="tooltiprtext">This optional
command allows you to specify if the predicted value should be
accompanied by either a confidence interval or a prediction
interval.</span> </span><span class="tooltipr"> “confidence” <span
class="tooltiprtext">This specifies that a confidence interval for the
prediction should be provided. This is of use whenever your interest is
in just estimating the average y-value, not the actual y-values.</span>
</span><span class="tooltipr"> ) <span class="tooltiprtext">Closing
parenthesis of the predict(…) function.</span> </span></p>
</div>
<p></a></p>
<div id="predictionConfidence" style="display:none;">
<p><code>mylm &lt;- lm(dist ~ speed, data = cars)</code></p>
<p><code>predict(mylm, data.frame(speed = 12), interval = "confidence")</code></p>
<table class="rconsole">
<tr>
<td align="right">
<span class="tooltiprout">   fit <span class="tooltiprouttext">The “fit”
is the predicted value.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   lwr <span class="tooltiprouttext">The “lwr”
is the lower bound.</span>
</td>
<td align="right">
<span class="tooltiprout">   upr <span class="tooltiprouttext">The “upr”
is the upper bound.</span> </span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> 1 29.60981 <span class="tooltiprouttext">In
this case, cars with a speed of 12 mph are predicted to have an average
stopping distance of 29.60981 feet, where the average could be anywhere
from 24.39514 feet to 34.82448 feet.</span> </span>
</td>
<td align="left">
<span class="tooltiprout"> 24.39514 <span class="tooltiprouttext">This
is the lower bound of the confidence interval. We are 95% confident that
the average stopping distance of cars going 12 mph is greater than this
value.</span> </span>
</td>
<td align="left">
<span class="tooltiprout"> 34.82448 <span class="tooltiprouttext">This
is the upper bound of the confidence interval. We are 95% confident that
the average stopping distance of cars going 12 mph is less than this
value.</span> </span>
</td>
</tr>
</table>
</div>
<p><br/></p>
<p><strong>Finding Confidence Intervals for Model
Parameters</strong></p>
<a href="javascript:showhide('confint')">
<div class="hoverchunk">
<p><span class="tooltipr"> confint( <span class="tooltiprtext">The R
function confint(…) allows you to use an lm(…) object to compute
confidence intervals for one or more parameters (like <span
class="math inline">\(\beta_0\)</span> or <span
class="math inline">\(\beta_1\)</span>) in your model.</span>
</span><span class="tooltipr"> mylm, <span class="tooltiprtext">This is
the name of a previously performed lm(…) that was saved into the name
<code>mylm &lt;- lm(...)</code>.</span> </span><span class="tooltipr">
 level = <span class="tooltiprtext">“level =” tells the confint(…)
function that you are going to declare at what level of confidence you
want the interval. The default is “level = 0.95.” If you want to find
95% confidence intervals for your parameters, then just run
<code>confint(mylm)</code>.</span> </span><span class="tooltipr">
 someConfidenceLevel <span class="tooltiprtext">someConfidenceLevel is
simply a confidence level you choose when you want something other than
a 95% confidence interval. Some examples of appropriate levels include
0.90 and 0.99.</span> </span><span class="tooltipr"> ) <span
class="tooltiprtext">Closing parenthesis for confint(..)
function.</span> </span></p>
</div>
<p></a></p>
<div id="confint" style="display:none;">
<p><code>mylm &lt;- lm(dist ~ speed, data = cars)</code></p>
<p><code>confint(mylm, level = 0.90)</code></p>
<table class="rconsole">
<tr>
<td align="left">
 
</td>
<td align="right">
<span class="tooltiprout">   5 % <span class="tooltiprouttext">The lower
bound of a 90% confidence interval occurs at the 5th percentile. This is
because at 90% confidence, 10% is left in the tails, with 5% on each
end. The upper bound will thus end at the 95th percentile, hence the 5%
and 95% as the column names.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   95 % <span class="tooltiprouttext">The
upper bound of a 90% confidence interval ends at the 95th
percentile.</span> </span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> (Intercept) <span
class="tooltiprouttext">This row of output specifies a confidence
interval for <span class="math inline">\(\beta_0\)</span>, the true
y-intercept.</span> </span>
</td>
<td align="left">
<span class="tooltiprout"> -28.914514 <span class="tooltiprouttext">This
is the lower bound for the confidence interval of the y-intercept, <span
class="math inline">\(\beta_0\)</span>. In this example, the confidence
interval for the y-intercept does not make sense because you cannot have
negative distance.</span> </span>
</td>
<td align="left">
<span class="tooltiprout"> -6.243676 <span class="tooltiprouttext">This
is the upper bound for the confidence interval for <span
class="math inline">\(\beta_0\)</span>, the y-intercpet. In this
example, the confidence interval for the y-intercept does not make sense
because you cannot have negative distance.</span> </span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> speed <span class="tooltiprouttext">This row
of the output provides the upper and lower bound for the confidence
interval for <span class="math inline">\(\beta_1\)</span>, the true
slope. In this case, you can be 90% confident that the true slope lies
between 3.235501 and 4.629317.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 3.235501 <span class="tooltiprouttext">This
is the lower bound of the confidence interval. In this case, you can be
90% confident that the slope lies between 3.235501 and 4.629317.</span>
</span>
</td>
<td align="right">
<span class="tooltiprout"> 4.629317 <span class="tooltiprouttext">This
is the upper bound of the confidence interval. In this case, you can be
90% confident that the slope lies between 3.235501 and 4.629317.</span>
</span>
</td>
</td>
</tr>
</table>
<p><br/> <br/></p>
<p><code>mylm &lt;- lm(dist ~ speed, data = cars)</code></p>
<p><code>confint(mylm, level = 0.95)</code></p>
<table class="rconsole">
<tr>
<td align="left">
 
</td>
<td align="right">
<span class="tooltiprout">   2.5 % <span class="tooltiprouttext">The
lower bound of a 95% confidence interval occurs at the 2.5th percentile.
This is because at 95% confidence, 5% is left in the tails, with 2.5% on
each end. The upper bound will thus end at the 97.5th percentile, hence
the 2.5% and 97.5% as the column names for the lower and upper bounds,
respectively.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   97.5 % <span class="tooltiprouttext">The
upper bound of a 95% confidence interval ends at the 97.5th
percentile.</span> </span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> (Intercept) <span
class="tooltiprouttext">This row of output specifies a confidence
interval for <span class="math inline">\(\beta_0\)</span>, the true
y-intercept.</span> </span>
</td>
<td align="left">
<span class="tooltiprout"> -31.167850 <span class="tooltiprouttext">This
is the lower bound for the confidence interval of the y-intercept, <span
class="math inline">\(\beta_0\)</span>. In this example, the confidence
interval for the y-intercept does not make sense because you cannot have
negative distance.</span> </span>
</td>
<td align="left">
<span class="tooltiprout"> -3.990340 <span class="tooltiprouttext">This
is the upper bound for the confidence interval for <span
class="math inline">\(\beta_0\)</span>, the y-intercpet. In this
example, the confidence interval for the y-intercept does not make sense
because you cannot have negative distance.</span> </span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> speed <span class="tooltiprouttext">This row
of the output provides the upper and lower bound for the confidence
interval for <span class="math inline">\(\beta_1\)</span>, the true
slope. In this case, you can be 90% confident that the true slope lies
between 3.096964 and 4.767853.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 3.096964 <span class="tooltiprouttext">This
is the lower bound of the confidence interval. In this case, you can be
90% confident that the slope lies between 3.096964 and 4.767853</span>
</span>
</td>
<td align="right">
<span class="tooltiprout"> 4.767853 <span class="tooltiprouttext">This
is the upper bound of the confidence interval. In this case, you can be
95% confident that the slope lies between 3.096964 and 4.767853</span>
</span>
</td>
</td>
</tr>
</table>
</div>
<hr />
</div>
</div>
<div id="explanation-8" class="section level6">
<h6>Explanation</h6>
<div style="padding-left:125px;">
<p>Linear regression has a rich mathematical theory behind it. This is
because it uses a mathematical function and a random error term to
describe the regression relation between a response variable <span
class="math inline">\(Y\)</span> and an explanatory variable called
<span class="math inline">\(X\)</span>.</p>
<div style="padding-left:30px;color:darkgray;">
<p>Expand each element below to learn more.</p>
</div>
<p><span
style="color:steelblue;font-size:.8em;padding-left:160px;">Regression
Cheat Sheet</span>
<a href="javascript:showhide('regressioncheatsheet')" style="font-size:.6em;color:skyblue;">(Expand)</a></p>
<div id="regressioncheatsheet" style="display:none;font-size:.7em;">
<table>
<colgroup>
<col width="13%" />
<col width="34%" />
<col width="15%" />
<col width="17%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th>Term</th>
<th>Pronunciation</th>
<th>Meaning</th>
<th>Math</th>
<th>R Code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="tooltipr"><span class="math inline">\(Y_i\)</span><span
class="tooltiprtext"> <code>$Y_i$</code></span>
</span><span class="tooltipr"></td>
<td>“why-eye”</td>
<td>The data</td>
<td><span class="tooltipr"> <span class="math inline">\(Y_i = \beta_0 +
\beta_1 X_i + \epsilon_i \quad \text{where} \ \epsilon_i \sim N(0,
\sigma^2)\)</span><span class="tooltiprtext">
<code>$Y_i = \beta_0 + \beta_1 X_i +</code>
<code>\epsilon_i \quad \text{where} \</code>
<code>\epsilon_i \sim N(0, \sigma^2)$</code></span>
</span><span class="tooltipr"></td>
<td><code>YourDataSet$YourYvariable</code></td>
</tr>
<tr class="even">
<td><span class="tooltipr"><span
class="math inline">\(\hat{Y}_i\)</span><span class="tooltiprtext">
<code>$\hat{Y}_i$</code></span> </span><span class="tooltipr"></td>
<td>“why-hat-eye”</td>
<td>The fitted line</td>
<td><span class="tooltipr"> <span class="math inline">\(\hat{Y}_i = b_0
+ b_1 X_i\)</span><span class="tooltiprtext">
<code>$\hat{Y}_i = b_0 + b_1 X_i$</code></span></td>
<td><code>lmObject$fitted.values</code></td>
</tr>
<tr class="odd">
<td><span class="tooltipr"><span
class="math inline">\(E\{Y_i\}\)</span><span class="tooltiprtext">
<code>$E\{Y_i\}$</code></span> </span><span class="tooltipr"></td>
<td>“expected value of why-eye”</td>
<td>True mean y-value</td>
<td><span class="tooltipr"><span class="math inline">\(E\{Y_i\} =
\beta_0 + \beta_1 X_i\)</span><span class="tooltiprtext">
<code>$E\{Y_i\} = \beta_0 + \beta_1 X_i$</code></span></td>
<td><code>&lt;none&gt;</code></td>
</tr>
<tr class="even">
<td><span class="tooltipr"><span
class="math inline">\(\beta_0\)</span><span class="tooltiprtext">
<code>$\beta_0$</code></span> </span><span class="tooltipr"></td>
<td>“beta-zero”</td>
<td>True y-intercept</td>
<td><code>&lt;none&gt;</code></td>
<td><code>&lt;none&gt;</code></td>
</tr>
<tr class="odd">
<td><span class="tooltipr"><span
class="math inline">\(\beta_1\)</span><span class="tooltiprtext">
<code>$\beta_1$</code></span> </span><span class="tooltipr"></td>
<td>“beta-one”</td>
<td>True slope</td>
<td><code>&lt;none&gt;</code></td>
<td><code>&lt;none&gt;</code></td>
</tr>
<tr class="even">
<td><span class="tooltipr"><span class="math inline">\(b_0\)</span><span
class="tooltiprtext"> <code>$b_0$</code></span>
</span><span class="tooltipr"></td>
<td>“b-zero”</td>
<td>Estimated y-intercept</td>
<td><span class="tooltipr"><span class="math inline">\(b_0 = \bar{Y} -
b_1\bar{X}\)</span><span class="tooltiprtext">
<code>$b_0 = \bar{Y} - b_1\bar{X}</code></span></td>
<td><code>b_0 &lt;- mean(Y) - b_1*mean(X)$</code></td>
</tr>
<tr class="odd">
<td><span class="tooltipr"><span class="math inline">\(b_1\)</span><span
class="tooltiprtext"> <code>$b_1$</code></span>
</span><span class="tooltipr"></td>
<td>“b-one”</td>
<td>Estimated slope</td>
<td><span class="tooltipr"><span class="math inline">\(b_1 = \frac{\sum
X_i(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2}\)</span><span
class="tooltiprtext"> <code>$b_1 = \frac{\sum X_i(Y_i - \bar{Y})}</code>
<code>{\sum(X_i - \bar{X})^2}$</code></span></td>
<td><code>b_1 &lt;- sum( X*(Y - mean(Y)) ) / sum( (X - mean(X))^2 )</code></td>
</tr>
<tr class="even">
<td><span class="tooltipr"><span
class="math inline">\(\epsilon_i\)</span><span class="tooltiprtext">
<code>$\epsilon_i$</code></span> </span><span class="tooltipr"></td>
<td>“epsilon-eye”</td>
<td>Distance of dot to true line</td>
<td><span class="tooltipr"><span class="math inline">\(\epsilon_i = Y_i
- E\{Y_i\}\)</span><span class="tooltiprtext">
<code>$\epsilon_i = Y_i - E\{Y_i\}$</code></span></td>
<td><code>&lt;none&gt;</code></td>
</tr>
<tr class="odd">
<td><span class="tooltipr"><span class="math inline">\(r_i\)</span><span
class="tooltiprtext"> <code>$r_i$</code></span>
</span><span class="tooltipr"></td>
<td>“r-eye” or “residual-eye”</td>
<td>Distance of dot to estimated line</td>
<td><span class="tooltipr"><span class="math inline">\(r_i = Y_i -
\hat{Y}_i\)</span><span class="tooltiprtext">
<code>$r_i = Y_i - \hat{Y}_i$</code></span></td>
<td><code>lmObject$residuals</code></td>
</tr>
<tr class="even">
<td><span class="tooltipr"><span
class="math inline">\(\sigma^2\)</span><span class="tooltiprtext">
<code>$\sigma^2$</code></span> </span><span class="tooltipr"></td>
<td>“sigma-squared”</td>
<td>Variance of the <span class="math inline">\(\epsilon_i\)</span></td>
<td><span class="tooltipr"><span class="math inline">\(Var\{\epsilon_i\}
= \sigma^2\)</span><span
class="tooltiprtext"><code>$Var\{\epsilon_i\} = \sigma^2$</code></span></td>
<td><code>&lt;none&gt;</code></td>
</tr>
<tr class="odd">
<td><span class="tooltipr"><span class="math inline">\(MSE\)</span><span
class="tooltiprtext"> <code>$MSE$</code></span>
</span><span class="tooltipr"></td>
<td>“mean squared error”</td>
<td>Estimate of <span class="math inline">\(\sigma^2\)</span></td>
<td><span class="tooltipr"><span class="math inline">\(MSE =
\frac{SSE}{n-p}\)</span><span
class="tooltiprtext"><code>$MSE = \frac{SSE}{n-p}$</code></span></td>
<td><code>sum( lmObject$res^2 ) / (n - p)</code></td>
</tr>
<tr class="even">
<td><span class="tooltipr"><span class="math inline">\(SSE\)</span><span
class="tooltiprtext"> <code>$SSE$</code></span>
</span><span class="tooltipr"></td>
<td>“sum of squared error” (residuals)</td>
<td>Measure of dot’s total deviation from the line</td>
<td><span class="tooltipr"><span class="math inline">\(SSE =
\sum_{i=1}^n (Y_i - \hat{Y}_i)^2\)</span><span
class="tooltiprtext"><code>$SSE = \sum_{i=1}^n</code>
<code>(Y_i - \hat{Y}_i)^2$</code></span></td>
<td><code>sum( lmObject$res^2 )</code></td>
</tr>
<tr class="odd">
<td><span class="tooltipr"><span class="math inline">\(SSR\)</span><span
class="tooltiprtext"> <code>$SSR$</code></span>
</span><span class="tooltipr"></td>
<td>“sum of squared regression error”</td>
<td>Measure of line’s deviation from y-bar</td>
<td><span class="tooltipr"> <span class="math inline">\(SSR =
\sum_{i=1}^n (\hat{Y}_i - \bar{Y})^2\)</span><span
class="tooltiprtext"><code>$SSR = \sum_{i=1}^n</code>
<code>(\hat{Y}_i - \bar{Y})^2$</code></span></td>
<td><code>sum( (lmObject$fit - mean(YourData$Y))^2 )</code></td>
</tr>
<tr class="even">
<td><span class="tooltipr"><span
class="math inline">\(SSTO\)</span><span class="tooltiprtext">
<code>$SSTO$</code></span> </span><span class="tooltipr"></td>
<td>“total sum of squares”</td>
<td>Measure of total variation in Y</td>
<td><span class="tooltipr"><span class="math inline">\(SSR + SSE = SSTO
= \sum_{i=1}^n (Y_i - \bar{Y})^2\)</span><span
class="tooltiprtext"><code>$SSR + SSE = SSTO = \sum_{i=1}^n</code>
<code>(Y_i - \bar{Y})^2$</code></span></td>
<td><code>sum( (YourData$Y - mean(YourData$Y))^2 )</code></td>
</tr>
<tr class="odd">
<td><span class="tooltipr"><span class="math inline">\(R^2\)</span><span
class="tooltiprtext"> <code>$R^2$</code></span>
</span><span class="tooltipr"></td>
<td>“R-squared”</td>
<td>Proportion of variation in Y explained by the regression</td>
<td><span class="tooltipr"><span class="math inline">\(R^2 =
\frac{SSR}{SSTO} = 1 - \frac{SSE}{SSTO}\)</span><span
class="tooltiprtext"><code>$R^2 = \frac{SSR}{SSTO} = 1</code>
<code>- \frac{SSE}{SSTO}$</code></span></td>
<td><code>SSR/SSTO</code></td>
</tr>
<tr class="even">
<td><span class="tooltipr"><span class="math inline">\(r\)</span><span
class="tooltiprtext"> <code>$r$</code></span>
</span><span class="tooltipr"></td>
<td>“r”</td>
<td>Correlation between X and Y.</td>
<td><span class="tooltipr"><span class="math inline">\(r =
\sqrt{R^2}\)</span><span
class="tooltiprtext"><code>$r = \sqrt{R^2}$</code></span></td>
<td><code>sqrt(R^2)</code></td>
</tr>
<tr class="odd">
<td><span class="tooltipr"><span
class="math inline">\(\hat{Y}_h\)</span><span class="tooltiprtext">
<code>$\hat{Y}_h$</code></span></span></td>
<td>“why-hat-aitch”</td>
<td>Estimated mean y-value for some x-value called <span
class="math inline">\(X_h\)</span></td>
<td><span class="tooltipr"><span class="math inline">\(\hat{Y}_h = b_0 +
b_1 X_h\)</span><span
class="tooltiprtext"><code>$\hat{Y}_h = b_0 + b_1 X_h$</code></span></span></td>
<td><code>predict(lmObject, data.frame(XvarName=#))</code></td>
</tr>
<tr class="even">
<td><span class="tooltipr"><span class="math inline">\(X_h\)</span><span
class="tooltiprtext"> <code>$X_h$</code></span> </span></td>
<td>“ex-aitch”</td>
<td>Some x-value, not necessarily one of the <span
class="math inline">\(X_i\)</span> values used in the regression</td>
<td><span class="tooltipr"><span class="math inline">\(X_h =\)</span>
some number<span
class="tooltiprtext"><code>$X_h = $</code></span></span></td>
<td><code>Xh = #</code></td>
</tr>
<tr class="odd">
<td>Confidence Interval</td>
<td>“confidence interval”</td>
<td>Estimated bounds at a certain level of confidence for a
parameter</td>
<td><span class="tooltipr"><span class="math inline">\(b_0 \pm t^* \cdot
s_{b_0}\)</span><span
class="tooltiprtext"><code>b_0 \pm t^* \cdot s_{b_0}</code></span></span>
or <span class="tooltipr"><span class="math inline">\(b_1 \pm t^* \cdot
s_{b_1}\)</span><span
class="tooltiprtext"><code>b_1 \pm t^* \cdot s_{b_1}</code></span></span></td>
<td><code>confint(mylm, level = someConfidenceLevel)</code></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\beta_0\)</span></td>
<td><span class="math inline">\(b_0\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_1\)</span></td>
<td><span class="math inline">\(b_1\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\epsilon_i\)</span></td>
<td><span class="math inline">\(r_i\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\sigma^2\)</span></td>
<td><span class="math inline">\(MSE\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\sigma\)</span></td>
<td><span class="math inline">\(\sqrt{MSE}\)</span>, the Residual
standard error</td>
</tr>
</tbody>
</table>
</div>
<p><br /></p>
<p><strong><em>The Mathematical Model
<a href="javascript:showhide('mathmodel1')" style="font-size:.6em;color:skyblue;">(Expand)</a></em></strong></p>
<p><span class="expand-caption"><span
class="math inline">\(Y_i\)</span>, <span
class="math inline">\(\hat{Y}_i\)</span>, and <span
class="math inline">\(E\{Y_i\}\)</span>…</span></p>
<div id="mathmodel1" style="display:none;">
<p>There are three main elements to the mathematical model of
regression. Each of these three elements is pictured below in the
“Regression Relation Diagram.”</p>
<div style="padding-left:60px;color:darkgray;font-size:.8em;">
<p>Study both the three bullet points and their visual representations
in the plot below for a clearer understanding.</p>
</div>
<ol style="list-style-type: decimal">
<li>The <strong>true line</strong>, i.e., the regression relation:</li>
</ol>
<div style="padding-left:60px;color:darkgray;">
<div style="color:steelblue;">
<p><span class="math inline">\(\underbrace{E\{Y\}}_{\substack{\text{true
mean} \\ \text{y-value}}} =
\underbrace{\overbrace{\beta_0}^\text{y-intercept} +
\overbrace{\beta_1}^\text{slope} X}_\text{equation of a
line}\)</span></p>
</div>
<p><a href="javascript:showhide('readmoretrueline')" style="font-size:.8em;color:skyblue;">(Read
more…)</a></p>
<div id="readmoretrueline" style="display:none;">
<p>The true line is shown by the dotted line in the graph pictured
below. This is typically unobservable. Think of it as “natural law” or
“God’s law”. It is some true line that is unknown to us.</p>
<p>The regression relation <span class="math inline">\(E\{Y\} = \beta_0
+ \beta_1 X\)</span> creates the line of regression where <span
class="math inline">\(\beta_0\)</span> is the <span
class="math inline">\(y\)</span>-intercept of the line and <span
class="math inline">\(\beta_1\)</span> is the slope of the line. The
regression relationship provides the average <span
class="math inline">\(Y\)</span>-value, denoted <span
class="math inline">\(E\{Y_i\}\)</span>, for a given <span
class="math inline">\(X\)</span>-value, denoted by <span
class="math inline">\(X_i\)</span>.</p>
<p>Note: <span class="math inline">\(E\{Y\}\)</span> is pronounced “the
expected value of y” because, well… the mean is the typical, average, or
“expected” value.</p>
</div>
</div>
<ol start="2" style="list-style-type: decimal">
<li>The <strong>dots</strong>, i.e., the regression relation plus an
error term:</li>
</ol>
<div style="padding-left:60px;color:darkgray;">
<div style="color:steelblue;">
<p><span class="math inline">\(Y_i = \underbrace{\beta_0 + \beta_1
X_i}_{E\{Y_i\}} + \underbrace{\epsilon_i}_\text{error term} \quad
\text{where} \ \epsilon_i\sim N(0,\sigma^2)\)</span></p>
</div>
<p><a href="javascript:showhide('readmoredots')" style="font-size:.8em;color:skyblue;">(Read
more…)</a></p>
<div id="readmoredots" style="display:none;">
<p>This is shown by the dots in the graph below. This is the data. In
regression, the assumption is that the y-value for individual <span
class="math inline">\(i\)</span>, denoted by <span
class="math inline">\(Y_i\)</span>, was “created” by adding an error
term <span class="math inline">\(\epsilon_i\)</span> to each
individual’s “expected” value <span class="math inline">\(\beta_0 +
\beta_1 X_i\)</span>. Note the “order of creation” would require first
knowing an indivual’s x-value, <span class="math inline">\(X_i\)</span>,
then their expected value from the regression relation <span
class="math inline">\(E\{Y_i\} = \beta_0 + \beta_1 X_i\)</span> and then
adding their <span class="math inline">\(\epsilon_i\)</span> value to
the result. The <span class="math inline">\(\epsilon_i\)</span> allows
each individual to deviate from the line. Some individuals deviate
dramatically, some deviate only a little, but all dots vary some
distance <span class="math inline">\(\epsilon_i\)</span> from the
line.</p>
<p>Note: <span class="math inline">\(Y_i\)</span> is pronounced
“why-eye” because it is the y-value for individual <span
class="math inline">\(i\)</span>. Sometimes also called “why-sub-eye”
because <span class="math inline">\(i\)</span> is in the subscript of
<span class="math inline">\(Y\)</span>.</p>
</div>
</div>
<ol start="3" style="list-style-type: decimal">
<li>The <strong>estimated line</strong>, i.e., the line we get from a
sample of data.</li>
</ol>
<div style="padding-left:60px;color:darkgray;">
<div style="color:steelblue;">
<p><span
class="math inline">\(\underbrace{\hat{Y}_i}_{\substack{\text{estimated
mean} \\ \text{y-value}}} = \underbrace{b_0 + b_1 X_i}_\text{estimated
regression equation}\)</span></p>
</div>
<p><a href="javascript:showhide('readmoreestimatedline')" style="font-size:.8em;color:skyblue;">(Read
more…)</a></p>
<div id="readmoreestimatedline" style="display:none;">
<p>The estimated line is shown by the solid line in the graph below.
<span class="math inline">\(\hat{Y}\)</span> is the estimated regression
equation obtained from the sample of data. It is the estimator of the
true regression equation <span class="math inline">\(E\{Y\}\)</span>. So
<span class="math inline">\(\hat{Y}\)</span> is interpreted as the
estimated average (or mean) <span class="math inline">\(Y\)</span>-value
for any given <span class="math inline">\(X\)</span>-value. Thus, <span
class="math inline">\(b_0\)</span> is the estimated y-intercept and
<span class="math inline">\(b_1\)</span> is the estimated slope. The b’s
are sample statistics, like <span class="math inline">\(\bar{x}\)</span>
and the <span class="math inline">\(\beta\)</span>’s are population
parameters like <span class="math inline">\(\mu\)</span>. The <span
class="math inline">\(b\)</span>’s estimate the <span
class="math inline">\(\beta\)</span>’s.</p>
<p>Note: <span class="math inline">\(\hat{Y}_i\)</span> is pronounced
“why-hat-eye” and is known as the “estimated y-value” or “fitted
y-value” because it is the y-value you get from <span
class="math inline">\(b_0 + b_1 X_i\)</span>. It is always different
from <span class="math inline">\(Y_i\)</span> because dots are rarely if
ever exactly on the estimated regression line.</p>
</div>
</div>
<p>This graphic depicts the true, but typically unknown, regression
relation (dotted line). It also shows how a sample of data from the true
regression relation (the dots) can be used to obtain an estimated
regression equation (solid line) that is fairly close to the truth
(dotted line).</p>
<p><img src="index_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<p>Something to ponder: The true line, when coupled with the error
terms, “creates” the data. The estimated (or fitted) line uses the
sampled data to try to “re-create” the true line.</p>
<p>We could loosely call this the “order of creation” as shown by the
following diagram.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">mai=</span><span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">2</span>,.<span class="dv">4</span>,.<span class="dv">1</span>))</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">col=</span><span class="st">&quot;white&quot;</span>,  <span class="at">main=</span><span class="st">&quot;A Law is Given&quot;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a><span class="fu">curve</span>(beta0 <span class="sc">+</span> beta1<span class="sc">*</span>x, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">main=</span><span class="st">&quot;Data is Created&quot;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a><span class="fu">curve</span>(beta0 <span class="sc">+</span> beta1<span class="sc">*</span>x, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">main=</span><span class="st">&quot;The Law is Estimated&quot;</span>)</span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a><span class="fu">curve</span>(xylm<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> xylm<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>x, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a><span class="fu">curve</span>(beta0 <span class="sc">+</span> beta1<span class="sc">*</span>x, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
<table>
<colgroup>
<col width="29%" />
<col width="31%" />
<col width="38%" />
</colgroup>
<thead>
<tr class="header">
<th>A Law is Given</th>
<th>Data is Created</th>
<th>The Law is Estimated</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(E\{Y_i\} = \beta_0 + \beta_1
X_i\)</span></td>
<td><span class="math inline">\(Y_i = E\{Y_i\} +
\epsilon_i\)</span></td>
<td><span class="math inline">\(\hat{Y}_i = b_0 + b_1 X_i\)</span></td>
</tr>
<tr class="even">
<td>The true line is the “law”.</td>
<td>The <span class="math inline">\(Y_i\)</span> are created by adding
<span class="math inline">\(\epsilon_i\)</span> to <span
class="math inline">\(E\{Y_i\}\)</span> where <span
class="math inline">\(E\{Y_i\} = \beta_0 + \beta_1 X_i\)</span>.</td>
<td>The law is estimated with <span
class="math inline">\(\hat{Y}_i\)</span> which is given with
<code>lm(...)</code>.</td>
</tr>
</tbody>
</table>
<p>Click open the “Code” buttom below to the right to find code that
runs a simulation demonstrating this “order of creation”.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="do">## Simulating Data from a Regression Model</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a><span class="do">## This R-chunk is meant to be played in your R Console.</span></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a><span class="do">## It allows you to explore how the various elements</span></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a><span class="do">## of the regression model combine together to &quot;create&quot;</span></span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a><span class="do">## data and then use the data to &quot;re-create&quot; the line.</span></span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>) <span class="co">#Allows us to always get the same &quot;random&quot; sample</span></span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>              <span class="co">#Change to a new number to get a new sample</span></span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co">#set the sample size</span></span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a>  X_i <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">15</span>, <span class="dv">45</span>) <span class="co">#Gives n random values from a uniform distribution between 15 to 45.</span></span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a>  beta0 <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co">#Our choice for the y-intercept. </span></span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a>  beta1 <span class="ot">&lt;-</span> .<span class="dv">1</span> <span class="co">#Our choice for the slope. </span></span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fl">12.5</span> <span class="co">#Our choice for the std. deviation of the error terms.</span></span>
<span id="cb44-19"><a href="#cb44-19" tabindex="-1"></a></span>
<span id="cb44-20"><a href="#cb44-20" tabindex="-1"></a>  epsilon_i <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma) <span class="co">#Gives n random values from a normal distribution with mean = 0, st. dev. = sigma.</span></span>
<span id="cb44-21"><a href="#cb44-21" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" tabindex="-1"></a>  Y_i <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> beta1<span class="sc">*</span>X_i <span class="sc">+</span> epsilon_i <span class="co">#Create Y using the normal error regression model</span></span>
<span id="cb44-23"><a href="#cb44-23" tabindex="-1"></a></span>
<span id="cb44-24"><a href="#cb44-24" tabindex="-1"></a>  fabData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y=</span>Y_i, <span class="at">x=</span>X_i) <span class="co">#Store the data as data</span></span>
<span id="cb44-25"><a href="#cb44-25" tabindex="-1"></a></span>
<span id="cb44-26"><a href="#cb44-26" tabindex="-1"></a>  <span class="fu">View</span>(fabData) </span>
<span id="cb44-27"><a href="#cb44-27" tabindex="-1"></a>  </span>
<span id="cb44-28"><a href="#cb44-28" tabindex="-1"></a>  <span class="co">#In the real world, we begin with data (like fabData) and try to recover the model that (we assume) was used to created it.</span></span>
<span id="cb44-29"><a href="#cb44-29" tabindex="-1"></a></span>
<span id="cb44-30"><a href="#cb44-30" tabindex="-1"></a>  fab.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data=</span>fabData) <span class="co">#Fit an estimated regression model to the fabData.</span></span>
<span id="cb44-31"><a href="#cb44-31" tabindex="-1"></a></span>
<span id="cb44-32"><a href="#cb44-32" tabindex="-1"></a>  <span class="fu">summary</span>(fab.lm) <span class="co">#Summarize your model. </span></span>
<span id="cb44-33"><a href="#cb44-33" tabindex="-1"></a></span>
<span id="cb44-34"><a href="#cb44-34" tabindex="-1"></a>  <span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">data=</span>fabData) <span class="co">#Plot the data.</span></span>
<span id="cb44-35"><a href="#cb44-35" tabindex="-1"></a></span>
<span id="cb44-36"><a href="#cb44-36" tabindex="-1"></a>  <span class="fu">abline</span>(fab.lm) <span class="co">#Add the estimated regression line to your plot.</span></span>
<span id="cb44-37"><a href="#cb44-37" tabindex="-1"></a></span>
<span id="cb44-38"><a href="#cb44-38" tabindex="-1"></a><span class="co"># Now for something you can&#39;t do in real life... but since we created the data...</span></span>
<span id="cb44-39"><a href="#cb44-39" tabindex="-1"></a></span>
<span id="cb44-40"><a href="#cb44-40" tabindex="-1"></a>  <span class="fu">abline</span>(beta0, beta1, <span class="at">lty=</span><span class="dv">2</span>) <span class="co">#Add the true regression line to your plot using a dashed line (lty=2). </span></span>
<span id="cb44-41"><a href="#cb44-41" tabindex="-1"></a></span>
<span id="cb44-42"><a href="#cb44-42" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;True Line&quot;</span>, <span class="st">&quot;Estimated Line&quot;</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>) <span class="co">#Add a legend to your plot specifying which line is which.</span></span></code></pre></div>
</div>
<p><br /></p>
<hr />
<p><strong><em>Interpreting the Model Parameters
<a href="javascript:showhide('interpretingparameters')" style="font-size:.6em;color:skyblue;">(Expand)</a></em></strong></p>
<p><span class="expand-caption"><span
class="math inline">\(\beta_0\)</span> (intercept) and <span
class="math inline">\(\beta_1\)</span> (slope), estimated by <span
class="math inline">\(b_0\)</span> and <span
class="math inline">\(b_1\)</span>, interpreted as…</span></p>
<div id="interpretingparameters" style="display:none;">
<p>The interpretation of <span class="math inline">\(\beta_0\)</span> is
only meaningful if <span class="math inline">\(X=0\)</span> is in the
scope of the model. If <span class="math inline">\(X=0\)</span> is in
the scope of the model, then the intercept is interpreted as the average
y-value, denoted <span class="math inline">\(E\{Y\}\)</span>, when <span
class="math inline">\(X=0\)</span>.</p>
<p>The interpretation of <span class="math inline">\(\beta_1\)</span> is
the amount of increase (or decrease) in the average y-value, denoted
<span class="math inline">\(E\{Y\}\)</span>, per unit change in <span
class="math inline">\(X\)</span>. It is often misunderstood to be the
“average change in y” or just “the change in y” but it is more correctly
referred to as the “change in the average y”.</p>
<p>To better see this, consider the three graphics shown below.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a><span class="fu">hist</span>(mtcars<span class="sc">$</span>mpg, <span class="at">main=</span><span class="st">&quot;Gas Mileage of mtcars Vehicles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Number of Vehicles&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Gas Mileage (mpg)&quot;</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a><span class="fu">boxplot</span>(mpg <span class="sc">~</span> cyl, <span class="at">data=</span>mtcars, <span class="at">border=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">boxwex=</span><span class="fl">0.5</span>, <span class="at">main=</span><span class="st">&quot;Gas Mileage of mtcars Vehicles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Gas Mileage (mpg)&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Number of Cylinders of Engine (cyl)&quot;</span>)</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a><span class="fu">plot</span>(mpg <span class="sc">~</span> qsec, <span class="at">data=</span><span class="fu">subset</span>(mtcars, am<span class="sc">==</span><span class="dv">0</span>), <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">main=</span><span class="st">&quot;Gas Mileage of mtcars Vehicles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Gas Mileage (mpg)&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Quarter Mile Time (qsec)&quot;</span>)</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(mpg <span class="sc">~</span> qsec, <span class="at">data=</span><span class="fu">subset</span>(mtcars, am<span class="sc">==</span><span class="dv">0</span>)), <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>)</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">text=</span><span class="st">&quot;Automatic Transmissions Only (am==0)&quot;</span>, <span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">seq</span>(<span class="dv">16</span>,<span class="dv">22</span>,<span class="dv">2</span>), <span class="at">h=</span><span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">30</span>,<span class="dv">5</span>), <span class="at">lty=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;gray&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<table>
<colgroup>
<col width="31%" />
<col width="31%" />
<col width="36%" />
</colgroup>
<thead>
<tr class="header">
<th>The Histogram</th>
<th>The Boxplot</th>
<th>The Scatterplot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>The <strong>histogram</strong> on the left shows gas mileages of
vehicles from the mtcars data set. The average gas mileage is
20.09.</td>
<td>The <strong>boxplot</strong> in the middle shows that if we look at
gas mileage for 4, 6, and 8 cylinder vehicles separately, we find the
means to be 26.66, 19.74, and 15.1, respectively. If we wanted to, we
could talk about the change in the means across cylinders, and would see
that the mean is decreasing, first by <span class="math inline">\(26.66
- 19.74 = 6.92\)</span> mpg, then by <span class="math inline">\(19.74 -
15.1 = 4.64\)</span> mpg.</td>
<td>The <strong>scatterplot</strong> on the right shows that the average
gas mileage (for just automatic transmission vehicles) increases by a
slope of 1.44 for each 1 second increase in quarter mile time. In other
words, the line gives the average y-value for any x-value. Thus, the
slope of the line is the change in the average y-value.</td>
</tr>
</tbody>
</table>
</div>
<p><br /></p>
<hr />
<p><strong><em>Residuals and Errors
<a href="javascript:showhide('residualsanderrors')" style="font-size:.6em;color:skyblue;">(Expand)</a></em></strong></p>
<p><span class="expand-caption"><span
class="math inline">\(r_i\)</span>, the residual, estimates <span
class="math inline">\(\epsilon_i\)</span>, the true error…</span></p>
<div id="residualsanderrors" style="display:none;">
<p>Residuals are the difference between the observed value of <span
class="math inline">\(Y_i\)</span> (the point) and the predicted, or
estimated value, for that point called <span
class="math inline">\(\hat{Y_i}\)</span>. The errors are the true
distances between the observed <span class="math inline">\(Y_i\)</span>
and the actual regression relation for that point, <span
class="math inline">\(E\{Y_i\}\)</span>.</p>
<p>We will denote a <strong>residual</strong> for individual <span
class="math inline">\(i\)</span> by <span
class="math inline">\(r_i\)</span>, <span class="math display">\[
  r_i = \underbrace{Y_i}_{\substack{\text{Observed} \\ \text{Y-value}}}
- \underbrace{\hat{Y}_i}_{\substack{\text{Predicted} \\ \text{Y-value}}}
\quad \text{(residual)}
\]</span> The residual <span class="math inline">\(r_i\)</span>
estimates the true <strong>error</strong> for individual <span
class="math inline">\(i\)</span>, <span
class="math inline">\(\epsilon_i\)</span>, <span class="math display">\[
  \epsilon_i = \underbrace{Y_i}_{\substack{\text{Observed} \\
\text{Y-value}}} - \underbrace{E\{Y_i\}}_{\substack{\text{True Mean} \\
\text{Y-value}}} \quad \text{(error)}
\]</span></p>
<p>In summary…</p>
<div style="padding-left:30px;">
<table>
<colgroup>
<col width="44%" />
<col width="55%" />
</colgroup>
<thead>
<tr class="header">
<th>Residual <span class="math inline">\(r_i\)</span></th>
<th>Error <span class="math inline">\(\epsilon_i\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Distance between the dot <span class="math inline">\(Y_i\)</span>
and the estimated line <span
class="math inline">\(\hat{Y}_i\)</span></td>
<td>Distance between the dot <span class="math inline">\(Y_i\)</span>
and the true line <span class="math inline">\(E\{Y_i\}\)</span>.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_i = Y_i - \hat{Y}_i\)</span></td>
<td><span class="math inline">\(\epsilon_i = Y_i -
E\{Y_i\}\)</span></td>
</tr>
<tr class="odd">
<td>Known</td>
<td>Typically Unknown</td>
</tr>
</tbody>
</table>
</div>
<p>As shown in the graph below, the residuals are known values and they
estimate the unknown (but true) error terms.</p>
<p><img src="index_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<p>Keep in mind the idea that the errors <span
class="math inline">\(\epsilon_i\)</span> “created” the data and that
the residuals <span class="math inline">\(r_i\)</span> are computed
after using the data to “re-create” the line.</p>
<p>Residuals have many uses in regression analysis. They allow us to</p>
<ol style="list-style-type: decimal">
<li>diagnose the regression assumptions,</li>
</ol>
<div style="padding-left:60px;color:darkgray;font-size:.8em;">
<p>See the “Assumptions” section below for more details.</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>estimate the regression relation,</li>
</ol>
<div style="padding-left:60px;color:darkgray;font-size:.8em;">
<p>See the “Estimating the Model Parameters” section below for more
details.</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>estimate the variance of the error terms,</li>
</ol>
<div style="padding-left:60px;color:darkgray;font-size:.8em;">
<p>See the “Estimating the Model Variance” section below for more
details.</p>
</div>
<ol start="4" style="list-style-type: decimal">
<li>and assess the fit of the regression relation.</li>
</ol>
<div style="padding-left:60px;color:darkgray;font-size:.8em;">
<p>See the “Assessing the Fit of a Regression” section below for more
details.</p>
</div>
</div>
<p><br /></p>
<hr />
<p><strong><em>Assessing the Fit of a Regression
<a href="javascript:showhide('assessingthefit')" style="font-size:.6em;color:skyblue;">(Expand)</a></em></strong></p>
<p><span class="expand-caption"><span
class="math inline">\(R^2\)</span>, SSTO, SSR, and SSE…</span></p>
<div id="assessingthefit" style="display:none;">
<p>Not all regressions are created equally as the three plots below
show. Sometimes the dots are a clustered very tightly to the line. At
other times, the dots spread out fairly dramatically from the line.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">mai=</span><span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">5</span>,.<span class="dv">1</span>))</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">30</span>,<span class="dv">0</span>,<span class="dv">20</span>)</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">3.5</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">30</span>,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">3.5</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">30</span>,<span class="dv">0</span>,<span class="dv">8</span>)</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">3.5</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">30</span>,<span class="dv">0</span>,<span class="dv">27</span>)</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a><span class="fu">plot</span>(y1 <span class="sc">~</span> x, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">21</span>), <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">100</span>), <span class="at">main=</span><span class="st">&quot;Excellent Fit&quot;</span>)</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y1 <span class="sc">~</span> x), <span class="at">col=</span><span class="st">&quot;gray&quot;</span>)</span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a><span class="fu">plot</span>(y2 <span class="sc">~</span> x, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">21</span>), <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">100</span>), <span class="at">main=</span><span class="st">&quot;Good Fit&quot;</span>)</span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y2 <span class="sc">~</span> x), <span class="at">col=</span><span class="st">&quot;gray&quot;</span>)</span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a><span class="fu">plot</span>(y3 <span class="sc">~</span> x, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">21</span>), <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">100</span>), <span class="at">main=</span><span class="st">&quot;Poor Fit&quot;</span>)</span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y3 <span class="sc">~</span> x), <span class="at">col=</span><span class="st">&quot;gray&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<p>A common way to measure the fit of a regression is with <a
href="NumericalSummaries.html#correlation">correlation</a>. While this
can be a useful measurement, there is greater insight in using the
square of the correlation, called <span
class="math inline">\(R^2\)</span>. (If you are a Math 325 student, just
stick with correlation for now and skip on to the next section of this
Explanation tab. If you are a Math 425 student, it is critical that you
come to understand <span class="math inline">\(R^2\)</span> deeply, so
read on.)</p>
<p>Before you can understand <span class="math inline">\(R^2\)</span>,
you must understand three important “sums of squares”.</p>
<div style="padding-left:30px;">
<p><a href="javascript:showhide('sumsofsquaresread')" style="font-size:.8em;color:skyblue;">(Read
more about sums…)</a></p>
<div id="sumsofsquaresread" style="display:none;">
<p>A sum is just a fancy word for adding things together. <span
class="math display">\[
  1 + 2 + 3 + 4 + 5 + 6 = 21
\]</span></p>
<p>Long sums get tedious to write out by hand. So we use the symbol
<span class="math inline">\(\Sigma\)</span> to denote the word “sum”.
Further, we use a subscript <span
class="math inline">\(\Sigma_{i=1}\)</span> to state what value the sum
is beginning with, and a superscript <span
class="math inline">\(\Sigma_{i=1}^6\)</span> to state the value we are
ending at. This gives <span class="math display">\[
  \sum_{i=1}^6 i = 1 + 2 + 3 + 4 + 5 + 6 = 21
\]</span></p>
<p>Test your knowledge, do you see why the answer is 6 to the sum below?
<span class="math display">\[
  \sum_{i=1}^3 i = 6
\]</span></p>
<p>Computing sums in R is fairly easy. Type the following codes in your
R Console.</p>
<p><code>sum(1:6) #gives the answer of 21</code></p>
<p><code>sum(1:3) #gives the answer of 6</code></p>
<p>However, sums really become useful when used with a data set.</p>
<p>Each row of a data set represents an “individual’s” data. We can
reference each individual with a row number. In the data below,
individual 3, denoted by <span class="math inline">\(i=3\)</span>, has a
<code>speed</code> of 7 and a <code>dist</code> of 4.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">head</span>(<span class="fu">cbind</span>(<span class="at">Individual =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, cars), <span class="dv">6</span>), <span class="at">emphasize.strong.rows=</span><span class="dv">3</span>)</span></code></pre></div>
<table style="width:40%;">
<colgroup>
<col width="18%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Individual</th>
<th align="center">speed</th>
<th align="center">dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">4</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">4</td>
<td align="center">10</td>
</tr>
<tr class="odd">
<td align="center"><strong>3</strong></td>
<td align="center"><strong>7</strong></td>
<td align="center"><strong>4</strong></td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">7</td>
<td align="center">22</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">8</td>
<td align="center">16</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">9</td>
<td align="center">10</td>
</tr>
</tbody>
</table>
<p>To compute the sum of the <strong>speed</strong> column, use
<code>sum(speed)</code>. If we divided this sum by 6, we would get the
mean of speed <code>mean(speed)</code>. In fact, the two most used
statistics <code>mean(...)</code> and <code>sd(...)</code> both use
sums. Take a moment to review the formulas for <a
href="NumericalSummaries.html#mean">mean</a> and <a
href="NumericalSummaries.html#standard-deviation">standard
deviation</a>. It is strongly recommended that you study the Explanation
tab for both as well. We’ll wait. See you back here shortly.</p>
<p>…</p>
<p>Welcome back.</p>
<p>Suppose we let <code>X = speed</code> and <code>Y = dist</code>. Then
<span class="math inline">\(X_3 = 7\)</span> and <span
class="math inline">\(Y_3 = 4\)</span> because we are accessing row 3 of
both the <span class="math inline">\(X\)</span> (or speed) column and
<span class="math inline">\(Y\)</span> (or dist) column. (Remember from
the above discussion that for individual #3, the speed was 7 and the
dist was 4.) Further, <code>sum(speed)</code> would be written
mathematically as <span class="math inline">\(\sum_{i=1}^6 X_i\)</span>
and <code>sum(dist)</code> would be written as <span
class="math inline">\(\sum_{i=1}^6 Y_i\)</span>.</p>
</div>
</div>
<table>
<colgroup>
<col width="32%" />
<col width="36%" />
<col width="30%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Sum of Squared Errors</strong></th>
<th><strong>Sum of Squares Regression</strong></th>
<th><strong>Total Sum of Squares</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\text{SSE} = \sum_{i=1}^n \left(Y_i -
\hat{Y}_i\right)^2\)</span></td>
<td><span class="math inline">\(\text{SSR} = \sum_{i=1}^n
\left(\hat{Y}_i - \bar{Y}\right)^2\)</span></td>
<td><span class="math inline">\(\text{SSTO} = \sum_{i=1}^n \left(Y_i -
\bar{Y}\right)^2\)</span></td>
</tr>
<tr class="even">
<td>Measures how much the residuals deviate from the line.</td>
<td>Measures how much the regression line deviates from the average
y-value.</td>
<td>Measures how much the y-values deviate from the average
y-value.</td>
</tr>
<tr class="odd">
<td>Equals SSTO - SSR</td>
<td>Equals SSTO - SSE</td>
<td>Equals SSE + SSR</td>
</tr>
<tr class="even">
<td><code>sum( (Y - mylm$fit)^2 )</code></td>
<td><code>sum( (mylm$fit - mean(Y))^2 )</code></td>
<td><code>sum( (Y - mean(Y))^2 )</code></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><img src="index_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<hr style="border-color:#d5d5d5; border-style:solid;"/>
<p><img src="index_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<p>It is important to remember that SSE and SSR split up SSTO, so that
<span class="math display">\[
  \text{SSTO} = \text{SSE} + \text{SSR}
\]</span> This implies that if SSE is large (close to SSTO) then SSR is
small (close to zero) and visa versa. The following three graphics
demonstrate how this works.</p>
<p><img src="index_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<p>The above graphs reveal that the idea of correlation is tightly
linked with sums of squares. In fact, the correlation squared is equal
to SSR/SSTO. And this fraction, SSR/SSTO is called <span
class="math inline">\(R^2\)</span> (“r-squared”).</p>
<p><strong>R-Squared (<span class="math inline">\(R^2\)</span>)</strong>
<span class="math display">\[
  \underbrace{R^2 = \frac{SSR}{SSTO} = 1 -
\frac{SSE}{SSTO}}_\text{Interpretation: Proportion of variation in Y
explained by the regression.}
\]</span></p>
<p>The smallest <span class="math inline">\(R^2\)</span> can be is zero,
and the largest it can be is 1. This is because <span
class="math inline">\(SSR\)</span> must be between 0 and SSTO,
inclusive.</p>
</div>
<p><br /></p>
<hr />
<p><strong><em>Residual Plots &amp; Regression Assumptions
<a href="javascript:showhide('assumptions1')" style="font-size:.6em;color:skyblue;">(Expand)</a></em></strong></p>
<p><span class="expand-caption">Residuals vs. fitted-values, Q-Q Plot of
the residuals, and residuals vs. order plots…</span></p>
<div id="assumptions1" style="display:none;">
<p>There are five assumptions that should be met for the mathematical
model of simple linear regression to be appropriate.</p>
<div style="padding-left:60px;color:darkgray;font-size:.8em;">
<p>Each assumption is labeled in the regression equation below.</p>
</div>
<ol style="list-style-type: decimal">
<li>The regression relation between <span
class="math inline">\(Y\)</span> and <span
class="math inline">\(X\)</span> is linear.</li>
<li>The error terms are normally distributed with <span
class="math inline">\(E\{\epsilon_i\}=0\)</span>.</li>
<li>The variance of the error terms is constant over all <span
class="math inline">\(X\)</span> values.</li>
<li>The <span class="math inline">\(X\)</span> values can be considered
fixed and measured without error.</li>
<li>The error terms are independent.</li>
</ol>
<p><span style="color:darkgray;">Regression Equation</span> <span
class="math display">\[
  Y_i = \underbrace{\beta_0 + \beta_1
\overbrace{X_i}^\text{#4}}_{\text{#1}} + \epsilon_i \quad \text{where} \
\overbrace{\epsilon_i \sim}^\text{#5} \overbrace{N(0}^\text{#2},
\overbrace{\sigma^2}^\text{#3})
\]</span></p>
<p>Residuals are used to diagnose departures from the regression
assumptions.</p>
<p><a href="javascript:showhide('moreassumptionsdetail')" style="font-size:.8em;color:skyblue;">(Read
more…)</a></p>
<div id="moreassumptionsdetail" style="display:none;">
<p>As shown above, the regression equation makes several claims, or
assumptions, about the error terms <span
class="math inline">\(\epsilon_i\)</span>, specifically 2, 3, and 5 of
the regression assumptions are hidden inside the statement <span
class="math inline">\(\epsilon_i \sim N(0, \sigma^2)\)</span> as shown
here <span class="math display">\[
  \epsilon_i \underbrace{\sim}_{\substack{\text{Independent} \\
\text{Errors}}} \overbrace{N}^{\substack{\text{Normally} \\
\text{distributed}}}(\underbrace{0}_{\substack{\text{mean of} \\
\text{zero}}}, \underbrace{\sigma^2}_{\substack{\text{Constant} \\
\text{Variance}}})
\]</span></p>
<p>While the actual error terms (<span
class="math inline">\(\epsilon_i\)</span>) are unknown in real life, the
residuals (<span class="math inline">\(r_i\)</span>) are known. Thus, we
can use the residuals to check if the assumptions of the regression
appear to be satisfied or not.</p>
</div>
<p><br /></p>
<div style="padding-left:15px;">
<hr />
<p><strong><em>Residuals versus Fitted-values Plot: Checks Assumptions
#1 and #3</em></strong></p>
<table width="90%">
<tr>
<td with="15%">
<p><img src="index_files/figure-html/unnamed-chunk-68-1.png" width="144" /></p>
</td>
<td width="75%">
<p>The linear relationship and constant variance assumptions can be
diagnosed using a residuals versus fitted-values plot. The fitted values
are the <span class="math inline">\(\hat{Y}_i\)</span>. The residuals
are the <span class="math inline">\(r_i\)</span>. This plot compares the
residual to the magnitude of the fitted-value. No discernable pattern in
this plot is desirable.</p>
<p>|
<a href="javascript:showhide('residualsvsfittedvalues')" style="font-size:.8em;color:steelblue2;">Show
Examples</a> |</p>
</td>
</tr>
</table>
<div id="residualsvsfittedvalues" style="display:none;">
<p><a href="javascript:showhide('residualsvsfittedvaluesread')" style="font-size:.8em;color:skyblue;">(Read
more…)</a></p>
<div id="residualsvsfittedvaluesread" style="display:none;">
<p>The residuals versus fitted values plot checks for departures from
the linear relation assumption and the constant variance assumption.</p>
<ul>
<li><p>The linear relation is assumed to be satisfied if there are no
apparent trends in the plot.</p></li>
<li><p>The constant variance assumption is assumed to be satisfied if
the vertical spread of the residuals remains roughly consistent across
all fitted values.</p></li>
</ul>
<p>The left column of plots below show scenarios that would be
considered not linear. The right column of plots show scenarios that
would be considered linear, but lacking constant variance. The middle
column of plots shows scenarios that would satisfy both assumptions,
linear and constant variance.</p>
</div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>,<span class="dv">15</span>,<span class="dv">3</span>)</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>notLin <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X, <span class="at">Y =</span> <span class="dv">500</span><span class="sc">-</span>X<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">30</span>,<span class="dv">1</span>,<span class="dv">8</span>))</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>notLin.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X, <span class="at">data=</span>notLin)</span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>Lin <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X, <span class="at">Y =</span> <span class="dv">5</span><span class="fl">+1.8</span><span class="sc">*</span>X<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">30</span>,<span class="dv">2</span>,<span class="fl">1.3</span>))</span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>Lin.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X, <span class="at">data=</span>Lin)</span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>),  <span class="at">mai=</span><span class="fu">c</span>(.<span class="dv">25</span>,.<span class="dv">25</span>,.<span class="dv">25</span>,.<span class="dv">25</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="dv">1</span>,.<span class="dv">75</span>,<span class="dv">0</span>))</span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a>  <span class="fu">plot</span>(notLin.lm<span class="sc">$</span>fitted.values,notLin.lm<span class="sc">$</span>residuals, <span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Fitted Values&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>, </span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a>       <span class="at">main=</span><span class="st">&quot;Not Linear&quot;</span>, <span class="at">cex.main=</span><span class="fl">0.95</span>,</span>
<span id="cb48-12"><a href="#cb48-12" tabindex="-1"></a>       <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span>
<span id="cb48-13"><a href="#cb48-13" tabindex="-1"></a>  mycurve <span class="ot">&lt;-</span> <span class="fu">lowess</span>(notLin.lm<span class="sc">$</span>fitted.values,notLin.lm<span class="sc">$</span>residuals)</span>
<span id="cb48-14"><a href="#cb48-14" tabindex="-1"></a>  mycurveOrder <span class="ot">&lt;-</span> <span class="fu">order</span>(mycurve<span class="sc">$</span>x)</span>
<span id="cb48-15"><a href="#cb48-15" tabindex="-1"></a>  mycurve<span class="sc">$</span>x <span class="ot">&lt;-</span> mycurve<span class="sc">$</span>x[mycurveOrder]</span>
<span id="cb48-16"><a href="#cb48-16" tabindex="-1"></a>  mycurve<span class="sc">$</span>y <span class="ot">&lt;-</span> mycurve<span class="sc">$</span>y[mycurveOrder]</span>
<span id="cb48-17"><a href="#cb48-17" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(mycurve<span class="sc">$</span>x,<span class="fu">rev</span>(mycurve<span class="sc">$</span>x)), <span class="fu">c</span>(mycurve<span class="sc">$</span>y<span class="sc">+</span><span class="dv">10</span>, <span class="fu">rev</span>(mycurve<span class="sc">$</span>y<span class="dv">-10</span>)), <span class="at">col=</span><span class="fu">rgb</span>(.<span class="dv">7</span>,.<span class="dv">7</span>,.<span class="dv">7</span>,.<span class="dv">2</span>), <span class="at">border=</span><span class="cn">NA</span>) </span>
<span id="cb48-18"><a href="#cb48-18" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb48-19"><a href="#cb48-19" tabindex="-1"></a>  <span class="fu">plot</span>(Lin.lm<span class="sc">$</span>fitted.values,Lin.lm<span class="sc">$</span>residuals, <span class="at">pch=</span><span class="dv">20</span>, </span>
<span id="cb48-20"><a href="#cb48-20" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Fitted Values&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>, </span>
<span id="cb48-21"><a href="#cb48-21" tabindex="-1"></a>       <span class="at">main=</span><span class="st">&quot;Good: Linear, Constant Variance&quot;</span>, </span>
<span id="cb48-22"><a href="#cb48-22" tabindex="-1"></a>       <span class="at">cex.main=</span><span class="fl">0.95</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb48-23"><a href="#cb48-23" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb48-24"><a href="#cb48-24" tabindex="-1"></a></span>
<span id="cb48-25"><a href="#cb48-25" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">6</span>)</span>
<span id="cb48-26"><a href="#cb48-26" tabindex="-1"></a>notCon <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X, <span class="at">Y =</span> <span class="dv">5</span><span class="fl">+1.8</span><span class="sc">*</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">30</span>,<span class="dv">2</span>,X<span class="sc">^</span><span class="fl">1.5</span>))</span>
<span id="cb48-27"><a href="#cb48-27" tabindex="-1"></a>notCon.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X, <span class="at">data=</span>notCon)</span>
<span id="cb48-28"><a href="#cb48-28" tabindex="-1"></a>LinO <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X, <span class="at">Y =</span> <span class="dv">5</span><span class="fl">+1.8</span><span class="sc">*</span>X<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">30</span>,<span class="dv">2</span>,<span class="fl">1.3</span>))</span>
<span id="cb48-29"><a href="#cb48-29" tabindex="-1"></a>LinO[<span class="dv">1</span>] <span class="ot">&lt;-</span> LinO[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb48-30"><a href="#cb48-30" tabindex="-1"></a>LinO.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X, <span class="at">data=</span>LinO)</span>
<span id="cb48-31"><a href="#cb48-31" tabindex="-1"></a>  <span class="fu">plot</span>(notCon.lm<span class="sc">$</span>fitted.values,notCon.lm<span class="sc">$</span>residuals, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="st">&quot;Fitted Values&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>, <span class="at">main=</span><span class="st">&quot;Unconstant Variance&quot;</span>, <span class="at">cex.main=</span><span class="fl">0.95</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span>
<span id="cb48-32"><a href="#cb48-32" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">min</span>(notCon.lm<span class="sc">$</span>fit),<span class="dv">2</span>), <span class="fu">rep</span>(<span class="fu">max</span>(notCon.lm<span class="sc">$</span>fit), <span class="dv">2</span>)), <span class="fu">c</span>(<span class="sc">-</span><span class="dv">30</span>,<span class="dv">30</span>,<span class="fl">1.2</span><span class="sc">*</span><span class="fu">max</span>(notCon.lm<span class="sc">$</span>res),<span class="fl">1.2</span><span class="sc">*</span><span class="fu">min</span>(notCon.lm<span class="sc">$</span>res)), <span class="at">col=</span><span class="fu">rgb</span>(.<span class="dv">7</span>,.<span class="dv">7</span>,.<span class="dv">7</span>,.<span class="dv">2</span>), <span class="at">border=</span><span class="cn">NA</span>) </span>
<span id="cb48-33"><a href="#cb48-33" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb48-34"><a href="#cb48-34" tabindex="-1"></a><span class="co">#  plot(LinO.lm$fitted.values,LinO.lm$residuals, pch=20, xlab=&quot;Fitted Values&quot;, ylab=&quot;Residuals&quot;, main=&quot;Outliers&quot;, cex.main=0.95)</span></span>
<span id="cb48-35"><a href="#cb48-35" tabindex="-1"></a><span class="co">#  abline(h=0)</span></span>
<span id="cb48-36"><a href="#cb48-36" tabindex="-1"></a></span>
<span id="cb48-37"><a href="#cb48-37" tabindex="-1"></a>  </span>
<span id="cb48-38"><a href="#cb48-38" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> age, <span class="at">data=</span>Loblolly)</span>
<span id="cb48-39"><a href="#cb48-39" tabindex="-1"></a>  <span class="fu">plot</span>(tmp<span class="sc">$</span>residuals <span class="sc">~</span> tmp<span class="sc">$</span>fitted.values, <span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb48-40"><a href="#cb48-40" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Fitted Values&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>, </span>
<span id="cb48-41"><a href="#cb48-41" tabindex="-1"></a>       <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex.main=</span><span class="fl">0.95</span>,</span>
<span id="cb48-42"><a href="#cb48-42" tabindex="-1"></a>       <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span>
<span id="cb48-43"><a href="#cb48-43" tabindex="-1"></a>  mycurve <span class="ot">&lt;-</span> <span class="fu">lowess</span>(tmp<span class="sc">$</span>fitted.values,tmp<span class="sc">$</span>residuals)</span>
<span id="cb48-44"><a href="#cb48-44" tabindex="-1"></a>  mycurveOrder <span class="ot">&lt;-</span> <span class="fu">order</span>(mycurve<span class="sc">$</span>x)</span>
<span id="cb48-45"><a href="#cb48-45" tabindex="-1"></a>  mycurve<span class="sc">$</span>x <span class="ot">&lt;-</span> mycurve<span class="sc">$</span>x[mycurveOrder]</span>
<span id="cb48-46"><a href="#cb48-46" tabindex="-1"></a>  mycurve<span class="sc">$</span>y <span class="ot">&lt;-</span> mycurve<span class="sc">$</span>y[mycurveOrder]</span>
<span id="cb48-47"><a href="#cb48-47" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(mycurve<span class="sc">$</span>x,<span class="fu">rev</span>(mycurve<span class="sc">$</span>x)), <span class="fu">c</span>(mycurve<span class="sc">$</span>y<span class="sc">+</span><span class="dv">3</span>, <span class="fu">rev</span>(mycurve<span class="sc">$</span>y<span class="dv">-1</span>)), <span class="at">col=</span><span class="fu">rgb</span>(.<span class="dv">7</span>,.<span class="dv">7</span>,.<span class="dv">7</span>,.<span class="dv">2</span>), <span class="at">border=</span><span class="cn">NA</span>) </span>
<span id="cb48-48"><a href="#cb48-48" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb48-49"><a href="#cb48-49" tabindex="-1"></a>  </span>
<span id="cb48-50"><a href="#cb48-50" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">lm</span>(Girth <span class="sc">~</span> Volume, <span class="at">data=</span>trees[<span class="sc">-</span><span class="dv">31</span>,])</span>
<span id="cb48-51"><a href="#cb48-51" tabindex="-1"></a>  <span class="fu">plot</span>(tmp<span class="sc">$</span>residuals <span class="sc">~</span> tmp<span class="sc">$</span>fitted.values, <span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb48-52"><a href="#cb48-52" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Fitted Values&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>, </span>
<span id="cb48-53"><a href="#cb48-53" tabindex="-1"></a>       <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex.main=</span><span class="fl">0.95</span>,</span>
<span id="cb48-54"><a href="#cb48-54" tabindex="-1"></a>       <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb48-55"><a href="#cb48-55" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb48-56"><a href="#cb48-56" tabindex="-1"></a></span>
<span id="cb48-57"><a href="#cb48-57" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">lm</span>(Height <span class="sc">~</span> Volume, <span class="at">data=</span>trees)</span>
<span id="cb48-58"><a href="#cb48-58" tabindex="-1"></a>  <span class="fu">plot</span>(tmp<span class="sc">$</span>residuals <span class="sc">~</span> tmp<span class="sc">$</span>fitted.values, <span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb48-59"><a href="#cb48-59" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Fitted Values&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>, </span>
<span id="cb48-60"><a href="#cb48-60" tabindex="-1"></a>       <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex.main=</span><span class="fl">0.95</span>,</span>
<span id="cb48-61"><a href="#cb48-61" tabindex="-1"></a>       <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span>
<span id="cb48-62"><a href="#cb48-62" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">min</span>(tmp<span class="sc">$</span>fit), <span class="dv">2</span>), <span class="fu">max</span>(tmp<span class="sc">$</span>fit)), <span class="fu">c</span>(<span class="fl">1.3</span><span class="sc">*</span><span class="fu">max</span>(tmp<span class="sc">$</span>res),<span class="fl">1.2</span><span class="sc">*</span><span class="fu">min</span>(tmp<span class="sc">$</span>res),<span class="dv">0</span>), <span class="at">col=</span><span class="fu">rgb</span>(.<span class="dv">8</span>,.<span class="dv">8</span>,.<span class="dv">8</span>,.<span class="dv">2</span>), <span class="at">border=</span><span class="cn">NA</span>) </span>
<span id="cb48-63"><a href="#cb48-63" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb48-64"><a href="#cb48-64" tabindex="-1"></a>  </span>
<span id="cb48-65"><a href="#cb48-65" tabindex="-1"></a>  </span>
<span id="cb48-66"><a href="#cb48-66" tabindex="-1"></a>  </span>
<span id="cb48-67"><a href="#cb48-67" tabindex="-1"></a>  </span>
<span id="cb48-68"><a href="#cb48-68" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data=</span>mtcars)</span>
<span id="cb48-69"><a href="#cb48-69" tabindex="-1"></a>  <span class="fu">plot</span>(tmp<span class="sc">$</span>residuals <span class="sc">~</span> tmp<span class="sc">$</span>fitted.values, <span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb48-70"><a href="#cb48-70" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Fitted Values&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>, </span>
<span id="cb48-71"><a href="#cb48-71" tabindex="-1"></a>       <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex.main=</span><span class="fl">0.95</span>,</span>
<span id="cb48-72"><a href="#cb48-72" tabindex="-1"></a>       <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span>
<span id="cb48-73"><a href="#cb48-73" tabindex="-1"></a>  mycurve <span class="ot">&lt;-</span> <span class="fu">lowess</span>(tmp<span class="sc">$</span>fitted.values,tmp<span class="sc">$</span>residuals, <span class="at">f=</span>.<span class="dv">4</span>)</span>
<span id="cb48-74"><a href="#cb48-74" tabindex="-1"></a>  mycurveOrder <span class="ot">&lt;-</span> <span class="fu">order</span>(mycurve<span class="sc">$</span>x)</span>
<span id="cb48-75"><a href="#cb48-75" tabindex="-1"></a>  mycurve<span class="sc">$</span>x <span class="ot">&lt;-</span> mycurve<span class="sc">$</span>x[mycurveOrder]</span>
<span id="cb48-76"><a href="#cb48-76" tabindex="-1"></a>  mycurve<span class="sc">$</span>y <span class="ot">&lt;-</span> mycurve<span class="sc">$</span>y[mycurveOrder]</span>
<span id="cb48-77"><a href="#cb48-77" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(mycurve<span class="sc">$</span>x,<span class="fu">rev</span>(mycurve<span class="sc">$</span>x)), <span class="fu">c</span>(mycurve<span class="sc">$</span>y<span class="fl">+3.5</span>, <span class="fu">rev</span>(mycurve<span class="sc">$</span>y<span class="dv">-2</span>)), <span class="at">col=</span><span class="fu">rgb</span>(.<span class="dv">7</span>,.<span class="dv">7</span>,.<span class="dv">7</span>,.<span class="dv">2</span>), <span class="at">border=</span><span class="cn">NA</span>) </span>
<span id="cb48-78"><a href="#cb48-78" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>) </span>
<span id="cb48-79"><a href="#cb48-79" tabindex="-1"></a>  </span>
<span id="cb48-80"><a href="#cb48-80" tabindex="-1"></a>  </span>
<span id="cb48-81"><a href="#cb48-81" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> repwt, <span class="at">data=</span>Davis[<span class="sc">-</span><span class="dv">12</span>,])</span>
<span id="cb48-82"><a href="#cb48-82" tabindex="-1"></a>  <span class="fu">plot</span>(tmp<span class="sc">$</span>residuals <span class="sc">~</span> tmp<span class="sc">$</span>fitted.values, <span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb48-83"><a href="#cb48-83" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Fitted Values&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>, </span>
<span id="cb48-84"><a href="#cb48-84" tabindex="-1"></a>       <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex.main=</span><span class="fl">0.95</span>,</span>
<span id="cb48-85"><a href="#cb48-85" tabindex="-1"></a>       <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb48-86"><a href="#cb48-86" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>) </span>
<span id="cb48-87"><a href="#cb48-87" tabindex="-1"></a></span>
<span id="cb48-88"><a href="#cb48-88" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> repht, <span class="at">data=</span>Davis[<span class="sc">-</span><span class="dv">12</span>,])</span>
<span id="cb48-89"><a href="#cb48-89" tabindex="-1"></a>  <span class="fu">plot</span>(tmp<span class="sc">$</span>residuals <span class="sc">~</span> tmp<span class="sc">$</span>fitted.values, <span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb48-90"><a href="#cb48-90" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Fitted Values&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>, </span>
<span id="cb48-91"><a href="#cb48-91" tabindex="-1"></a>       <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex.main=</span><span class="fl">0.95</span>,</span>
<span id="cb48-92"><a href="#cb48-92" tabindex="-1"></a>       <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span>
<span id="cb48-93"><a href="#cb48-93" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(<span class="fu">min</span>(tmp<span class="sc">$</span>fit),<span class="fu">rep</span>(<span class="fu">max</span>(tmp<span class="sc">$</span>fit), <span class="dv">2</span>)), <span class="fu">c</span>(<span class="dv">2</span>,<span class="fu">max</span>(tmp<span class="sc">$</span>res),<span class="fl">1.6</span><span class="sc">*</span><span class="fu">min</span>(tmp<span class="sc">$</span>res)), <span class="at">col=</span><span class="fu">rgb</span>(.<span class="dv">85</span>,.<span class="dv">85</span>,.<span class="dv">85</span>,.<span class="dv">2</span>), <span class="at">border=</span><span class="cn">NA</span>) </span>
<span id="cb48-94"><a href="#cb48-94" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>) </span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
</div>
<p><br /></p>
<hr />
<p><strong><em>Q-Q Plot of the Residuals: Checks Assumption
#2</em></strong></p>
<table width="90%">
<tr>
<td with="15%">
<img src="index_files/figure-html/unnamed-chunk-70-1.png" width="144" />
</td>
<td width="75%">
<p>The normality of the error terms can be assessed by considering a
normal probability plot (Q-Q Plot) of the residuals. If the residuals
appear to be normal, then the error terms are also considered to be
normal. If the residuals do not appear to be normal, then the error
terms are also assumed to violate the normality assumption.</p>
<p>|
<a href="javascript:showhide('qqplots')" style="font-size:.8em;color:steelblue2;">Show
Examples</a> |</p>
</td>
</tr>
</table>
<div id="qqplots" style="display:none;">
<p><a href="javascript:showhide('qqplotsread')" style="font-size:.8em;color:skyblue;">(Read
more…)</a></p>
<div id="qqplotsread" style="display:none;">
<p>There are four main trends that occur in a normal probability plot.
Examples of each are plotted below with a histogram of the data next to
the normal probability plot.</p>
<p>Often the plot is called a Q-Q Plot, which stands for
quantile-quantile plot. The idea is to compare the observed distribution
of data to what the distribution should look like in theory if it was
normal. Q-Q Plots are more general than normal probability plots because
they can be used with any theoretical distribution, not just the normal
distribution.</p>
</div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),  <span class="at">mai=</span><span class="fu">c</span>(.<span class="dv">5</span>,.<span class="dv">5</span>,.<span class="dv">25</span>,.<span class="dv">25</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="dv">1</span>,.<span class="dv">75</span>,<span class="dv">0</span>))</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>  <span class="fu">qqnorm</span>(tmp, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">ylab=</span><span class="st">&quot;Observed&quot;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>  <span class="fu">qqline</span>(tmp)</span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a>  <span class="fu">hist</span>(tmp, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">main=</span><span class="st">&quot;Normal&quot;</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>  </span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> Davis<span class="sc">$</span>weight</span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a>  <span class="fu">qqnorm</span>(tmp, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">ylab=</span><span class="st">&quot;Observed&quot;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a>  <span class="fu">qqline</span>(tmp)</span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a>  <span class="fu">hist</span>(tmp, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">main=</span><span class="st">&quot;Right-skewed&quot;</span>,</span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a>       <span class="at">breaks=</span><span class="dv">15</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),  <span class="at">mai=</span><span class="fu">c</span>(.<span class="dv">5</span>,.<span class="dv">5</span>,.<span class="dv">25</span>,.<span class="dv">25</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="dv">1</span>,.<span class="dv">75</span>,<span class="dv">0</span>))</span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">100</span>, <span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>  <span class="fu">qqnorm</span>(tmp, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">ylab=</span><span class="st">&quot;Observed&quot;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>  <span class="fu">qqline</span>(tmp)</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>  <span class="fu">hist</span>(tmp, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">main=</span><span class="st">&quot;Left-skewed&quot;</span>,</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>       <span class="at">breaks=</span><span class="fu">seq</span>(<span class="fu">min</span>(tmp),<span class="fu">max</span>(tmp), <span class="at">length.out=</span><span class="dv">13</span>), <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>  </span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">100</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a>  <span class="fu">qqnorm</span>(tmp, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">ylab=</span><span class="st">&quot;Observed&quot;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a>  <span class="fu">qqline</span>(tmp)</span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a>  <span class="fu">hist</span>(tmp, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">main=</span><span class="st">&quot;Heavy-tailed&quot;</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-71-2.png" width="672" /></p>
</div>
<p><br /></p>
<hr />
<p><strong><em>Residuals versus Order Plot: Checks Assumption
#5</em></strong></p>
<table width="90%">
<tr>
<td with="15%">
<img src="index_files/figure-html/unnamed-chunk-72-1.png" width="144" />
</td>
<td width="75%">
<p>When the data is collected in a specific order, or has some other
important ordering to it, then the independence of the error terms can
be assessed. This is typically done by plotting the residuals against
their order of occurrance. If any dramatic trends are visible in the
plot, then the independence assumption is violated.</p>
<p>|
<a href="javascript:showhide('resorderplots')" style="font-size:.8em;color:steelblue2;">Show
Examples</a> |</p>
</td>
</tr>
</table>
<div id="resorderplots" style="display:none;">
<p><a href="javascript:showhide('resorderplotsread')" style="font-size:.8em;color:skyblue;">(Read
more…)</a></p>
<div id="resorderplotsread" style="display:none;">
<p>Plotting the residuals against the order in which the data was
collected provides insight as to whether or not the observations can be
considered independent. If the plot shows no trend, then the error terms
are considered independent and the regression assumption satisfied. If
there is a visible trend in the plot, then the regression assumption is
likely violated.</p>
</div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),  <span class="at">mai=</span><span class="fu">c</span>(.<span class="dv">5</span>,.<span class="dv">5</span>,.<span class="dv">25</span>,.<span class="dv">25</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="dv">1</span>,.<span class="dv">75</span>,<span class="dv">0</span>))</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data=</span>mtcars)</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>  <span class="fu">plot</span>(tmp<span class="sc">$</span>residuals, <span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Order&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>, </span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>       <span class="at">main=</span><span class="st">&quot;Good: No Trend&quot;</span>, <span class="at">cex.main=</span><span class="fl">0.95</span>,</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>       <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> age, <span class="at">data=</span>Loblolly)</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>  <span class="fu">plot</span>(tmp<span class="sc">$</span>residuals, <span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Order&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>, </span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a>       <span class="at">main=</span><span class="st">&quot;Questionable: General Trend&quot;</span>, <span class="at">cex.main=</span><span class="fl">0.95</span>,</span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a>       <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">col=</span><span class="st">&quot;orangered&quot;</span>)</span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">lm</span>(hp <span class="sc">~</span> qsec, <span class="at">data=</span>mtcars)</span>
<span id="cb51-16"><a href="#cb51-16" tabindex="-1"></a>  <span class="fu">plot</span>(tmp<span class="sc">$</span>residuals, <span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb51-17"><a href="#cb51-17" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Order&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>, </span>
<span id="cb51-18"><a href="#cb51-18" tabindex="-1"></a>       <span class="at">main=</span><span class="st">&quot;Questionable: Interesting Patterns&quot;</span>, <span class="at">cex.main=</span><span class="fl">0.95</span>,</span>
<span id="cb51-19"><a href="#cb51-19" tabindex="-1"></a>       <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">col=</span><span class="st">&quot;orangered&quot;</span>)</span>
<span id="cb51-20"><a href="#cb51-20" tabindex="-1"></a>  </span>
<span id="cb51-21"><a href="#cb51-21" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">lm</span>(hp <span class="sc">~</span> drat, <span class="at">data=</span>mtcars[<span class="fu">order</span>(mtcars<span class="sc">$</span>cyl),])</span>
<span id="cb51-22"><a href="#cb51-22" tabindex="-1"></a>  <span class="fu">plot</span>(tmp<span class="sc">$</span>residuals, <span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb51-23"><a href="#cb51-23" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Order&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>, </span>
<span id="cb51-24"><a href="#cb51-24" tabindex="-1"></a>       <span class="at">main=</span><span class="st">&quot;Bad: Obvious Trend&quot;</span>, <span class="at">cex.main=</span><span class="fl">0.95</span>,</span>
<span id="cb51-25"><a href="#cb51-25" tabindex="-1"></a>       <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
</div>
</div>
<p><br /></p>
<hr />
<p><strong><em>Problems from Failed Assumptions</em></strong></p>
<p>There are various problems that can arise when certain of the
regression assupmtions are not satisfied.</p>
<p><strong>Lack of Linearity</strong></p>
<p>When the linearity assumption is violated, pretty much everything we
obtain from the regression summary is no longer meaningful.</p>
<ul>
<li><p>The y-intercept estimate can be drastically off from its actual
true value.</p></li>
<li><p>Important model information is lost by trying to use a simple
slope term <span class="math inline">\(\beta_1\)</span> to describe the
model with respect to <span class="math inline">\(X\)</span>.</p></li>
<li><p>The residual standard error will be much higher than it otherwise
would be because of curvature patterns in the data that the line cannot
capture. Thus, R-squared will be lower than it otherwise should
be.</p></li>
<li><p>P-values can become non-significant, when in fact there is a
strong pattern in the data, but that pattern just cannot be captured by
a simple line.</p></li>
</ul>
<p>*Normality of the errors is often put into question as well when a
simplified line is used to try to capture a more complicated curved
model.</p>
<p>The plot below demonstrate these difficulties.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="co"># Create Data from a True Model</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span>                           <span class="co">#sample size</span></span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> <span class="fl">14.2</span>                    <span class="co">#True y-intercept</span></span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="fl">7.5</span>                     <span class="co">#True slope</span></span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a>beta_2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.25</span>                   <span class="co">#True bend</span></span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" tabindex="-1"></a>X_i <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">20</span>)            <span class="co">#Sample of X-values</span></span>
<span id="cb52-12"><a href="#cb52-12" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">2.5</span>                      <span class="co">#True standard deviation</span></span>
<span id="cb52-14"><a href="#cb52-14" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" tabindex="-1"></a>epsilon_i <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma)   <span class="co">#normally distributed errors</span></span>
<span id="cb52-16"><a href="#cb52-16" tabindex="-1"></a></span>
<span id="cb52-17"><a href="#cb52-17" tabindex="-1"></a>Y_i <span class="ot">&lt;-</span> beta_0 <span class="sc">+</span> beta_1<span class="sc">*</span>X_i <span class="sc">+</span> beta_2<span class="sc">*</span>X_i<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> epsilon_i </span>
<span id="cb52-18"><a href="#cb52-18" tabindex="-1"></a>                                  <span class="co">#Sample of Y-values from model</span></span>
<span id="cb52-19"><a href="#cb52-19" tabindex="-1"></a></span>
<span id="cb52-20"><a href="#cb52-20" tabindex="-1"></a></span>
<span id="cb52-21"><a href="#cb52-21" tabindex="-1"></a><span class="co"># Plot the Data and Fitted Model</span></span>
<span id="cb52-22"><a href="#cb52-22" tabindex="-1"></a></span>
<span id="cb52-23"><a href="#cb52-23" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y_i <span class="sc">~</span> X_i)            <span class="co">#Fit Model to Data</span></span>
<span id="cb52-24"><a href="#cb52-24" tabindex="-1"></a></span>
<span id="cb52-25"><a href="#cb52-25" tabindex="-1"></a></span>
<span id="cb52-26"><a href="#cb52-26" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="dv">2</span>, <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>), </span>
<span id="cb52-27"><a href="#cb52-27" tabindex="-1"></a>   <span class="at">widths=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">heights=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb52-28"><a href="#cb52-28" tabindex="-1"></a>                                 <span class="co">#create plot panel</span></span>
<span id="cb52-29"><a href="#cb52-29" tabindex="-1"></a></span>
<span id="cb52-30"><a href="#cb52-30" tabindex="-1"></a></span>
<span id="cb52-31"><a href="#cb52-31" tabindex="-1"></a><span class="fu">plot</span>(Y_i <span class="sc">~</span> X_i,                  <span class="co">#Plot the data</span></span>
<span id="cb52-32"><a href="#cb52-32" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">16</span>, </span>
<span id="cb52-33"><a href="#cb52-33" tabindex="-1"></a>     <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>, </span>
<span id="cb52-34"><a href="#cb52-34" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), </span>
<span id="cb52-35"><a href="#cb52-35" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),</span>
<span id="cb52-36"><a href="#cb52-36" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Non-Linear Relation&quot;</span>)</span>
<span id="cb52-37"><a href="#cb52-37" tabindex="-1"></a></span>
<span id="cb52-38"><a href="#cb52-38" tabindex="-1"></a><span class="fu">abline</span>(mylm, <span class="at">col=</span><span class="st">&quot;gray&quot;</span>)         <span class="co">#Add fitted line to plot</span></span>
<span id="cb52-39"><a href="#cb52-39" tabindex="-1"></a></span>
<span id="cb52-40"><a href="#cb52-40" tabindex="-1"></a><span class="fu">curve</span>(beta_0 <span class="sc">+</span> beta_1<span class="sc">*</span>x <span class="sc">+</span> beta_2<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>) </span>
<span id="cb52-41"><a href="#cb52-41" tabindex="-1"></a>                                 <span class="co">#Add True line to plot</span></span>
<span id="cb52-42"><a href="#cb52-42" tabindex="-1"></a>      </span>
<span id="cb52-43"><a href="#cb52-43" tabindex="-1"></a></span>
<span id="cb52-44"><a href="#cb52-44" tabindex="-1"></a>                                 <span class="co">#Add summary to plot</span></span>
<span id="cb52-45"><a href="#cb52-45" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;Y-Intercept:&quot;</span>, <span class="fu">round</span>(mylm<span class="sc">$</span>coef[[<span class="dv">1</span>]], <span class="dv">3</span>), <span class="st">&quot;  (True value:&quot;</span>, beta_0, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb52-46"><a href="#cb52-46" tabindex="-1"></a>                           <span class="fu">paste</span>(<span class="st">&quot;Slope:&quot;</span>, <span class="fu">round</span>(mylm<span class="sc">$</span>coef[[<span class="dv">2</span>]], <span class="dv">3</span>), <span class="st">&quot;  (True value:&quot;</span>, beta_1, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb52-47"><a href="#cb52-47" tabindex="-1"></a>                           <span class="fu">paste</span>(<span class="st">&quot;Sigma:&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(mylm)<span class="sc">$</span>sigma, <span class="dv">3</span>), <span class="st">&quot;  (True value:&quot;</span>, sigma, <span class="st">&quot;)&quot;</span>)), <span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb52-48"><a href="#cb52-48" tabindex="-1"></a></span>
<span id="cb52-49"><a href="#cb52-49" tabindex="-1"></a>                                 <span class="co">#Draw diagnostic plots</span></span>
<span id="cb52-50"><a href="#cb52-50" tabindex="-1"></a><span class="fu">plot</span>(mylm, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb52-51"><a href="#cb52-51" tabindex="-1"></a><span class="fu">plot</span>(mylm<span class="sc">$</span>residuals, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>)</span>
<span id="cb52-52"><a href="#cb52-52" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Residuals vs Order&quot;</span>, <span class="at">side=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<p><br/></p>
<p><strong>Non-normal Error Terms</strong></p>
<p>When the normality assumption for the error terms is violated, not
all is lost. In fact, the estimate of the slope and intercept are still
often fairly meaningful. However, it is unwise to put too much trust in
the residual standard error as an estimate of the standard deviation
<span class="math inline">\(\sigma\)</span>. This is because the
standard deviation in skewed distributions does not carry the same
meaning it has in normal distributions.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="co"># Create Data from a True Model</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span>                           <span class="co">#sample size</span></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> <span class="fl">14.2</span>                    <span class="co">#True y-intercept</span></span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="fl">3.5</span>                     <span class="co">#True slope</span></span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>X_i <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">20</span>)            <span class="co">#Sample of X-values</span></span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">2.5</span>                      <span class="co">#True standard deviation</span></span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a>epsilon_i <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="dv">1</span>)<span class="sc">*</span><span class="dv">3</span> <span class="sc">-</span> <span class="dv">1</span> <span class="co">#non-normally distributed errors</span></span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a>Y_i <span class="ot">&lt;-</span> beta_0 <span class="sc">+</span> beta_1<span class="sc">*</span>X_i <span class="sc">+</span> epsilon_i </span>
<span id="cb53-16"><a href="#cb53-16" tabindex="-1"></a>                                  <span class="co">#Sample of Y-values from model</span></span>
<span id="cb53-17"><a href="#cb53-17" tabindex="-1"></a></span>
<span id="cb53-18"><a href="#cb53-18" tabindex="-1"></a></span>
<span id="cb53-19"><a href="#cb53-19" tabindex="-1"></a><span class="co"># Plot the Data and Fitted Model</span></span>
<span id="cb53-20"><a href="#cb53-20" tabindex="-1"></a></span>
<span id="cb53-21"><a href="#cb53-21" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y_i <span class="sc">~</span> X_i)            <span class="co">#Fit Model to Data</span></span>
<span id="cb53-22"><a href="#cb53-22" tabindex="-1"></a></span>
<span id="cb53-23"><a href="#cb53-23" tabindex="-1"></a></span>
<span id="cb53-24"><a href="#cb53-24" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="dv">2</span>, <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>), </span>
<span id="cb53-25"><a href="#cb53-25" tabindex="-1"></a>   <span class="at">widths=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">heights=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb53-26"><a href="#cb53-26" tabindex="-1"></a>                                 <span class="co">#create plot panel</span></span>
<span id="cb53-27"><a href="#cb53-27" tabindex="-1"></a></span>
<span id="cb53-28"><a href="#cb53-28" tabindex="-1"></a></span>
<span id="cb53-29"><a href="#cb53-29" tabindex="-1"></a><span class="fu">plot</span>(Y_i <span class="sc">~</span> X_i,                  <span class="co">#Plot the data</span></span>
<span id="cb53-30"><a href="#cb53-30" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">16</span>, </span>
<span id="cb53-31"><a href="#cb53-31" tabindex="-1"></a>     <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>, </span>
<span id="cb53-32"><a href="#cb53-32" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), </span>
<span id="cb53-33"><a href="#cb53-33" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),</span>
<span id="cb53-34"><a href="#cb53-34" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Normality Assumption Violated&quot;</span>)</span>
<span id="cb53-35"><a href="#cb53-35" tabindex="-1"></a></span>
<span id="cb53-36"><a href="#cb53-36" tabindex="-1"></a><span class="fu">abline</span>(mylm, <span class="at">col=</span><span class="st">&quot;gray&quot;</span>)         <span class="co">#Add fitted line to plot</span></span>
<span id="cb53-37"><a href="#cb53-37" tabindex="-1"></a></span>
<span id="cb53-38"><a href="#cb53-38" tabindex="-1"></a><span class="fu">abline</span>(beta_0, beta_1,           <span class="co">#Add True line to plot</span></span>
<span id="cb53-39"><a href="#cb53-39" tabindex="-1"></a>       <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb53-40"><a href="#cb53-40" tabindex="-1"></a></span>
<span id="cb53-41"><a href="#cb53-41" tabindex="-1"></a>                                 <span class="co">#Add summary to plot</span></span>
<span id="cb53-42"><a href="#cb53-42" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;Y-Intercept:&quot;</span>, <span class="fu">round</span>(mylm<span class="sc">$</span>coef[[<span class="dv">1</span>]], <span class="dv">3</span>), <span class="st">&quot;  (&quot;</span>, beta_0, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb53-43"><a href="#cb53-43" tabindex="-1"></a>                           <span class="fu">paste</span>(<span class="st">&quot;Slope:&quot;</span>, <span class="fu">round</span>(mylm<span class="sc">$</span>coef[[<span class="dv">2</span>]], <span class="dv">3</span>), <span class="st">&quot;  (&quot;</span>, beta_1, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb53-44"><a href="#cb53-44" tabindex="-1"></a>                           <span class="fu">paste</span>(<span class="st">&quot;Sigma:&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(mylm)<span class="sc">$</span>sigma, <span class="dv">3</span>), <span class="st">&quot;  (&quot;</span>, sigma, <span class="st">&quot;)&quot;</span>)), <span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb53-45"><a href="#cb53-45" tabindex="-1"></a></span>
<span id="cb53-46"><a href="#cb53-46" tabindex="-1"></a>                                 <span class="co">#Draw diagnostic plots</span></span>
<span id="cb53-47"><a href="#cb53-47" tabindex="-1"></a><span class="fu">plot</span>(mylm, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb53-48"><a href="#cb53-48" tabindex="-1"></a><span class="fu">plot</span>(mylm<span class="sc">$</span>residuals, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>)</span>
<span id="cb53-49"><a href="#cb53-49" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Residuals vs Order&quot;</span>, <span class="at">side=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<p><strong>Unconstant Variance</strong></p>
<p>When variance of the error term changes across the regression, the
regression approximates the “average variance” of the errors because the
regression is still assuming the variance is constant across the
regression. The estimates of the slope and intercept are still typically
quite good, and can be used for interpretation. The residual standard
error however should not be considered to be meaningful as it will be
too large on one end of the regression and too small on the other
end.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="co"># Create Data from a True Model</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span>                           <span class="co">#sample size</span></span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> <span class="fl">14.2</span>                    <span class="co">#True y-intercept</span></span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="fl">3.5</span>                     <span class="co">#True slope</span></span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>X_i <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">20</span>)            <span class="co">#Sample of X-values</span></span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">2.5</span>                      <span class="co">#True standard deviation</span></span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a></span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a>epsilon_i <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma <span class="sc">+</span> X_i)   </span>
<span id="cb54-14"><a href="#cb54-14" tabindex="-1"></a>                                  <span class="co">#normally distributed errors</span></span>
<span id="cb54-15"><a href="#cb54-15" tabindex="-1"></a>                                  <span class="co">#with increasing variance</span></span>
<span id="cb54-16"><a href="#cb54-16" tabindex="-1"></a></span>
<span id="cb54-17"><a href="#cb54-17" tabindex="-1"></a>Y_i <span class="ot">&lt;-</span> beta_0 <span class="sc">+</span> beta_1<span class="sc">*</span>X_i <span class="sc">+</span> epsilon_i </span>
<span id="cb54-18"><a href="#cb54-18" tabindex="-1"></a>                                  <span class="co">#Sample of Y-values from model</span></span>
<span id="cb54-19"><a href="#cb54-19" tabindex="-1"></a></span>
<span id="cb54-20"><a href="#cb54-20" tabindex="-1"></a></span>
<span id="cb54-21"><a href="#cb54-21" tabindex="-1"></a><span class="co"># Plot the Data and Fitted Model</span></span>
<span id="cb54-22"><a href="#cb54-22" tabindex="-1"></a></span>
<span id="cb54-23"><a href="#cb54-23" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y_i <span class="sc">~</span> X_i)            <span class="co">#Fit Model to Data</span></span>
<span id="cb54-24"><a href="#cb54-24" tabindex="-1"></a></span>
<span id="cb54-25"><a href="#cb54-25" tabindex="-1"></a></span>
<span id="cb54-26"><a href="#cb54-26" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="dv">2</span>, <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>), </span>
<span id="cb54-27"><a href="#cb54-27" tabindex="-1"></a>   <span class="at">widths=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">heights=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb54-28"><a href="#cb54-28" tabindex="-1"></a>                                 <span class="co">#create plot panel</span></span>
<span id="cb54-29"><a href="#cb54-29" tabindex="-1"></a></span>
<span id="cb54-30"><a href="#cb54-30" tabindex="-1"></a></span>
<span id="cb54-31"><a href="#cb54-31" tabindex="-1"></a><span class="fu">plot</span>(Y_i <span class="sc">~</span> X_i,                  <span class="co">#Plot the data</span></span>
<span id="cb54-32"><a href="#cb54-32" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">16</span>, </span>
<span id="cb54-33"><a href="#cb54-33" tabindex="-1"></a>     <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>, </span>
<span id="cb54-34"><a href="#cb54-34" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), </span>
<span id="cb54-35"><a href="#cb54-35" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),</span>
<span id="cb54-36"><a href="#cb54-36" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Variance Varies (Non-Constant)&quot;</span>)</span>
<span id="cb54-37"><a href="#cb54-37" tabindex="-1"></a></span>
<span id="cb54-38"><a href="#cb54-38" tabindex="-1"></a><span class="fu">abline</span>(mylm, <span class="at">col=</span><span class="st">&quot;gray&quot;</span>)         <span class="co">#Add fitted line to plot</span></span>
<span id="cb54-39"><a href="#cb54-39" tabindex="-1"></a></span>
<span id="cb54-40"><a href="#cb54-40" tabindex="-1"></a><span class="fu">abline</span>(beta_0, beta_1,           <span class="co">#Add True line to plot</span></span>
<span id="cb54-41"><a href="#cb54-41" tabindex="-1"></a>       <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb54-42"><a href="#cb54-42" tabindex="-1"></a></span>
<span id="cb54-43"><a href="#cb54-43" tabindex="-1"></a>                                 <span class="co">#Summarize the Model Fit</span></span>
<span id="cb54-44"><a href="#cb54-44" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">rbind</span>(<span class="st">`</span><span class="at">Y-Intercept</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="at">True =</span> beta_0, <span class="at">Estimated =</span> mylm<span class="sc">$</span>coef[[<span class="dv">1</span>]]),</span>
<span id="cb54-45"><a href="#cb54-45" tabindex="-1"></a>      <span class="at">Slope =</span> <span class="fu">c</span>(<span class="at">True =</span> beta_1, <span class="at">Estimated =</span> mylm<span class="sc">$</span>coef[[<span class="dv">2</span>]]),</span>
<span id="cb54-46"><a href="#cb54-46" tabindex="-1"></a>      <span class="at">Sigma =</span> <span class="fu">c</span>(<span class="at">True =</span> sigma, <span class="at">Estimated =</span> <span class="fu">summary</span>(mylm)<span class="sc">$</span>sigma)))</span></code></pre></div>
<table style="width:51%;">
<colgroup>
<col width="25%" />
<col width="9%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">True</th>
<th align="center">Estimated</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Y-Intercept</strong></td>
<td align="center">14.2</td>
<td align="center">13.82</td>
</tr>
<tr class="even">
<td align="center"><strong>Slope</strong></td>
<td align="center">3.5</td>
<td align="center">3.768</td>
</tr>
<tr class="odd">
<td align="center"><strong>Sigma</strong></td>
<td align="center">2.5</td>
<td align="center">13.02</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a>                                 <span class="co">#Add summary to plot</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;Y-Intercept:&quot;</span>, <span class="fu">round</span>(mylm<span class="sc">$</span>coef[[<span class="dv">1</span>]], <span class="dv">3</span>), <span class="st">&quot;  (&quot;</span>, beta_0, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>                           <span class="fu">paste</span>(<span class="st">&quot;Slope:&quot;</span>, <span class="fu">round</span>(mylm<span class="sc">$</span>coef[[<span class="dv">2</span>]], <span class="dv">3</span>), <span class="st">&quot;  (&quot;</span>, beta_1, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>                           <span class="fu">paste</span>(<span class="st">&quot;Sigma:&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(mylm)<span class="sc">$</span>sigma, <span class="dv">3</span>), <span class="st">&quot;  (&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(sigma <span class="sc">+</span> X_i), <span class="dv">2</span>), <span class="st">&quot;, mean)&quot;</span>)), <span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>                                 <span class="co">#Draw diagnostic plots</span></span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a><span class="fu">plot</span>(mylm, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a><span class="fu">plot</span>(mylm<span class="sc">$</span>residuals, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>)</span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Residuals vs Order&quot;</span>, <span class="at">side=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
<p><strong>Normality Violated</strong></p>
<p>As silly as it sounds, if the only problem with the regression is the
lack of normality of the error terms, it isn’t all that big of a
problem. Depending on how non-normal the residuals appear, there could
be some skewing to the residual standard error, but otherwise, the slope
and intercept are still interpretable and meaningful.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="co"># Create Data from a True Model</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span>                           <span class="co">#sample size</span></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> <span class="fl">14.2</span>                    <span class="co">#True y-intercept</span></span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="fl">3.5</span>                     <span class="co">#True slope</span></span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>X_i <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">20</span>)            <span class="co">#Sample of X-values</span></span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">2.5</span>                      <span class="co">#True standard deviation</span></span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a></span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>epsilon_i <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="fu">sqrt</span>(<span class="dv">12</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="fu">sqrt</span>(<span class="dv">12</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="co">#non-normally distributed errors</span></span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>Y_i <span class="ot">&lt;-</span> beta_0 <span class="sc">+</span> beta_1<span class="sc">*</span>X_i <span class="sc">+</span> epsilon_i </span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>                                  <span class="co">#Sample of Y-values from model</span></span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a></span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a></span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a><span class="co"># Plot the Data and Fitted Model</span></span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a></span>
<span id="cb56-21"><a href="#cb56-21" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y_i <span class="sc">~</span> X_i)            <span class="co">#Fit Model to Data</span></span>
<span id="cb56-22"><a href="#cb56-22" tabindex="-1"></a></span>
<span id="cb56-23"><a href="#cb56-23" tabindex="-1"></a></span>
<span id="cb56-24"><a href="#cb56-24" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="dv">2</span>, <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>), </span>
<span id="cb56-25"><a href="#cb56-25" tabindex="-1"></a>   <span class="at">widths=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">heights=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb56-26"><a href="#cb56-26" tabindex="-1"></a>                                 <span class="co">#create plot panel</span></span>
<span id="cb56-27"><a href="#cb56-27" tabindex="-1"></a></span>
<span id="cb56-28"><a href="#cb56-28" tabindex="-1"></a></span>
<span id="cb56-29"><a href="#cb56-29" tabindex="-1"></a><span class="fu">plot</span>(Y_i <span class="sc">~</span> X_i,                  <span class="co">#Plot the data</span></span>
<span id="cb56-30"><a href="#cb56-30" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">16</span>, </span>
<span id="cb56-31"><a href="#cb56-31" tabindex="-1"></a>     <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>, </span>
<span id="cb56-32"><a href="#cb56-32" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), </span>
<span id="cb56-33"><a href="#cb56-33" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),</span>
<span id="cb56-34"><a href="#cb56-34" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Normality Assumption Violated&quot;</span>)</span>
<span id="cb56-35"><a href="#cb56-35" tabindex="-1"></a></span>
<span id="cb56-36"><a href="#cb56-36" tabindex="-1"></a><span class="fu">abline</span>(mylm, <span class="at">col=</span><span class="st">&quot;gray&quot;</span>)         <span class="co">#Add fitted line to plot</span></span>
<span id="cb56-37"><a href="#cb56-37" tabindex="-1"></a></span>
<span id="cb56-38"><a href="#cb56-38" tabindex="-1"></a><span class="fu">abline</span>(beta_0, beta_1,           <span class="co">#Add True line to plot</span></span>
<span id="cb56-39"><a href="#cb56-39" tabindex="-1"></a>       <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb56-40"><a href="#cb56-40" tabindex="-1"></a></span>
<span id="cb56-41"><a href="#cb56-41" tabindex="-1"></a>                                 <span class="co">#Summarize the Model Fit</span></span>
<span id="cb56-42"><a href="#cb56-42" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">rbind</span>(<span class="st">`</span><span class="at">Y-Intercept</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="at">True =</span> beta_0, <span class="at">Estimated =</span> mylm<span class="sc">$</span>coef[[<span class="dv">1</span>]]),</span>
<span id="cb56-43"><a href="#cb56-43" tabindex="-1"></a>      <span class="at">Slope =</span> <span class="fu">c</span>(<span class="at">True =</span> beta_1, <span class="at">Estimated =</span> mylm<span class="sc">$</span>coef[[<span class="dv">2</span>]]),</span>
<span id="cb56-44"><a href="#cb56-44" tabindex="-1"></a>      <span class="at">Sigma =</span> <span class="fu">c</span>(<span class="at">True =</span> sigma, <span class="at">Estimated =</span> <span class="fu">summary</span>(mylm)<span class="sc">$</span>sigma)))</span></code></pre></div>
<table style="width:51%;">
<colgroup>
<col width="25%" />
<col width="9%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">True</th>
<th align="center">Estimated</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Y-Intercept</strong></td>
<td align="center">14.2</td>
<td align="center">14.7</td>
</tr>
<tr class="even">
<td align="center"><strong>Slope</strong></td>
<td align="center">3.5</td>
<td align="center">3.449</td>
</tr>
<tr class="odd">
<td align="center"><strong>Sigma</strong></td>
<td align="center">2.5</td>
<td align="center">2.317</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>                                 <span class="co">#Add summary to plot</span></span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;Y-Intercept:&quot;</span>, <span class="fu">round</span>(mylm<span class="sc">$</span>coef[[<span class="dv">1</span>]], <span class="dv">3</span>), <span class="st">&quot;  (&quot;</span>, beta_0, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>                           <span class="fu">paste</span>(<span class="st">&quot;Slope:&quot;</span>, <span class="fu">round</span>(mylm<span class="sc">$</span>coef[[<span class="dv">2</span>]], <span class="dv">3</span>), <span class="st">&quot;  (&quot;</span>, beta_1, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>                           <span class="fu">paste</span>(<span class="st">&quot;Sigma:&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(mylm)<span class="sc">$</span>sigma, <span class="dv">3</span>), <span class="st">&quot;  (&quot;</span>, sigma, <span class="st">&quot;)&quot;</span>)), <span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a>                                 <span class="co">#Draw diagnostic plots</span></span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a><span class="fu">plot</span>(mylm, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a><span class="fu">plot</span>(mylm<span class="sc">$</span>residuals, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>)</span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Residuals vs Order&quot;</span>, <span class="at">side=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<p><strong>Independence Assumption Violated</strong></p>
<p>While the slope and intercept are often still meaningful when the
independence assumption is violated, the residual standard error is
unnecessarily large in this case.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="co"># Create Data from a True Model</span></span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span>                           <span class="co">#sample size</span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> <span class="fl">14.2</span>                    <span class="co">#True y-intercept</span></span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="fl">3.5</span>                     <span class="co">#True slope</span></span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a>X_i <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">20</span>)            <span class="co">#Sample of X-values</span></span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">2.5</span>                      <span class="co">#True standard deviation</span></span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a>epsilon_i <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">2.5</span>) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">:</span>n <span class="sc">-</span>n<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>.<span class="dv">5</span></span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a>                                <span class="co">#normal, but correlated errors</span></span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a></span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a>Y_i <span class="ot">&lt;-</span> beta_0 <span class="sc">+</span> beta_1<span class="sc">*</span>X_i <span class="sc">+</span> epsilon_i </span>
<span id="cb58-17"><a href="#cb58-17" tabindex="-1"></a>                                  <span class="co">#Sample of Y-values from model</span></span>
<span id="cb58-18"><a href="#cb58-18" tabindex="-1"></a></span>
<span id="cb58-19"><a href="#cb58-19" tabindex="-1"></a></span>
<span id="cb58-20"><a href="#cb58-20" tabindex="-1"></a><span class="co"># Plot the Data and Fitted Model</span></span>
<span id="cb58-21"><a href="#cb58-21" tabindex="-1"></a></span>
<span id="cb58-22"><a href="#cb58-22" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y_i <span class="sc">~</span> X_i)            <span class="co">#Fit Model to Data</span></span>
<span id="cb58-23"><a href="#cb58-23" tabindex="-1"></a></span>
<span id="cb58-24"><a href="#cb58-24" tabindex="-1"></a></span>
<span id="cb58-25"><a href="#cb58-25" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="dv">2</span>, <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>), </span>
<span id="cb58-26"><a href="#cb58-26" tabindex="-1"></a>   <span class="at">widths=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">heights=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb58-27"><a href="#cb58-27" tabindex="-1"></a>                                 <span class="co">#create plot panel</span></span>
<span id="cb58-28"><a href="#cb58-28" tabindex="-1"></a></span>
<span id="cb58-29"><a href="#cb58-29" tabindex="-1"></a></span>
<span id="cb58-30"><a href="#cb58-30" tabindex="-1"></a><span class="fu">plot</span>(Y_i <span class="sc">~</span> X_i,                  <span class="co">#Plot the data</span></span>
<span id="cb58-31"><a href="#cb58-31" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">16</span>, </span>
<span id="cb58-32"><a href="#cb58-32" tabindex="-1"></a>     <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>, </span>
<span id="cb58-33"><a href="#cb58-33" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), </span>
<span id="cb58-34"><a href="#cb58-34" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),</span>
<span id="cb58-35"><a href="#cb58-35" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Independence Assumption Violated&quot;</span>)</span>
<span id="cb58-36"><a href="#cb58-36" tabindex="-1"></a></span>
<span id="cb58-37"><a href="#cb58-37" tabindex="-1"></a><span class="fu">abline</span>(mylm, <span class="at">col=</span><span class="st">&quot;gray&quot;</span>)         <span class="co">#Add fitted line to plot</span></span>
<span id="cb58-38"><a href="#cb58-38" tabindex="-1"></a></span>
<span id="cb58-39"><a href="#cb58-39" tabindex="-1"></a><span class="fu">abline</span>(beta_0, beta_1,           <span class="co">#Add True line to plot</span></span>
<span id="cb58-40"><a href="#cb58-40" tabindex="-1"></a>       <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb58-41"><a href="#cb58-41" tabindex="-1"></a></span>
<span id="cb58-42"><a href="#cb58-42" tabindex="-1"></a>                                 <span class="co">#Summarize the Model Fit</span></span>
<span id="cb58-43"><a href="#cb58-43" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">rbind</span>(<span class="st">`</span><span class="at">Y-Intercept</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="at">True =</span> beta_0, <span class="at">Estimated =</span> mylm<span class="sc">$</span>coef[[<span class="dv">1</span>]]),</span>
<span id="cb58-44"><a href="#cb58-44" tabindex="-1"></a>      <span class="at">Slope =</span> <span class="fu">c</span>(<span class="at">True =</span> beta_1, <span class="at">Estimated =</span> mylm<span class="sc">$</span>coef[[<span class="dv">2</span>]]),</span>
<span id="cb58-45"><a href="#cb58-45" tabindex="-1"></a>      <span class="at">Sigma =</span> <span class="fu">c</span>(<span class="at">True =</span> sigma, <span class="at">Estimated =</span> <span class="fu">summary</span>(mylm)<span class="sc">$</span>sigma)))</span></code></pre></div>
<table style="width:51%;">
<colgroup>
<col width="25%" />
<col width="9%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">True</th>
<th align="center">Estimated</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Y-Intercept</strong></td>
<td align="center">14.2</td>
<td align="center">16.47</td>
</tr>
<tr class="even">
<td align="center"><strong>Slope</strong></td>
<td align="center">3.5</td>
<td align="center">3.296</td>
</tr>
<tr class="odd">
<td align="center"><strong>Sigma</strong></td>
<td align="center">2.5</td>
<td align="center">4.819</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a>                                 <span class="co">#Add summary to plot</span></span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;Y-Intercept:&quot;</span>, <span class="fu">round</span>(mylm<span class="sc">$</span>coef[[<span class="dv">1</span>]], <span class="dv">3</span>), <span class="st">&quot;  (&quot;</span>, beta_0, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>                           <span class="fu">paste</span>(<span class="st">&quot;Slope:&quot;</span>, <span class="fu">round</span>(mylm<span class="sc">$</span>coef[[<span class="dv">2</span>]], <span class="dv">3</span>), <span class="st">&quot;  (&quot;</span>, beta_1, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>                           <span class="fu">paste</span>(<span class="st">&quot;Sigma:&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(mylm)<span class="sc">$</span>sigma, <span class="dv">3</span>), <span class="st">&quot;  (&quot;</span>, sigma, <span class="st">&quot;)&quot;</span>)), <span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a>                                 <span class="co">#Draw diagnostic plots</span></span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a><span class="fu">plot</span>(mylm, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a><span class="fu">plot</span>(mylm<span class="sc">$</span>residuals, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>)</span>
<span id="cb59-9"><a href="#cb59-9" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Residuals vs Order&quot;</span>, <span class="at">side=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
<p><strong>Outliers Present</strong></p>
<p>While outliers do not violate any of the regression assumptions, they
do pose substantial difficulties for the least squares regression
estimates of the slope and intercept.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="co"># Create Data from a True Model</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span>                           <span class="co">#sample size</span></span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> <span class="fl">14.2</span>                    <span class="co">#True y-intercept</span></span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="fl">3.5</span>                     <span class="co">#True slope</span></span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a>X_i <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">20</span>)            <span class="co">#Sample of X-values</span></span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">2.5</span>                      <span class="co">#True standard deviation</span></span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a>epsilon_i <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma)   <span class="co">#normally distributed errors</span></span>
<span id="cb60-14"><a href="#cb60-14" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" tabindex="-1"></a></span>
<span id="cb60-16"><a href="#cb60-16" tabindex="-1"></a>epsilon_i[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(X_i[<span class="dv">3</span>] <span class="sc">&lt;</span> <span class="dv">10</span>, <span class="fu">runif</span>(<span class="dv">1</span>,<span class="dv">25</span>,<span class="dv">35</span>), <span class="sc">-</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="dv">25</span>,<span class="dv">35</span>))</span>
<span id="cb60-17"><a href="#cb60-17" tabindex="-1"></a>                                  <span class="co">#create outlier</span></span>
<span id="cb60-18"><a href="#cb60-18" tabindex="-1"></a></span>
<span id="cb60-19"><a href="#cb60-19" tabindex="-1"></a>Y_i <span class="ot">&lt;-</span> beta_0 <span class="sc">+</span> beta_1<span class="sc">*</span>X_i <span class="sc">+</span> epsilon_i </span>
<span id="cb60-20"><a href="#cb60-20" tabindex="-1"></a>                                  <span class="co">#Sample of Y-values from model</span></span>
<span id="cb60-21"><a href="#cb60-21" tabindex="-1"></a></span>
<span id="cb60-22"><a href="#cb60-22" tabindex="-1"></a></span>
<span id="cb60-23"><a href="#cb60-23" tabindex="-1"></a></span>
<span id="cb60-24"><a href="#cb60-24" tabindex="-1"></a><span class="co"># Plot the Data and Fitted Model</span></span>
<span id="cb60-25"><a href="#cb60-25" tabindex="-1"></a></span>
<span id="cb60-26"><a href="#cb60-26" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y_i <span class="sc">~</span> X_i)            <span class="co">#Fit Model to Data</span></span>
<span id="cb60-27"><a href="#cb60-27" tabindex="-1"></a></span>
<span id="cb60-28"><a href="#cb60-28" tabindex="-1"></a></span>
<span id="cb60-29"><a href="#cb60-29" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="dv">2</span>, <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>), </span>
<span id="cb60-30"><a href="#cb60-30" tabindex="-1"></a>   <span class="at">widths=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">heights=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb60-31"><a href="#cb60-31" tabindex="-1"></a>                                 <span class="co">#create plot panel</span></span>
<span id="cb60-32"><a href="#cb60-32" tabindex="-1"></a></span>
<span id="cb60-33"><a href="#cb60-33" tabindex="-1"></a></span>
<span id="cb60-34"><a href="#cb60-34" tabindex="-1"></a><span class="fu">plot</span>(Y_i <span class="sc">~</span> X_i,                  <span class="co">#Plot the data</span></span>
<span id="cb60-35"><a href="#cb60-35" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">16</span>, </span>
<span id="cb60-36"><a href="#cb60-36" tabindex="-1"></a>     <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>, </span>
<span id="cb60-37"><a href="#cb60-37" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), </span>
<span id="cb60-38"><a href="#cb60-38" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),</span>
<span id="cb60-39"><a href="#cb60-39" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;An Outlier Present&quot;</span>)</span>
<span id="cb60-40"><a href="#cb60-40" tabindex="-1"></a></span>
<span id="cb60-41"><a href="#cb60-41" tabindex="-1"></a><span class="fu">abline</span>(mylm, <span class="at">col=</span><span class="st">&quot;gray&quot;</span>)         <span class="co">#Add fitted line to plot</span></span>
<span id="cb60-42"><a href="#cb60-42" tabindex="-1"></a></span>
<span id="cb60-43"><a href="#cb60-43" tabindex="-1"></a><span class="fu">abline</span>(beta_0, beta_1,           <span class="co">#Add True line to plot</span></span>
<span id="cb60-44"><a href="#cb60-44" tabindex="-1"></a>       <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb60-45"><a href="#cb60-45" tabindex="-1"></a></span>
<span id="cb60-46"><a href="#cb60-46" tabindex="-1"></a>                                 <span class="co">#Summarize the Model Fit</span></span>
<span id="cb60-47"><a href="#cb60-47" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">rbind</span>(<span class="st">`</span><span class="at">Y-Intercept</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="at">True =</span> beta_0, <span class="at">Estimated =</span> mylm<span class="sc">$</span>coef[[<span class="dv">1</span>]]),</span>
<span id="cb60-48"><a href="#cb60-48" tabindex="-1"></a>      <span class="at">Slope =</span> <span class="fu">c</span>(<span class="at">True =</span> beta_1, <span class="at">Estimated =</span> mylm<span class="sc">$</span>coef[[<span class="dv">2</span>]]),</span>
<span id="cb60-49"><a href="#cb60-49" tabindex="-1"></a>      <span class="at">Sigma =</span> <span class="fu">c</span>(<span class="at">True =</span> sigma, <span class="at">Estimated =</span> <span class="fu">summary</span>(mylm)<span class="sc">$</span>sigma)))</span></code></pre></div>
<table style="width:51%;">
<colgroup>
<col width="25%" />
<col width="9%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">True</th>
<th align="center">Estimated</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Y-Intercept</strong></td>
<td align="center">14.2</td>
<td align="center">13.18</td>
</tr>
<tr class="even">
<td align="center"><strong>Slope</strong></td>
<td align="center">3.5</td>
<td align="center">3.447</td>
</tr>
<tr class="odd">
<td align="center"><strong>Sigma</strong></td>
<td align="center">2.5</td>
<td align="center">6.389</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a>                                 <span class="co">#Add summary to plot</span></span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;Y-Intercept:&quot;</span>, <span class="fu">round</span>(mylm<span class="sc">$</span>coef[[<span class="dv">1</span>]], <span class="dv">3</span>), <span class="st">&quot;  (&quot;</span>, beta_0, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>                           <span class="fu">paste</span>(<span class="st">&quot;Slope:&quot;</span>, <span class="fu">round</span>(mylm<span class="sc">$</span>coef[[<span class="dv">2</span>]], <span class="dv">3</span>), <span class="st">&quot;  (&quot;</span>, beta_1, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a>                           <span class="fu">paste</span>(<span class="st">&quot;Sigma:&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(mylm)<span class="sc">$</span>sigma, <span class="dv">3</span>), <span class="st">&quot;  (&quot;</span>, sigma, <span class="st">&quot;)&quot;</span>)), <span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb61-5"><a href="#cb61-5" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" tabindex="-1"></a>                                 <span class="co">#Draw diagnostic plots</span></span>
<span id="cb61-7"><a href="#cb61-7" tabindex="-1"></a><span class="fu">plot</span>(mylm, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb61-8"><a href="#cb61-8" tabindex="-1"></a><span class="fu">plot</span>(mylm<span class="sc">$</span>residuals, <span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>)</span>
<span id="cb61-9"><a href="#cb61-9" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Residuals vs Order&quot;</span>, <span class="at">side=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
</div>
<p><br /></p>
<hr />
<p><br/></p>
<p><em>The material below this section is meant for Math 425 students
only.</em></p>
<p><br/></p>
<hr />
<p><strong><em>Estimating the Model Parameters
<a href="javascript:showhide('estimatingparameters')" style="font-size:.6em;color:skyblue;" id="estMod">(Expand)</a></em></strong></p>
<p><span class="expand-caption">How to get <span
class="math inline">\(b_0\)</span> and <span
class="math inline">\(b_1\)</span>: least squares &amp; maximum
likelihood…</span></p>
<div id="estimatingparameters" style="display:none;">
<p>There are two approaches to estimating the parameters <span
class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span> in the regression model. The
oldest and most tradiational approach is using the idea of least
squares. A more general approach uses the idea of maximum likelihood
(see below). Fortunately, for simple linear regression, the estimates
for <span class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span> obtained from either method are
identical. The estimates for the true parameter values <span
class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span> are typically denoted by <span
class="math inline">\(b_0\)</span> and <span
class="math inline">\(b_1\)</span>, respectively, and are given by the
following formulas.</p>
<table>
<colgroup>
<col width="40%" />
<col width="44%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th>Parameter Estimate</th>
<th>Mathematical Formula</th>
<th>R Code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Slope</td>
<td><span class="math inline">\(b_1 = \frac{\sum
X_i(Y_i-\bar{Y})}{\sum(X_i-\bar{X})^2}\)</span></td>
<td><code>b_1 &lt;- sum( X*(Y - mean(Y)) ) / sum( (X - mean(X))^2 )</code></td>
</tr>
<tr class="even">
<td>Intercept</td>
<td><span class="math inline">\(b_0 = \bar{Y} - b_1\bar{X}\)</span></td>
<td><code>b_0 &lt;- mean(Y) - b_1*mean(X)</code></td>
</tr>
</tbody>
</table>
<p>It is important to note that these estimates are entirely determined
from the observed data <span class="math inline">\(X\)</span> and <span
class="math inline">\(Y\)</span>. When the regression equation is
written using the estimates instead of the parameters, we use the
notation <span class="math inline">\(\hat{Y}\)</span>, which is the
estimator of <span class="math inline">\(E\{Y\}\)</span>. Thus, we write
<span class="math display">\[\begin{equation}
  \hat{Y}_i = b_0 + b_1 X_i
\end{equation}\]</span> which is directly comparable to the true, but
unknown values <span class="math display">\[\begin{equation}
  E\{Y_i\} = \beta_0 + \beta_1 X_i.
  \label{exp}
\end{equation}\]</span></p>
<hr />
<p><strong><em>Least Squares{#leastSquares}</em></strong></p>
<p>To estimate the model parameters <span
class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span> using least squares, we start by
defining the function <span class="math inline">\(Q\)</span> as the sum
of the squared errors, <span class="math inline">\(\epsilon_i\)</span>.
<span class="math display">\[
  Q = \sum_{i=1}^n \epsilon_i^2 = \sum_{i=1}^n (Y_i - (\beta_0 + \beta_1
X_i))^2
\]</span> Then we use the function Q as if it were a function of <span
class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span>. Ironically, the values of <span
class="math inline">\(Y\)</span> and <span
class="math inline">\(X\)</span> are considered fixed. However, this
makes sense because once a particular data set has been observed, these
values are all known for that data set. What we don’t know are the
values of <span class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span>.</p>
<p>This <a
href="https://phet.colorado.edu/sims/html/least-squares-regression/latest/least-squares-regression_en.html">least
squares applet</a> is a good way to explore how various choices of the
slope and intercept yield different values of the “sum of squared
residuals”. But it turns out that there is one “best” choice of the
slope and intercept that yields a “smallest” value of the “sum of
squared residuals.” This best choice can actually be found using
calculus by taking the partial derivatives of <span
class="math inline">\(Q\)</span> with respect to both <span
class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span>. <span class="math display">\[
  \frac{\partial Q}{\partial \beta_0} = -2\sum (Y_i - \beta_0 -
\beta_1X_i)
\]</span> <span class="math display">\[
  \frac{\partial Q}{\partial \beta_1} = -2\sum
X_i(Y_i-\beta_0-\beta_1X_i)
\]</span> Setting these partial derivatives to zero, and solving the
resulting system of equations provides the values of the parameters
which minimize <span class="math inline">\(Q\)</span> for a given set of
data. After all the calculations are completed we find the values of the
parameter estimators <span class="math inline">\(b_0\)</span> and <span
class="math inline">\(b_1\)</span> (of <span
class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span>, respectively) are as stated
previously.</p>
<hr />
<p><strong><em>Maximum Likelihood{#mle}</em></strong></p>
<p>The idea of maximum likelihood estimation is opposite that of least
squares. Instead of choosing those values of <span
class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span> which minime the least squares
<span class="math inline">\(Q\)</span> function, we choose the values of
<span class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span> which maximize the likelihood
function. The likelihood function is created by first determining the
joint distribution of the <span class="math inline">\(Y_i\)</span> for
all observations <span class="math inline">\(i=1,\ldots,n\)</span>. We
can do this rather simply by using the assumption that the errors, <span
class="math inline">\(\epsilon_i\)</span> are independently normally
distributed. When events are independent, their joint probability is
simply the product of their individual probabilities. Thus, if <span
class="math inline">\(f(Y_i)\)</span> denotes the probability density
function for <span class="math inline">\(Y_i\)</span>, then the joint
probability density for all <span class="math inline">\(Y_i\)</span>,
<span class="math inline">\(f(Y_1,\ldots,Y_n)\)</span> is given by <span
class="math display">\[
  f(Y_1,\ldots,Y_n) = \prod_{i=1}^n f(Y_i)
\]</span> Since each <span class="math inline">\(Y_i\)</span> is assumed
to be normally distributed with mean <span class="math inline">\(\beta_0
+ \beta_1 X_i\)</span> and variance <span
class="math inline">\(\sigma^2\)</span> (see model (<span
class="math inline">\(\ref{model}\)</span>)) we have that <span
class="math display">\[
  f(Y_i) =
\frac{1}{\sqrt{2\pi}\sigma}\exp{\left[-\frac{1}{2}\left(\frac{Y_i-\beta_0-\beta_1X_i}{\sigma}\right)^2\right]}
\]</span> which provides the joint probability as <span
class="math display">\[
  f(Y_1,\ldots,Y_n) = \prod_{i=1}^n f(Y_i) =
\frac{1}{(2\pi\sigma^2)^{n/2}}\exp{\left[-\frac{1}{2\sigma^2}\sum_{i=1}^n(Y_i-\beta_0-\beta_1X_i)^2\right]}
\]</span> The likelihood function <span class="math inline">\(L\)</span>
is then given by consider the <span class="math inline">\(Y_i\)</span>
and <span class="math inline">\(X_i\)</span> fixed and the parameters
<span class="math inline">\(\beta_0\)</span>, <span
class="math inline">\(\beta_1\)</span> and <span
class="math inline">\(\sigma^2\)</span> as the variables in the
function. <span class="math display">\[
  L(\beta_0,\beta_1,\sigma^2) =
\frac{1}{(2\pi\sigma^2)^{n/2}}\exp{\left[-\frac{1}{2\sigma^2}\sum_{i=1}^n(Y_i-\beta_0-\beta_1X_i)^2\right]}
\]</span> Instead of taking partial derivatives of <span
class="math inline">\(L\)</span> directly (with respect to all
parameters) we take the partial derivatives of the <span
class="math inline">\(\log\)</span> of <span
class="math inline">\(L\)</span>, which is easier to work with. In a
similar, but more difficult calculation, to that of minimizing <span
class="math inline">\(Q\)</span>, we obtain the values of <span
class="math inline">\(\beta_0\)</span>, <span
class="math inline">\(\beta_1\)</span>, and <span
class="math inline">\(\sigma^2\)</span> which maximize the log of <span
class="math inline">\(L\)</span>, and which therefore maximize <span
class="math inline">\(L\)</span>. (This is not an obvious result, but
can be verified after some intense calculations.) The additional result
that maximimum likelihood estimation provides that the least squares
estimates did not give us is the estimate <span
class="math inline">\(\hat{\sigma}^2\)</span> of <span
class="math inline">\(\sigma^2\)</span>. <span class="math display">\[
  \hat{\sigma}^2 = \frac{\sum(Y_i-\hat{Y}_i)^2}{n}
\]</span></p>
</div>
<p><br /></p>
<hr />
<p><strong><em>Estimating the Model Variance
<a href="javascript:showhide('estimatingvariance')" style="font-size:.6em;color:skyblue;" id="varEst">(Expand)</a></em></strong></p>
<p><span class="expand-caption">Estimating <span
class="math inline">\(\sigma^2\)</span> with MSE…</span></p>
<div id="estimatingvariance" style="display:none;">
<p>As shown previously in the “Estimating Model Parameters” section of
this page, we can obtain estimates for the model parameters <span
class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span> by using either least squares
estimation or maximum likelihood estimation. Those estimates were given
by the formulas</p>
<p><span class="math display">\[
b_1 = \frac{\sum X_i(Y_i-\bar{Y})}{\sum(X_i-\bar{X})^2} \quad
\text{(Unbiased Estimate of $\beta_1$)}
\]</span></p>
<p><span class="math display">\[
b_0 = \bar{Y} - b_1\bar{X} \quad \text{(Unbiased Estimate of $\beta_0$)}
\]</span></p>
<p>It turns out that these estimates for <span
class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span> are nice in the sense that on
average they provide the correct estimate of the true parameter, i.e.,
they are unbiased estimators. Unfortunately, this is not the case for
the maximum likelihood estimate <span
class="math inline">\(\widehat{\sigma}^2\)</span> of the model variance
<span class="math inline">\(\sigma^2\)</span>. This estimate turns out
to be a biased estimator. This means that it is consistently wrong in
its estimates of <span class="math inline">\(\sigma^2\)</span>. If we
left the estimator alone, our estimates for <span
class="math inline">\(\sigma^2\)</span> would always be wrong. This is
bad. Fortunately, there is a way to fix it, and this corrected version
of the estimator is what we will actually use in practice to estimate
<span class="math inline">\(\sigma^2\)</span>.</p>
<p>Without going into all the details, to “fix” the biased estimator of
<span class="math inline">\(\sigma^2\)</span> that is given to us
through maximum likelihood estimation, we need to correct its
denominator so that it properly represent the degrees of freedom
associated with the numerator, which it does not currently. To find the
correct degrees of freedom, we have to notice that the <span
class="math inline">\(\hat{Y}_i\)</span> in the numerator of <span
class="math inline">\(\widehat{\sigma}^2\)</span> is defined by <span
class="math display">\[\begin{equation}
  \widehat{Y}_i = b_0 + b_1X_i
  \label{hatY}
\end{equation}\]</span> From this equation, we notice that two means,
<span class="math inline">\(\bar{X}\)</span> and <span
class="math inline">\(\bar{Y}\)</span>, were estimated from the data in
order to obtain <span class="math inline">\(\hat{Y}_i\)</span>. (See the
formulas for <span class="math inline">\(b_0\)</span> and <span
class="math inline">\(b_1\)</span> above, and note how they use both
<span class="math inline">\(\bar{X}\)</span> and <span
class="math inline">\(\bar{Y}\)</span> in their calculation.) Anytime a
mean is estimated from the data we lose a degree of freedom. Hence, the
denominator for <span class="math inline">\(\hat{\sigma}^2\)</span>
should be <span class="math inline">\(n-2\)</span> instead of <span
class="math inline">\(n\)</span>. Some incredibly long calculations will
show that the “fixed” estimator <span
class="math display">\[\begin{equation}
  s^2 = MSE = \frac{\sum(Y_i-\hat{Y}_i)^2}{n-2} \quad \text{(Unbiased
Estimator of $\sigma^2$)}
\end{equation}\]</span> is an unbiased estimator of <span
class="math inline">\(\sigma^2\)</span>. Here <span
class="math inline">\(MSE\)</span> stands for <strong>m</strong>ean
<strong>s</strong>quared <strong>e</strong>rror, which is the most
obvious name for a formula that squares the errors <span
class="math inline">\(Y_i-\hat{Y}_i\)</span> then adds them up and
divides by their degrees of freedom. Similarly, we call the numerator
<span class="math inline">\(\sum(Y_i-\hat{Y}_i)^2\)</span> the sum of
the squared errors, denoted by <span class="math inline">\(SSE\)</span>.
It is also important to note that the errors are often denoted by <span
class="math inline">\(r_i = Y_i-\hat{Y}_i\)</span>, the residuals.
Putting this all together we get the following equivalent statements for
<span class="math inline">\(MSE\)</span>. <span
class="math display">\[\begin{equation}
  s^2 = MSE = \frac{SSE}{n-2} = \frac{\sum(Y_i-\widehat{Y}_i)^2}{n-2} =
\frac{\sum r_i^2}{n-2}
\end{equation}\]</span> As a final note, even though the expected value
<span class="math inline">\(E\{MSE\} = \sigma^2\)</span>, which shows
<span class="math inline">\(MSE\)</span> is an unbiased estimator of
<span class="math inline">\(\sigma^2\)</span>, it unfortunately isn’t
true that <span class="math inline">\(\sqrt{MSE}\)</span> is an unbiased
estimator of <span class="math inline">\(\sigma\)</span>. This presents
a few problems later on, but these are minimal enough that we can
overlook the issue and move forward.</p>
</div>
<p><br /></p>
<hr />
<p><strong><em>Transformations
<a href="javascript:showhide('transformations')" style="font-size:.6em;color:skyblue;">(Expand)</a></em></strong></p>
<p><span class="expand-caption"><span
class="math inline">\(Y&#39;\)</span>, <span
class="math inline">\(X&#39;\)</span>, and returning to the original
space…</span></p>
<div id="transformations" style="display:none;">
<p>Y transformations are denoted by y-prime, written <span
class="math inline">\(Y&#39;\)</span>, and consist of raising <span
class="math inline">\(Y\)</span> to some power called <span
class="math inline">\(\lambda\)</span>.</p>
<p><span class="math display">\[
  Y&#39; = Y^\lambda \quad \text{(Y Transformation)}
\]</span></p>
<table>
<colgroup>
<col width="35%" />
<col width="42%" />
<col width="21%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Value of <span
class="math inline">\(\lambda\)</span></th>
<th>Transformation to Use</th>
<th>R Code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">-2</td>
<td><span class="math inline">\(Y&#39; = Y^{-2} = 1/Y^2\)</span></td>
<td><code>lm(Y^-2 ~ X)</code></td>
</tr>
<tr class="even">
<td align="center">-1</td>
<td><span class="math inline">\(Y&#39; = Y^{-1} = 1/Y\)</span></td>
<td><code>lm(Y^-1 ~ X)</code></td>
</tr>
<tr class="odd">
<td align="center">0</td>
<td><span class="math inline">\(Y&#39; = \log(Y)\)</span></td>
<td><code>lm(log(Y) ~ X)</code></td>
</tr>
<tr class="even">
<td align="center">0.25</td>
<td><span class="math inline">\(Y&#39; = \sqrt(\sqrt(Y))\)</span></td>
<td><code>lm(sqrt(sqrt(Y)) ~ X)</code></td>
</tr>
<tr class="odd">
<td align="center">0.5</td>
<td><span class="math inline">\(Y&#39; = \sqrt(Y)\)</span></td>
<td><code>lm(sqrt(Y) ~ X)</code></td>
</tr>
<tr class="even">
<td align="center">1</td>
<td><span class="math inline">\(Y&#39; = Y\)</span></td>
<td><code>lm(Y ~ X)</code></td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td><span class="math inline">\(Y&#39; = Y^2\)</span></td>
<td><code>lm(Y^2 ~ X)</code></td>
</tr>
</tbody>
</table>
<p>Using “maximum-likelihood” estimation, the Box-Cox procedure can
actually automatically detect the “optimal” value of <span
class="math inline">\(\lambda\)</span> to consider for a
Y-transformation. Keep in mind however, that simply accepting a
suggested Y-transformation without considering the scatterplot and
diagnostic plots first, is unwise.</p>
<div class="tab">
<p><button class="tablinks" onclick="openTab(event, 'ScatterplotView')">Scatterplot
Recognition</button>
<button class="tablinks" onclick="openTab(event, 'BoxCoxView')">Box-Cox
Suggestion</button>
<button class="tablinks" onclick="openTab(event, 'YTransExample')">An
Example</button></p>
</div>
<div id="ScatterplotView" class="tabcontent" style="display:block;">
<p>
<hr />
<p><strong><em>Scatterplot Recognition</em></strong></p>
<p>The following panel of scatterplots can give you a good feel for when
to try different values of <span
class="math inline">\(\lambda\)</span>.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="dv">5</span>, <span class="dv">50</span>)</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">25</span> <span class="sc">+</span> <span class="fl">3.5</span><span class="sc">*</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(N, <span class="dv">0</span>, <span class="dv">20</span>)</span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>Ya <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(Y)   <span class="co">#1/Y^2   Lam = -2</span></span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>Yb <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>Y         <span class="co">#1/Y     Lam = -1</span></span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>Yc <span class="ot">&lt;-</span> <span class="fu">exp</span>(.<span class="dv">02</span><span class="sc">*</span>Y)  <span class="co">#log(Y)  Lam =  0</span></span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>Yd <span class="ot">&lt;-</span> Y<span class="sc">^</span><span class="dv">2</span>         <span class="co">#sqrt(Y) Lam =  0.5</span></span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>Ye <span class="ot">&lt;-</span> Y           <span class="co">#Y       Lam =  1</span></span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a>Yf <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(Y)     <span class="co">#Y^2     Lam =  2</span></span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mai=</span><span class="fu">c</span>(.<span class="dv">4</span>,.<span class="dv">4</span>,.<span class="dv">3</span>,.<span class="dv">2</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">0</span>))</span>
<span id="cb62-15"><a href="#cb62-15" tabindex="-1"></a></span>
<span id="cb62-16"><a href="#cb62-16" tabindex="-1"></a><span class="fu">plot</span>(Ya <span class="sc">~</span> X, <span class="at">main=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, lambda <span class="sc">==</span> <span class="sc">-</span><span class="dv">2</span>)), <span class="at">ylab=</span><span class="st">&quot;Y in Original Units&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;gray45&quot;</span>, <span class="at">cex=</span><span class="fl">0.9</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xlab=</span><span class="st">&quot;X in Original Units&quot;</span>)</span>
<span id="cb62-17"><a href="#cb62-17" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(Ya<span class="sc">^-</span><span class="dv">2</span> <span class="sc">~</span> X))</span>
<span id="cb62-18"><a href="#cb62-18" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb62-19"><a href="#cb62-19" tabindex="-1"></a></span>
<span id="cb62-20"><a href="#cb62-20" tabindex="-1"></a></span>
<span id="cb62-21"><a href="#cb62-21" tabindex="-1"></a><span class="fu">plot</span>(Yb <span class="sc">~</span> X, <span class="at">main=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, lambda <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>)), <span class="at">ylab=</span><span class="st">&quot;Y in Original Units&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;gray45&quot;</span>, <span class="at">cex=</span><span class="fl">0.9</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xlab=</span><span class="st">&quot;X in Original Units&quot;</span>)</span>
<span id="cb62-22"><a href="#cb62-22" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(Yb<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span> X))</span>
<span id="cb62-23"><a href="#cb62-23" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">1</span><span class="sc">/</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb62-24"><a href="#cb62-24" tabindex="-1"></a></span>
<span id="cb62-25"><a href="#cb62-25" tabindex="-1"></a><span class="fu">plot</span>(Yc <span class="sc">~</span> X, <span class="at">main=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, lambda <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot; i.e., log(...)&quot;</span>)), <span class="at">ylab=</span><span class="st">&quot;Y in Original Units&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;gray45&quot;</span>, <span class="at">cex=</span><span class="fl">0.9</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xlab=</span><span class="st">&quot;X in Original Units&quot;</span>)</span>
<span id="cb62-26"><a href="#cb62-26" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(<span class="fu">log</span>(Yc) <span class="sc">~</span> X))</span>
<span id="cb62-27"><a href="#cb62-27" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb62-28"><a href="#cb62-28" tabindex="-1"></a></span>
<span id="cb62-29"><a href="#cb62-29" tabindex="-1"></a></span>
<span id="cb62-30"><a href="#cb62-30" tabindex="-1"></a><span class="fu">plot</span>(Yd <span class="sc">~</span> X, <span class="at">main=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, lambda <span class="sc">==</span> <span class="fl">0.5</span>)), <span class="at">ylab=</span><span class="st">&quot;Y in Original Units&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;gray45&quot;</span>, <span class="at">cex=</span><span class="fl">0.9</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xlab=</span><span class="st">&quot;X in Original Units&quot;</span>)</span>
<span id="cb62-31"><a href="#cb62-31" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(<span class="fu">sqrt</span>(Yd) <span class="sc">~</span> X))</span>
<span id="cb62-32"><a href="#cb62-32" tabindex="-1"></a><span class="fu">curve</span>((b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x)<span class="sc">^</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb62-33"><a href="#cb62-33" tabindex="-1"></a></span>
<span id="cb62-34"><a href="#cb62-34" tabindex="-1"></a><span class="fu">plot</span>(Ye <span class="sc">~</span> X, <span class="at">main=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, lambda <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot; (No Transformation)&quot;</span>)), <span class="at">ylab=</span><span class="st">&quot;Y in Original Units&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;gray45&quot;</span>, <span class="at">cex=</span><span class="fl">0.9</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xlab=</span><span class="st">&quot;X in Original Units&quot;</span>)</span>
<span id="cb62-35"><a href="#cb62-35" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(Ye <span class="sc">~</span> X))</span>
<span id="cb62-36"><a href="#cb62-36" tabindex="-1"></a><span class="fu">curve</span>((b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb62-37"><a href="#cb62-37" tabindex="-1"></a></span>
<span id="cb62-38"><a href="#cb62-38" tabindex="-1"></a><span class="fu">plot</span>(Yf <span class="sc">~</span> X, <span class="at">main=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, lambda <span class="sc">==</span> <span class="dv">2</span>)), </span>
<span id="cb62-39"><a href="#cb62-39" tabindex="-1"></a><span class="at">ylab=</span><span class="st">&quot;Y in Original Units&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;gray45&quot;</span>, <span class="at">cex=</span><span class="fl">0.9</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xlab=</span><span class="st">&quot;X in Original Units&quot;</span>)</span>
<span id="cb62-40"><a href="#cb62-40" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(Yf<span class="sc">^</span><span class="dv">2</span> <span class="sc">~</span> X))</span>
<span id="cb62-41"><a href="#cb62-41" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">sqrt</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
</p>
</div>
<div id="BoxCoxView" class="tabcontent">
<p>
<hr />
<p><strong><em>Box-Cox Suggestion</em></strong></p>
<p>The <code>boxCox(...)</code> function in <code>library(car)</code>
can also be helpful on finding values of <span
class="math inline">\(\lambda\)</span> to try.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mai=</span><span class="fu">c</span>(.<span class="dv">4</span>,.<span class="dv">4</span>,.<span class="dv">3</span>,.<span class="dv">2</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">0.5</span>,<span class="dv">0</span>))</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a><span class="fu">boxCox</span>(<span class="fu">lm</span>(Ya <span class="sc">~</span> X))</span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">text=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, lambda <span class="sc">==</span> <span class="sc">-</span><span class="dv">2</span>)), <span class="at">line=</span>.<span class="dv">5</span>)</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a><span class="fu">boxCox</span>(<span class="fu">lm</span>(Yb <span class="sc">~</span> X))</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">text=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, lambda <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>)), <span class="at">line=</span>.<span class="dv">5</span>)</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a><span class="fu">boxCox</span>(<span class="fu">lm</span>(Yc <span class="sc">~</span> X))</span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">text=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, lambda <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot; i.e., log(...)&quot;</span>)), <span class="at">line=</span>.<span class="dv">5</span>)</span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" tabindex="-1"></a><span class="fu">boxCox</span>(<span class="fu">lm</span>(Yd <span class="sc">~</span> X))</span>
<span id="cb63-13"><a href="#cb63-13" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">text=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, lambda <span class="sc">==</span> <span class="fl">0.5</span>)), <span class="at">line=</span>.<span class="dv">5</span>)</span>
<span id="cb63-14"><a href="#cb63-14" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" tabindex="-1"></a><span class="fu">boxCox</span>(<span class="fu">lm</span>(Ye <span class="sc">~</span> X))</span>
<span id="cb63-16"><a href="#cb63-16" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">text=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, lambda <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot; (No Transformation)&quot;</span>)), <span class="at">line=</span>.<span class="dv">5</span>)</span>
<span id="cb63-17"><a href="#cb63-17" tabindex="-1"></a></span>
<span id="cb63-18"><a href="#cb63-18" tabindex="-1"></a><span class="fu">boxCox</span>(<span class="fu">lm</span>(Yf <span class="sc">~</span> X))</span>
<span id="cb63-19"><a href="#cb63-19" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">text=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, lambda <span class="sc">==</span> <span class="dv">2</span>)), <span class="at">line=</span>.<span class="dv">5</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
</p>
</div>
<div id="YTransExample" class="tabcontent">
<p>
<hr />
<p><strong><em>An Example</em></strong></p>
<p>Suppose we were running a simple linear regression on the
<code>cars</code> dataset.</p>
<p>This would be done with the code</p>
<p><code>cars.lm &lt;- lm(dist ~ speed, data=cars)</code></p>
<p><code>summary(cars.lm)</code></p>
<p>Notice the line doesn’t quite fit the data as well as we would hope.
Instead, the data looks a little curved.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a>cars.lm <span class="ot">&lt;-</span><span class="fu">lm</span>(dist <span class="sc">~</span> speed,<span class="at">data=</span>cars)</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a><span class="fu">plot</span>(dist <span class="sc">~</span> speed, <span class="at">data=</span>cars, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Speed of the Vehicle (mph) </span><span class="sc">\n</span><span class="st"> the Moment the Brakes were Applied&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Distance (ft) it took the Vehicle to Stop&quot;</span>,</span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Don&#39;t Step in front of a Moving 1920&#39;s Vehicle...&quot;</span>)</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">text=</span><span class="st">&quot;...they take a few feet to stop.&quot;</span>, <span class="at">cex=</span><span class="fl">0.7</span>, <span class="at">line=</span>.<span class="dv">5</span>)</span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="st">&quot;Stopping Distance Experiment&quot;</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a><span class="fu">abline</span>(cars.lm, <span class="at">col=</span><span class="st">&quot;gray&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<p>Using the <code>boxCox(...)</code> function from
<code>library(car)</code> we would compute the following to determine
which Y-transformation would be most meaningful.</p>
<p><code>library(car)</code></p>
<p><code>boxCox(cars.lm)</code></p>
<p>The output from the <code>boxCox(...)</code> function looks as
follows.</p>
<p><img src="index_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
<p>This plot tells use to use the <span class="math inline">\(\lambda =
0.5\)</span> transformation, so that <span class="math inline">\(Y&#39;
= Y^0.5 = \sqrt{Y}\)</span>. (To see this yourself, click on the
“Box-Cox Suggestion” tab above, as well as on the “Scatterplot
Recognition” tab.)</p>
<p>Now, a transformation regression is performed using
<code>sqrt(Y)</code> in place of <code>Y</code> as follows:</p>
<p><code>cars.lm.t &lt;- lm(sqrt(dist) ~ speed, data=cars)</code></p>
<p><code>summary(cars.lm.t)</code></p>
<table>
<thead>
<tr class="header">
<th> </th>
<th>Estimate</th>
<th>Std. Error</th>
<th>t value</th>
<th>Pr(&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>(Intercept)</strong></td>
<td>1.277</td>
<td>0.4844</td>
<td>2.636</td>
<td>0.01126</td>
</tr>
<tr class="even">
<td><strong>speed</strong></td>
<td>0.3224</td>
<td>0.02978</td>
<td>10.83</td>
<td>1.773e-14</td>
</tr>
</tbody>
</table>
<p>Then,</p>
<p><span class="math display">\[
  \widehat{Y}_i&#39; = 1.277 + 0.3224 X_i
\]</span></p>
<p>And replacing <span class="math inline">\(\hat{Y}_i&#39; =
\sqrt{\hat{Y}_i}\)</span> we have</p>
<p><span class="math display">\[
  \sqrt{\widehat{Y}_i} = 1.277 + 0.3224 X_i
\]</span></p>
<p>Solving for <span class="math inline">\(\hat{Y}_i\)</span> gives</p>
<p><span class="math display">\[
  \widehat{Y}_i = (1.277 + 0.3224 X_i)^2
\]</span></p>
<p>Which, using <code>curve((1.277 + 0.3224*x)^2, add=TRUE)</code> (see
code for details) looks like this:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="fu">plot</span>(dist <span class="sc">~</span> speed, <span class="at">data=</span>cars, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Speed of the Vehicle (mph) </span><span class="sc">\n</span><span class="st"> the Moment the Brakes were Applied&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Distance (ft) it took the Vehicle to Stop&quot;</span>,</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Don&#39;t Step in front of a Moving 1920&#39;s Vehicle...&quot;</span>)</span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">text=</span><span class="st">&quot;...they take a few feet to stop.&quot;</span>, <span class="at">cex=</span><span class="fl">0.7</span>, <span class="at">line=</span>.<span class="dv">5</span>)</span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="st">&quot;Stopping Distance Experiment&quot;</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a><span class="fu">curve</span>( (<span class="fl">1.277</span> <span class="sc">+</span> <span class="fl">0.3224</span><span class="sc">*</span>x)<span class="sc">^</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
</p>
</div>
<p><br /></p>
<hr />
<p><strong><em>X-Transformations</em></strong></p>
<p>X-transformations are more difficult to recognize than
y-transformations. This is partially because there is no Box-Cox method
to automatically search for them.</p>
<p>The best indicator that you should consider an x-transformation is
when the variance of the residuals is constant across all fitted-values,
but linearity is clearly violated.</p>
<p>The following panel of scatterplots can give you a good feel for when
to try different values of an x-transformation.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="dv">5</span>, <span class="dv">50</span>)</span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">25</span> <span class="sc">+</span> <span class="fl">3.5</span><span class="sc">*</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(N, <span class="dv">0</span>, <span class="dv">20</span>)</span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>Xa <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(X)   <span class="co">#1/X^2   Lam = -2</span></span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>Xb <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>X         <span class="co">#1/X     Lam = -1</span></span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a>Xc <span class="ot">&lt;-</span> <span class="fu">exp</span>(.<span class="dv">02</span><span class="sc">*</span>X)  <span class="co">#log(X)  Lam =  0</span></span>
<span id="cb66-9"><a href="#cb66-9" tabindex="-1"></a>Xd <span class="ot">&lt;-</span> X<span class="sc">^</span><span class="dv">2</span>         <span class="co">#sqrt(X) Lam =  0.5</span></span>
<span id="cb66-10"><a href="#cb66-10" tabindex="-1"></a>Xe <span class="ot">&lt;-</span> X           <span class="co">#X       Lam =  1</span></span>
<span id="cb66-11"><a href="#cb66-11" tabindex="-1"></a>Xf <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(X)     <span class="co">#X^2     Lam =  2</span></span>
<span id="cb66-12"><a href="#cb66-12" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" tabindex="-1"></a></span>
<span id="cb66-14"><a href="#cb66-14" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mai=</span><span class="fu">c</span>(.<span class="dv">4</span>,.<span class="dv">4</span>,.<span class="dv">3</span>,.<span class="dv">2</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">0</span>))</span>
<span id="cb66-15"><a href="#cb66-15" tabindex="-1"></a></span>
<span id="cb66-16"><a href="#cb66-16" tabindex="-1"></a><span class="fu">plot</span>(Y <span class="sc">~</span> Xa, <span class="at">main=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, X<span class="sc">*</span>minute <span class="sc">==</span> X<span class="sc">^-</span><span class="dv">2</span>)), <span class="at">ylab=</span><span class="st">&quot;Y in Original Units&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;gray45&quot;</span>, <span class="at">cex=</span><span class="fl">0.9</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xlab=</span><span class="st">&quot;X in Original Units&quot;</span>)</span>
<span id="cb66-17"><a href="#cb66-17" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(Y <span class="sc">~</span> <span class="fu">I</span>(Xa<span class="sc">^-</span><span class="dv">2</span>)))</span>
<span id="cb66-18"><a href="#cb66-18" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x<span class="sc">^-</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb66-19"><a href="#cb66-19" tabindex="-1"></a></span>
<span id="cb66-20"><a href="#cb66-20" tabindex="-1"></a></span>
<span id="cb66-21"><a href="#cb66-21" tabindex="-1"></a><span class="fu">plot</span>(Y <span class="sc">~</span> Xb, <span class="at">main=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, X<span class="sc">*</span>minute <span class="sc">==</span> X<span class="sc">^-</span><span class="dv">1</span>)), <span class="at">ylab=</span><span class="st">&quot;Y in Original Units&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;gray45&quot;</span>, <span class="at">cex=</span><span class="fl">0.9</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xlab=</span><span class="st">&quot;X in Original Units&quot;</span>)</span>
<span id="cb66-22"><a href="#cb66-22" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(Y <span class="sc">~</span> <span class="fu">I</span>(Xb<span class="sc">^-</span><span class="dv">1</span>)))</span>
<span id="cb66-23"><a href="#cb66-23" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x<span class="sc">^-</span><span class="dv">1</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb66-24"><a href="#cb66-24" tabindex="-1"></a></span>
<span id="cb66-25"><a href="#cb66-25" tabindex="-1"></a><span class="fu">plot</span>(Y <span class="sc">~</span> Xc, <span class="at">main=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, X<span class="sc">*</span>minute <span class="sc">==</span> <span class="fu">log</span>(X))), <span class="at">ylab=</span><span class="st">&quot;Y in Original Units&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;gray45&quot;</span>, <span class="at">cex=</span><span class="fl">0.9</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xlab=</span><span class="st">&quot;X in Original Units&quot;</span>)</span>
<span id="cb66-26"><a href="#cb66-26" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(Y <span class="sc">~</span> <span class="fu">log</span>(Xc)))</span>
<span id="cb66-27"><a href="#cb66-27" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">log</span>(x), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb66-28"><a href="#cb66-28" tabindex="-1"></a></span>
<span id="cb66-29"><a href="#cb66-29" tabindex="-1"></a></span>
<span id="cb66-30"><a href="#cb66-30" tabindex="-1"></a><span class="fu">plot</span>(Y <span class="sc">~</span> Xd, <span class="at">main=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, X<span class="sc">*</span>minute <span class="sc">==</span> <span class="fu">sqrt</span>(X))), <span class="at">ylab=</span><span class="st">&quot;Y in Original Units&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;gray45&quot;</span>, <span class="at">cex=</span><span class="fl">0.9</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xlab=</span><span class="st">&quot;X in Original Units&quot;</span>)</span>
<span id="cb66-31"><a href="#cb66-31" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(Y <span class="sc">~</span> <span class="fu">sqrt</span>(Xd)))</span>
<span id="cb66-32"><a href="#cb66-32" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(x), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb66-33"><a href="#cb66-33" tabindex="-1"></a></span>
<span id="cb66-34"><a href="#cb66-34" tabindex="-1"></a><span class="fu">plot</span>(Y <span class="sc">~</span> Xe, <span class="at">main=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, X<span class="sc">*</span>minute <span class="sc">==</span> X, <span class="st">&quot; (No Transformation)&quot;</span>)), <span class="at">ylab=</span><span class="st">&quot;Y in Original Units&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;gray45&quot;</span>, <span class="at">cex=</span><span class="fl">0.9</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xlab=</span><span class="st">&quot;X in Original Units&quot;</span>)</span>
<span id="cb66-35"><a href="#cb66-35" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(Y <span class="sc">~</span> Xe))</span>
<span id="cb66-36"><a href="#cb66-36" tabindex="-1"></a><span class="fu">curve</span>((b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb66-37"><a href="#cb66-37" tabindex="-1"></a></span>
<span id="cb66-38"><a href="#cb66-38" tabindex="-1"></a><span class="fu">plot</span>(Y <span class="sc">~</span> Xf, <span class="at">main=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Use &quot;</span>, X<span class="sc">*</span>minute <span class="sc">==</span> X<span class="sc">^</span><span class="dv">2</span>)), </span>
<span id="cb66-39"><a href="#cb66-39" tabindex="-1"></a><span class="at">ylab=</span><span class="st">&quot;Y in Original Units&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;gray45&quot;</span>, <span class="at">cex=</span><span class="fl">0.9</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xlab=</span><span class="st">&quot;X in Original Units&quot;</span>)</span>
<span id="cb66-40"><a href="#cb66-40" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(Y <span class="sc">~</span> <span class="fu">I</span>(Xf<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb66-41"><a href="#cb66-41" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
</div>
<p><br /></p>
<hr />
<p><strong><em>Inference for the Model Parameters
<a href="javascript:showhide('inference1')" style="font-size:.6em;color:skyblue;" id="infModelParam">(Expand)</a></em></strong></p>
<p><span class="expand-caption">t test formulas, sampling distributions,
confidence intervals, and F tests…</span></p>
<div id="inference1" style="display:none;">
<p>When fitting the regression model given by the equation</p>
<p><span class="math display">\[
  Y_i = \beta_0 + \beta_1 X_i + \epsilon_i \quad \text{where} \
\epsilon_i \sim N(0, \sigma^2)
\]</span> to a sample of data, we typically test hypotheses about the
parameters <span class="math inline">\(\beta_0\)</span>, <span
class="math inline">\(\beta_1\)</span>, or both.</p>
<table class="fancytable">
<tr>
<th>
<strong>Hypotheses</strong>
</th>
<th>
<strong>Test Statistic</strong>
</th>
<th>
<strong>P-value</strong>
</th>
</tr>
<tr>
<td style="text-align:center;width:25%;">
<p><span class="math inline">\(H_0: \beta_0 =\)</span> <span
class="tooltiprbold"> <span class="math inline">\(\underbrace{0}_\text{a
number}\)</span> <span class="tooltiprtext">This could be any number,
not just 0. However, the default summar(mylm) output in R only shows the
test statistic and p-value for the test that uses 0. To test a different
value, you would need to compute the test statistic and p-value by hand
using the formula shown.</span> </span></p>
<p><span class="math inline">\(H_a: \beta_0\)</span><span
class="tooltiprbold"> <span class="math inline">\(\,\neq\,\)</span>
<span class="tooltiprtext">You could use <span
class="math inline">\(&gt;\)</span> or <span
class="math inline">\(&lt;\)</span> instead of <span
class="math inline">\(\neq\)</span> for the alternative hypothesis. By
default, the p-value from summary(mylm) in R uses <span
class="math inline">\(\neq\)</span>.</span> </span><span
class="tooltiprbold"> <span class="math inline">\(\underbrace{0}_\text{a
number}\)</span> <span class="tooltiprtext">This could be any number,
not just 0. However, the default summar(mylm) output in R only shows the
test statistic and p-value for the test that uses 0. To test a different
value, you would need to compute the test statistic and p-value by hand
using the formula shown.</span> </span></p>
</td>
<td style="text-align:center;width:25%;">
<p><span class="tooltiprbold"> <span class="math display">\[t =
\frac{b_0 - \overbrace{0}^\text{a number}}{s_{b_0}}\]</span> <span
class="tooltiprtext">This is the formula for the test statistic. It
measures how far the estimated y-intercept <span
class="math inline">\(b_0\)</span> is from the null hypothesis for <span
class="math inline">\(\beta_0\)</span> in units of “standard errors of
<span class="math inline">\(b_0\)</span>”. Thus the division by <span
class="math inline">\(s_{b_0}\)</span>. Though the hypothesized value of
<span class="math inline">\(\beta_0\)</span> is typically 0, it could be
any number.</span> </span></p>
</td>
<td style="text-align:center;width:50%;">
<p><a href="https://byuimath.com/apps/normprobwitht.html" target="_blank" title="Go to t applet"></p>
<p><img src="index_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
</a>
</td>
</tr>
<tr>
<td style="text-align:center;width:25%;">
<p><span class="math inline">\(H_0: \beta_1 =\)</span> <span
class="tooltiprbold"> <span class="math inline">\(\underbrace{0}_\text{a
number}\)</span> <span class="tooltiprtext">This could be any number,
not just 0. However, the default summar(mylm) output in R only shows the
test statistic and p-value for the test that uses 0. To test a different
value, you would need to compute the test statistic and p-value by hand
using the formula shown.</span> </span></p>
<p><span class="math inline">\(H_a: \beta_1\)</span><span
class="tooltiprbold"> <span class="math inline">\(\,\neq\,\)</span>
<span class="tooltiprtext">You could use <span
class="math inline">\(&gt;\)</span> or <span
class="math inline">\(&lt;\)</span> instead of <span
class="math inline">\(\neq\)</span> for the alternative hypothesis. By
default, the p-value from summary(mylm) in R uses <span
class="math inline">\(\neq\)</span>.</span> </span><span
class="tooltiprbold"> <span class="math inline">\(\underbrace{0}_\text{a
number}\)</span> <span class="tooltiprtext">This could be any number,
not just 0. However, the default summar(mylm) output in R only shows the
test statistic and p-value for the test that uses 0. To test a different
value, you would need to compute the test statistic and p-value by hand
using the formula shown.</span> </span></p>
</td>
<td style="text-align:center;width:25%;">
<p><span class="tooltiprbold"> <span class="math display">\[t =
\frac{b_1 - \overbrace{0}^\text{a number}}{s_{b_1}}\]</span> <span
class="tooltiprtext">This is the formula for the test statistic. It
measures how far the estimated slope <span
class="math inline">\(b_1\)</span> is from the null hypothesis for <span
class="math inline">\(\beta_1\)</span> in units of “standard errors of
<span class="math inline">\(b_1\)</span>”. Thus the division by <span
class="math inline">\(s_{b_1}\)</span>. Though the hypothesized value of
<span class="math inline">\(\beta_1\)</span> is typically 0, it could be
any number.</span> </span></p>
</td>
<td>
<p>Left-tailed p-value =
<code>pt(-abs(tvalue), degrees of freedom)</code>.</p>
Double it to get the two-sided p-value.
</td>
</tr>
</table>
<p><br></p>
<p>In R, these values correspond to the output summary of an lm as
follows.</p>
<p><br></p>
<p><img src="Images/summaryOutputLabeled.png"></p>
<p><a href="javascript:showhide('ttestexample')" style="font-size:.9em;color:skyblue;">(Show
Example)</a></p>
<div id="ttestexample" style="display:none;">
<p>Consider the <code>cars</code> data in R. Suppose we used the
regression model given by</p>
<p><span class="math display">\[
  \underbrace{Y_i}_\text{Feet to Stop} = \beta_0 + \beta_1
\underbrace{X_{i}}_\text{mph} + \epsilon_i \quad \text{where} \
\epsilon_i \quad \sim N(0,\sigma^2)
\]</span> to model the feet a vehicle (from the 1920’s) takes to stop
when traveling at a certain speed (in miles per hour, mph) prior to
stopping. When the regression is performed and summarized in R, it is
always testing the following two hypotheses:</p>
<p><span class="math display">\[
H_0: \beta_0 = 0 \quad\quad H_0: \beta_1 = 0 \\
H_a: \beta_0 \neq 0 \quad\quad H_a: \beta_1 \neq 0
\]</span></p>
<p>To perform the test of these hypotheses for the regression stated
above, we would run the following codes in R.</p>
<p><code>cars.lm &lt;- lm(dist ~ speed, data=cars)</code></p>
<p><code>pander(summary(cars.lm)$coefficients)</code></p>
<p>These would produce summary output like the following, but the
following output has been labeled with the math notation corresponding
to each value.</p>
<p><img src="Images/summaryOutputLabeled.png"></p>
<p>Let’s emphasize what is happening in this summary output table.</p>
<p>First, here is how the “t value” is calculated for the “(Intercept)”
in the summary table above.</p>
<p><span class="math display">\[
t = \frac{b_0-0}{s_{b_0}} = \frac{-17.58 - 0}{6.758} = -2.601
\]</span> Second, here is a visual representation of how the P-value,
the “Pr(&gt;|t|)” as it is called in the summary table above, is
calculated for this test statistic. (Click the graph to view an
interactive applet showing this calculation.) Notice both ends of the
t-distribution are being shaded to compute the P-value because the
alternative hypothesis was <span class="math inline">\(H_a: \beta_0 \neq
0\)</span>.</p>
<p><a href="https://byuimath.com/apps/normprobwitht.html?z=-2.601&df=48" target="_blank" title="Click to View in t Applet"></p>
<p><img src="index_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
<p></a></p>
<p>To compute the P-value in R, we use the “percentile function for the
t-distribution” called <code>pt( )</code>. This function requires two
things, the t-value and the degrees of freedom, in our case
<code>pt(-2.601, 48)</code>. Note the degrees of freedom (df) are 48
because the sample size is <span class="math inline">\(n=50\)</span> and
there are two parameters (<span class="math inline">\(\beta_0\)</span>
and <span class="math inline">\(\beta_1\)</span>) in our regression
model.</p>
<p>Running this code in R gives: <code>pt(-2.601, 48)</code> =
0.00616</p>
<p>However, note that this value is only half of the actual P-value of
0.0123. To get the “two-sided” P-value (note that our alternative
hypothesis used a <span class="math inline">\(\neq\)</span> symbol) we
need to double this left-tailed P-value.</p>
<p><code>2*pt(-2.601, 48))</code> = 0.0123</p>
<p>Finally, note that the same procedure can be used to test hypotheses
that use a value other than 0 in the null and alternative. For example,
to test the hypotheses:</p>
<p><span class="math display">\[
H_0: \beta_1 = 3 \\
H_a: \beta_1 \neq 3
\]</span> Use the t-formula</p>
<p><span class="math display">\[
  t = \frac{b_1 - 3}{s_{b_1}} = \frac{\overbrace{3.932}^{b_1} -
\overbrace{3}^{H_0}}{\underbrace{0.4155}_{s_{b_1}}} = 2.243
\]</span> then the P-value is calculated in R by</p>
<p><code>2*pt(-abs(2.243), 48)</code> = 0.0295495</p>
<hr>
</div>
<p><br/></p>
<p>To obtain confidence intervals in R use
<code>confint(mylm)</code>.</p>
<table class="fancytable">
<tr>
<th>
<strong>Confidence Interval</strong>
</th>
<th>
<strong>Formula</strong>
</th>
<th>
<strong>Standard Error</strong>
</th>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(\beta_0\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(b_0 \pm\)</span><span class="tooltiprbold">
<span class="math inline">\(t^*\)</span> <span class="tooltiprtext">This
is called the “critical value” and denotes the number of standard
deviations that are needed to obtain a 95% confidence interval from a t
distribution with degrees of freedom <span
class="math inline">\(n-p\)</span>. Use <code>qt(0.975, df)</code> to
get <span class="math inline">\(t*\)</span> in R.</span> </span><span
class="tooltiprbold"> <span class="math inline">\(\cdot\)</span> <span
class="tooltiprtext">The critical value is multiplied by the standard
error of <span class="math inline">\(b_0\)</span>.</span> </span><span
class="tooltiprbold"> <span class="math inline">\(s_{b_0}\)</span> <span
class="tooltiprtext">The standard error of <span
class="math inline">\(b_0\)</span>, denoted by <span
class="math inline">\(s_{b_0}\)</span> is provided in the regression
summary output under the column header called “Std. Error” for the
“(Intercept)” row of the output. It is calculated using the formula
shown below.</span> </span>
</td>
<td style="text-align:center;">
<span class="tooltiprbold"> <span class="math display">\[s^2_{b_0} =
MSE\left[\frac{1}{n} +
\frac{\bar{X}^2}{\sum(X_i-\bar{X})^2}\right]\]</span> <span
class="tooltiprtext">This is called the “estimated variance of <span
class="math inline">\(b_0\)</span>”. Taking the square root of this
number gives the “standard error of <span
class="math inline">\(b_0\)</span>”.</span> </span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(\beta_1\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(b_1 \pm\)</span><span class="tooltiprbold">
<span class="math inline">\(t^*\)</span> <span class="tooltiprtext">This
is called the “critical value” and denotes the number of standard
deviations that are needed to obtain a 95% confidence interval from a t
distribution with degrees of freedom <span
class="math inline">\(n-p\)</span> (sample size - number of parameters
in the regression model). Use <code>qt(0.975, df)</code> to get <span
class="math inline">\(t*\)</span> in R</span> </span><span
class="tooltiprbold"> <span class="math inline">\(\cdot\)</span> <span
class="tooltiprtext">The critical value is multiplied by the standard
error of <span class="math inline">\(b_1\)</span>.</span> </span><span
class="tooltiprbold"> <span class="math inline">\(s_{b_1}\)</span> <span
class="tooltiprtext">The standard error of <span
class="math inline">\(b_1\)</span>, denoted by <span
class="math inline">\(s_{b_1}\)</span> is provided in the regression
summary output under the column header called “Std. Error”. It is
calculated using the formula shown below.</span> </span>
</td>
<td style="text-align:center;">
<span class="tooltiprbold"> <span class="math display">\[s^2_{b_1} =
\frac{MSE}{\sum(X_i-\bar{X})^2}\]</span> <span class="tooltiprtext">This
is called the “estimated variance of <span
class="math inline">\(b_1\)</span>”. Taking the square root of this
number gives the “standard error of <span
class="math inline">\(b_1\)</span>”.</span> </span>
</td>
</tr>
</table>
<p>To be more exact, the types of inference we are interested in are the
following.</p>
<ol style="list-style-type: decimal">
<li><p>Determine if there is evidence of a meaningful linear
relationship in the data. If <span class="math inline">\(\beta_1 =
0\)</span>, then there is no relation between <span
class="math inline">\(X\)</span> and <span
class="math inline">\(E\{Y\}\)</span>. Hence we might be interested in
testing the hypotheses <span class="math display">\[
  H_0: \beta_1 = 0
\]</span> <span class="math display">\[
  H_a: \beta_1 \neq 0
\]</span></p></li>
<li><p>Determine if the slope is greater, less than, or different from
some other hypothesized value. In this case, we would be interested in
using hypotheses of the form <span class="math display">\[
  H_0: \beta_1 = \beta_{10}
\]</span> <span class="math display">\[
  H_a: \beta_1 \neq \beta_{10}
\]</span> where <span class="math inline">\(\beta_{10}\)</span> is some
hypothesized number.</p></li>
<li><p>To provide a confidence interval for the true value of <span
class="math inline">\(\beta_1\)</span>.</p></li>
</ol>
<p><br /></p>
<p>Before we discuss how to test the hypotheses listed above or
construct a confidence interval, we must understand the <strong>sampling
distribution</strong> of the estimate <span
class="math inline">\(b_1\)</span> of the parameter <span
class="math inline">\(\beta_1\)</span>. And, while we are at it, we may
as well come to understand the sampling distribution of the estimate
<span class="math inline">\(b_0\)</span> of the parameter <span
class="math inline">\(\beta_0\)</span>.</p>
<div style="padding-left:30px;color:darkgray;font-size:.8em;">
<p>Review <a
href="http://statistics.byuimath.com/index.php?title=Lesson_6:_Distribution_of_Sample_Means_%26_The_Central_Limit_Theorem#Introduction_to_Sampling_Distributions">sampling
distributions</a> from Math 221.</p>
</div>
<p>Since <span class="math inline">\(b_1\)</span> is an estimate, it
will vary from sample to sample, even though the truth, <span
class="math inline">\(\beta_1\)</span>, remains fixed. (The same holds
for <span class="math inline">\(b_0\)</span> and <span
class="math inline">\(\beta_0\)</span>.) It turns out that the sampling
distribution of <span class="math inline">\(b_1\)</span> (where the
<span class="math inline">\(X\)</span> values remain fixed from study to
study) is normal with mean and variance: <span class="math display">\[
  \mu_{b_1} = \beta_1
\]</span> <span class="math display">\[
  \sigma^2_{b_1} = \frac{\sigma^2}{\sum(X_i-\bar{X})^2}
\]</span></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="do">## Simulation to Show relationship between Standard Errors</span></span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a><span class="do">##-----------------------------------------------</span></span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a><span class="do">## Edit anything in this area... </span></span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co">#sample size</span></span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a>Xstart <span class="ot">&lt;-</span> <span class="dv">30</span> <span class="co">#lower-bound for x-axis</span></span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a>Xstop <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co">#upper-bound for x-axis</span></span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co">#choice of true y-intercept</span></span>
<span id="cb67-11"><a href="#cb67-11" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="fl">3.5</span> <span class="co">#choice of true slope</span></span>
<span id="cb67-12"><a href="#cb67-12" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">13.8</span> <span class="co">#choice of st. deviation of error terms</span></span>
<span id="cb67-13"><a href="#cb67-13" tabindex="-1"></a></span>
<span id="cb67-14"><a href="#cb67-14" tabindex="-1"></a><span class="do">## End of Editable area.</span></span>
<span id="cb67-15"><a href="#cb67-15" tabindex="-1"></a><span class="do">##-----------------------------------------------</span></span>
<span id="cb67-16"><a href="#cb67-16" tabindex="-1"></a></span>
<span id="cb67-17"><a href="#cb67-17" tabindex="-1"></a></span>
<span id="cb67-18"><a href="#cb67-18" tabindex="-1"></a><span class="co"># Create X, which will be used in the next R-chunk.</span></span>
<span id="cb67-19"><a href="#cb67-19" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">seq</span>(Xstart,Xstop, <span class="at">length.out=</span>n<span class="sc">/</span><span class="dv">2</span>), <span class="at">each=</span><span class="dv">2</span>) </span>
<span id="cb67-20"><a href="#cb67-20" tabindex="-1"></a></span>
<span id="cb67-21"><a href="#cb67-21" tabindex="-1"></a><span class="do">## After playing this chunk, play the next chunk as well.</span></span></code></pre></div>
<p>To see that this is true, consider the regression model with values
specified for each parameter as follows.</p>
<p><span class="math display">\[
  Y_i = \overbrace{\beta_0}^{2} + \overbrace{\beta_1}^{3.5} X_i +
\epsilon_i \quad \text{where} \ \epsilon_i \sim N(0,
\overbrace{\sigma^2}^{\sigma=13.8})
\]</span></p>
<p>Using the equations above for <span
class="math inline">\(\mu_{b_1}\)</span> and <span
class="math inline">\(\sigma^2_{b_1}\)</span> we obtain that the mean of
the sampling distribution of <span class="math inline">\(b_1\)</span>
will be</p>
<p><span class="math inline">\(\mu_{b_1} = \beta_1 = 3.5\)</span></p>
<p>Further, we see that the variance of the sampling distribution of
<span class="math inline">\(b_1\)</span> will be</p>
<p><span class="math inline">\(\sigma^2_{b_1} =
\frac{\sigma^2}{\sum(X_i-\bar{X})^2} = \frac{13.8^2}{4.25\times
10^{4}}\)</span></p>
<p>Taking the square root of the variance, the standard deviation of the
sampling distribution of <span class="math inline">\(b_1\)</span> will
be</p>
<p><span class="math inline">\(\sigma_{b_1} = 0.067\)</span>.</p>
<p>That’s very nice. But to really believe it, let’s run a simulation
ourselves. The “Code” below is worth studying. It runs a simulation that
(1) takes a sample of data from the true regression relation, (2) fits
the sampled data with an estimated regression equation (gray lines in
the plot), and (3) computes the estimated values of <span
class="math inline">\(b_1\)</span> and <span
class="math inline">\(b_0\)</span> for that regression.</p>
<p>After doing this many, many times, the results of every single
regression are plotted (in gray lines, which creates a gray shaded
region because there are so many lines) in the scatterplot below.
Further, each obtained estimate of <span
class="math inline">\(b_0\)</span> is plotted in the histogram on the
left (below the scatterplot) and each obtained estimate of <span
class="math inline">\(b_1\)</span> is plotted in the histogram on the
right. Looking at the histograms carefully, it can be seen that the mean
of each histogram is very close to the true parameter value of <span
class="math inline">\(\beta_0\)</span> or <span
class="math inline">\(\beta_1\)</span>, respectively. Also, the “Std.
Error” of each histogram is incredibly close (if not exact to 3 decimal
places) to the computed value of <span
class="math inline">\(\sigma_{b_0}\)</span> and <span
class="math inline">\(\sigma_{b_1}\)</span>, respectively. Amazing!</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#number of times to pull a random sample</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>storage_b0 <span class="ot">&lt;-</span> storage_b1 <span class="ot">&lt;-</span> storage_rmse <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, N)</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> beta_0 <span class="sc">+</span> beta_1<span class="sc">*</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma) <span class="co">#Sample Y from true model</span></span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>  mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>  storage_b0[i] <span class="ot">&lt;-</span> <span class="fu">coef</span>(mylm)[<span class="dv">1</span>]</span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>  storage_b1[i] <span class="ot">&lt;-</span> <span class="fu">coef</span>(mylm)[<span class="dv">2</span>]</span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>  storage_rmse[i] <span class="ot">&lt;-</span> <span class="fu">summary</span>(mylm)<span class="sc">$</span>sigma</span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a>}</span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" tabindex="-1"></a></span>
<span id="cb68-12"><a href="#cb68-12" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dv">2</span>, <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>), <span class="at">widths=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">heights=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb68-13"><a href="#cb68-13" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" tabindex="-1"></a>Ystart <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#min(0,min(Y)) </span></span>
<span id="cb68-15"><a href="#cb68-15" tabindex="-1"></a>Ystop <span class="ot">&lt;-</span> <span class="dv">500</span> <span class="co">#max(max(Y), 0)</span></span>
<span id="cb68-16"><a href="#cb68-16" tabindex="-1"></a>Yrange <span class="ot">&lt;-</span> Ystop <span class="sc">-</span> Ystart</span>
<span id="cb68-17"><a href="#cb68-17" tabindex="-1"></a></span>
<span id="cb68-18"><a href="#cb68-18" tabindex="-1"></a><span class="fu">plot</span>(Y <span class="sc">~</span> X, <span class="at">xlim=</span><span class="fu">c</span>(<span class="fu">min</span>(<span class="dv">0</span>,Xstart<span class="dv">-2</span>), <span class="fu">max</span>(<span class="dv">0</span>,Xstop<span class="sc">+</span><span class="dv">2</span>)), </span>
<span id="cb68-19"><a href="#cb68-19" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(Ystart, Ystop), <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;gray&quot;</span>,</span>
<span id="cb68-20"><a href="#cb68-20" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Regression Lines from many Samples (gray lines) </span><span class="sc">\n</span><span class="st"> Plus Residual Standard Deviation Lines (green lines)&quot;</span>)</span>
<span id="cb68-21"><a href="#cb68-21" tabindex="-1"></a><span class="fu">text</span>(Xstart, Ystop, <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(sigma)), <span class="at">pos=</span><span class="dv">1</span>)</span>
<span id="cb68-22"><a href="#cb68-22" tabindex="-1"></a><span class="fu">text</span>(Xstart, Ystop<span class="fl">-.1</span><span class="sc">*</span>Yrange, <span class="fu">bquote</span>(<span class="fu">sum</span> ((x[i]<span class="sc">-</span><span class="fu">bar</span>(x))<span class="sc">^</span><span class="dv">2</span>, i<span class="sc">==</span><span class="dv">1</span>, n) <span class="sc">==</span> .(<span class="fu">var</span>(X)<span class="sc">*</span>(n<span class="dv">-1</span>))), <span class="at">pos=</span><span class="dv">1</span>)</span>
<span id="cb68-23"><a href="#cb68-23" tabindex="-1"></a><span class="fu">text</span>(Xstart, Ystop<span class="fl">-.25</span><span class="sc">*</span>Yrange, <span class="fu">bquote</span>(<span class="fu">sqrt</span>(MSE) <span class="sc">==</span> .(<span class="fu">mean</span>(storage_rmse))), <span class="at">pos=</span><span class="dv">1</span>)</span>
<span id="cb68-24"><a href="#cb68-24" tabindex="-1"></a></span>
<span id="cb68-25"><a href="#cb68-25" tabindex="-1"></a></span>
<span id="cb68-26"><a href="#cb68-26" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb68-27"><a href="#cb68-27" tabindex="-1"></a>  <span class="fu">abline</span>(storage_b0[i], storage_b1[i], <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>)  </span>
<span id="cb68-28"><a href="#cb68-28" tabindex="-1"></a>}</span>
<span id="cb68-29"><a href="#cb68-29" tabindex="-1"></a><span class="fu">abline</span>(beta_0, beta_1, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb68-30"><a href="#cb68-30" tabindex="-1"></a><span class="fu">abline</span>(beta_0<span class="sc">+</span>sigma, beta_1, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb68-31"><a href="#cb68-31" tabindex="-1"></a><span class="fu">abline</span>(beta_0<span class="sc">-</span>sigma, beta_1, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb68-32"><a href="#cb68-32" tabindex="-1"></a><span class="fu">abline</span>(beta_0<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>sigma, beta_1, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">1</span>)</span>
<span id="cb68-33"><a href="#cb68-33" tabindex="-1"></a><span class="fu">abline</span>(beta_0<span class="dv">-2</span><span class="sc">*</span>sigma, beta_1, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">1</span>)</span>
<span id="cb68-34"><a href="#cb68-34" tabindex="-1"></a><span class="fu">abline</span>(beta_0<span class="sc">+</span><span class="dv">3</span><span class="sc">*</span>sigma, beta_1, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span>.<span class="dv">5</span>)</span>
<span id="cb68-35"><a href="#cb68-35" tabindex="-1"></a><span class="fu">abline</span>(beta_0<span class="dv">-3</span><span class="sc">*</span>sigma, beta_1, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span>.<span class="dv">5</span>)</span>
<span id="cb68-36"><a href="#cb68-36" tabindex="-1"></a></span>
<span id="cb68-37"><a href="#cb68-37" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mai=</span><span class="fu">c</span>(<span class="dv">1</span>,.<span class="dv">6</span>,.<span class="dv">5</span>,.<span class="dv">01</span>))</span>
<span id="cb68-38"><a href="#cb68-38" tabindex="-1"></a></span>
<span id="cb68-39"><a href="#cb68-39" tabindex="-1"></a>  addnorm <span class="ot">&lt;-</span> <span class="cf">function</span>(m,s, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>){</span>
<span id="cb68-40"><a href="#cb68-40" tabindex="-1"></a>    <span class="fu">curve</span>(<span class="fu">dnorm</span>(x, m, s), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span>col, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb68-41"><a href="#cb68-41" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="fu">c</span>(m,m), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(m,m,s)), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span>col)</span>
<span id="cb68-42"><a href="#cb68-42" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="fu">rep</span>(m<span class="sc">-</span>s,<span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(m<span class="sc">-</span>s, m, s)), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span>col)</span>
<span id="cb68-43"><a href="#cb68-43" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="fu">rep</span>(m<span class="dv">-2</span><span class="sc">*</span>s,<span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(m<span class="dv">-2</span><span class="sc">*</span>s, m, s)), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span>col)</span>
<span id="cb68-44"><a href="#cb68-44" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="fu">rep</span>(m<span class="dv">-3</span><span class="sc">*</span>s,<span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(m<span class="dv">-3</span><span class="sc">*</span>s, m, s)), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span>col)</span>
<span id="cb68-45"><a href="#cb68-45" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="fu">rep</span>(m<span class="sc">+</span>s,<span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(m<span class="sc">+</span>s, m, s)), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span>col)</span>
<span id="cb68-46"><a href="#cb68-46" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="fu">rep</span>(m<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>s,<span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(m<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>s, m, s)), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span>col)</span>
<span id="cb68-47"><a href="#cb68-47" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="fu">rep</span>(m<span class="sc">+</span><span class="dv">3</span><span class="sc">*</span>s,<span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(m<span class="sc">+</span><span class="dv">3</span><span class="sc">*</span>s, m, s)), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span>col)</span>
<span id="cb68-48"><a href="#cb68-48" tabindex="-1"></a>    <span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">paste</span>(<span class="st">&quot;Std. Error = &quot;</span>, <span class="fu">round</span>(s,<span class="dv">3</span>)), <span class="at">cex=</span><span class="fl">0.7</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb68-49"><a href="#cb68-49" tabindex="-1"></a>  }</span>
<span id="cb68-50"><a href="#cb68-50" tabindex="-1"></a></span>
<span id="cb68-51"><a href="#cb68-51" tabindex="-1"></a>  h0 <span class="ot">&lt;-</span> <span class="fu">hist</span>(storage_b0, </span>
<span id="cb68-52"><a href="#cb68-52" tabindex="-1"></a>             <span class="at">col=</span><span class="st">&quot;skyblue3&quot;</span>, </span>
<span id="cb68-53"><a href="#cb68-53" tabindex="-1"></a>             <span class="at">main=</span><span class="st">&quot;Sampling Distribution</span><span class="sc">\n</span><span class="st"> Y-intercept&quot;</span>,</span>
<span id="cb68-54"><a href="#cb68-54" tabindex="-1"></a>             <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Estimates of &quot;</span>, beta[<span class="dv">0</span>], <span class="st">&quot; from each Sample&quot;</span>)),</span>
<span id="cb68-55"><a href="#cb68-55" tabindex="-1"></a>             <span class="at">freq=</span><span class="cn">FALSE</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb68-56"><a href="#cb68-56" tabindex="-1"></a>  m0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(storage_b0)</span>
<span id="cb68-57"><a href="#cb68-57" tabindex="-1"></a>  s0 <span class="ot">&lt;-</span> <span class="fu">sd</span>(storage_b0)</span>
<span id="cb68-58"><a href="#cb68-58" tabindex="-1"></a>  <span class="fu">addnorm</span>(m0,s0, <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb68-59"><a href="#cb68-59" tabindex="-1"></a>  </span>
<span id="cb68-60"><a href="#cb68-60" tabindex="-1"></a>  h1 <span class="ot">&lt;-</span> <span class="fu">hist</span>(storage_b1, </span>
<span id="cb68-61"><a href="#cb68-61" tabindex="-1"></a>             <span class="at">col=</span><span class="st">&quot;skyblue3&quot;</span>, </span>
<span id="cb68-62"><a href="#cb68-62" tabindex="-1"></a>             <span class="at">main=</span><span class="st">&quot;Sampling Distribution</span><span class="sc">\n</span><span class="st"> Slope&quot;</span>,</span>
<span id="cb68-63"><a href="#cb68-63" tabindex="-1"></a>             <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Estimates of &quot;</span>, beta[<span class="dv">1</span>], <span class="st">&quot; from each Sample&quot;</span>)),</span>
<span id="cb68-64"><a href="#cb68-64" tabindex="-1"></a>             <span class="at">freq=</span><span class="cn">FALSE</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb68-65"><a href="#cb68-65" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(storage_b1)</span>
<span id="cb68-66"><a href="#cb68-66" tabindex="-1"></a>  s1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(storage_b1)</span>
<span id="cb68-67"><a href="#cb68-67" tabindex="-1"></a>  <span class="fu">addnorm</span>(m1,s1, <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-89-1.png" width="768" /></p>
<div style="padding-left:15px;">
<hr />
<p><strong><em>t Tests{#tTests}</em></strong></p>
<p>Using the information above about the sampling distributions of <span
class="math inline">\(b_1\)</span> and <span
class="math inline">\(b_0\)</span>, an immediate choice of statistical
test to test the hypotheses <span class="math display">\[
  H_0: \beta_1 = \beta_{10}
\]</span> <span class="math display">\[
  H_a: \beta_1 \neq \beta_{10}
\]</span> where <span class="math inline">\(\beta_{10}\)</span> can be
zero, or any other value, is a t test given by <span
class="math display">\[
  t = \frac{b_1 - \beta_{10}}{s_{b_1}}
\]</span> where <span class="math inline">\(s^2_{b_1} =
\frac{MSE}{\sum(X_i-\bar{X})^2}\)</span>. (You may want to review the
section “Estimating the Model Variance” of this file to know where MSE
came from.) With quite a bit of work it has been shown that <span
class="math inline">\(t\)</span> is distributed as a <span
class="math inline">\(t\)</span> distribution with <span
class="math inline">\(n-2\)</span> degrees of freedom. The nearly
identical test statistic for testing <span class="math display">\[
  H_0: \beta_0 = \beta_{00}
\]</span> <span class="math display">\[
  H_a: \beta_0 \neq \beta_{00}
\]</span> is given by <span class="math display">\[
  t = \frac{b_0 - \beta_{00}}{s_{b_0}}
\]</span> where <span class="math inline">\(s^2_{b_0} =
MSE\left[\frac{1}{n}+\frac{\bar{X}^2}{\sum(X_i-\bar{X})^2}\right]\)</span>.
This version of <span class="math inline">\(t\)</span> has also been
shown to be distributed as a <span class="math inline">\(t\)</span>
distribution with <span class="math inline">\(n-2\)</span> degrees of
freedom.</p>
<hr />
<p><strong><em>Confidence Intervals</em></strong></p>
<p>Creating a confidence interval for either <span
class="math inline">\(\beta_1\)</span> or <span
class="math inline">\(\beta_0\)</span> follows immediately from these
results using the formulas <span class="math display">\[
  b_1 \pm t^*_{n-2}\cdot s_{b_1}
\]</span> <span class="math display">\[
  b_0 \pm t^*_{n-2}\cdot s_{b_0}
\]</span> where <span class="math inline">\(t^*_{n-2}\)</span> is the
critical value from a t distribution with <span
class="math inline">\(n-2\)</span> degrees of freedom corresponding to
the chosen confidence level.</p>
<p><br /></p>
<hr />
<p><strong><em>F tests{#Ftests}</em></strong></p>
<p>Another way to test the hypotheses <span class="math display">\[
  H_0: \beta_1 = \beta_{10}  \quad\quad \text{or} \quad\quad H_0:
\beta_0 = \beta_{00}
\]</span> <span class="math display">\[
  H_a: \beta_1 \neq \beta_{10} \quad\quad \ \ \quad \quad H_a: \beta_0
\neq \beta_{00}
\]</span> is with an <span class="math inline">\(F\)</span> Test. One
downside of the F test is that we cannot construct confidence intervals.
Another is that we can only perform two-sided tests, we cannot use
one-sided alternatives with an F test. The upside is that an <span
class="math inline">\(F\)</span> test is very general and can be used in
many places that a t test cannot.</p>
<p>In its most general form, the <span class="math inline">\(F\)</span>
test partitions the sums of squared errors into different pieces and
compares the pieces to see what is accounting for the most variation in
the data. To test the hypothesis that <span
class="math inline">\(H_0:\beta_1=0\)</span> against the alternative
that <span class="math inline">\(H_a: \beta_1\neq 0\)</span>, we are
essentially comparing two models against each other. If <span
class="math inline">\(\beta_1=0\)</span>, then the corresponding model
would be <span class="math inline">\(E\{Y_i\} = \beta_0\)</span>. If
<span class="math inline">\(\beta_1\neq0\)</span>, then the model
remains <span
class="math inline">\(E\{Y_i\}=\beta_0+\beta_1X_i\)</span>. We call the
model corresponding to the null hypothesis the reduced model because it
will always have fewer parameters than the model corresponding to the
alternative hypothesis (which we call the full model). This is the first
requirement of the <span class="math inline">\(F\)</span> Test, that the
null model (reduced model) have fewer “free” parameters than the
alternative model (full model). To demonstrate what we mean by “free”
parameters, consider the following example.</p>
<p>Say we wanted to test the hypothesis that <span
class="math inline">\(H_0:\beta_1 = 2.5\)</span> against the alternative
that <span class="math inline">\(\beta_1\neq2.5\)</span>. Then the null,
or reduced model, would be <span
class="math inline">\(E\{Y_i\}=\beta_0+2.5X_i\)</span>. The alternative,
or full model, would be <span
class="math inline">\(E\{Y_i\}=\beta_0+\beta_1X_i\)</span>. Thus, the
null (reduced) model contains only one “free” parameter because <span
class="math inline">\(\beta_1\)</span> has been fixed to be 2.5 and is
no longer free to be estimated from the data. The alternative (full)
model contains two “free” parameters, both are to be estimated from the
data. The null (reduced) model must contain fewer free parameters than
the alternative (full) model.</p>
<p>Once the null and alternative models have been specified, the General
Linear Test is performed by appropriately partitioning the squared
errors into pieces corresponding to each model. In the first example
where we were testing <span class="math inline">\(H_0:
\beta_1=0\)</span> against <span
class="math inline">\(H_a:\beta_1\neq0\)</span> we have the partition
<span class="math display">\[
  \underbrace{Y_i-\bar{Y}}_{Total} = \underbrace{\hat{Y}_i -
\bar{Y}}_{Regression} + \underbrace{Y_i-\hat{Y}_i}_{Error}
\]</span> The reason we use <span class="math inline">\(\bar{Y}\)</span>
for the null model is that <span class="math inline">\(\bar{Y}\)</span>
is the unbiased estimator of <span
class="math inline">\(\beta_0\)</span> for the null model, <span
class="math inline">\(E\{Y_i\} = \beta_0\)</span>. Thus we would compute
the following sums of squares: <span class="math display">\[
  SSTO = \sum(Y_i-\bar{Y})^2
\]</span> <span class="math display">\[
  SSR = \sum(\hat{Y}_i-\bar{Y})^2
\]</span> <span class="math display">\[
  SSE = \sum(Y_i-\hat{Y}_i)^2
\]</span> and note that <span class="math inline">\(SSTO = SSR +
SSE\)</span>. Important to note is that <span
class="math inline">\(SSTO\)</span> uses the difference between the
observations <span class="math inline">\(Y_i\)</span> and the null
(reduced) model. The <span class="math inline">\(SSR\)</span> uses the
diffences between the alternative (full) and null (reduced) model. The
<span class="math inline">\(SSE\)</span> uses the differences between
the observations <span class="math inline">\(Y_i\)</span> and the
alternative (full) model. From these we could set up a General <span
class="math inline">\(F\)</span> table of the form</p>
<table style="width:100%;">
<colgroup>
<col width="21%" />
<col width="21%" />
<col width="10%" />
<col width="23%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th> </th>
<th>Sum Sq</th>
<th>Df</th>
<th>Mean Sq</th>
<th>F Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Model Error</td>
<td><span class="math inline">\(SSR\)</span></td>
<td><span class="math inline">\(df_R-df_F\)</span></td>
<td><span class="math inline">\(\frac{SSR}{df_R-df_F}\)</span></td>
<td><span
class="math inline">\(\frac{SSR}{df_R-df_F}\cdot\frac{df_F}{SSE}\)</span></td>
</tr>
<tr class="even">
<td>Residual Error</td>
<td><span class="math inline">\(SSE\)</span></td>
<td><span class="math inline">\(df_F\)</span></td>
<td><span class="math inline">\(\frac{SSE}{df_F}\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td>Total Error</td>
<td><span class="math inline">\(SSTO\)</span></td>
<td><span class="math inline">\(df_R\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br /></p>
<hr />
<p><strong><em>Prediction and Confidence Intervals for <span
class="math inline">\(\hat{Y}_h\)</span>
<a href="javascript:showhide('predictionintervals')" style="font-size:.6em;color:skyblue;">(Expand)</a></em></strong></p>
<p><span class="expand-caption">predict(…, interval=“prediction”)…
</span></p>
<div id="predictionintervals" style="display:none;">
<p>It is a common mistake to assume that averages (means) describe
individuals. They do not. So, when providing predictions on individuals,
it is crucial to capture the variability of individuals around the
line.</p>
<table>
<colgroup>
<col width="21%" />
<col width="17%" />
<col width="32%" />
<col width="28%" />
</colgroup>
<thead>
<tr class="header">
<th>Interval</th>
<th>R Code</th>
<th>Math Equation</th>
<th>When to Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Prediction</td>
<td><span
style="font-size:.8em;"><code>predict(..., interval="prediction")</code></span></td>
<td><span class="math inline">\(\hat{Y}_i \pm t^* \cdot s_{\text{Pred}\
Y}\)</span></td>
<td>Predict an individual’s value.</td>
</tr>
<tr class="even">
<td>Confidence</td>
<td><span
style="font-size:.8em;"><code>predict(..., interval="confidence")</code></span></td>
<td><span class="math inline">\(\hat{Y}_i \pm t^* \cdot
s_{\hat{Y}}\)</span></td>
<td>Estimate location of the mean y-value.</td>
</tr>
</tbody>
</table>
<p><code>predict(mylm, data.frame(XvarName = number), interval=...)</code></p>
<p><br /> <br /></p>
<p>For example, consider this graph. Then
<a href="javascript:showhide('predictionintervalsgraph')" style="color:skyblue;">click
here</a> to read about the graph.</p>
<div id="predictionintervalsgraph"
style="padding-left:30px;padding-right:30px;font-size:.9em;display:none;">
<p>Notice the three dots above 15 mph in the graph. Each of these dots
show a car that was going 15 mph when it applied the brakes. However,
stopping distances of the three individual cars differ with one at 20
feet, one at 26 feet and one at 54 feet.</p>
<p>The regression line represents the average stopping distance of cars.
In this case, cars going 15 mph are estimated to have an average
stopping distance of about 40 feet, as shown by the line. But individual
vehicles, all going the same speed of 15 mph, varied from stopping
distances of 20 feet up to 54 feet!</p>
<p>So, to predict that a car going 15 mph will take 41.4 feet to stop,
doesn’t tell the whole story. Far more revealing is the complete
statement, “Cars going 15 mph are predicted to take anywhere from 10.2
to 72.6 feet to stop, with an average stopping distance of 41.4 feet.”
This is called the “prediction interval” and is shown in the graph in
blue. It is obtained in R with the codes:</p>
<p><code>cars.lm &lt;- lm(dist ~ speed, data=cars)</code></p>
<p><code>predict(cars.lm, data.frame(speed=15), interval="prediction")</code></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a>cars.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed, <span class="at">data=</span>cars)</span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">predict</span>(cars.lm, <span class="fu">data.frame</span>(<span class="at">speed=</span><span class="dv">15</span>), <span class="at">interval=</span><span class="st">&quot;prediction&quot;</span>))</span></code></pre></div>
<table style="width:33%;">
<colgroup>
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">fit</th>
<th align="center">lwr</th>
<th align="center">upr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">41.41</td>
<td align="center">10.17</td>
<td align="center">72.64</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">plot</span>(dist <span class="sc">~</span> speed, <span class="at">data=</span>cars, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Speed of the Vehicle (mph) </span><span class="sc">\n</span><span class="st"> the Moment the Brakes were Applied&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Distance (ft) it took the Vehicle to Stop&quot;</span>,</span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Don&#39;t Step in front of a Moving 1920&#39;s Vehicle...&quot;</span>)</span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">text=</span><span class="st">&quot;...they take a few feet to stop.&quot;</span>, <span class="at">cex=</span><span class="fl">0.7</span>, <span class="at">line=</span>.<span class="dv">5</span>)</span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="st">&quot;Stopping Distance Experiment&quot;</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a><span class="fu">points</span>(dist <span class="sc">~</span> speed, <span class="at">data=</span><span class="fu">subset</span>(cars, speed<span class="sc">==</span><span class="dv">15</span>), <span class="at">pch=</span><span class="dv">20</span>, <span class="at">col=</span><span class="st">&quot;firebrick2&quot;</span>, <span class="at">cex=</span><span class="fl">1.5</span>)</span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a>cars.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed, <span class="at">data=</span>cars)</span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a><span class="fu">abline</span>(cars.lm, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="fu">rgb</span>(.<span class="dv">689</span>,.<span class="dv">133</span>,.<span class="dv">133</span>, .<span class="dv">3</span>))</span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">120</span>,<span class="dv">20</span>), <span class="at">v=</span><span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">25</span>,<span class="dv">5</span>), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="fu">rgb</span>(.<span class="dv">2</span>,.<span class="dv">2</span>,.<span class="dv">2</span>,.<span class="dv">2</span>))</span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">15</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span>
<span id="cb70-12"><a href="#cb70-12" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(cars.lm, <span class="fu">data.frame</span>(<span class="at">speed=</span><span class="dv">15</span>), <span class="at">interval=</span><span class="st">&quot;prediction&quot;</span>)</span>
<span id="cb70-14"><a href="#cb70-14" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">15</span>), preds[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">-</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>), <span class="at">col=</span><span class="fu">rgb</span>(.<span class="dv">529</span>,.<span class="dv">8078</span>,.<span class="dv">9216</span>,.<span class="dv">4</span>), <span class="at">lwd=</span><span class="dv">12</span>)</span>
<span id="cb70-15"><a href="#cb70-15" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">15</span>), preds[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)], <span class="at">col=</span><span class="fu">rgb</span>(.<span class="dv">529</span>,.<span class="dv">8078</span>,.<span class="dv">9216</span>,.<span class="dv">8</span>))</span>
<span id="cb70-16"><a href="#cb70-16" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">15</span>), preds[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>)], <span class="at">col=</span><span class="fu">rgb</span>(.<span class="dv">529</span>,.<span class="dv">8078</span>,.<span class="dv">9216</span>,.<span class="dv">8</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
<p>Now, for the details behind prediction intervals and confidence
intervals.</p>
<p>Let’s begin by recalling some details (from the section “Inference
for the Model Parameters”) about the standard error of the y-intercept,
<span class="math inline">\(b_0\)</span>. Recall that the y-intercept is
the average y-value for the given x-value of <span
class="math inline">\(x=0\)</span>. Recall further that the formula for
the standard error of <span class="math inline">\(b_0\)</span> is given
by the formula</p>
<p><span class="math display">\[
  s^2_{b_0} = MSE\left[\frac{1}{n} +
\frac{\bar{X}^2}{\sum(X_i-\bar{X})^2}\right]
\]</span></p>
<p>If we wanted to be more exact with this formula, we would write it
as</p>
<p><span class="math display">\[
  s^2_{b_0} = MSE\left[\frac{1}{n} +
\frac{(0-\bar{X})^2}{\sum(X_i-\bar{X})^2}\right]
\]</span></p>
<p>Did you notice the addition of <span class="math inline">\((0 -
\bar{X})^2\)</span> instead of just <span
class="math inline">\(\bar{X}^2\)</span> in the numerator of the
right-most part of the equation? This more complete statement obviously
would reduce to just <span class="math inline">\(\bar{X}^2\)</span>, but
that is only because <span class="math inline">\(X=0\)</span> when we
are working with the y-intercept, <span
class="math inline">\(b_0\)</span>. We could be working with other
values of <span class="math inline">\(X\)</span> than just zero.</p>
<div class="note">
<p>Let’s take a quick detour and talk notation for a second. Typically,
<span class="math inline">\(X_i\)</span> and <span
class="math inline">\(Y_i\)</span> are used to denote the x-value and
y-value of points that are contained in our data set. When we want to
reference a point that wasn’t within our original data set, we use the
notation <span class="math inline">\(X_h\)</span> and <span
class="math inline">\(Y_h\)</span>. (The letter h is close to i, but
different from i, so why not. There is really no other reason to use h.)
Thus, <span class="math inline">\(Y_h\)</span> is the y-value for the
<span class="math inline">\(X_h\)</span> x-value, neither of which were
included in our original regression of <span
class="math inline">\(X_i\)</span>’s and <span
class="math inline">\(Y_i\)</span>’s.</p>
</div>
<p>Now, back to the previous discussion. If <span
class="math inline">\(X_h = 0\)</span>, then <span
class="math inline">\(\hat{Y}_h\)</span> is the y-intercept, so <span
class="math inline">\(\hat{Y}_h = b_0\)</span> when <span
class="math inline">\(X_h=0\)</span>. So, we could write,</p>
<p><span class="math display">\[
  s^2_{\hat{Y}_h} = MSE\left[\frac{1}{n} +
\frac{(X_h-\bar{X})^2}{\sum(X_i-\bar{X})^2}\right]
\]</span></p>
<p>Did you notice how the <span class="math inline">\(b_0\)</span> in
<span class="math inline">\(s_{b_0}\)</span> was replaced with <span
class="math inline">\(\hat{Y}_h\)</span> to get <span
class="math inline">\(s_{\hat{Y}_h}\)</span> and the 0 in <span
class="math inline">\((0 - \bar{X})^2\)</span> was replaced with <span
class="math inline">\(X_h\)</span> to get <span
class="math inline">\((X_h - \bar{X})^2\)</span>? Interesting. We now
have a formula that would give us the standard error of <span
class="math inline">\(\hat{Y}_h\)</span> for any <span
class="math inline">\(X_h\)</span> value, not just <span
class="math inline">\(X_h = 0\)</span>, or the y-intercept, <span
class="math inline">\(b_0\)</span>. That is fantastic. It would look
like this if plotted. Notice how the gray region is showing the standard
error for each <span class="math inline">\(\hat{Y}_h\)</span> value? (It
is technically showing the confidence interval for <span
class="math inline">\(E\{Y_h\}\)</span> at every possible <span
class="math inline">\(X_h\)</span> value, but that is just <span
class="math inline">\(\hat{Y}_h \pm t^* \cdot
s_{\hat{Y}_h}\)</span>.)</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">ggplot</span>(cars, <span class="fu">aes</span>(<span class="at">x=</span>speed, <span class="at">y=</span>dist)) <span class="sc">+</span> </span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">color=</span><span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
<p><strong>Confidence Interval for <span
class="math inline">\(\hat{Y}_h\)</span></strong></p>
<p><span class="math display">\[
  \hat{Y}_h \pm t^* s_{\hat{Y}_h} \quad \text{where} \ s_{\hat{Y}_h}^2 =
MSE\left[\frac{1}{n} + \frac{(X_h - \bar{X})^2}{\sum(X_i -
\bar{X})^2}\right]
\]</span></p>
<p>The confidence interval is a wonderful tool for estimating <span
class="math inline">\(E\{Y_h\}\)</span>, the “true” average y-value for
a given x-value of <span class="math inline">\(X_h\)</span>. However, it
is not valuable for predicting an individual dot, or <span
class="math inline">\(Y_h\)</span> value. Notice how few of the dots of
the regression are actually contained within the confidence interval
band in the plot? The confidence interval does not really predict where
the dots will land, just where the average y-value is located for each
x-value.</p>
<p>Remember the 68-95-99.7 Rule of the normal distribution? If not, here
is a link back to that concept in the <a
href="https://byuistats.github.io/BYUI_M221_Book/Lesson05.html#normal-probability-computations">Math
221</a> textbook. This rule states that roughly 95% of data, when
normally distributed, will be between <span
class="math inline">\(z=-2\)</span> and <span
class="math inline">\(z=2\)</span> standard deviations from the mean.
So, is going two “residual standard errors” to both sides of the
regression line enough to capture 95% of the data? The answer is, not
quite. The reason for this is because our knowledge of where the true
mean lies is uncertain. (Notice the confidence interval band shown in
the plot.) However, adding two standard errors to the edges of the
confidence band would get us in the right place. In other words, there
are two sources of variability at play here, (1) our uncertaintity in
where the regression line is sitting, and (2) the natural variability of
the data points around the line. Thus, the “prediction interval”
requires accounting for both of these sources of variability to produce
the following equation.</p>
<p><strong>Prediction Interval for <span
class="math inline">\(Y_h\)</span></strong></p>
<p><span class="math display">\[
  \hat{Y}_h \pm t^* s_{Pred \hat{Y}_h} \quad \text{where} \ s_{Pred
\hat{Y}_h}^2 = MSE\left[\frac{1}{n} + 1 + \frac{(X_h -
\bar{X})^2}{\sum(X_i - \bar{X})^2}\right]
\]</span></p>
<p>This formula provides a useful band for identifying a region where we
are 95% confident that a new observation for <span
class="math inline">\(Y_h\)</span> will land, given the value of <span
class="math inline">\(X_h\)</span>.</p>
<p>It looks as follows. Notice the prediction interval is much wider
than the confidence interval. This is because data varies far more than
do means. Prediction is for where the individual data points will land,
confidence is for where the mean will land.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a>cars.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed, <span class="at">data=</span>cars)</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a>predy <span class="ot">&lt;-</span> <span class="fu">predict</span>(cars.lm, <span class="fu">data.frame</span>(<span class="at">speed=</span><span class="dv">15</span>), <span class="at">interval=</span><span class="st">&quot;prediction&quot;</span>)</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a><span class="fu">ggplot</span>(cars, <span class="fu">aes</span>(<span class="at">x=</span>speed, <span class="at">y=</span>dist)) <span class="sc">+</span> </span>
<span id="cb73-5"><a href="#cb73-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb73-6"><a href="#cb73-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">color=</span><span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb73-7"><a href="#cb73-7" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">15</span>, <span class="at">xend=</span><span class="dv">15</span>, <span class="at">y=</span>predy[<span class="dv">2</span>], <span class="at">yend=</span>predy[<span class="dv">3</span>]), <span class="at">lwd=</span><span class="dv">4</span>, <span class="at">color=</span><span class="fu">rgb</span>(.<span class="dv">5</span>,.<span class="dv">7</span>,.<span class="dv">5</span>,.<span class="dv">01</span>)) <span class="sc">+</span> </span>
<span id="cb73-8"><a href="#cb73-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">15</span>, <span class="at">y=</span>predy[<span class="dv">1</span>]), <span class="at">cex=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">pch=</span><span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb73-9"><a href="#cb73-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
</div>
<p><br/></p>
<hr />
<p><strong><em>Lowess (and Loess) Curves
<a href="javascript:showhide('lowesscurves')" style="font-size:.6em;color:skyblue;">(Expand)</a></em></strong></p>
<p><span class="expand-caption">A non-parametric approach to estimating
<span class="math inline">\(E\{Y_i\}\)</span>… </span></p>
<div id="lowesscurves" style="display:none;">
<p>Robust <strong>lo</strong>cally <strong>wei</strong>ghted regression
and <strong>s</strong>moothing <strong>s</strong>catterplots (LOWESS),
is an effective way to visually model the average y-value.</p>
<hr />
<table>
<tr>
<td>
<p><strong>Using Base R</strong></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="co"># Select the relevant columns and remove NA values</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>air2 <span class="ot">&lt;-</span> airquality <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Temp, Ozone) <span class="sc">%&gt;%</span>  <span class="co"># Use dplyr&#39;s select function explicitly</span></span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a>  <span class="fu">drop_na</span>()  <span class="co"># Drop rows with NA values in Temp or Ozone</span></span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a></span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a><span class="fu">plot</span>(Temp <span class="sc">~</span> Ozone, <span class="at">data=</span>air2, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>)</span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(air2<span class="sc">$</span>Ozone, air2<span class="sc">$</span>Temp), <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
</td>
<td>
<p><strong>Using ggplot2</strong></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="co"># Your dataset (air2) should have been created earlier, ensuring no NAs</span></span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>air2 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(airquality[<span class="fu">c</span>(<span class="st">&quot;Temp&quot;</span>, <span class="st">&quot;Ozone&quot;</span>)])</span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a><span class="co"># Just quickly draw the lowess curve:</span></span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a><span class="fu">ggplot</span>(air2, <span class="fu">aes</span>(<span class="at">x=</span>Ozone, <span class="at">y=</span>Temp)) <span class="sc">+</span></span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;darkgray&quot;</span>) <span class="sc">+</span>  <span class="co"># Add points with dark gray color</span></span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">method=</span><span class="st">&quot;loess&quot;</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">degree=</span><span class="dv">1</span>)) <span class="sc">+</span> <span class="co"># Lowess curve, no standard error shading</span></span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="co"># Black and white theme</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="co"># Optionally, allow for predictions as well as the graph:</span></span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a><span class="co"># Uncomment the following lines if you want predictions as well:</span></span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a><span class="co"># air2 &lt;- arrange(air2, desc(Ozone))</span></span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a><span class="co"># mylo &lt;- loess(Temp ~ Ozone, data=air2, degree=1)</span></span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a><span class="co"># ggplot(air2, aes(x=Ozone, y=Temp)) +</span></span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a><span class="co">#   geom_point() +</span></span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a><span class="co">#   geom_line(data=air2, aes(y=mylo$fitted, x=Ozone))  # Use fitted values from loess</span></span></code></pre></div>
<p><img src="images/Screenshot%202025-01-11%20183505.png" /></p>
</td>
</tr>
</table>
<hr />
<p><br /></p>
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Advantages</strong></th>
<th><strong>Disadvantages</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Quick. Good at ignoring outliers. Good at capturing the general
pattern in the data. Good for making predictions within the scope of the
data.</td>
<td>No mathematical model. Not interpretable. No p-values. No adjusted
R-squared.</td>
</tr>
</tbody>
</table>
<p><strong>How it Works</strong></p>
<p>The Lowess curve localizes the regression model to a “neighborhood”
of points, and then joins these localized regressions together into a
smooth line. It minimizes the effect of outliers, and let’s the data
“speak for itself”.</p>
<p>As a downside, it is not interpretable, and has no final way to write
the model mathematically. All the same, it is a very powerful tool for
identifying an appropriate model, or verifying the fit of a model, or
making predictions when no reasonable model does an adequate job.</p>
<p>Study this graphic and the explanations below to learn how it
works.</p>
<p><em>Recommendation: run the code in this “Code” chunk to the right in
your Console, and flip through the resulting graphics.</em></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a>X <span class="ot">&lt;-</span> cars<span class="sc">$</span>speed</span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> cars<span class="sc">$</span>dist</span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> X[<span class="sc">!</span><span class="fu">is.na</span>(X) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(Y)]</span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> Y[<span class="sc">!</span><span class="fu">is.na</span>(X) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(Y)]</span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(X)</span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" tabindex="-1"></a>lfit <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,n)</span>
<span id="cb78-9"><a href="#cb78-9" tabindex="-1"></a><span class="cf">for</span> (xh <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb78-10"><a href="#cb78-10" tabindex="-1"></a> xdists <span class="ot">&lt;-</span> X <span class="sc">-</span> X[xh]</span>
<span id="cb78-11"><a href="#cb78-11" tabindex="-1"></a> nn <span class="ot">&lt;-</span> <span class="fu">floor</span>(n<span class="sc">*</span>f)</span>
<span id="cb78-12"><a href="#cb78-12" tabindex="-1"></a> r <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">abs</span>(xdists))[nn]</span>
<span id="cb78-13"><a href="#cb78-13" tabindex="-1"></a> xdists.nbrhd <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(xdists) <span class="sc">&lt;</span> r)</span>
<span id="cb78-14"><a href="#cb78-14" tabindex="-1"></a> w <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(xdists))</span>
<span id="cb78-15"><a href="#cb78-15" tabindex="-1"></a> w[xdists.nbrhd] <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">abs</span>(xdists[xdists.nbrhd]<span class="sc">/</span>r)<span class="sc">^</span><span class="dv">3</span>)<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb78-16"><a href="#cb78-16" tabindex="-1"></a> <span class="fu">plot</span>(Y <span class="sc">~</span> X, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">bg=</span><span class="fu">rgb</span>(.<span class="dv">53</span>,.<span class="dv">81</span>,.<span class="dv">92</span>, w),   </span>
<span id="cb78-17"><a href="#cb78-17" tabindex="-1"></a>      <span class="at">col=</span><span class="fu">rgb</span>(.<span class="dv">2</span>,.<span class="dv">2</span>,.<span class="dv">2</span>,.<span class="dv">3</span>), <span class="at">cex=</span><span class="fl">1.5</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb78-18"><a href="#cb78-18" tabindex="-1"></a> <span class="fu">points</span>(Y[xh] <span class="sc">~</span> X[xh], <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>)</span>
<span id="cb78-19"><a href="#cb78-19" tabindex="-1"></a> lmc <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">weights=</span>w)</span>
<span id="cb78-20"><a href="#cb78-20" tabindex="-1"></a> <span class="fu">curve</span>(lmc<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> lmc<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>x, <span class="at">from=</span><span class="fu">min</span>(X[xdists.nbrhd]), <span class="at">to=</span><span class="fu">max</span>(X[xdists.nbrhd]), <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb78-21"><a href="#cb78-21" tabindex="-1"></a> <span class="fu">lines</span>(lfit[<span class="dv">1</span><span class="sc">:</span>xh] <span class="sc">~</span> X[<span class="dv">1</span><span class="sc">:</span>xh], <span class="at">col=</span><span class="st">&quot;gray&quot;</span>)</span>
<span id="cb78-22"><a href="#cb78-22" tabindex="-1"></a> </span>
<span id="cb78-23"><a href="#cb78-23" tabindex="-1"></a> <span class="co">#lines(lowess(X,Y), col=rgb(0.698,0.133,0.133,.2))</span></span>
<span id="cb78-24"><a href="#cb78-24" tabindex="-1"></a> <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb78-25"><a href="#cb78-25" tabindex="-1"></a> <span class="fu">readline</span>(<span class="at">prompt=</span><span class="fu">paste0</span>(<span class="st">&quot;Center point is point #&quot;</span>, xh, <span class="st">&quot;... Press [enter] to continue...&quot;</span>))</span>
<span id="cb78-26"><a href="#cb78-26" tabindex="-1"></a> </span>
<span id="cb78-27"><a href="#cb78-27" tabindex="-1"></a></span>
<span id="cb78-28"><a href="#cb78-28" tabindex="-1"></a> MADnotThereYet <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb78-29"><a href="#cb78-29" tabindex="-1"></a> count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb78-30"><a href="#cb78-30" tabindex="-1"></a> <span class="cf">while</span>(MADnotThereYet){</span>
<span id="cb78-31"><a href="#cb78-31" tabindex="-1"></a>   </span>
<span id="cb78-32"><a href="#cb78-32" tabindex="-1"></a>      <span class="fu">readline</span>(<span class="at">prompt=</span><span class="fu">paste0</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">   Adjusting line to account for outliers in the y-direction... Press [enter] to continue...&quot;</span>))   </span>
<span id="cb78-33"><a href="#cb78-33" tabindex="-1"></a>   </span>
<span id="cb78-34"><a href="#cb78-34" tabindex="-1"></a>   <span class="fu">curve</span>(lmc<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> lmc<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>x, <span class="at">from=</span><span class="fu">min</span>(X[xdists.nbrhd]), <span class="at">to=</span><span class="fu">max</span>(X[xdists.nbrhd]), <span class="at">col=</span><span class="st">&quot;wheat&quot;</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb78-35"><a href="#cb78-35" tabindex="-1"></a></span>
<span id="cb78-36"><a href="#cb78-36" tabindex="-1"></a>   MAD <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">abs</span>(lmc<span class="sc">$</span>res))</span>
<span id="cb78-37"><a href="#cb78-37" tabindex="-1"></a>   resm <span class="ot">&lt;-</span> lmc<span class="sc">$</span>res<span class="sc">/</span>(<span class="dv">6</span><span class="sc">*</span>MAD)</span>
<span id="cb78-38"><a href="#cb78-38" tabindex="-1"></a>   resm[resm<span class="sc">&gt;</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb78-39"><a href="#cb78-39" tabindex="-1"></a>   bisq <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>resm<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb78-40"><a href="#cb78-40" tabindex="-1"></a>   w <span class="ot">&lt;-</span> w<span class="sc">*</span>bisq</span>
<span id="cb78-41"><a href="#cb78-41" tabindex="-1"></a>   obs <span class="ot">&lt;-</span> <span class="fu">coef</span>(lmc)</span>
<span id="cb78-42"><a href="#cb78-42" tabindex="-1"></a>   lmc <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">weights=</span>w)</span>
<span id="cb78-43"><a href="#cb78-43" tabindex="-1"></a> </span>
<span id="cb78-44"><a href="#cb78-44" tabindex="-1"></a>   <span class="fu">curve</span>(lmc<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> lmc<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>x, <span class="at">from=</span><span class="fu">min</span>(X[xdists.nbrhd]), <span class="at">to=</span><span class="fu">max</span>(X[xdists.nbrhd]), <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb78-45"><a href="#cb78-45" tabindex="-1"></a></span>
<span id="cb78-46"><a href="#cb78-46" tabindex="-1"></a>   count <span class="ot">&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb78-47"><a href="#cb78-47" tabindex="-1"></a>   <span class="cf">if</span> ( (<span class="fu">sum</span>(<span class="fu">abs</span>(obs<span class="sc">-</span>lmc<span class="sc">$</span>coef))<span class="sc">&lt;</span>.<span class="dv">1</span>) <span class="sc">|</span> (count <span class="sc">&gt;</span> <span class="dv">3</span>))</span>
<span id="cb78-48"><a href="#cb78-48" tabindex="-1"></a>     MADnotThereYet <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb78-49"><a href="#cb78-49" tabindex="-1"></a>       </span>
<span id="cb78-50"><a href="#cb78-50" tabindex="-1"></a> }</span>
<span id="cb78-51"><a href="#cb78-51" tabindex="-1"></a></span>
<span id="cb78-52"><a href="#cb78-52" tabindex="-1"></a>   <span class="fu">curve</span>(lmc<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> lmc<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>x, <span class="at">from=</span><span class="fu">min</span>(X[xdists.nbrhd]), <span class="at">to=</span><span class="fu">max</span>(X[xdists.nbrhd]), <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb78-53"><a href="#cb78-53" tabindex="-1"></a>   <span class="fu">points</span>(lmc<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> lmc<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>X[xh] <span class="sc">~</span> X[xh], <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb78-54"><a href="#cb78-54" tabindex="-1"></a>   </span>
<span id="cb78-55"><a href="#cb78-55" tabindex="-1"></a></span>
<span id="cb78-56"><a href="#cb78-56" tabindex="-1"></a>  <span class="fu">readline</span>(<span class="at">prompt=</span><span class="fu">paste0</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">   Use final line to get fitted value for this point... Press [enter] to continue to next point...&quot;</span>))</span>
<span id="cb78-57"><a href="#cb78-57" tabindex="-1"></a> </span>
<span id="cb78-58"><a href="#cb78-58" tabindex="-1"></a> lfit[xh] <span class="ot">&lt;-</span> <span class="fu">predict</span>(lmc, <span class="fu">data.frame</span>(<span class="at">X=</span>X[xh]))</span>
<span id="cb78-59"><a href="#cb78-59" tabindex="-1"></a> <span class="fu">lines</span>(lfit[<span class="dv">1</span><span class="sc">:</span>xh] <span class="sc">~</span> X[<span class="dv">1</span><span class="sc">:</span>xh], <span class="at">col=</span><span class="st">&quot;gray&quot;</span>)</span>
<span id="cb78-60"><a href="#cb78-60" tabindex="-1"></a> </span>
<span id="cb78-61"><a href="#cb78-61" tabindex="-1"></a></span>
<span id="cb78-62"><a href="#cb78-62" tabindex="-1"></a> <span class="cf">if</span> (xh <span class="sc">==</span> n){</span>
<span id="cb78-63"><a href="#cb78-63" tabindex="-1"></a>     <span class="fu">readline</span>(<span class="at">prompt=</span><span class="fu">paste0</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">  Press [enter] to see actual Lowess curve...&quot;</span>))</span>
<span id="cb78-64"><a href="#cb78-64" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="fu">lowess</span>(X,Y, <span class="at">f=</span>f), <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span>
<span id="cb78-65"><a href="#cb78-65" tabindex="-1"></a>    <span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">legend=</span><span class="st">&quot;Actual lowess Curve using lowess(...)&quot;</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb78-66"><a href="#cb78-66" tabindex="-1"></a> }</span>
<span id="cb78-67"><a href="#cb78-67" tabindex="-1"></a>  </span>
<span id="cb78-68"><a href="#cb78-68" tabindex="-1"></a>  </span>
<span id="cb78-69"><a href="#cb78-69" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
<ol style="list-style-type: decimal">
<li><p>Select a fraction of the data to use for the “neighborhood” of
points (shown in blue in the graph above). The <code>lowess</code>
function in R uses “f=2/3” and the <code>loess</code> function uses
“span=0.75” for this value, which selects the nearest two-thirds or 75%
of the data, respectively, depending on which function you use. For this
example, we set the fraction of points at 50%. Both functions can be set
to whatever you want.</p></li>
<li><p>Pick any point in the regression, eventually selecting all points
one at a time. The selected point becomes the “center” of a
“neighborhood” of points surrounding it. In this example, the center
point is in orange, and the neighboring points are in blue.</p></li>
<li><p>Use the points within the neighborhood to fit a regression line.
However, make the regression depend most on points closest to “center”
and least on points furthest from “center.” This is called a weighted
regression. Weights are decided according to what is called the tricubic
weight function, so that the weight <span
class="math inline">\(w\)</span> given to point <span
class="math inline">\(j\)</span> of the neighborhood of points is
defined by <span class="math display">\[
  w_j = \left(1- \left( \frac{|X_c - X_j|}{\max_k |X_c -
X_k|}\right)^3\right)^3
\]</span> where <span class="math inline">\(X_c\)</span> is the x-value
of the “center” dot and <span class="math inline">\(X_j\)</span> is the
x-value of any other dot in the neighborhood.</p></li>
<li><p>The fitted-value of <span
class="math inline">\(\hat{Y}_c\)</span> is obtained for the center
point <span class="math inline">\(X_c\)</span> of the current
regression. This point is used as the Lowess (or Loess) curve’s value at
that particular x-value. Well, almost. It’s a first guess at where this
value will end up, but there’s a little more to the algorithm before we
are done. Initial guesses for each of these fitted values are obtained
for each point in the regression.</p></li>
<li><p>Now each local regression for each neighborhood is re-run a few
times in such a way the the effect of outliers is minimized. The final
line for each neighborhood is obtained by the following steps.</p>
<ul>
<li>Compute all residuals for points in the neighborhood of the current
regression, denoted by <span class="math inline">\(r_i\)</span>.</li>
<li>Then compute the MAD, median absolute deviation, of the residuals
<span class="math inline">\(MAD = \text{median} (|r_1|, |r_2|,
\ldots)\)</span>.</li>
<li>Divide all residuals by 6 times the MAD: <span
class="math inline">\(u_i = r_i/(6\cdot MAD)\)</span> (If <span
class="math inline">\(r_i &gt; 6\cdot MAD\)</span> then set <span
class="math inline">\(u_i = 0\)</span>.)</li>
<li>Compute what are called bisquare weights using the formula: <span
class="math inline">\(b_i = (1 - u_i^2)^2\)</span></li>
<li>Perform a regression using the weights <span
class="math inline">\(w_i = w_i b_i\)</span></li>
<li>Repeat the above process with the new weights <span
class="math inline">\(w_i\)</span> until the weights stop changing very
much.</li>
</ul></li>
<li><p>The final fitted values for each <span
class="math inline">\(X\)</span>-value in the regression are obtained
from the final regression line for each neighborhood. These fitted
values make up the Lowess (or loess) curve.</p></li>
</ol>
<p>Note that the default of the <code>loess</code> function in R is to
use quadratic regressions in each neighborhood instead of linear
regressions. This can be controlled with the <code>loess</code> option
of “degree=2” (quadratic fits) or “degree = 1”. In the
<code>lowess</code> function only a linear regression in each
neighborhood is allowed.</p>
</div>
<p><br /></p>
<hr />
</div>
<div style="padding-left:125px;">
<p><strong>Examples:</strong> <a
href="./Analyses/Linear%20Regression/Examples/BodyWeightSLR.html">bodyweight</a>,
<a
href="./Analyses/Linear%20Regression/Examples/carsSLR.html">cars</a></p>
</div>
<hr />
<!--- End of Add content area.  ------------------>
</div>
<div style="clear:both;">

</div>
<hr />
<div id="quantitative-y-multiple-x"
class="section level3 tabset tabset-fade">
<h3 class="tabset tabset-fade">Quantitative Y | Multiple X</h3>
<div id="graphics-5" class="section level4">
<h4>Graphics</h4>
<div class="tooltipimage" style="float:left;width:125px;"
align="center">
<p><img src="Images/QuantYMultX.png" width=100px;> <span
class="tooltipimagetext">Y is a single quantitative variable of
interest, like height. While we could use an X1 of “shoe-size” to
explain height, we might also want to use a second x-variable, X2, like
“gender” to help explain height. Further x-variables could also be
used.</span></p>
</div>
<div style="padding-left:125px;color:black;">
<p><strong>Test(s) used for this category:</strong></p>
<ul>
<li><p>Multiple Linear Regression</p>
<ul>
<li>Analysis : <a
href="file:///C:/Users/paige/OneDrive/Documents/Fall%20Semester%202024/MATH%20325/Statistics-Notebook-master/Analyses/Linear%20Regression/Weather.html">Heatwaves
in Japanese Navy Air Bases</a></li>
</ul></li>
</ul>
<p><br></p>
<p><strong>Uses multiple factors (predictors) to see the effects on one
quantitative Y variable (outcome):</strong></p>
<ul>
<li><p>How does a combination of factors like study hours, prior test
scores, and student engagement affect a student’s final exam
grade?</p></li>
<li><p>How do factors like age, weight, exercise level, and diet impact
a person’s blood pressure?</p></li>
</ul>
<p><br></p>
<p><a href="GraphicalSummaries.html#scatterplots">
<img class="myhover" src="Images/scatterplotmany.png" alt="Scatterplot" title="Scatterplot with Color and Sizing">
</a></p>
<p><em>Examples:</em></p>
<ul>
<li><p>Is one Navy base more prone to heatwaves than the other?</p>
<ul>
<li>The graph below this one is just a subset by months of this
graph</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>weather <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;C:/Users/paige/OneDrive/Documents/Fall Semester 2024/MATH 325/Statistics-Notebook-master/Data/weather.csv&quot;</span>)</span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>weathery <span class="ot">&lt;-</span> weather <span class="sc">%&gt;%</span></span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(NAME, MAX, RH, MONTH) <span class="sc">%&gt;%</span></span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a>    <span class="at">HUMIDITY =</span> RH, </span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a>    <span class="st">`</span><span class="at">AIR NAVY BASE</span><span class="st">`</span> <span class="ot">=</span> NAME, </span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a>    <span class="at">MAXTEMP =</span> MAX</span>
<span id="cb79-9"><a href="#cb79-9" tabindex="-1"></a>  )</span>
<span id="cb79-10"><a href="#cb79-10" tabindex="-1"></a></span>
<span id="cb79-11"><a href="#cb79-11" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" tabindex="-1"></a></span>
<span id="cb79-13"><a href="#cb79-13" tabindex="-1"></a>weathery.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(weathery, <span class="fu">aes</span>(<span class="at">y =</span> HUMIDITY, <span class="at">x =</span> MAXTEMP, <span class="at">color =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">AIR NAVY BASE</span><span class="st">`</span>))) <span class="sc">+</span></span>
<span id="cb79-14"><a href="#cb79-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb79-15"><a href="#cb79-15" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">paste</span>(</span>
<span id="cb79-16"><a href="#cb79-16" tabindex="-1"></a>      <span class="st">&quot;Air Navy Base:&quot;</span>, <span class="st">`</span><span class="at">AIR NAVY BASE</span><span class="st">`</span>, <span class="st">&quot;&lt;br&gt;&quot;</span>,</span>
<span id="cb79-17"><a href="#cb79-17" tabindex="-1"></a>      <span class="st">&quot;Max Temp:&quot;</span>, <span class="fu">round</span>(MAXTEMP, <span class="dv">1</span>), <span class="st">&quot;C&lt;br&gt;&quot;</span>,</span>
<span id="cb79-18"><a href="#cb79-18" tabindex="-1"></a>      <span class="st">&quot;Humidity:&quot;</span>, <span class="fu">round</span>(HUMIDITY, <span class="dv">1</span>), <span class="st">&quot;%&lt;br&gt;&quot;</span>,</span>
<span id="cb79-19"><a href="#cb79-19" tabindex="-1"></a>      <span class="st">&quot;Month:&quot;</span>, MONTH</span>
<span id="cb79-20"><a href="#cb79-20" tabindex="-1"></a>    )</span>
<span id="cb79-21"><a href="#cb79-21" tabindex="-1"></a>  ), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb79-22"><a href="#cb79-22" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> <span class="st">`</span><span class="at">AIR NAVY BASE</span><span class="st">`</span>), <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb79-23"><a href="#cb79-23" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">&quot;Air Naval Bases&quot;</span>, </span>
<span id="cb79-24"><a href="#cb79-24" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;darkred&quot;</span>),</span>
<span id="cb79-25"><a href="#cb79-25" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Atsugi Air Naval Base&quot;</span>, <span class="st">&quot;Misawa Air Naval Base&quot;</span>)) <span class="sc">+</span></span>
<span id="cb79-26"><a href="#cb79-26" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Weather Patterns in Japan throughout the Year&quot;</span>,</span>
<span id="cb79-27"><a href="#cb79-27" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Max Temperature (C)&quot;</span>,</span>
<span id="cb79-28"><a href="#cb79-28" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;Relative Humidity (%)&quot;</span> ) <span class="sc">+</span></span>
<span id="cb79-29"><a href="#cb79-29" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb79-30"><a href="#cb79-30" tabindex="-1"></a></span>
<span id="cb79-31"><a href="#cb79-31" tabindex="-1"></a><span class="fu">ggplotly</span>(weathery.plot, <span class="at">tooltip=</span><span class="st">&quot;text&quot;</span>)</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-b74c61a2082ad578e6b0" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-b74c61a2082ad578e6b0">{"x":{"data":[{"x":[13,11,11,11,10,10,10,12,14,11,11,13,14,14,12,7,8,12,8,13,9,9,7,13,4,9,6,8,8,11,9,13,10,7,12,11,13,14,11,11,8,14,16,9,8,8,9,10,16,20,14,9,10,17,12,11,11,14,18,18,19,11,16,12,14,18,20,21,23,21,18,17,14,17,21,15,9,15,18,17,22,21,24,11,13,16,14,18,19,18,23,17,18,20,21,21,20,21,16,21,24,23,20,22,19,25,19,20,25,24,25,15,19,16,17,20,21,22,22,25,22,23,24,25,26,27,21,18,20,24,22,22,17,20,19,25,28,31,23,23,25,28,18,24,24,24,25,24,22,24,22,24,24,24,25,28,24,29,27,24,26,23,23,29,26,25,31,27,29,28,26,26,23,25,28,29,29,29,32,33,30,28,31,31,30,27,32,32,30,32,36,35,36,30,31,32,36,37,37,35,31,32,34,33,32,35,36,33,33,33,34,34,33,33,33,35,33,32,34,34,33,33,35,35,32,34,31,30,33,34,35,34,29,34,33,35,33,33,33,32,33,34,30,34,32,30,23,28,31,32,31,33,32,33,31,32,32,33,30,34,30,28,29,27,27,20,28,25,25,20,19,26,25,23,24,23,19,25,25,25,25,27,22,20,22,23,21,24,23,22,21,22,20,23,26,24,25,23,24,27,21,21,18,15,11,16,18,14,17,15,16,19,19,17,21,21,23,13,9,17,22,17,17,11,13,15,14,11,17,19,17,19,20,15,17,16,14,22,25,15,11,10,13,12,10,10,10,13,13,12,11,15,14,13],"y":[52.299999999999997,44.299999999999997,47.700000000000003,41.700000000000003,34.399999999999999,40.100000000000001,50.5,46.899999999999999,50.299999999999997,34.100000000000001,45.600000000000001,43,54.299999999999997,71.200000000000003,82,66.200000000000003,55.600000000000001,48.399999999999999,56.200000000000003,44.100000000000001,32.100000000000001,44.700000000000003,58.799999999999997,33.899999999999999,28.100000000000001,39.799999999999997,51.700000000000003,39.399999999999999,49.700000000000003,32.899999999999999,39.5,40.600000000000001,30.199999999999999,38.299999999999997,48.700000000000003,45.799999999999997,45.399999999999999,55,53.600000000000001,35.600000000000001,75,46.700000000000003,58.5,68.900000000000006,36.100000000000001,33.700000000000003,43.399999999999999,52,52,54.5,34.5,25.699999999999999,45.700000000000003,47,69.900000000000006,33.5,30.199999999999999,44.100000000000001,40.399999999999999,48.399999999999999,38.700000000000003,59.5,36,69.900000000000006,72.099999999999994,61.799999999999997,50.700000000000003,52.799999999999997,44.899999999999999,49.200000000000003,62.399999999999999,59.700000000000003,54.100000000000001,67.299999999999997,58.200000000000003,77.5,80.200000000000003,50.700000000000003,51.700000000000003,73,68.700000000000003,91.5,79.900000000000006,91.099999999999994,85.299999999999997,56.100000000000001,71.799999999999997,70.299999999999997,65.799999999999997,63.600000000000001,56.100000000000001,60.100000000000001,51.299999999999997,47.200000000000003,54.5,70.900000000000006,84.200000000000003,55.399999999999999,45.200000000000003,48.100000000000001,51.799999999999997,48.799999999999997,48.200000000000003,52.399999999999999,93.099999999999994,50.600000000000001,39.100000000000001,56.100000000000001,65.700000000000003,66.799999999999997,57.299999999999997,41.600000000000001,30,33.5,58.799999999999997,72.700000000000003,55.5,60.799999999999997,68.400000000000006,72.900000000000006,58.5,38.200000000000003,59.700000000000003,54.100000000000001,56.299999999999997,60,93.799999999999997,57.100000000000001,43.799999999999997,55.799999999999997,66.599999999999994,63.200000000000003,82.400000000000006,87.900000000000006,78.299999999999997,58.5,62.200000000000003,50.600000000000001,88.799999999999997,76.799999999999997,77.5,68.200000000000003,84.900000000000006,42,63.899999999999999,62.799999999999997,62.700000000000003,69.200000000000003,89.400000000000006,80.900000000000006,63.799999999999997,77,95.200000000000003,63.700000000000003,67.400000000000006,60.5,75.799999999999997,68.599999999999994,77.5,88.400000000000006,86.299999999999997,90.099999999999994,94.099999999999994,79.900000000000006,77.799999999999997,90.599999999999994,58.799999999999997,67.900000000000006,66.099999999999994,63.899999999999999,68.299999999999997,67.099999999999994,82.299999999999997,76.200000000000003,75.099999999999994,76.599999999999994,77.599999999999994,82,71.5,66.299999999999997,77.400000000000006,86.5,74,74.400000000000006,71.200000000000003,81.900000000000006,74.200000000000003,71.5,75.700000000000003,77.5,67,65.099999999999994,59.100000000000001,69.799999999999997,70.400000000000006,67.599999999999994,61.200000000000003,53.600000000000001,65.400000000000006,64.200000000000003,71.400000000000006,64.900000000000006,65.200000000000003,67.700000000000003,68.700000000000003,58.899999999999999,62.299999999999997,71.099999999999994,70.099999999999994,66.099999999999994,66.599999999999994,69,79.099999999999994,70.599999999999994,66.099999999999994,62.200000000000003,73.200000000000003,79.900000000000006,68.5,74.599999999999994,80,70.200000000000003,64.200000000000003,70.599999999999994,84.299999999999997,81.900000000000006,82.799999999999997,84.299999999999997,70.799999999999997,74.599999999999994,73.799999999999997,61.399999999999999,83.700000000000003,74.799999999999997,67.200000000000003,69.400000000000006,70.599999999999994,74.5,71.299999999999997,69.200000000000003,73.5,70.099999999999994,87.799999999999997,68.900000000000006,71.5,72.599999999999994,94.099999999999994,88.700000000000003,81.799999999999997,76.5,74.099999999999994,67.799999999999997,72.200000000000003,80.299999999999997,76.700000000000003,74,68.400000000000006,61.700000000000003,74.900000000000006,62.200000000000003,68.700000000000003,75.799999999999997,68.5,47.299999999999997,56.100000000000001,90.400000000000006,53.899999999999999,41.399999999999999,40.100000000000001,68.599999999999994,92.099999999999994,65.900000000000006,52.299999999999997,57.700000000000003,47.899999999999999,70.400000000000006,85.099999999999994,60.799999999999997,49.700000000000003,65.200000000000003,63.100000000000001,56.100000000000001,46.600000000000001,56.600000000000001,55.899999999999999,61.200000000000003,63.5,54.200000000000003,64.099999999999994,70.099999999999994,54.799999999999997,58.200000000000003,70.400000000000006,67.400000000000006,50.799999999999997,66.200000000000003,67.200000000000003,76.200000000000003,78.200000000000003,55.600000000000001,56.5,65,78.599999999999994,47.100000000000001,74.099999999999994,46.399999999999999,50.100000000000001,67.099999999999994,67,69.700000000000003,41.700000000000003,61.700000000000003,51,66.299999999999997,71.200000000000003,61.700000000000003,42.799999999999997,44.299999999999997,78,74.799999999999997,44.399999999999999,51.100000000000001,43.5,59.399999999999999,54.600000000000001,49.600000000000001,50.200000000000003,60.399999999999999,65.299999999999997,40.100000000000001,59.100000000000001,58.200000000000003,54.299999999999997,78.200000000000003,68.700000000000003,51.100000000000001,52.399999999999999,75.599999999999994,54.799999999999997,32.200000000000003,37.299999999999997,49.399999999999999,52.899999999999999,38.600000000000001,34.700000000000003,44.799999999999997,58.200000000000003,52.600000000000001,60.600000000000001,45.799999999999997,56.200000000000003,56.399999999999999,62.100000000000001,64],"text":["Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 52.3 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 44.3 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 47.7 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 41.7 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 10 C<br> Humidity: 34.4 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 10 C<br> Humidity: 40.1 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 10 C<br> Humidity: 50.5 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 46.9 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 50.3 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 34.1 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 45.6 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 43 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 54.3 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 71.2 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 82 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 7 C<br> Humidity: 66.2 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 55.6 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 48.4 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 56.2 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 44.1 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 9 C<br> Humidity: 32.1 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 9 C<br> Humidity: 44.7 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 7 C<br> Humidity: 58.8 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 33.9 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 4 C<br> Humidity: 28.1 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 9 C<br> Humidity: 39.8 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 6 C<br> Humidity: 51.7 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 39.4 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 49.7 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 32.9 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 9 C<br> Humidity: 39.5 %<br> Month: 1","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 40.6 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 10 C<br> Humidity: 30.2 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 7 C<br> Humidity: 38.3 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 48.7 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 45.8 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 45.4 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 55 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 53.6 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 35.6 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 75 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 46.7 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 58.5 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 9 C<br> Humidity: 68.9 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 36.1 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 33.7 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 9 C<br> Humidity: 43.4 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 10 C<br> Humidity: 52 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 52 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 54.5 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 34.5 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 9 C<br> Humidity: 25.7 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 10 C<br> Humidity: 45.7 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 47 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 69.9 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 33.5 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 30.2 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 44.1 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 40.4 %<br> Month: 2","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 48.4 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 38.7 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 59.5 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 36 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 69.9 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 72.1 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 61.8 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 50.7 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 52.8 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 44.9 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 49.2 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 62.4 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 59.7 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 54.1 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 67.3 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 58.2 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 15 C<br> Humidity: 77.5 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 9 C<br> Humidity: 80.2 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 15 C<br> Humidity: 50.7 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 51.7 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 73 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 68.7 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 91.5 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 79.9 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 91.1 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 85.3 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 56.1 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 71.8 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 70.3 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 65.8 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 63.6 %<br> Month: 3","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 56.1 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 60.1 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 51.3 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 47.2 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 54.5 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 70.9 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 84.2 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 55.4 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 45.2 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 48.1 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 51.8 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 48.8 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 48.2 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 52.4 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 93.1 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 50.6 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 39.1 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 56.1 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 65.7 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 66.8 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 57.3 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 15 C<br> Humidity: 41.6 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 30 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 33.5 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 58.8 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 72.7 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 55.5 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 60.8 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 68.4 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 72.9 %<br> Month: 4","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 58.5 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 38.2 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 59.7 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 54.1 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 26 C<br> Humidity: 56.3 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 60 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 93.8 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 57.1 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 43.8 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 55.8 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 66.6 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 63.2 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 82.4 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 87.9 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 78.3 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 58.5 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 62.2 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 31 C<br> Humidity: 50.6 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 88.8 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 76.8 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 77.5 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 68.2 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 84.9 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 42 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 63.9 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 62.8 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 62.7 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 69.2 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 89.4 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 80.9 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 63.8 %<br> Month: 5","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 77 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 95.2 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 63.7 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 67.4 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 60.5 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 75.8 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 29 C<br> Humidity: 68.6 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 77.5 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 88.4 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 26 C<br> Humidity: 86.3 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 90.1 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 94.1 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 29 C<br> Humidity: 79.9 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 26 C<br> Humidity: 77.8 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 90.6 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 31 C<br> Humidity: 58.8 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 67.9 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 29 C<br> Humidity: 66.1 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 63.9 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 26 C<br> Humidity: 68.3 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 26 C<br> Humidity: 67.1 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 82.3 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 76.2 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 75.1 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 29 C<br> Humidity: 76.6 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 29 C<br> Humidity: 77.6 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 29 C<br> Humidity: 82 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 71.5 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 66.3 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 77.4 %<br> Month: 6","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 86.5 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 31 C<br> Humidity: 74 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 31 C<br> Humidity: 74.4 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 71.2 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 81.9 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 74.2 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 71.5 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 75.7 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 77.5 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 36 C<br> Humidity: 67 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 35 C<br> Humidity: 65.1 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 36 C<br> Humidity: 59.1 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 69.8 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 31 C<br> Humidity: 70.4 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 67.6 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 36 C<br> Humidity: 61.2 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 37 C<br> Humidity: 53.6 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 37 C<br> Humidity: 65.4 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 35 C<br> Humidity: 64.2 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 31 C<br> Humidity: 71.4 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 64.9 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 34 C<br> Humidity: 65.2 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 67.7 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 68.7 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 35 C<br> Humidity: 58.9 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 36 C<br> Humidity: 62.3 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 71.1 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 70.1 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 66.1 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 34 C<br> Humidity: 66.6 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 34 C<br> Humidity: 69 %<br> Month: 7","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 79.1 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 70.6 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 66.1 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 35 C<br> Humidity: 62.2 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 73.2 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 79.9 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 34 C<br> Humidity: 68.5 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 34 C<br> Humidity: 74.6 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 80 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 70.2 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 35 C<br> Humidity: 64.2 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 35 C<br> Humidity: 70.6 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 84.3 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 34 C<br> Humidity: 81.9 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 31 C<br> Humidity: 82.8 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 84.3 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 70.8 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 34 C<br> Humidity: 74.6 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 35 C<br> Humidity: 73.8 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 34 C<br> Humidity: 61.4 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 29 C<br> Humidity: 83.7 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 34 C<br> Humidity: 74.8 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 67.2 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 35 C<br> Humidity: 69.4 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 70.6 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 74.5 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 71.3 %<br> Month: 8","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 69.2 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 73.5 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 34 C<br> Humidity: 70.1 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 87.8 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 34 C<br> Humidity: 68.9 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 71.5 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 72.6 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 94.1 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 88.7 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 31 C<br> Humidity: 81.8 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 76.5 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 31 C<br> Humidity: 74.1 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 67.8 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 72.2 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 80.3 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 31 C<br> Humidity: 76.7 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 74 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 68.4 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 61.7 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 74.9 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 34 C<br> Humidity: 62.2 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 68.7 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 75.8 %<br> Month: 9","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 29 C<br> Humidity: 68.5 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 47.3 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 56.1 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 90.4 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 53.9 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 41.4 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 40.1 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 68.6 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 92.1 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 26 C<br> Humidity: 65.9 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 52.3 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 57.7 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 47.9 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 70.4 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 85.1 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 60.8 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 49.7 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 65.2 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 63.1 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 56.1 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 46.6 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 56.6 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 55.9 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 61.2 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 63.5 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 54.2 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 64.1 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 70.1 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 54.8 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 58.2 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 70.4 %<br> Month: 10","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 67.4 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 26 C<br> Humidity: 50.8 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 66.2 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 67.2 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 76.2 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 78.2 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 55.6 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 56.5 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 65 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 78.6 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 15 C<br> Humidity: 47.1 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 74.1 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 46.4 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 50.1 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 67.1 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 67 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 15 C<br> Humidity: 69.7 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 41.7 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 61.7 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 51 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 66.3 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 71.2 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 61.7 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 42.8 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 44.3 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 9 C<br> Humidity: 78 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 74.8 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 44.4 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 51.1 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 43.5 %<br> Month: 11","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 59.4 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 54.6 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 15 C<br> Humidity: 49.6 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 50.2 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 60.4 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 65.3 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 40.1 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 59.1 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 58.2 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 54.3 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 15 C<br> Humidity: 78.2 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 68.7 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 51.1 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 52.4 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 75.6 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 54.8 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 15 C<br> Humidity: 32.2 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 37.3 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 10 C<br> Humidity: 49.4 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 52.9 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 38.6 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 10 C<br> Humidity: 34.7 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 10 C<br> Humidity: 44.8 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 10 C<br> Humidity: 58.2 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 52.6 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 60.6 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 45.8 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 56.2 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 15 C<br> Humidity: 56.4 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 62.1 %<br> Month: 12","Air Navy Base: ATSUGI US NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 64 %<br> Month: 12"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","opacity":1,"size":3.7795275590551185,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(255,0,0,1)"}},"hoveron":"points","name":"ATSUGI US NAVAL AIR STATION","legendgroup":"ATSUGI US NAVAL AIR STATION","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5,-3,-3,-2,-1,2,3,1,5,1,6,9,12,6,1,1,-1,0,2,4,-1,-2,1,-1,-6,-5,-2,-4,-4,-2,-3,3,-1,-3,0,1,5,4,0,-3,1,2,5,0,-2,-3,0,6,8,3,-1,-2,1,6,3,1,-1,7,11,9,3,3,4,6,9,12,16,8,12,11,11,11,8,8,15,9,7,12,16,13,17,22,16,8,8,10,10,11,13,17,13,8,12,19,18,19,17,12,11,18,21,13,16,19,11,15,9,13,15,22,16,12,14,13,16,16,15,19,18,21,20,16,21,24,24,13,10,11,20,17,16,14,16,17,17,17,23,31,16,14,19,21,12,20,23,24,24,21,22,20,23,25,20,20,23,25,28,22,21,18,19,17,19,20,22,21,24,27,26,20,23,24,24,18,19,21,22,26,30,24,25,27,23,21,22,25,30,26,27,25,28,25,24,28,27,25,25,27,28,24,22,23,25,28,32,33,32,30,30,33,34,30,30,33,34,35,34,32,27,30,34,36,31,23,null,22,26,31,32,28,29,30,29,31,33,33,31,33,31,30,28,29,35,33,27,27,29,24,25,25,25,25,26,28,34,27,27,24,27,28,31,28,26,19,24,24,22,22,23,24,22,25,22,25,21,22,21,20,17,19,18,21,18,19,20,23,23,17,19,16,19,21,17,10,14,17,18,19,18,19,18,16,17,18,21,17,25,13,17,21,20,11,16,19,7,8,8,7,11,14,15,11,14,9,13,18,19,8,2,4,8,11,1,0,2,3,4,8,12,12,12,10,16,8,5,2,2,3,1,7,0,-3,-1,-1,0,-1,-3,0,4,4,0,5,4,4,5],"y":[72.599999999999994,84,80.299999999999997,80.299999999999997,75.900000000000006,68.5,84.5,76.099999999999994,73,68.799999999999997,61.600000000000001,68.099999999999994,63.700000000000003,92.5,95,77.599999999999994,80.5,78.599999999999994,69,73.599999999999994,77.799999999999997,75.400000000000006,75.900000000000006,77.900000000000006,77.799999999999997,81.900000000000006,80.099999999999994,80.5,76.799999999999997,80.200000000000003,77.799999999999997,75.599999999999994,82.599999999999994,78.400000000000006,77.400000000000006,73.099999999999994,68.299999999999997,67,69.200000000000003,74.799999999999997,73.099999999999994,87.099999999999994,82.900000000000006,94.299999999999997,82.099999999999994,73.5,61.799999999999997,59.100000000000001,60.299999999999997,89.700000000000003,80.299999999999997,85.299999999999997,64.900000000000006,70.599999999999994,84.599999999999994,78.700000000000003,67.299999999999997,50.700000000000003,54,71,72.900000000000006,74.700000000000003,61.799999999999997,61.5,51.5,59.399999999999999,58.799999999999997,85.200000000000003,70.299999999999997,63,78.900000000000006,69.5,49.600000000000001,67.400000000000006,62.200000000000003,49.100000000000001,52.600000000000001,41.299999999999997,50.200000000000003,67.700000000000003,70.400000000000006,69.700000000000003,55.5,69,87.599999999999994,54.200000000000003,59.700000000000003,58.5,57.399999999999999,52,53,75.700000000000003,64.599999999999994,41.299999999999997,50.200000000000003,67.599999999999994,88.700000000000003,68.400000000000006,59.899999999999999,42,40.100000000000001,44.100000000000001,32.399999999999999,55.399999999999999,74.900000000000006,66,64.5,70.900000000000006,62.799999999999997,46.299999999999997,32.399999999999999,44.399999999999999,36.100000000000001,36.700000000000003,34.299999999999997,70.799999999999997,33.600000000000001,52.799999999999997,77.700000000000003,50.700000000000003,53.899999999999999,49.600000000000001,33.200000000000003,34.299999999999997,64.599999999999994,92.799999999999997,77.400000000000006,82.799999999999997,43,56.799999999999997,68.900000000000006,67.200000000000003,77.400000000000006,75.400000000000006,89.400000000000006,88.799999999999997,72.200000000000003,43.399999999999999,88.200000000000003,86.5,75.599999999999994,59.700000000000003,75.200000000000003,55,43.200000000000003,64,63.799999999999997,78.5,73.799999999999997,59.600000000000001,48.200000000000003,45.5,85.799999999999997,69.299999999999997,51.299999999999997,38.5,55.200000000000003,80.400000000000006,82.099999999999994,92,89.599999999999994,94.400000000000006,92,95,88.099999999999994,93.299999999999997,86.400000000000006,57,52.200000000000003,71.200000000000003,57.299999999999997,70,79.099999999999994,92.599999999999994,95,87.599999999999994,87.599999999999994,82.099999999999994,67.200000000000003,85.200000000000003,75.400000000000006,73.200000000000003,82.799999999999997,89.900000000000006,82.200000000000003,83.400000000000006,61.899999999999999,79.5,77.099999999999994,86.200000000000003,76.900000000000006,82.299999999999997,83.599999999999994,66,75.700000000000003,92.400000000000006,90.200000000000003,85.900000000000006,82.299999999999997,90.599999999999994,82.900000000000006,84.5,86.299999999999997,79.299999999999997,65.599999999999994,64,77.299999999999997,73.700000000000003,69.799999999999997,60.799999999999997,55.399999999999999,76.099999999999994,72.599999999999994,63.100000000000001,59.200000000000003,61.5,69.200000000000003,80.700000000000003,90.700000000000003,81.099999999999994,62.799999999999997,53.100000000000001,77.299999999999997,92.900000000000006,93.400000000000006,92.900000000000006,93.599999999999994,77.400000000000006,75,86,89.799999999999997,83.599999999999994,86.099999999999994,77.5,71,76.700000000000003,76.200000000000003,76.099999999999994,75.599999999999994,75.900000000000006,83.599999999999994,83.599999999999994,66.900000000000006,70.599999999999994,81.799999999999997,79.900000000000006,86.599999999999994,91.799999999999997,82.200000000000003,71.799999999999997,77.200000000000003,89.599999999999994,87,82.5,82.400000000000006,81.900000000000006,82.799999999999997,76.099999999999994,74.900000000000006,77.099999999999994,69.400000000000006,76,70.700000000000003,92.099999999999994,72.599999999999994,73.400000000000006,69.099999999999994,73.400000000000006,85.400000000000006,81.900000000000006,87.099999999999994,61.200000000000003,72.799999999999997,74.599999999999994,65.799999999999997,58.799999999999997,73.099999999999994,73,74.299999999999997,70.799999999999997,69.400000000000006,79.799999999999997,74.5,60.100000000000001,57.700000000000003,56.899999999999999,59.899999999999999,82.799999999999997,60.5,58.200000000000003,60.600000000000001,72.900000000000006,82,78.900000000000006,65.599999999999994,60,68.599999999999994,78.799999999999997,82.599999999999994,79.200000000000003,83.200000000000003,83.599999999999994,78.099999999999994,69.5,67.5,72.700000000000003,63.399999999999999,80.299999999999997,72.299999999999997,70.5,61.100000000000001,76.799999999999997,67.5,71.200000000000003,78.900000000000006,74.599999999999994,74.599999999999994,66.599999999999994,73.799999999999997,68.799999999999997,84,74.099999999999994,62.600000000000001,62.200000000000003,55.899999999999999,61.299999999999997,62.5,79.900000000000006,83.799999999999997,80.5,90,79.099999999999994,90.900000000000006,84.900000000000006,80.799999999999997,75.299999999999997,88.5,68.599999999999994,78.200000000000003,80.099999999999994,68.200000000000003,55.5,68.700000000000003,56,66.400000000000006,86.5,64.799999999999997,61.299999999999997,93,90.5,82.200000000000003,79,83.599999999999994,75.5,65.700000000000003,73.799999999999997,82.700000000000003,78.200000000000003,74.299999999999997,73.599999999999994,72.099999999999994,67.400000000000006,65.599999999999994,85.400000000000006,81.700000000000003],"text":["Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 5 C<br> Humidity: 72.6 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -3 C<br> Humidity: 84 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -3 C<br> Humidity: 80.3 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -2 C<br> Humidity: 80.3 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -1 C<br> Humidity: 75.9 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 2 C<br> Humidity: 68.5 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 3 C<br> Humidity: 84.5 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 1 C<br> Humidity: 76.1 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 5 C<br> Humidity: 73 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 1 C<br> Humidity: 68.8 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 6 C<br> Humidity: 61.6 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 9 C<br> Humidity: 68.1 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 63.7 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 6 C<br> Humidity: 92.5 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 1 C<br> Humidity: 95 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 1 C<br> Humidity: 77.6 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -1 C<br> Humidity: 80.5 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 0 C<br> Humidity: 78.6 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 2 C<br> Humidity: 69 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 4 C<br> Humidity: 73.6 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -1 C<br> Humidity: 77.8 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -2 C<br> Humidity: 75.4 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 1 C<br> Humidity: 75.9 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -1 C<br> Humidity: 77.9 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -6 C<br> Humidity: 77.8 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -5 C<br> Humidity: 81.9 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -2 C<br> Humidity: 80.1 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -4 C<br> Humidity: 80.5 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -4 C<br> Humidity: 76.8 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -2 C<br> Humidity: 80.2 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -3 C<br> Humidity: 77.8 %<br> Month: 1","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 3 C<br> Humidity: 75.6 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -1 C<br> Humidity: 82.6 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -3 C<br> Humidity: 78.4 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 0 C<br> Humidity: 77.4 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 1 C<br> Humidity: 73.1 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 5 C<br> Humidity: 68.3 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 4 C<br> Humidity: 67 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 0 C<br> Humidity: 69.2 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -3 C<br> Humidity: 74.8 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 1 C<br> Humidity: 73.1 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 2 C<br> Humidity: 87.1 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 5 C<br> Humidity: 82.9 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 0 C<br> Humidity: 94.3 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -2 C<br> Humidity: 82.1 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -3 C<br> Humidity: 73.5 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 0 C<br> Humidity: 61.8 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 6 C<br> Humidity: 59.1 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 60.3 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 3 C<br> Humidity: 89.7 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -1 C<br> Humidity: 80.3 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -2 C<br> Humidity: 85.3 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 1 C<br> Humidity: 64.9 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 6 C<br> Humidity: 70.6 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 3 C<br> Humidity: 84.6 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 1 C<br> Humidity: 78.7 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -1 C<br> Humidity: 67.3 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 7 C<br> Humidity: 50.7 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 54 %<br> Month: 2","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 9 C<br> Humidity: 71 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 3 C<br> Humidity: 72.9 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 3 C<br> Humidity: 74.7 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 4 C<br> Humidity: 61.8 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 6 C<br> Humidity: 61.5 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 9 C<br> Humidity: 51.5 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 59.4 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 58.8 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 85.2 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 70.3 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 63 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 78.9 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 69.5 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 49.6 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 67.4 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 15 C<br> Humidity: 62.2 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 9 C<br> Humidity: 49.1 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 7 C<br> Humidity: 52.6 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 41.3 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 50.2 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 67.7 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 70.4 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 69.7 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 55.5 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 69 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 87.6 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 10 C<br> Humidity: 54.2 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 10 C<br> Humidity: 59.7 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 58.5 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 57.4 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 52 %<br> Month: 3","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 53 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 75.7 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 64.6 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 41.3 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 50.2 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 67.6 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 88.7 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 68.4 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 59.9 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 42 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 40.1 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 44.1 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 32.4 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 55.4 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 74.9 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 15 C<br> Humidity: 66 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 9 C<br> Humidity: 64.5 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 70.9 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 15 C<br> Humidity: 62.8 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 46.3 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 32.4 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 44.4 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 36.1 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 36.7 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 34.3 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 70.8 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 15 C<br> Humidity: 33.6 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 52.8 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 77.7 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 50.7 %<br> Month: 4","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 53.9 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 49.6 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 33.2 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 34.3 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 64.6 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 92.8 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 10 C<br> Humidity: 77.4 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 82.8 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 43 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 56.8 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 68.9 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 67.2 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 77.4 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 75.4 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 89.4 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 88.8 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 72.2 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 31 C<br> Humidity: 43.4 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 88.2 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 86.5 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 75.6 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 59.7 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 75.2 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 55 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 43.2 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 64 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 63.8 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 78.5 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 73.8 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 59.6 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 48.2 %<br> Month: 5","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 45.5 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 85.8 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 69.3 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 51.3 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 38.5 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 55.2 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 80.4 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 82.1 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 92 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 89.6 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 94.4 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 92 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 95 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 88.1 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 93.3 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 86.4 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 57 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 26 C<br> Humidity: 52.2 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 71.2 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 57.3 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 70 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 79.1 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 92.6 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 95 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 87.6 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 87.6 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 26 C<br> Humidity: 82.1 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 67.2 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 85.2 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 75.4 %<br> Month: 6","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 73.2 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 82.8 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 89.9 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 82.2 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 83.4 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 61.9 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 26 C<br> Humidity: 79.5 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 77.1 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 86.2 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 76.9 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 82.3 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 83.6 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 66 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 75.7 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 92.4 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 90.2 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 85.9 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 82.3 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 90.6 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 82.9 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 84.5 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 86.3 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 79.3 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 65.6 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 64 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 77.3 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 73.7 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 69.8 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 60.8 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 34 C<br> Humidity: 55.4 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 76.1 %<br> Month: 7","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 72.6 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 63.1 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 34 C<br> Humidity: 59.2 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 35 C<br> Humidity: 61.5 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 34 C<br> Humidity: 69.2 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 80.7 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 90.7 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 81.1 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 34 C<br> Humidity: 62.8 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 36 C<br> Humidity: 53.1 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 31 C<br> Humidity: 77.3 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 92.9 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: NA C<br> Humidity: 93.4 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 92.9 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 26 C<br> Humidity: 93.6 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 31 C<br> Humidity: 77.4 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 32 C<br> Humidity: 75 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 86 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 29 C<br> Humidity: 89.8 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 83.6 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 29 C<br> Humidity: 86.1 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 31 C<br> Humidity: 77.5 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 71 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 76.7 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 31 C<br> Humidity: 76.2 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 76.1 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 31 C<br> Humidity: 75.6 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 30 C<br> Humidity: 75.9 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 83.6 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 29 C<br> Humidity: 83.6 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 35 C<br> Humidity: 66.9 %<br> Month: 8","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 33 C<br> Humidity: 70.6 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 81.8 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 79.9 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 29 C<br> Humidity: 86.6 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 91.8 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 82.2 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 71.8 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 77.2 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 89.6 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 26 C<br> Humidity: 87 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 82.5 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 34 C<br> Humidity: 82.4 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 81.9 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 82.8 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 76.1 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 27 C<br> Humidity: 74.9 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 77.1 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 31 C<br> Humidity: 69.4 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 28 C<br> Humidity: 76 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 26 C<br> Humidity: 70.7 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 92.1 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 72.6 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 73.4 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 69.1 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 73.4 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 85.4 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 24 C<br> Humidity: 81.9 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 87.1 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 61.2 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 72.8 %<br> Month: 9","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 74.6 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 65.8 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 22 C<br> Humidity: 58.8 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 73.1 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 73 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 74.3 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 70.8 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 69.4 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 79.8 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 74.5 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 60.1 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 57.7 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 56.9 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 23 C<br> Humidity: 59.9 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 82.8 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 60.5 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 58.2 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 60.6 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 72.9 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 82 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 10 C<br> Humidity: 78.9 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 65.6 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 60 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 68.6 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 78.8 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 82.6 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 79.2 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 83.2 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 83.6 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 78.1 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 69.5 %<br> Month: 10","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 67.5 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 72.7 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 25 C<br> Humidity: 63.4 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 80.3 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 17 C<br> Humidity: 72.3 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 21 C<br> Humidity: 70.5 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 20 C<br> Humidity: 61.1 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 76.8 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 67.5 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 71.2 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 7 C<br> Humidity: 78.9 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 74.6 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 74.6 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 7 C<br> Humidity: 66.6 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 73.8 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 68.8 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 15 C<br> Humidity: 84 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 74.1 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 14 C<br> Humidity: 62.6 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 9 C<br> Humidity: 62.2 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 13 C<br> Humidity: 55.9 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 18 C<br> Humidity: 61.3 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 19 C<br> Humidity: 62.5 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 79.9 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 2 C<br> Humidity: 83.8 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 4 C<br> Humidity: 80.5 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 90 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 11 C<br> Humidity: 79.1 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 1 C<br> Humidity: 90.9 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 0 C<br> Humidity: 84.9 %<br> Month: 11","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 2 C<br> Humidity: 80.8 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 3 C<br> Humidity: 75.3 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 4 C<br> Humidity: 88.5 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 68.6 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 78.2 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 80.1 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 12 C<br> Humidity: 68.2 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 10 C<br> Humidity: 55.5 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 16 C<br> Humidity: 68.7 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 8 C<br> Humidity: 56 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 5 C<br> Humidity: 66.4 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 2 C<br> Humidity: 86.5 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 2 C<br> Humidity: 64.8 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 3 C<br> Humidity: 61.3 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 1 C<br> Humidity: 93 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 7 C<br> Humidity: 90.5 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 0 C<br> Humidity: 82.2 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -3 C<br> Humidity: 79 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -1 C<br> Humidity: 83.6 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -1 C<br> Humidity: 75.5 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 0 C<br> Humidity: 65.7 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -1 C<br> Humidity: 73.8 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: -3 C<br> Humidity: 82.7 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 0 C<br> Humidity: 78.2 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 4 C<br> Humidity: 74.3 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 4 C<br> Humidity: 73.6 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 0 C<br> Humidity: 72.1 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 5 C<br> Humidity: 67.4 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 4 C<br> Humidity: 65.6 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 4 C<br> Humidity: 85.4 %<br> Month: 12","Air Navy Base: MISAWA NAVAL AIR STATION <br> Max Temp: 5 C<br> Humidity: 81.7 %<br> Month: 12"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(139,0,0,1)","opacity":1,"size":3.7795275590551185,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(139,0,0,1)"}},"hoveron":"points","name":"MISAWA NAVAL AIR STATION","legendgroup":"MISAWA NAVAL AIR STATION","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4,4.4177215189873422,4.8354430379746836,5.2531645569620249,5.6708860759493671,6.0886075949367093,6.5063291139240507,6.924050632911392,7.3417721518987342,7.7594936708860764,8.1772151898734187,8.5949367088607591,9.0126582278481013,9.4303797468354436,9.848101265822784,10.265822784810126,10.683544303797468,11.101265822784811,11.518987341772153,11.936708860759493,12.354430379746836,12.772151898734178,13.189873417721518,13.60759493670886,14.025316455696203,14.443037974683545,14.860759493670887,15.278481012658228,15.69620253164557,16.11392405063291,16.531645569620252,16.949367088607595,17.367088607594937,17.784810126582279,18.202531645569621,18.620253164556964,19.037974683544306,19.455696202531648,19.873417721518987,20.291139240506329,20.708860759493671,21.126582278481013,21.544303797468356,21.962025316455698,22.379746835443036,22.797468354430379,23.215189873417721,23.632911392405063,24.050632911392405,24.468354430379748,24.88607594936709,25.303797468354432,25.721518987341774,26.139240506329113,26.556962025316455,26.974683544303797,27.39240506329114,27.810126582278482,28.227848101265824,28.645569620253166,29.063291139240505,29.481012658227847,29.898734177215189,30.316455696202532,30.734177215189874,31.151898734177216,31.569620253164558,31.9873417721519,32.405063291139243,32.822784810126578,33.240506329113927,33.658227848101262,34.075949367088612,34.493670886075947,34.911392405063296,35.329113924050631,35.746835443037973,36.164556962025316,36.582278481012658,37],"y":[46.051816291702636,46.426381468656878,46.800946645611113,47.175511822565348,47.55007699951959,47.924642176473824,48.299207353428059,48.673772530382294,49.048337707336536,49.422902884290771,49.797468061245013,50.172033238199248,50.546598415153483,50.921163592107717,51.295728769061952,51.670293946016194,52.044859122970429,52.419424299924671,52.793989476878906,53.168554653833141,53.543119830787376,53.917685007741618,54.292250184695853,54.666815361650094,55.041380538604329,55.415945715558564,55.790510892512799,56.165076069467041,56.539641246421276,56.914206423375511,57.288771600329753,57.663336777283988,58.037901954238222,58.412467131192464,58.787032308146699,59.161597485100941,59.536162662055176,59.910727839009411,60.285293015963646,60.659858192917881,61.034423369872123,61.408988546826365,61.783553723780599,62.158118900734834,62.532684077689069,62.907249254643304,63.281814431597539,63.656379608551781,64.030944785506023,64.405509962460258,64.780075139414492,65.154640316368727,65.529205493322962,65.903770670277197,66.278335847231432,66.652901024185681,67.027466201139916,67.402031378094151,67.776596555048386,68.151161732002635,68.525726908956869,68.900292085911104,69.274857262865339,69.649422439819574,70.023987616773809,70.398552793728044,70.773117970682279,71.147683147636528,71.522248324590763,71.896813501544997,72.271378678499232,72.645943855453467,73.020509032407716,73.395074209361951,73.769639386316186,74.144204563270421,74.518769740224656,74.89333491717889,75.267900094133125,75.64246527108736],"text":"","type":"scatter","mode":"lines","name":"ATSUGI US NAVAL AIR STATION","line":{"width":3.7795275590551185,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","legendgroup":"ATSUGI US NAVAL AIR STATION","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-6,-5.4683544303797467,-4.9367088607594933,-4.4050632911392409,-3.8734177215189876,-3.3417721518987342,-2.8101265822784813,-2.2784810126582284,-1.7468354430379751,-1.2151898734177218,-0.68354430379746844,-0.151898734177216,0.37974683544303733,0.91139240506329067,1.4430379746835431,1.9746835443037964,2.5063291139240498,3.0379746835443022,3.5696202531645564,4.1012658227848089,4.6329113924050631,5.1645569620253156,5.696202531645568,6.2278481012658222,6.7594936708860747,7.2911392405063271,7.8227848101265813,8.3544303797468338,8.8860759493670862,9.4177215189873404,9.9493670886075929,10.481012658227847,11.0126582278481,11.544303797468352,12.075949367088604,12.60759493670886,13.139240506329113,13.670886075949365,14.202531645569618,14.73417721518987,15.265822784810126,15.797468354430379,16.329113924050631,16.860759493670884,17.392405063291136,17.924050632911388,18.455696202531644,18.987341772151897,19.518987341772149,20.050632911392402,20.582278481012654,21.11392405063291,21.645569620253163,22.177215189873415,22.708860759493668,23.24050632911392,23.772151898734172,24.303797468354428,24.835443037974681,25.367088607594933,25.898734177215186,26.430379746835442,26.962025316455694,27.493670886075947,28.025316455696199,28.556962025316452,29.088607594936704,29.620253164556956,30.151898734177209,30.683544303797461,31.215189873417721,31.746835443037973,32.278481012658226,32.810126582278478,33.341772151898731,33.873417721518983,34.405063291139236,34.936708860759488,35.46835443037974,36],"y":[73.98360092304199,73.933531591671795,73.883462260301584,73.833392928931374,73.783323597561164,73.733254266190954,73.683184934820744,73.633115603450534,73.583046272080324,73.532976940710114,73.482907609339904,73.432838277969694,73.382768946599484,73.332699615229274,73.282630283859064,73.232560952488853,73.182491621118643,73.132422289748433,73.082352958378223,73.032283627008013,72.982214295637803,72.932144964267593,72.882075632897383,72.832006301527173,72.781936970156963,72.731867638786753,72.681798307416543,72.631728976046332,72.581659644676122,72.531590313305912,72.481520981935702,72.431451650565492,72.381382319195282,72.331312987825072,72.281243656454862,72.231174325084652,72.181104993714442,72.131035662344232,72.080966330974022,72.030896999603812,71.980827668233601,71.930758336863391,71.880689005493181,71.830619674122971,71.780550342752761,71.730481011382551,71.680411680012341,71.630342348642131,71.580273017271921,71.530203685901711,71.480134354531501,71.430065023161291,71.379995691791081,71.32992636042087,71.27985702905066,71.22978769768045,71.17971836631024,71.12964903494003,71.07957970356982,71.02951037219961,70.9794410408294,70.92937170945919,70.87930237808898,70.82923304671877,70.77916371534856,70.729094383978349,70.679025052608139,70.628955721237929,70.578886389867719,70.528817058497509,70.478747727127299,70.428678395757089,70.378609064386879,70.328539733016669,70.278470401646459,70.228401070276249,70.178331738906039,70.128262407535829,70.078193076165618,70.028123744795408],"text":"","type":"scatter","mode":"lines","name":"MISAWA NAVAL AIR STATION","line":{"width":3.7795275590551185,"color":"rgba(139,0,0,1)","dash":"solid"},"hoveron":"points","legendgroup":"MISAWA NAVAL AIR STATION","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":37.260273972602747},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Weather Patterns in Japan throughout the Year","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-8.1500000000000004,39.149999999999999],"tickmode":"array","ticktext":["0","10","20","30"],"tickvals":[0,9.9999999999999982,19.999999999999993,30],"categoryorder":"array","categoryarray":["0","10","20","30"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Max Temperature (C)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[22.224999999999998,98.674999999999997],"tickmode":"array","ticktext":["40","60","80"],"tickvals":[40,60,80],"categoryorder":"array","categoryarray":["40","60","80"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Relative Humidity (%)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Air Naval Bases","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"30a8257d698b":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"},"30a81d508a5":{"x":{},"y":{},"colour":{}}},"cur_data":"30a8257d698b","visdat":{"30a8257d698b":["function (y) ","x"],"30a81d508a5":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><br><br></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="fu">ggplot</span>(weathery, <span class="fu">aes</span>(<span class="at">y =</span> HUMIDITY, <span class="at">x =</span> MAXTEMP, <span class="at">color =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">AIR NAVY BASE</span><span class="st">`</span>))) <span class="sc">+</span></span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> <span class="st">`</span><span class="at">AIR NAVY BASE</span><span class="st">`</span>), <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">&quot;Air Naval Bases&quot;</span>, </span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;darkred&quot;</span>),</span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Atsugi Air Naval Base&quot;</span>, <span class="st">&quot;Misawa Air Naval Base&quot;</span>)) <span class="sc">+</span></span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Weather Patterns in Japan throughout the Year by Months&quot;</span>,</span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Max Temperature (C)&quot;</span>,</span>
<span id="cb80-9"><a href="#cb80-9" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;Relative Humidity (%)&quot;</span> ) <span class="sc">+</span></span>
<span id="cb80-10"><a href="#cb80-10" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-11"><a href="#cb80-11" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>MONTH)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
<!--- End of Add content area.  ------------------>
</div>
</div>
<div id="tests-5" class="section level4">
<h4>Tests</h4>
<div style="padding-left:125px;color:black;">
<!-- Add your customizations in the area below: -->
<hr />
<div id="multiple-linear-regression"
class="section level5 tabset tabset-fade tabset-pills">
<h5 class="tabset tabset-fade tabset-pills">Multiple Linear
Regression</h5>
<div style="float:left;width:125px;" align="center">
<p><img src="Images/QuantYMultX.png" width=108px;></p>
</div>
<p>Multiple regression is a way to understand how different factors
affect something we’re interested in. <em>It’s like having more than one
clue to solve a mystery.</em></p>
<p><u>Here’s what you need to know:</u></p>
<ul>
<li><p>We can use several different pieces of information (called
variables) to predict an outcome.</p></li>
<li><p>There are many ways to combine these pieces of
information.</p></li>
<li><p>We start with simple combinations and build up to more complex
ones, kind of like building with Lego blocks.</p></li>
</ul>
<p>This helps us make better predictions and understand complex
situations more clearly.</p>
<div id="overview-10" class="section level6">
<h6>Overview</h6>
<div style="padding-left:125px;">
<p>Select a model to see interpretation details, an example, and R Code
help.</p>
<div class="tab">
<p><button class="tablinks" onclick="openTab(event, 'LearnMoresimpleLinearModel')">Simple</button>
<button class="tablinks" onclick="openTab(event, 'LearnMoreQuadraticModel')">Quadratic</button>
<button class="tablinks" onclick="openTab(event, 'LearnMoreCubicModel')">Cubic</button>
<button class="tablinks" onclick="openTab(event, 'LearnMoreTwoLinesModel')">Two-Lines</button>
<button class="tablinks" onclick="openTab(event, 'LearnMorethreeDModel')">3D</button>
<button class="tablinks" onclick="openTab(event, 'LearnMoreHDModel')">HD</button></p>
</div>
<div id="LearnMoresimpleLinearModel" class="tabcontent"
style="display:block;">
<p>
<table>
<tr>
<td>
<p><img src="index_files/figure-html/unnamed-chunk-100-1.png" width="144" /></p>
</td>
<td style="text-align: center;padding-left:15px;">
<p><span class="math display">\[
Y_i = \overbrace{\underbrace{\beta_0 + \beta_1
X_i}_{E\{Y_i\}}}^\text{Simple Model} + \epsilon_i
\]</span></p>
</td>
</tr>
</table>
<p><br/></p>
<p>The Simple Linear Regression model uses a single x-variable once:
<span class="math inline">\(X_i\)</span>.</p>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\beta_0\)</span></td>
<td>Y-intercept of the Model</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_1\)</span></td>
<td>Slope of the line</td>
</tr>
</tbody>
</table>
</p>
</div>
<div id="LearnMoreQuadraticModel" class="tabcontent">
<p>
<table>
<tr>
<td>
<p><img src="index_files/figure-html/unnamed-chunk-101-1.png" width="144" /></p>
</td>
<td style="text-align: center;padding-left:15px;">
<p><span class="math display">\[
Y_i = \overbrace{\underbrace{\beta_0 + \beta_1 X_i + \beta_2
X_i^2}_{E\{Y_i\}}}^\text{Quadratic Model} + \epsilon_i
\]</span></p>
</td>
</tr>
</table>
<p><br/></p>
<p>The Quadratic model is a bit like using the same ingredient twice in
a recipe, but in different ways. It uses the same factor (<span
class="math inline">\(X_i^2\)</span>) in two different forms:</p>
<ul>
<li>Once in its regular form (<span class="math inline">\(\beta_1
X_i\)</span>)</li>
<li>Once squared (<span class="math inline">\(\beta_2
X_i^2\)</span>)</li>
</ul>
<p>This squared part is what we call the “quadratic” term. It helps us
describe relationships that aren’t just straight lines, but have curves
to them.</p>
<table>
<colgroup>
<col width="13%" />
<col width="86%" />
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\beta_0\)</span></td>
<td>Y-intercept of the Model.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_1\)</span></td>
<td>Controls the x-position of the vertex of the parabola by <span
class="math inline">\(\frac{-\beta_1}{2\cdot\beta_2}\)</span>.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\beta_2\)</span></td>
<td>Controls the concavity and “steepness” of the Model: negative values
face down, positive values face up; large values imply “steeper”
parabolas and low values imply “flatter” parabolas. Also involved in the
position of the vertex, see <span
class="math inline">\(\beta_1\)</span>’s explanation.</td>
</tr>
</tbody>
</table>
<p><strong>An Example</strong></p>
<p>Using the <code>airquality</code> data set, we run the following
“quadratic” regression. Pay careful attention to how the mathematical
model for <span class="math inline">\(Y_i = \ldots\)</span> is
translated to R-Code inside of <code>lm(...)</code>.</p>
<p><span class="math display">\[
  \underbrace{Y_i}_\text{Temp} \underbrace{=}_{\sim}
\overbrace{\beta_0}^{\text{y-int}} +
\overbrace{\beta_1}^{\stackrel{\text{slope}}{\text{term}}}
\underbrace{X_{i}}_\text{Month} \underbrace{+}_{+}
\overbrace{\beta_2}^{\stackrel{\text{quadratic}}{\text{term}}}  \underbrace{X_{i}^2}_\text{I(Month^2)}
+ \epsilon_i
\]</span></p>
<a href="javascript:showhide('quadraticregressionexamplecode')">
<div class="hoverchunk">
<p><span class="tooltipr"> lm.quad &lt;- <span class="tooltiprtext">A
name we made up for our “quadratic” regression.</span> </span><span
class="tooltipr"> lm( <span class="tooltiprtext">R function lm used to
perform linear regressions in R. The lm stands for “linear
model”.</span> </span><span class="tooltipr"> Temp <span
class="tooltiprtext">Y-variable, should be quantitative.</span>
</span><span class="tooltipr">  ~  <span class="tooltiprtext">The tilde
<code>~</code> is what lm(…) uses to state the regression equation <span
class="math inline">\(Y_i = ...\)</span>. Notice that the <code>~</code>
is not followed by <span class="math inline">\(\beta_0 +
\beta_1\)</span> like <span class="math inline">\(Y_i = ...\)</span>.
Instead, <span class="math inline">\(X_{i}\)</span> (Month in this case)
is the first term following <code>~</code>. This is because the <span
class="math inline">\(\beta\)</span>’s are going to be estimated by the
lm(…). These “Estimates” can be found using summary(lmObject) and
looking at the <strong>Estimates</strong> column in the output.</span>
</span><span class="tooltipr"> Month <span class="tooltiprtext"><span
class="math inline">\(X_{i}\)</span>, should be quantitative.</span>
</span><span class="tooltipr">  +  <span class="tooltiprtext">The plus
<code>+</code> is used between each term in the model. Note that only
the x-variables are included in the lm(…) from the <span
class="math inline">\(Y_i = ...\)</span> model. No beta’s are
included.</span> </span><span class="tooltipr"> I(Month^2) <span
class="tooltiprtext"><span class="math inline">\(X_{i}^2\)</span>, where
the function I(…) protects the squaring of Month from how lm(…) would
otherwise interpret that statement. The I(…) function must be used
anytime you raise an x-variable to a power in the lm(…)
statement.</span> </span><span class="tooltipr"> , data=airquality <span
class="tooltiprtext">This is the data set we are using for the
regression.</span> </span><span class="tooltipr"> )<br />
<span class="tooltiprtext">Closing parenthsis for the lm(…)
function.</span> </span><span class="tooltipr">     <br />
<span class="tooltiprtext">Press Enter to run the code.</span>
</span><span class="tooltipr" style="float:right;">  …  <span
class="tooltiprtext">Click to View Output.</span> </span></p>
</div>
</a>
<div id="quadraticregressionexamplecode" style="display:none;">
<p>Pay special attention to how the lm(…) code uses <span
class="math inline">\(Y_i \sim X_{i} + X_{i}^2\)</span> and drops all
<span class="math inline">\(\beta\)</span>’s and <span
class="math inline">\(\epsilon\)</span> from the model statement. This
is because the estimates for the <span
class="math inline">\(\beta\)</span>’s and <span
class="math inline">\(\epsilon\)</span> are given by the output of the
lm(…) funtion in the “Estimates” column of summary(….) and in
<code>lmObject$residuals</code>.</p>
</div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a>lm.quad <span class="ot">&lt;-</span> <span class="fu">lm</span>(Temp <span class="sc">~</span> Month <span class="sc">+</span> <span class="fu">I</span>(Month<span class="sc">^</span><span class="dv">2</span>), <span class="at">data=</span>airquality)</span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a><span class="fu">emphasize.strong.cols</span>(<span class="dv">1</span>)</span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">summary</span>(lm.quad)<span class="sc">$</span>coefficients, )</span></code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="25%" />
<col width="18%" />
<col width="18%" />
<col width="13%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center"><strong>-95.73</strong></td>
<td align="center">15.24</td>
<td align="center">-6.281</td>
<td align="center">3.458e-09</td>
</tr>
<tr class="even">
<td align="center"><strong>Month</strong></td>
<td align="center"><strong>48.72</strong></td>
<td align="center">4.489</td>
<td align="center">10.85</td>
<td align="center">1.29e-20</td>
</tr>
<tr class="odd">
<td align="center"><strong>I(Month^2)</strong></td>
<td align="center"><strong>-3.283</strong></td>
<td align="center">0.3199</td>
<td align="center">-10.26</td>
<td align="center">4.737e-19</td>
</tr>
</tbody>
</table>
<p>The <strong>estimates</strong> shown in the summary output table
above approximate the <span class="math inline">\(\beta\)</span>’s in
the regression model:</p>
<ul>
<li><span class="math inline">\(\beta_0\)</span> is estimated by the
(Intercept) value of -95.73,</li>
<li><span class="math inline">\(\beta_1\)</span> is estimated by the
<code>Month</code> value of 48.72, and</li>
<li><span class="math inline">\(\beta_2\)</span> is estimated by the
<code>I(Month^2)</code> value of -3.283.</li>
</ul>
<p>Because the estimate of the <span
class="math inline">\(\beta_2\)</span> term is negative (-3.283), this
parabola will “open down” (concave). This tells us that average
temperatures will increase to a point, then decrease again. The vertex
of this parabola will be at <span class="math inline">\(-b_1/(2b_2) =
-(48.72)/(2\cdot (-3.283)) = 7.420043\)</span> months, which tells us
that the highest average temperature will occur around mid July (7.42
months to be exact). The y-intercept is -95.73, which would be awfully
cold if it were possible for the month to be “month zero.” Since this is
not possible, the y-intercept is not meaningful for this model.</p>
<p>Note that interpreting either <span
class="math inline">\(\beta_1\)</span> or <span
class="math inline">\(\beta_2\)</span> by themselves is quite difficult
because they both work with together with <span
class="math inline">\(X_{i}\)</span>.</p>
<p><span class="math display">\[
\hat{Y}_i = \overbrace{-95.73}^\text{y-int} +
\overbrace{48.72}^{\stackrel{\text{slope}}{\text{term}}} X_{i} +
\overbrace{-3.283}^{\stackrel{\text{quadratic}}{\text{term}}} X_{i}^2
\]</span></p>
<p>The regression function is drawn as follows. Be sure to look at the
“Code” to understand how this graph was created using the ideas in the
equation above.</p>
<table>
<tr>
<td>
<p><strong>Using Base R</strong></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="fu">plot</span>(Temp <span class="sc">~</span> Month, <span class="at">data=</span>airquality, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">bg=</span><span class="st">&quot;gray83&quot;</span>, <span class="at">main=</span><span class="st">&quot;Quadratic Model using airquality data set&quot;</span>, <span class="at">cex.main=</span><span class="dv">1</span>)</span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a><span class="co">#get the &quot;Estimates&quot; automatically:</span></span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm.quad)</span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a><span class="co"># Then b will have 3 numbers stored inside:</span></span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a><span class="co"># b[1] is the estimate of beta_0: -95.73</span></span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a><span class="co"># b[2] is the estimate of beta_1: 48.72</span></span>
<span id="cb82-8"><a href="#cb82-8" tabindex="-1"></a><span class="co"># b[3] is the estimate of beta_2: -3.28</span></span>
<span id="cb82-9"><a href="#cb82-9" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-103-1.png" width="672" /></p>
</td>
<td>
<p><strong>Using ggplot2</strong></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="co">#get the &quot;Estimates&quot; automatically:</span></span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm.quad)</span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a><span class="co"># Then b will have 3 estimates:</span></span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a><span class="co"># b[1] is the estimate of beta_0: 35.38</span></span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a><span class="co"># b[2] is the estimate of beta_1: -7.099</span></span>
<span id="cb83-6"><a href="#cb83-6" tabindex="-1"></a><span class="co"># b[3] is the estimate of beta_2: 0.4759</span></span>
<span id="cb83-7"><a href="#cb83-7" tabindex="-1"></a></span>
<span id="cb83-8"><a href="#cb83-8" tabindex="-1"></a><span class="fu">ggplot</span>(airquality, <span class="fu">aes</span>(<span class="at">y=</span>Temp, <span class="at">x=</span>Month)) <span class="sc">+</span></span>
<span id="cb83-9"><a href="#cb83-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch=</span><span class="dv">21</span>, <span class="at">bg=</span><span class="st">&quot;gray83&quot;</span>, <span class="at">color=</span><span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-10"><a href="#cb83-10" tabindex="-1"></a>  <span class="co">#geom_smooth(method=&quot;lm&quot;, se=F, formula = y ~ poly(x, 2)) + #easy way, but the more involved manual way using stat_function (see below) is more dynamic.</span></span>
<span id="cb83-11"><a href="#cb83-11" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-12"><a href="#cb83-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Quadratic Model using airquality data set&quot;</span>) </span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
</td>
</tr>
</table>
</p>
</div>
<div id="LearnMoreCubicModel" class="tabcontent" style="display:none;">
<p>
<table>
<tr>
<td>
<p><img src="index_files/figure-html/unnamed-chunk-105-1.png" width="144" /></p>
</td>
<td style="text-align: center;padding-left:15px;">
<p><span class="math display">\[
Y_i = \overbrace{\underbrace{\beta_0 + \beta_1 X_i + \beta_2 X_i^2 +
\beta_3 X_i^3}_{E\{Y_i\}}}^\text{Cubic Model} + \epsilon_i
\]</span></p>
</td>
</tr>
</table>
<p><br/></p>
<p>The Cubic model uses the same <span
class="math inline">\(X\)</span>-variable thrice, once with a <span
class="math inline">\(\beta_1 X_i\)</span> term, once with a <span
class="math inline">\(\beta_2 X_i^2\)</span> term, and once with a <span
class="math inline">\(\beta_3 X_i^3\)</span> term. The <span
class="math inline">\(X_i^3\)</span> term is called the “cubic”
term.</p>
<table>
<colgroup>
<col width="13%" />
<col width="86%" />
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\beta_0\)</span></td>
<td>Y-intercept of the Model.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_1\)</span></td>
<td>No clear interpretation, but could be called the “base slope
coefficient” and contributes to the position of the inflection points of
the cubic function.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\beta_2\)</span></td>
<td>No clear interpretation, but it also contributes to the location of
the inflection points.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_3\)</span></td>
<td>This is the coefficient of the cubic term. No clear interpretation,
but it determines the concavity of the model by its sign.</td>
</tr>
</tbody>
</table>
<p><strong>An Example</strong></p>
<p>Using the <code>CO2</code> data set, we run the following “cubic”
regression.</p>
<p><span class="math display">\[
  \underbrace{Y_i}_\text{uptake} \underbrace{=}_{\sim}
\overbrace{\beta_0}^{\text{y-int}} +
\overbrace{\beta_1}^{\stackrel{\text{slope}}{\text{term}}}
\underbrace{X_{i}}_\text{conc} +
\overbrace{\beta_2}^{\stackrel{\text{quadratic}}{\text{term}}}  \underbrace{X_{i}^2}_\text{I(conc^2)}
+  \overbrace{\beta_3}^{\stackrel{\text{cubic}}{\text{term}}}  \underbrace{X_{i}^3}_\text{I(conc^3)}
+ \epsilon_i
\]</span></p>
<a href="javascript:showhide('cubicregressionexamplecode')">
<div class="hoverchunk">
<p><span class="tooltipr"> lm.cubic &lt;- <span class="tooltiprtext">A
name we made up for our “cubic” regression.</span> </span><span
class="tooltipr"> lm( <span class="tooltiprtext">R function lm used to
perform linear regressions in R. The lm stands for “linear
model”.</span> </span><span class="tooltipr"> uptake <span
class="tooltiprtext">Y-variable, should be quantitative.</span>
</span><span class="tooltipr">  ~  <span class="tooltiprtext">The tilde
<code>~</code> is what lm(…) uses to state the regression equation <span
class="math inline">\(Y_i = ...\)</span>. Notice that the <code>~</code>
is not followed by <span class="math inline">\(\beta_0 +
\beta_1\)</span> like <span class="math inline">\(Y_i = ...\)</span>.
Instead, <span class="math inline">\(X_i\)</span> is the first term
following <code>~</code>. This is because the <span
class="math inline">\(\beta\)</span>’s are going to be estimated by the
lm(…). These estimates can be found using summary(lmObject).</span>
</span><span class="tooltipr"> conc <span class="tooltiprtext"><span
class="math inline">\(X_{i}\)</span>, should be quantitative.</span>
</span><span class="tooltipr">  +  <span class="tooltiprtext">The plus
<code>+</code> is used between each term in the model. Note that only
the x-variables are included in the lm(…) from the <span
class="math inline">\(Y_i = ...\)</span> model. No beta’s are
included.</span> </span><span class="tooltipr"> I(conc^2) <span
class="tooltiprtext"><span class="math inline">\(X_{i}^2\)</span>, where
the function I(…) protects the squaring of conc from how lm(…) would
otherwise interpret that statement. The I(…) function must be used
anytime you raise an x-variable to a power in the lm(…)
statement.</span> </span><span class="tooltipr">  +  <span
class="tooltiprtext">The plus <code>+</code> is used between each term
in the model. Note that only the x-variables are included in the lm(…)
from the <span class="math inline">\(Y_i = ...\)</span> model. No beta’s
are included.</span> </span><span class="tooltipr"> I(conc^3) <span
class="tooltiprtext"><span class="math inline">\(X_{i}^3\)</span>, where
the function I(…) protects the cubing of conc from how lm(…) would
otherwise interpret that statement. The I(…) function must be used
anytime you raise an x-variable to a power in the lm(…)
statement.</span> </span><span class="tooltipr"> , data=CO2 <span
class="tooltiprtext">This is the data set we are using for the
regression.</span> </span><span class="tooltipr"> )<br />
<span class="tooltiprtext">Closing parenthsis for the lm(…)
function.</span> </span><span class="tooltipr">     <br />
<span class="tooltiprtext">Press Enter to run the code.</span>
</span><span class="tooltipr" style="float:right;">  …  <span
class="tooltiprtext">Click to View Output.</span> </span></p>
</div>
</a>
<div id="cubicregressionexamplecode" style="display:none;">
<p>Pay special attention to how the lm(…) code uses <span
class="math inline">\(Y_i \sim X_{i} + X_{i}^2\)</span> and drops all
<span class="math inline">\(\beta\)</span>’s and <span
class="math inline">\(\epsilon\)</span> from the model statement. This
is because the estimates for the <span
class="math inline">\(\beta\)</span>’s and <span
class="math inline">\(\epsilon\)</span> are given by the output of the
lm(…) funtion in the “Estimates” column of summary(….) and in
<code>lmObject$residuals</code>.</p>
</div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a>lm.cubic <span class="ot">&lt;-</span> <span class="fu">lm</span>(uptake <span class="sc">~</span> conc <span class="sc">+</span> <span class="fu">I</span>(conc<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(conc<span class="sc">^</span><span class="dv">3</span>), <span class="at">data=</span>CO2)</span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">summary</span>(lm.cubic)<span class="sc">$</span>coefficients)</span></code></pre></div>
<table style="width:90%;">
<colgroup>
<col width="25%" />
<col width="18%" />
<col width="18%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-1.483</td>
<td align="center">5.043</td>
<td align="center">-0.2941</td>
<td align="center">0.7694</td>
</tr>
<tr class="even">
<td align="center"><strong>conc</strong></td>
<td align="center">0.1814</td>
<td align="center">0.0416</td>
<td align="center">4.36</td>
<td align="center">3.83e-05</td>
</tr>
<tr class="odd">
<td align="center"><strong>I(conc^2)</strong></td>
<td align="center">-0.0003063</td>
<td align="center">9.067e-05</td>
<td align="center">-3.378</td>
<td align="center">0.00113</td>
</tr>
<tr class="even">
<td align="center"><strong>I(conc^3)</strong></td>
<td align="center">1.601e-07</td>
<td align="center">5.512e-08</td>
<td align="center">2.905</td>
<td align="center">0.004745</td>
</tr>
</tbody>
</table>
<p>The <strong>estimates</strong> shown above approximate the <span
class="math inline">\(\beta\)</span>’s in the regression model: <span
class="math inline">\(\beta_0\)</span> is estimated by the (Intercept)
value of -1.483, <span class="math inline">\(\beta_1\)</span> is
estimated by the <code>conc</code> value of 0.1814, <span
class="math inline">\(\beta_2\)</span> is estimated by the
<code>I(conc^2)</code> value of -0.0003063, and <span
class="math inline">\(\beta_3\)</span> is estimated by the
<code>I(conc^3)</code> value of 1.601e-07, which translates to
0.0000001601.</p>
<p>Because the estimate of the <span
class="math inline">\(\beta_3\)</span> term is positive, this cubic
model will “open up”. In other words, as the function moves from left to
right, it will go off to positive infinity (up). If the term would have
been negative, then the function would head to negative infinity (down)
instead.</p>
<p><span class="math display">\[
\hat{Y}_i = \overbrace{-1.483}^\text{y-int} +
\overbrace{0.1814}^{\stackrel{\text{slope}}{\text{term}}} X_{i} +
\overbrace{-0.0003063}^{\stackrel{\text{quadratic}}{\text{term}}}
X_{i}^2 + \overbrace{1.601e-07}^{\stackrel{\text{cubic}}{\text{term}}}
X_{i}^3
\]</span></p>
<p>The regression function is drawn as follows. Be sure to look at the
“Code” to understand how this graph was created using the ideas in the
equation above.</p>
<table>
<tr>
<td>
<p><strong>Using Base R</strong></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">plot</span>(uptake <span class="sc">~</span> conc, <span class="at">data=</span>CO2, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">bg=</span><span class="st">&quot;gray83&quot;</span>, <span class="at">main=</span><span class="st">&quot;Cubic Model using CO2 data set&quot;</span>, <span class="at">cex.main=</span><span class="dv">1</span>)</span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a><span class="co">#get the &quot;Estimates&quot; automatically:</span></span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm.cubic)</span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a><span class="co"># Then b will have 4 estimates:</span></span>
<span id="cb85-6"><a href="#cb85-6" tabindex="-1"></a><span class="co"># b[1] is the estimate of beta_0: -1.483</span></span>
<span id="cb85-7"><a href="#cb85-7" tabindex="-1"></a><span class="co"># b[2] is the estimate of beta_1: 0.1814</span></span>
<span id="cb85-8"><a href="#cb85-8" tabindex="-1"></a><span class="co"># b[3] is the estimate of beta_2: -0.0003063</span></span>
<span id="cb85-9"><a href="#cb85-9" tabindex="-1"></a><span class="co"># b[4] is the estimate of beta_3: 1.601e-07</span></span>
<span id="cb85-10"><a href="#cb85-10" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b[<span class="dv">4</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-107-1.png" width="672" /></p>
</td>
<td>
<p><strong>Using ggplot2</strong></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="co">#get the &quot;Estimates&quot; automatically:</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm.cubic)</span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a><span class="co"># Then b will have 4 estimates:</span></span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a><span class="co"># b[1] is the estimate of beta_0: -1.483</span></span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a><span class="co"># b[2] is the estimate of beta_1: 0.1814</span></span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a><span class="co"># b[3] is the estimate of beta_2: -0.0003063</span></span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a><span class="co"># b[4] is the estimate of beta_3: 1.601e-07</span></span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a></span>
<span id="cb86-9"><a href="#cb86-9" tabindex="-1"></a><span class="fu">ggplot</span>(CO2, <span class="fu">aes</span>(<span class="at">y=</span>uptake, <span class="at">x=</span>conc)) <span class="sc">+</span></span>
<span id="cb86-10"><a href="#cb86-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch=</span><span class="dv">21</span>, <span class="at">bg=</span><span class="st">&quot;gray83&quot;</span>, <span class="at">color=</span><span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb86-11"><a href="#cb86-11" tabindex="-1"></a>  <span class="co">#geom_smooth(method=&quot;lm&quot;, se=F, formula = y ~ poly(x, 3)) + #easy way, but the more involved manual way using stat_function (see below) is more dynamic.</span></span>
<span id="cb86-12"><a href="#cb86-12" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b[<span class="dv">4</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb86-13"><a href="#cb86-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Cubic Model using CO2 data set&quot;</span>) </span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
</td>
</tr>
</table>
<p>It should be stated, that the cubic function is not the best fit for
this data. However, it is a lot better than just a simple line, or a
quadratic model, as shown below.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="fu">plot</span>(uptake <span class="sc">~</span> conc, <span class="at">data=</span>CO2, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">bg=</span><span class="st">&quot;gray83&quot;</span>, <span class="at">main=</span><span class="st">&quot;Cubic Model using CO2 data set&quot;</span>, <span class="at">cex.main=</span><span class="dv">1</span>)</span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a><span class="co">#get the &quot;Estimates&quot; automatically:</span></span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm.cubic)</span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a><span class="co"># Then b will have 4 estimates:</span></span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a><span class="co"># b[1] is the estimate of beta_0: -1.483</span></span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a><span class="co"># b[2] is the estimate of beta_1: 0.1814</span></span>
<span id="cb87-8"><a href="#cb87-8" tabindex="-1"></a><span class="co"># b[3] is the estimate of beta_2: -0.0003063</span></span>
<span id="cb87-9"><a href="#cb87-9" tabindex="-1"></a><span class="co"># b[4] is the estimate of beta_3: 1.601e-07</span></span>
<span id="cb87-10"><a href="#cb87-10" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b[<span class="dv">4</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb87-11"><a href="#cb87-11" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(uptake <span class="sc">~</span> conc <span class="sc">+</span> <span class="fu">I</span>(conc<span class="sc">^</span><span class="dv">2</span>), <span class="at">data=</span>CO2))</span>
<span id="cb87-12"><a href="#cb87-12" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb87-13"><a href="#cb87-13" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(uptake <span class="sc">~</span> conc, <span class="at">data=</span>CO2))</span>
<span id="cb87-14"><a href="#cb87-14" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-109-1.png" width="672" /></p>
</p>
</div>
<div id="LearnMoreTwoLinesModel" class="tabcontent">
<p>
<table>
<tr>
<td>
<p><img src="index_files/figure-html/unnamed-chunk-110-1.png" width="144" /></p>
</td>
<td style="text-align: center;padding-left:15px;">
<p><span class="math display">\[
Y_i = \overbrace{\underbrace{\beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} +
\beta_3 X_{1i} X_{2i}}_{E\{Y_i\}}}^\text{Two-lines Model} + \epsilon_i
\]</span></p>
<p><span class="math display">\[
X_{2i} = \left\{\begin{array}{ll} 1, &amp; \text{Group B} \\ 0, &amp;
\text{Group A} \end{array}\right.
\]</span></p>
</td>
</tr>
</table>
<p>The <strong>“two-lines” model</strong> is a way to compare two
different groups in statistics using numbers. Here’s how it works:</p>
<ul>
<li>It uses two types of numbers:
<ul>
<li>A regular number that can be any value (<span
class="math inline">\(X_{1i}\)</span>)</li>
<li>A special number that’s either 0 or 1 (called an “indicator
variable”, <span class="math inline">\(X_{2i}\)</span>)</li>
</ul></li>
</ul>
<p>The special number (<span class="math inline">\(X_{2i}\)</span>)
helps us turn group information (like “Group A” or “Group B”) into
numbers we can use in calculations.</p>
<p>This model creates two separate lines on a graph:</p>
<ul>
<li>One line for Group A</li>
<li>One line for Group B</li>
</ul>
<p><br></p>
<p>By using this method, we can easily see and compare how the two
groups are different from each other.</p>
<p><em>Think of it like having two recipes for the same dish, but with
slightly different ingredients.</em> This model helps us see how those
small changes affect the final result.</p>
<p><br></p>
<table>
<colgroup>
<col width="13%" />
<col width="86%" />
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\beta_0\)</span></td>
<td>Y-intercept of the Model.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_1\)</span></td>
<td>Controls the slope of the “base-line” of the model, the “Group 0”
line.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\beta_2\)</span></td>
<td>Controls the <strong>change in y-intercept</strong> for the second
line in the model as compared to the y-intercept of the “base-line”
line.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_3\)</span></td>
<td>Called the “interaction” term. Controls the <strong>change in the
slope</strong> for the second line in the model as compared to the slope
of the “base-line” line.</td>
</tr>
</tbody>
</table>
<p><strong>An Example</strong></p>
<p>Using the <code>mtcars</code> data set, we run the following
“two-lines” regression. Note that <code>am</code> has only 0 or 1
values: <code>View(mtcars)</code>.</p>
<p><span class="math display">\[
  \underbrace{Y_i}_\text{mpg} \underbrace{=}_{\sim}
\overbrace{\beta_0}^{\stackrel{\text{y-int}}{\text{baseline}}} +
\overbrace{\beta_1}^{\stackrel{\text{slope}}{\text{baseline}}}
\underbrace{X_{1i}}_\text{qsec} +
\overbrace{\beta_2}^{\stackrel{\text{change
in}}{\text{y-int}}}  \underbrace{X_{2i}}_\text{am} +
\overbrace{\beta_3}^{\stackrel{\text{change in}}{\text{slope}}}
\underbrace{X_{1i}X_{2i}}_\text{qsec:am} + \epsilon_i
\]</span></p>
<a href="javascript:showhide('twolinesregressionexamplecode')">
<div class="hoverchunk">
<p><span class="tooltipr"> lm.2lines &lt;- <span class="tooltiprtext">A
name we made up for our “two-lines” regression.</span> </span><span
class="tooltipr"> lm( <span class="tooltiprtext">R function lm used to
perform linear regressions in R. The lm stands for “linear
model”.</span> </span><span class="tooltipr"> mpg <span
class="tooltiprtext">Y-variable, should be quantitative.</span>
</span><span class="tooltipr">  ~  <span class="tooltiprtext">The tilde
<code>~</code> is what lm(…) uses to state the regression equation <span
class="math inline">\(Y_i = ...\)</span>. Notice that the <code>~</code>
is not followed by <span class="math inline">\(\beta_0 +
\beta_1\)</span> like <span class="math inline">\(Y_i = ...\)</span>.
Instead, <span class="math inline">\(X_{1i}\)</span> is the first term
following <code>~</code>. This is because <span
class="math inline">\(\beta\)</span>’s are going to be estimated by the
lm(…). These estimates can be found using summary(lmObject).</span>
</span><span class="tooltipr"> qsec <span class="tooltiprtext"><span
class="math inline">\(X_{1i}\)</span>, should be quantitative.</span>
</span><span class="tooltipr">  +  <span class="tooltiprtext">The plus
<code>+</code> is used between each term in the model. Note that only
the x-variables are included in the lm(…) from the <span
class="math inline">\(Y_i = ...\)</span> model. No beta’s are
included.</span> </span><span class="tooltipr"> am <span
class="tooltiprtext"><span class="math inline">\(X_{2i}\)</span>, an
indicator or 0,1 variable. This term allows the y-intercept of the two
lines to differ.</span> </span><span class="tooltipr">  +  <span
class="tooltiprtext">The plus <code>+</code> is used between each term
in the model. Note that only the x-variables are included in the lm(…)
from the <span class="math inline">\(Y_i = ...\)</span> model. No beta’s
are included.</span> </span><span class="tooltipr"> qsec:am <span
class="tooltiprtext"><span class="math inline">\(X_{1i}X_{2i}\)</span>
the interaction term. This allows the slopes of the two lines to
differ.</span> </span><span class="tooltipr"> , data=mtcars <span
class="tooltiprtext">This is the data set we are using for the
regression.</span> </span><span class="tooltipr"> )<br />
<span class="tooltiprtext">Closing parenthsis for the lm(…)
function.</span> </span><span class="tooltipr">     <br />
<span class="tooltiprtext">Press Enter to run the code.</span>
</span><span class="tooltipr" style="float:right;">  …  <span
class="tooltiprtext">Click to View Output.</span> </span></p>
</div>
</a>
<div id="twolinesregressionexamplecode" style="display:none;">
<p>Pay special attention to how the lm(…) code uses <span
class="math inline">\(Y_i \sim X_{1i} + X_{2i} + X_{1i}X_{2i}\)</span>
and drops all <span class="math inline">\(\beta\)</span>’s and <span
class="math inline">\(\epsilon\)</span> from the model statement. This
is because the estimates for the <span
class="math inline">\(\beta\)</span>’s and <span
class="math inline">\(\epsilon\)</span> are given by the output of the
lm(…) funtion in the “Estimates” column of summary(….) and in
<code>lm.2lines$residuals</code>.</p>
</div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a>lm<span class="fl">.2</span>lines <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> qsec <span class="sc">+</span> am <span class="sc">+</span> qsec<span class="sc">:</span>am, <span class="at">data=</span>mtcars)</span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">summary</span>(lm<span class="fl">.2</span>lines)<span class="sc">$</span>coefficients)</span></code></pre></div>
<table style="width:88%;">
<colgroup>
<col width="25%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-9.01</td>
<td align="center">8.218</td>
<td align="center">-1.096</td>
<td align="center">0.2823</td>
</tr>
<tr class="even">
<td align="center"><strong>qsec</strong></td>
<td align="center">1.439</td>
<td align="center">0.45</td>
<td align="center">3.197</td>
<td align="center">0.003432</td>
</tr>
<tr class="odd">
<td align="center"><strong>am</strong></td>
<td align="center">-14.51</td>
<td align="center">12.48</td>
<td align="center">-1.163</td>
<td align="center">0.2548</td>
</tr>
<tr class="even">
<td align="center"><strong>qsec:am</strong></td>
<td align="center">1.321</td>
<td align="center">0.7017</td>
<td align="center">1.883</td>
<td align="center">0.07012</td>
</tr>
</tbody>
</table>
<p>The <strong>estimates</strong> shown above approximate the <span
class="math inline">\(\beta\)</span>’s in the regression model:</p>
<ul>
<li><span class="math inline">\(\beta_0\)</span> (beta zero): This is
like the starting point. It’s estimated by something called the
“Intercept”.</li>
<li><span class="math inline">\(\beta_1\)</span> (beta one): This shows
how one thing changes when another thing (called “qsec”) changes. It’s
estimated to be 1.439.</li>
<li><span class="math inline">\(\beta_2\)</span> (beta two): This shows
how something else (called “am”) affects the overall result. It’s
estimated to be -14.51.</li>
<li><span class="math inline">\(\beta_3\)</span> (beta three): This
shows how “qsec” and “am” work together to affect the result. It’s
estimated to be 1.321.</li>
</ul>
<p>This gives two separate equations of lines.</p>
<p><strong>Automatic Transmission (am==0, <span
class="math inline">\(X_{2i} = 0\)</span>) Line</strong></p>
<p><span class="math display">\[
\hat{Y}_i = \overbrace{-9.01}^{\stackrel{\text{y-int}}{\text{baseline}}}
+ \overbrace{1.439}^{\stackrel{\text{slope}}{\text{baseline}}} X_{1i}
\]</span></p>
<p><strong>Manual Transmission (am==1 , <span
class="math inline">\(X_{2i} = 1\)</span>) Line</strong></p>
<p><span class="math display">\[
\hat{Y}_i =
\underbrace{(\overbrace{-9.01}^{\stackrel{\text{y-int}}{\text{baseline}}}
+ \overbrace{-14.51}^{\stackrel{\text{change
in}}{\text{y-int}}})}_{\stackrel{\text{y-intercept}}{-23.52}} +
\underbrace{(\overbrace{1.439}^{\stackrel{\text{slope}}{\text{baseline}}}
+\overbrace{1.321}^{\stackrel{\text{change
in}}{\text{slope}}})}_{\stackrel{\text{slope}}{2.76}} X_{1i}
\]</span></p>
<p>These lines are drawn as follows. Be sure to look at the “Code” to
understand how this graph was created using the ideas in the two
equations above.</p>
<table>
<tr>
<td>
<p><strong>Using Base R</strong></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="fu">plot</span>(mpg <span class="sc">~</span> qsec, <span class="at">data=</span>mtcars, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;skyblue&quot;</span>,<span class="st">&quot;orange&quot;</span>)[<span class="fu">as.factor</span>(am)], <span class="at">pch=</span><span class="dv">21</span>, <span class="at">bg=</span><span class="st">&quot;gray83&quot;</span>, <span class="at">main=</span><span class="st">&quot;Two-lines Model using mtcars data set&quot;</span>, <span class="at">cex.main=</span><span class="dv">1</span>)</span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Baseline (am==0)&quot;</span>, <span class="st">&quot;Changed-line (am==1)&quot;</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;skyblue&quot;</span>,<span class="st">&quot;orange&quot;</span>), <span class="at">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a><span class="co">#get the &quot;Estimates&quot; automatically:</span></span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm<span class="fl">.2</span>lines)</span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a><span class="co"># Then b will have 4 estimates:</span></span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a><span class="co"># b[1] is the estimate of beta_0: -9.0099</span></span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a><span class="co"># b[2] is the estimate of beta_1:  1.4385</span></span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a><span class="co"># b[3] is the estimate of beta_2: -14.5107</span></span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a><span class="co"># b[4] is the estimate of beta_3: 1.3214</span></span>
<span id="cb89-12"><a href="#cb89-12" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>)  <span class="co">#baseline (in blue)</span></span>
<span id="cb89-13"><a href="#cb89-13" tabindex="-1"></a><span class="fu">curve</span>((b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">3</span>]) <span class="sc">+</span> (b[<span class="dv">2</span>] <span class="sc">+</span> b[<span class="dv">4</span>])<span class="sc">*</span>x, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>) <span class="co">#changed line (in orange)</span></span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
</td>
<td>
<p><strong>Using ggplot2</strong></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="co">#get the &quot;Estimates&quot; automatically:</span></span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm<span class="fl">.2</span>lines)</span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a><span class="co"># Then b will have 4 estimates:</span></span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a><span class="co"># b[1] is the estimate of beta_0: -9.0099</span></span>
<span id="cb90-5"><a href="#cb90-5" tabindex="-1"></a><span class="co"># b[2] is the estimate of beta_1:  1.4385</span></span>
<span id="cb90-6"><a href="#cb90-6" tabindex="-1"></a><span class="co"># b[3] is the estimate of beta_2: -14.5107</span></span>
<span id="cb90-7"><a href="#cb90-7" tabindex="-1"></a><span class="co"># b[4] is the estimate of beta_3: 1.3214</span></span>
<span id="cb90-8"><a href="#cb90-8" tabindex="-1"></a></span>
<span id="cb90-9"><a href="#cb90-9" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">y=</span>mpg, <span class="at">x=</span>qsec, <span class="at">color=</span><span class="fu">factor</span>(am))) <span class="sc">+</span></span>
<span id="cb90-10"><a href="#cb90-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch=</span><span class="dv">21</span>, <span class="at">bg=</span><span class="st">&quot;gray83&quot;</span>) <span class="sc">+</span></span>
<span id="cb90-11"><a href="#cb90-11" tabindex="-1"></a>  <span class="co">#geom_smooth(method=&quot;lm&quot;, se=F) + #easy way, but only draws the full interaction model. The manual way using stat_function (see below) is more involved, but more dynamic.</span></span>
<span id="cb90-12"><a href="#cb90-12" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x, <span class="at">color=</span><span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span> <span class="co">#am==0 line</span></span>
<span id="cb90-13"><a href="#cb90-13" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) (b[<span class="dv">1</span>]<span class="sc">+</span>b[<span class="dv">3</span>]) <span class="sc">+</span> (b[<span class="dv">2</span>]<span class="sc">+</span>b[<span class="dv">4</span>])<span class="sc">*</span>x,<span class="at">color=</span><span class="st">&quot;orange&quot;</span>) <span class="sc">+</span> <span class="co">#am==1 line </span></span>
<span id="cb90-14"><a href="#cb90-14" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Transmission (am)&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;skyblue&quot;</span>,<span class="st">&quot;orange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb90-15"><a href="#cb90-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Two-lines Model using mtcars data set&quot;</span>) </span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-113-1.png" width="672" /></p>
</td>
</tr>
</table>
</p>
</div>
<div id="LearnMorethreeDModel" class="tabcontent">
<p>
<table>
<tr>
<td>
<p><img src="index_files/figure-html/volcano-1.png" width="144" /></p>
</td>
<td style="text-align: center;padding-left:15px;">
<p><span class="math display">\[
Y_i = \overbrace{\underbrace{\beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} +
\beta_3 X_{1i}X_{2i}}_{E\{Y_i\}}}^\text{3D Model} + \epsilon_i
\]</span></p>
</td>
</tr>
</table>
<p>The so called “3D” regression model uses two different quantitative
x-variables, an <span class="math inline">\(X_{1i}\)</span> and an <span
class="math inline">\(X_{2i}\)</span>.</p>
<p>Unlike the two-lines model where <span
class="math inline">\(X_{2i}\)</span> could only be a 0 or a 1, this
<span class="math inline">\(X_{2i}\)</span> variable is quantitative,
and can take on any quantitative value.</p>
<table>
<colgroup>
<col width="12%" />
<col width="87%" />
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\beta_0\)</span></td>
<td>Y-intercept of the Model</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_1\)</span></td>
<td>Slope of the line in the <span class="math inline">\(X_1\)</span>
direction.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\beta_2\)</span></td>
<td>Slope of the line in the <span class="math inline">\(X_2\)</span>
direction.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_3\)</span></td>
<td>Interaction term that allows the model, which is a plane in
three-dimensional space, to “bend”. If this term is zero, then the
regression surface is just a flat plane.</td>
</tr>
</tbody>
</table>
<p><strong>An Example</strong></p>
<p>Here is what a 3D regression looks like when there is no interaction
term. The two x-variables of <code>Month</code> and <code>Temp</code>
are being used to predict the y-variable of <code>Ozone</code>.</p>
<p><span class="math display">\[
  \underbrace{Y_i}_\text{Ozone} \underbrace{=}_{\sim}
\overbrace{\beta_0}^{\stackrel{\text{y-int}}{\text{baseline}}} +
\overbrace{\beta_1}^{\stackrel{\text{slope}}{\text{baseline}}}
\underbrace{X_{1i}}_\text{Temp} +
\overbrace{\beta_2}^{\stackrel{\text{change
in}}{\text{y-int}}}  \underbrace{X_{2i}}_\text{Month} + \epsilon_i
\]</span></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a>air_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ozone <span class="sc">~</span> Temp <span class="sc">+</span> Month, <span class="at">data=</span> airquality)</span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a><span class="fu">pander</span>(air_lm<span class="sc">$</span>coefficients)</span></code></pre></div>
<table style="width:43%;">
<colgroup>
<col width="19%" />
<col width="11%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">(Intercept)</th>
<th align="center">Temp</th>
<th align="center">Month</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">-139.6</td>
<td align="center">2.659</td>
<td align="center">-3.522</td>
</tr>
</tbody>
</table>
<p>Notice how the slope, <span class="math inline">\(\beta_1\)</span>,
in the “Temp” direction is estimated to be 2.659 and the slope in the
“Month” direction, <span class="math inline">\(\beta_2\)</span>, is
estimated to be -3.522. Also, the y-intercept, <span
class="math inline">\(\beta_0\)</span>, is estimated to be -139.6.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="do">## Hint: library(car) has a scatterplot 3d function which is simple to use</span></span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a><span class="co">#  but the code should only be run in your console, not knit.</span></span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a><span class="do">## library(car)</span></span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a><span class="do">## scatter3d(Y ~ X1 + X2, data=yourdata)</span></span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a></span>
<span id="cb92-7"><a href="#cb92-7" tabindex="-1"></a></span>
<span id="cb92-8"><a href="#cb92-8" tabindex="-1"></a></span>
<span id="cb92-9"><a href="#cb92-9" tabindex="-1"></a><span class="do">## To embed the 3d-scatterplot inside of your html document is harder.</span></span>
<span id="cb92-10"><a href="#cb92-10" tabindex="-1"></a><span class="co">#library(plotly)</span></span>
<span id="cb92-11"><a href="#cb92-11" tabindex="-1"></a><span class="co">#library(reshape2)</span></span>
<span id="cb92-12"><a href="#cb92-12" tabindex="-1"></a></span>
<span id="cb92-13"><a href="#cb92-13" tabindex="-1"></a><span class="co">#Perform the multiple regression</span></span>
<span id="cb92-14"><a href="#cb92-14" tabindex="-1"></a>air_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ozone <span class="sc">~</span> Temp <span class="sc">+</span> Month, <span class="at">data=</span> airquality)</span>
<span id="cb92-15"><a href="#cb92-15" tabindex="-1"></a></span>
<span id="cb92-16"><a href="#cb92-16" tabindex="-1"></a><span class="co">#Graph Resolution (more important for more complex shapes)</span></span>
<span id="cb92-17"><a href="#cb92-17" tabindex="-1"></a>graph_reso <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb92-18"><a href="#cb92-18" tabindex="-1"></a></span>
<span id="cb92-19"><a href="#cb92-19" tabindex="-1"></a><span class="co">#Setup Axis</span></span>
<span id="cb92-20"><a href="#cb92-20" tabindex="-1"></a>axis_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(airquality<span class="sc">$</span>Temp), <span class="fu">max</span>(airquality<span class="sc">$</span>Temp), <span class="at">by =</span> graph_reso)</span>
<span id="cb92-21"><a href="#cb92-21" tabindex="-1"></a>axis_y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(airquality<span class="sc">$</span>Month), <span class="fu">max</span>(airquality<span class="sc">$</span>Month), <span class="at">by =</span> graph_reso)</span>
<span id="cb92-22"><a href="#cb92-22" tabindex="-1"></a></span>
<span id="cb92-23"><a href="#cb92-23" tabindex="-1"></a><span class="co">#Sample points</span></span>
<span id="cb92-24"><a href="#cb92-24" tabindex="-1"></a>air_surface <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">Temp =</span> axis_x, <span class="at">Month =</span> axis_y, <span class="at">KEEP.OUT.ATTRS=</span>F)</span>
<span id="cb92-25"><a href="#cb92-25" tabindex="-1"></a>air_surface<span class="sc">$</span>Z <span class="ot">&lt;-</span> <span class="fu">predict.lm</span>(air_lm, <span class="at">newdata =</span> air_surface)</span>
<span id="cb92-26"><a href="#cb92-26" tabindex="-1"></a>air_surface <span class="ot">&lt;-</span> <span class="fu">acast</span>(air_surface, Month <span class="sc">~</span> Temp, <span class="at">value.var =</span> <span class="st">&quot;Z&quot;</span>) <span class="co">#y ~ x</span></span>
<span id="cb92-27"><a href="#cb92-27" tabindex="-1"></a></span>
<span id="cb92-28"><a href="#cb92-28" tabindex="-1"></a><span class="co">#Create scatterplot</span></span>
<span id="cb92-29"><a href="#cb92-29" tabindex="-1"></a><span class="fu">plot_ly</span>(airquality, </span>
<span id="cb92-30"><a href="#cb92-30" tabindex="-1"></a>        <span class="at">x =</span> <span class="sc">~</span>Temp, </span>
<span id="cb92-31"><a href="#cb92-31" tabindex="-1"></a>        <span class="at">y =</span> <span class="sc">~</span>Month, </span>
<span id="cb92-32"><a href="#cb92-32" tabindex="-1"></a>        <span class="at">z =</span> <span class="sc">~</span>Ozone,</span>
<span id="cb92-33"><a href="#cb92-33" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">rownames</span>(airquality), </span>
<span id="cb92-34"><a href="#cb92-34" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;scatter3d&quot;</span>, </span>
<span id="cb92-35"><a href="#cb92-35" tabindex="-1"></a>        <span class="at">mode =</span> <span class="st">&quot;markers&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb92-36"><a href="#cb92-36" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">z =</span> air_surface,</span>
<span id="cb92-37"><a href="#cb92-37" tabindex="-1"></a>            <span class="at">x =</span> axis_x,</span>
<span id="cb92-38"><a href="#cb92-38" tabindex="-1"></a>            <span class="at">y =</span> axis_y,</span>
<span id="cb92-39"><a href="#cb92-39" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&quot;surface&quot;</span>)</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-c051bb28c724e33c7cc0" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-c051bb28c724e33c7cc0">{"x":{"visdat":{"30a860b31116":["function () ","plotlyVisDat"]},"cur_data":"30a860b31116","attrs":{"30a860b31116":{"x":{},"y":{},"z":{},"text":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153"],"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"},"30a860b31116.1":{"x":[56,56.5,57,57.5,58,58.5,59,59.5,60,60.5,61,61.5,62,62.5,63,63.5,64,64.5,65,65.5,66,66.5,67,67.5,68,68.5,69,69.5,70,70.5,71,71.5,72,72.5,73,73.5,74,74.5,75,75.5,76,76.5,77,77.5,78,78.5,79,79.5,80,80.5,81,81.5,82,82.5,83,83.5,84,84.5,85,85.5,86,86.5,87,87.5,88,88.5,89,89.5,90,90.5,91,91.5,92,92.5,93,93.5,94,94.5,95,95.5,96,96.5,97],"y":[5,5.5,6,6.5,7,7.5,8,8.5,9],"z":[[-8.2930156346033321,-6.9632802100885804,-5.6335447855738288,-4.3038093610590771,-2.9740739365443254,-1.6443385120295737,-0.31460308751482202,1.0151323369999297,2.3448677615146813,3.674603186029433,5.0043386105441847,6.3340740350589364,7.6638094595736881,8.9935448840884398,10.323280308603191,11.653015733117943,12.982751157632695,14.312486582147447,15.642222006662198,16.97195743117695,18.301692855691702,19.631428280206453,20.961163704721205,22.290899129235957,23.620634553750708,24.95036997826546,26.280105402780212,27.609840827294963,28.939576251809715,30.269311676324467,31.599047100839218,32.928782525353967,34.258517949868718,35.588253374383441,36.917988798898193,38.247724223412945,39.577459647927697,40.907195072442448,42.2369304969572,43.566665921471952,44.896401345986703,46.226136770501455,47.555872195016207,48.885607619530958,50.21534304404571,51.545078468560462,52.874813893075213,54.204549317589965,55.534284742104717,56.864020166619468,58.19375559113422,59.523491015648972,60.853226440163724,62.182961864678475,63.512697289193227,64.842432713707979,66.17216813822273,67.501903562737482,68.831638987252234,70.161374411766985,71.491109836281737,72.820845260796489,74.15058068531124,75.480316109825992,76.810051534340715,78.139786958855467,79.469522383370219,80.79925780788497,82.128993232399722,83.458728656914474,84.788464081429225,86.118199505943977,87.447934930458729,88.77767035497348,90.107405779488232,91.437141204002984,92.766876628517736,94.096612053032487,95.426347477547239,96.756082902061991,98.085818326576742,99.415553751091494,100.74528917560625],[-10.053971968669721,-8.7242365441549694,-7.3945011196402177,-6.064765695125466,-4.7350302706107144,-3.4052948460959627,-2.075559421581211,-0.7458239970664593,0.58391142744829239,1.9136468519630441,3.2433822764777958,4.5731177009925474,5.9028531255072991,7.2325885500220508,8.5623239745368025,9.8920593990515542,11.221794823566306,12.551530248081058,13.881265672595809,15.211001097110561,16.540736521625313,17.870471946140064,19.200207370654816,20.529942795169568,21.859678219684319,23.189413644199071,24.519149068713823,25.848884493228574,27.178619917743326,28.508355342258078,29.838090766772829,31.167826191287581,32.497561615802333,33.827297040317056,35.157032464831808,36.486767889346559,37.816503313861311,39.146238738376063,40.475974162890815,41.805709587405566,43.135445011920318,44.46518043643507,45.794915860949821,47.124651285464573,48.454386709979325,49.784122134494076,51.113857559008828,52.44359298352358,53.773328408038331,55.103063832553083,56.432799257067835,57.762534681582586,59.092270106097338,60.42200553061209,61.751740955126841,63.081476379641593,64.411211804156352,65.740947228671104,67.070682653185855,68.400418077700607,69.730153502215359,71.05988892673011,72.389624351244862,73.719359775759614,75.049095200274337,76.378830624789089,77.70856604930384,79.038301473818592,80.368036898333344,81.697772322848095,83.027507747362847,84.357243171877599,85.68697859639235,87.016714020907102,88.346449445421854,89.676184869936606,91.005920294451357,92.335655718966109,93.665391143480861,94.995126567995612,96.324861992510364,97.654597417025116,98.984332841539867],[-11.81492830273611,-10.485192878221358,-9.1554574537066067,-7.825722029191855,-6.4959866046771033,-5.1662511801623516,-3.8365157556475999,-2.5067803311328483,-1.1770449066180966,0.15269051789665511,1.4824259424114068,2.8121613669261585,4.1418967914409102,5.4716322159556618,6.8013676404704135,8.1311030649851652,9.4608384894999169,10.790573914014669,12.12030933852942,13.450044763044172,14.779780187558924,16.109515612073675,17.439251036588427,18.768986461103179,20.09872188561793,21.428457310132682,22.758192734647434,24.087928159162185,25.417663583676937,26.747399008191689,28.07713443270644,29.406869857221192,30.736605281735944,32.066340706250671,33.396076130765422,34.725811555280174,36.055546979794926,37.385282404309677,38.715017828824429,40.044753253339181,41.374488677853932,42.704224102368684,44.033959526883436,45.363694951398188,46.693430375912939,48.023165800427691,49.352901224942443,50.682636649457194,52.012372073971946,53.342107498486698,54.671842923001449,56.001578347516201,57.331313772030953,58.661049196545704,59.990784621060456,61.320520045575208,62.650255470089959,63.979990894604711,65.309726319119463,66.639461743634214,67.969197168148966,69.298932592663718,70.62866801717847,71.958403441693221,73.288138866207944,74.617874290722696,75.947609715237448,77.2773451397522,78.607080564266951,79.936815988781703,81.266551413296455,82.596286837811206,83.926022262325958,85.25575768684071,86.585493111355461,87.915228535870213,89.244963960384965,90.574699384899716,91.904434809414468,93.23417023392922,94.563905658443971,95.893641082958723,97.223376507473475],[-13.575884636802499,-12.246149212287747,-10.916413787772996,-9.586678363258244,-8.2569429387434923,-6.9272075142287406,-5.5974720897139889,-4.2677366651992372,-2.9380012406844855,-1.6082658161697339,-0.27853039165498217,1.0512050328597695,2.3809404573745212,3.7106758818892729,5.0404113064040246,6.3701467309187763,7.6998821554335279,9.0296175799482796,10.359353004463031,11.689088428977783,13.018823853492535,14.348559278007286,15.678294702522038,17.00803012703679,18.337765551551541,19.667500976066293,20.997236400581045,22.326971825095796,23.656707249610548,24.9864426741253,26.316178098640052,27.645913523154803,28.975648947669555,30.305384372184278,31.63511979669903,32.964855221213782,34.294590645728533,35.624326070243285,36.954061494758037,38.283796919272788,39.61353234378754,40.943267768302292,42.273003192817043,43.602738617331795,44.932474041846547,46.262209466361298,47.59194489087605,48.921680315390802,50.251415739905553,51.581151164420305,52.910886588935057,54.240622013449808,55.57035743796456,56.900092862479312,58.229828286994064,59.559563711508815,60.889299136023567,62.219034560538319,63.54876998505307,64.878505409567822,66.208240834082574,67.537976258597325,68.867711683112077,70.197447107626829,71.527182532141552,72.856917956656304,74.186653381171055,75.516388805685807,76.846124230200559,78.17585965471531,79.505595079230062,80.835330503744814,82.165065928259565,83.494801352774317,84.824536777289069,86.154272201803821,87.484007626318572,88.813743050833324,90.143478475348076,91.473213899862827,92.802949324377579,94.132684748892331,95.462420173407082],[-15.336840970868888,-14.007105546354136,-12.677370121839385,-11.347634697324633,-10.017899272809881,-8.6881638482951296,-7.3584284237803779,-6.0286929992656262,-4.6989575747508745,-3.3692221502361228,-2.0394867257213711,-0.70975130120661944,0.61998412330813224,1.9497195478228839,3.2794549723376356,4.6091903968523873,5.938925821367139,7.2686612458818907,8.5983966703966423,9.928132094911394,11.257867519426146,12.587602943940897,13.917338368455649,15.247073792970401,16.576809217485152,17.906544641999904,19.236280066514656,20.566015491029408,21.895750915544159,23.225486340058911,24.555221764573663,25.884957189088414,27.214692613603166,28.544428038117889,29.874163462632641,31.203898887147393,32.533634311662141,33.863369736176892,35.193105160691644,36.522840585206396,37.852576009721147,39.182311434235899,40.512046858750651,41.841782283265402,43.171517707780154,44.501253132294906,45.830988556809658,47.160723981324409,48.490459405839161,49.820194830353913,51.149930254868664,52.479665679383416,53.809401103898168,55.139136528412919,56.468871952927671,57.798607377442423,59.128342801957174,60.458078226471926,61.787813650986678,63.117549075501429,64.447284500016181,65.777019924530933,67.106755349045685,68.436490773560436,69.766226198075159,71.095961622589911,72.425697047104663,73.755432471619415,75.085167896134166,76.414903320648918,77.74463874516367,79.074374169678421,80.404109594193173,81.733845018707925,83.063580443222676,84.393315867737428,85.72305129225218,87.052786716766931,88.382522141281683,89.712257565796435,91.041992990311186,92.371728414825938,93.70146383934069],[-17.097797304935277,-15.768061880420525,-14.438326455905774,-13.108591031391022,-11.77885560687627,-10.449120182361519,-9.1193847578467668,-7.7896493333320151,-6.4599139088172635,-5.1301784843025118,-3.8004430597877601,-2.4707076352730084,-1.1409722107582567,0.18876321375649496,1.5184986382712466,2.8482340627859983,4.17796948730075,5.5077049118155017,6.8374403363302534,8.1671757608450051,9.4969111853597568,10.826646609874508,12.15638203438926,13.486117458904012,14.815852883418763,16.145588307933515,17.475323732448267,18.805059156963019,20.13479458147777,21.464530005992522,22.794265430507274,24.124000855022025,25.453736279536777,26.7834717040515,28.113207128566252,29.442942553081004,30.772677977595755,32.102413402110507,33.432148826625259,34.76188425114001,36.091619675654762,37.421355100169514,38.751090524684265,40.080825949199017,41.410561373713769,42.74029679822852,44.070032222743272,45.399767647258024,46.729503071772776,48.059238496287527,49.388973920802279,50.718709345317031,52.048444769831782,53.378180194346534,54.707915618861286,56.037651043376037,57.367386467890789,58.697121892405541,60.026857316920292,61.356592741435044,62.686328165949796,64.01606359046454,65.345799014979292,66.675534439494044,68.005269864008767,69.335005288523519,70.66474071303827,71.994476137553022,73.324211562067774,74.653946986582525,75.983682411097277,77.313417835612029,78.64315326012678,79.972888684641532,81.302624109156284,82.632359533671035,83.962094958185787,85.291830382700539,86.621565807215291,87.951301231730042,89.281036656244794,90.610772080759546,91.940507505274297],[-18.858753639001666,-17.529018214486914,-16.199282789972163,-14.869547365457411,-13.539811940942659,-12.210076516427907,-10.880341091913156,-9.5506056673984041,-8.2208702428836524,-6.8911348183689007,-5.5613993938541491,-4.2316639693393974,-2.9019285448246457,-1.572193120309894,-0.24245769579514231,1.0872777287196094,2.4170131532343611,3.7467485777491127,5.0764840022638644,6.4062194267786161,7.7359548512933678,9.0656902758081195,10.395425700322871,11.725161124837623,13.054896549352375,14.384631973867126,15.714367398381878,17.04410282289663,18.373838247411381,19.703573671926133,21.033309096440885,22.363044520955636,23.692779945470388,25.022515369985111,26.352250794499863,27.681986219014615,29.011721643529366,30.341457068044118,31.67119249255887,33.000927917073625,34.330663341588377,35.660398766103128,36.99013419061788,38.319869615132632,39.649605039647383,40.979340464162135,42.309075888676887,43.638811313191638,44.96854673770639,46.298282162221142,47.628017586735893,48.957753011250645,50.287488435765397,51.617223860280149,52.9469592847949,54.276694709309652,55.606430133824404,56.936165558339155,58.265900982853907,59.595636407368659,60.92537183188341,62.255107256398162,63.584842680912914,64.914578105427665,66.244313529942389,67.57404895445714,68.903784378971892,70.233519803486644,71.563255228001395,72.892990652516147,74.222726077030899,75.55246150154565,76.882196926060402,78.211932350575154,79.541667775089905,80.871403199604657,82.201138624119409,83.530874048634161,84.860609473148912,86.190344897663664,87.520080322178416,88.849815746693167,90.179551171207919],[-20.619709973068055,-19.289974548553303,-17.960239124038551,-16.6305036995238,-15.300768275009048,-13.971032850494296,-12.641297425979545,-11.311562001464793,-9.9818265769500414,-8.6520911524352897,-7.322355727920538,-5.9926203034057863,-4.6628848788910346,-3.333149454376283,-2.0034140298615313,-0.67367860534677959,0.65605681916797209,1.9857922436827238,3.3155276681974755,4.6452630927122271,5.9749985172269788,7.3047339417417305,8.6344693662564822,9.9642047907712339,11.293940215285986,12.623675639800737,13.953411064315489,15.283146488830241,16.612881913344992,17.942617337859744,19.272352762374496,20.602088186889247,21.931823611403999,23.261559035918722,24.591294460433474,25.921029884948226,27.250765309462977,28.580500733977729,29.910236158492481,31.239971583007232,32.569707007521984,33.899442432036736,35.229177856551487,36.558913281066239,37.888648705580991,39.218384130095743,40.548119554610494,41.877854979125246,43.207590403639998,44.537325828154749,45.867061252669501,47.196796677184253,48.526532101699004,49.856267526213756,51.186002950728508,52.515738375243259,53.845473799758011,55.175209224272763,56.504944648787514,57.834680073302266,59.164415497817018,60.494150922331769,61.823886346846521,63.153621771361273,64.483357195875996,65.813092620390748,67.142828044905499,68.472563469420251,69.802298893935003,71.132034318449755,72.461769742964506,73.791505167479258,75.12124059199401,76.450976016508761,77.780711441023513,79.110446865538265,80.440182290053016,81.769917714567768,83.09965313908252,84.429388563597271,85.759123988112023,87.088859412626775,88.418594837141526],[-22.380666307134444,-21.050930882619692,-19.72119545810494,-18.391460033590189,-17.061724609075437,-15.731989184560685,-14.402253760045934,-13.072518335531182,-11.74278291101643,-10.413047486501679,-9.083312061986927,-7.7535766374721753,-6.4238412129574236,-5.0941057884426719,-3.7643703639279202,-2.4346349394131686,-1.1048995148984169,0.22483590961633482,1.5545713341310865,2.8843067586458382,4.2140421831605899,5.5437776076753416,6.8735130321900932,8.2032484567048449,9.5329838812195966,10.862719305734348,12.1924547302491,13.522190154763852,14.851925579278603,16.181661003793355,17.511396428308107,18.841131852822858,20.17086727733761,21.500602701852333,22.830338126367085,24.160073550881837,25.489808975396588,26.81954439991134,28.149279824426092,29.479015248940843,30.808750673455595,32.138486097970343,33.468221522485095,34.797956946999847,36.127692371514598,37.45742779602935,38.787163220544102,40.116898645058853,41.446634069573605,42.776369494088357,44.106104918603108,45.43584034311786,46.765575767632612,48.095311192147363,49.425046616662115,50.754782041176867,52.084517465691619,53.41425289020637,54.743988314721122,56.073723739235874,57.403459163750625,58.733194588265377,60.062930012780129,61.39266543729488,62.722400861809604,64.052136286324355,65.381871710839107,66.711607135353859,68.04134255986861,69.371077984383362,70.700813408898114,72.030548833412865,73.360284257927617,74.690019682442369,76.01975510695712,77.349490531471872,78.679225955986624,80.008961380501376,81.338696805016127,82.668432229530879,83.998167654045631,85.327903078560382,86.657638503075134]],"text":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153"],"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Temp"},"yaxis":{"title":"Month"},"zaxis":{"title":"Ozone"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[67,72,74,62,66,65,59,61,74,69,66,68,58,64,66,57,68,62,59,73,61,61,67,81,79,76,82,90,87,82,77,72,65,73,76,84,85,81,83,83,88,92,92,89,73,81,80,81,82,84,87,85,74,86,85,82,86,88,86,83,81,81,81,82,86,85,87,89,90,90,86,82,80,77,79,76,78,78,77,72,79,81,86,97,94,96,94,91,92,93,93,87,84,80,78,75,73,81,76,77,71,71,78,67,76,68,82,64,71,81,69,63,70,75,76,68],"y":[5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],"z":[41,36,12,18,28,23,19,8,7,16,11,14,18,14,34,6,30,11,1,11,4,32,23,45,115,37,29,71,39,23,21,37,20,12,13,135,49,32,64,40,77,97,97,85,10,27,7,48,35,61,79,63,16,80,108,20,52,82,50,64,59,39,9,16,78,35,66,122,89,110,44,28,65,22,59,23,31,44,21,9,45,168,73,76,118,84,85,96,78,73,91,47,32,20,23,21,24,44,21,28,9,13,46,18,13,24,16,13,23,36,7,14,30,14,18,20],"text":["1","2","3","4","6","7","8","9","11","12","13","14","15","16","17","18","19","20","21","22","23","24","28","29","30","31","38","40","41","44","47","48","49","50","51","62","63","64","66","67","68","69","70","71","73","74","76","77","78","79","80","81","82","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","104","105","106","108","109","110","111","112","113","114","116","117","118","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","151","152","153"],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"colorbar":{"title":"Ozone","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[56,56.5,57,57.5,58,58.5,59,59.5,60,60.5,61,61.5,62,62.5,63,63.5,64,64.5,65,65.5,66,66.5,67,67.5,68,68.5,69,69.5,70,70.5,71,71.5,72,72.5,73,73.5,74,74.5,75,75.5,76,76.5,77,77.5,78,78.5,79,79.5,80,80.5,81,81.5,82,82.5,83,83.5,84,84.5,85,85.5,86,86.5,87,87.5,88,88.5,89,89.5,90,90.5,91,91.5,92,92.5,93,93.5,94,94.5,95,95.5,96,96.5,97],"y":[5,5.5,6,6.5,7,7.5,8,8.5,9],"z":[[-8.2930156346033321,-6.9632802100885804,-5.6335447855738288,-4.3038093610590771,-2.9740739365443254,-1.6443385120295737,-0.31460308751482202,1.0151323369999297,2.3448677615146813,3.674603186029433,5.0043386105441847,6.3340740350589364,7.6638094595736881,8.9935448840884398,10.323280308603191,11.653015733117943,12.982751157632695,14.312486582147447,15.642222006662198,16.97195743117695,18.301692855691702,19.631428280206453,20.961163704721205,22.290899129235957,23.620634553750708,24.95036997826546,26.280105402780212,27.609840827294963,28.939576251809715,30.269311676324467,31.599047100839218,32.928782525353967,34.258517949868718,35.588253374383441,36.917988798898193,38.247724223412945,39.577459647927697,40.907195072442448,42.2369304969572,43.566665921471952,44.896401345986703,46.226136770501455,47.555872195016207,48.885607619530958,50.21534304404571,51.545078468560462,52.874813893075213,54.204549317589965,55.534284742104717,56.864020166619468,58.19375559113422,59.523491015648972,60.853226440163724,62.182961864678475,63.512697289193227,64.842432713707979,66.17216813822273,67.501903562737482,68.831638987252234,70.161374411766985,71.491109836281737,72.820845260796489,74.15058068531124,75.480316109825992,76.810051534340715,78.139786958855467,79.469522383370219,80.79925780788497,82.128993232399722,83.458728656914474,84.788464081429225,86.118199505943977,87.447934930458729,88.77767035497348,90.107405779488232,91.437141204002984,92.766876628517736,94.096612053032487,95.426347477547239,96.756082902061991,98.085818326576742,99.415553751091494,100.74528917560625],[-10.053971968669721,-8.7242365441549694,-7.3945011196402177,-6.064765695125466,-4.7350302706107144,-3.4052948460959627,-2.075559421581211,-0.7458239970664593,0.58391142744829239,1.9136468519630441,3.2433822764777958,4.5731177009925474,5.9028531255072991,7.2325885500220508,8.5623239745368025,9.8920593990515542,11.221794823566306,12.551530248081058,13.881265672595809,15.211001097110561,16.540736521625313,17.870471946140064,19.200207370654816,20.529942795169568,21.859678219684319,23.189413644199071,24.519149068713823,25.848884493228574,27.178619917743326,28.508355342258078,29.838090766772829,31.167826191287581,32.497561615802333,33.827297040317056,35.157032464831808,36.486767889346559,37.816503313861311,39.146238738376063,40.475974162890815,41.805709587405566,43.135445011920318,44.46518043643507,45.794915860949821,47.124651285464573,48.454386709979325,49.784122134494076,51.113857559008828,52.44359298352358,53.773328408038331,55.103063832553083,56.432799257067835,57.762534681582586,59.092270106097338,60.42200553061209,61.751740955126841,63.081476379641593,64.411211804156352,65.740947228671104,67.070682653185855,68.400418077700607,69.730153502215359,71.05988892673011,72.389624351244862,73.719359775759614,75.049095200274337,76.378830624789089,77.70856604930384,79.038301473818592,80.368036898333344,81.697772322848095,83.027507747362847,84.357243171877599,85.68697859639235,87.016714020907102,88.346449445421854,89.676184869936606,91.005920294451357,92.335655718966109,93.665391143480861,94.995126567995612,96.324861992510364,97.654597417025116,98.984332841539867],[-11.81492830273611,-10.485192878221358,-9.1554574537066067,-7.825722029191855,-6.4959866046771033,-5.1662511801623516,-3.8365157556475999,-2.5067803311328483,-1.1770449066180966,0.15269051789665511,1.4824259424114068,2.8121613669261585,4.1418967914409102,5.4716322159556618,6.8013676404704135,8.1311030649851652,9.4608384894999169,10.790573914014669,12.12030933852942,13.450044763044172,14.779780187558924,16.109515612073675,17.439251036588427,18.768986461103179,20.09872188561793,21.428457310132682,22.758192734647434,24.087928159162185,25.417663583676937,26.747399008191689,28.07713443270644,29.406869857221192,30.736605281735944,32.066340706250671,33.396076130765422,34.725811555280174,36.055546979794926,37.385282404309677,38.715017828824429,40.044753253339181,41.374488677853932,42.704224102368684,44.033959526883436,45.363694951398188,46.693430375912939,48.023165800427691,49.352901224942443,50.682636649457194,52.012372073971946,53.342107498486698,54.671842923001449,56.001578347516201,57.331313772030953,58.661049196545704,59.990784621060456,61.320520045575208,62.650255470089959,63.979990894604711,65.309726319119463,66.639461743634214,67.969197168148966,69.298932592663718,70.62866801717847,71.958403441693221,73.288138866207944,74.617874290722696,75.947609715237448,77.2773451397522,78.607080564266951,79.936815988781703,81.266551413296455,82.596286837811206,83.926022262325958,85.25575768684071,86.585493111355461,87.915228535870213,89.244963960384965,90.574699384899716,91.904434809414468,93.23417023392922,94.563905658443971,95.893641082958723,97.223376507473475],[-13.575884636802499,-12.246149212287747,-10.916413787772996,-9.586678363258244,-8.2569429387434923,-6.9272075142287406,-5.5974720897139889,-4.2677366651992372,-2.9380012406844855,-1.6082658161697339,-0.27853039165498217,1.0512050328597695,2.3809404573745212,3.7106758818892729,5.0404113064040246,6.3701467309187763,7.6998821554335279,9.0296175799482796,10.359353004463031,11.689088428977783,13.018823853492535,14.348559278007286,15.678294702522038,17.00803012703679,18.337765551551541,19.667500976066293,20.997236400581045,22.326971825095796,23.656707249610548,24.9864426741253,26.316178098640052,27.645913523154803,28.975648947669555,30.305384372184278,31.63511979669903,32.964855221213782,34.294590645728533,35.624326070243285,36.954061494758037,38.283796919272788,39.61353234378754,40.943267768302292,42.273003192817043,43.602738617331795,44.932474041846547,46.262209466361298,47.59194489087605,48.921680315390802,50.251415739905553,51.581151164420305,52.910886588935057,54.240622013449808,55.57035743796456,56.900092862479312,58.229828286994064,59.559563711508815,60.889299136023567,62.219034560538319,63.54876998505307,64.878505409567822,66.208240834082574,67.537976258597325,68.867711683112077,70.197447107626829,71.527182532141552,72.856917956656304,74.186653381171055,75.516388805685807,76.846124230200559,78.17585965471531,79.505595079230062,80.835330503744814,82.165065928259565,83.494801352774317,84.824536777289069,86.154272201803821,87.484007626318572,88.813743050833324,90.143478475348076,91.473213899862827,92.802949324377579,94.132684748892331,95.462420173407082],[-15.336840970868888,-14.007105546354136,-12.677370121839385,-11.347634697324633,-10.017899272809881,-8.6881638482951296,-7.3584284237803779,-6.0286929992656262,-4.6989575747508745,-3.3692221502361228,-2.0394867257213711,-0.70975130120661944,0.61998412330813224,1.9497195478228839,3.2794549723376356,4.6091903968523873,5.938925821367139,7.2686612458818907,8.5983966703966423,9.928132094911394,11.257867519426146,12.587602943940897,13.917338368455649,15.247073792970401,16.576809217485152,17.906544641999904,19.236280066514656,20.566015491029408,21.895750915544159,23.225486340058911,24.555221764573663,25.884957189088414,27.214692613603166,28.544428038117889,29.874163462632641,31.203898887147393,32.533634311662141,33.863369736176892,35.193105160691644,36.522840585206396,37.852576009721147,39.182311434235899,40.512046858750651,41.841782283265402,43.171517707780154,44.501253132294906,45.830988556809658,47.160723981324409,48.490459405839161,49.820194830353913,51.149930254868664,52.479665679383416,53.809401103898168,55.139136528412919,56.468871952927671,57.798607377442423,59.128342801957174,60.458078226471926,61.787813650986678,63.117549075501429,64.447284500016181,65.777019924530933,67.106755349045685,68.436490773560436,69.766226198075159,71.095961622589911,72.425697047104663,73.755432471619415,75.085167896134166,76.414903320648918,77.74463874516367,79.074374169678421,80.404109594193173,81.733845018707925,83.063580443222676,84.393315867737428,85.72305129225218,87.052786716766931,88.382522141281683,89.712257565796435,91.041992990311186,92.371728414825938,93.70146383934069],[-17.097797304935277,-15.768061880420525,-14.438326455905774,-13.108591031391022,-11.77885560687627,-10.449120182361519,-9.1193847578467668,-7.7896493333320151,-6.4599139088172635,-5.1301784843025118,-3.8004430597877601,-2.4707076352730084,-1.1409722107582567,0.18876321375649496,1.5184986382712466,2.8482340627859983,4.17796948730075,5.5077049118155017,6.8374403363302534,8.1671757608450051,9.4969111853597568,10.826646609874508,12.15638203438926,13.486117458904012,14.815852883418763,16.145588307933515,17.475323732448267,18.805059156963019,20.13479458147777,21.464530005992522,22.794265430507274,24.124000855022025,25.453736279536777,26.7834717040515,28.113207128566252,29.442942553081004,30.772677977595755,32.102413402110507,33.432148826625259,34.76188425114001,36.091619675654762,37.421355100169514,38.751090524684265,40.080825949199017,41.410561373713769,42.74029679822852,44.070032222743272,45.399767647258024,46.729503071772776,48.059238496287527,49.388973920802279,50.718709345317031,52.048444769831782,53.378180194346534,54.707915618861286,56.037651043376037,57.367386467890789,58.697121892405541,60.026857316920292,61.356592741435044,62.686328165949796,64.01606359046454,65.345799014979292,66.675534439494044,68.005269864008767,69.335005288523519,70.66474071303827,71.994476137553022,73.324211562067774,74.653946986582525,75.983682411097277,77.313417835612029,78.64315326012678,79.972888684641532,81.302624109156284,82.632359533671035,83.962094958185787,85.291830382700539,86.621565807215291,87.951301231730042,89.281036656244794,90.610772080759546,91.940507505274297],[-18.858753639001666,-17.529018214486914,-16.199282789972163,-14.869547365457411,-13.539811940942659,-12.210076516427907,-10.880341091913156,-9.5506056673984041,-8.2208702428836524,-6.8911348183689007,-5.5613993938541491,-4.2316639693393974,-2.9019285448246457,-1.572193120309894,-0.24245769579514231,1.0872777287196094,2.4170131532343611,3.7467485777491127,5.0764840022638644,6.4062194267786161,7.7359548512933678,9.0656902758081195,10.395425700322871,11.725161124837623,13.054896549352375,14.384631973867126,15.714367398381878,17.04410282289663,18.373838247411381,19.703573671926133,21.033309096440885,22.363044520955636,23.692779945470388,25.022515369985111,26.352250794499863,27.681986219014615,29.011721643529366,30.341457068044118,31.67119249255887,33.000927917073625,34.330663341588377,35.660398766103128,36.99013419061788,38.319869615132632,39.649605039647383,40.979340464162135,42.309075888676887,43.638811313191638,44.96854673770639,46.298282162221142,47.628017586735893,48.957753011250645,50.287488435765397,51.617223860280149,52.9469592847949,54.276694709309652,55.606430133824404,56.936165558339155,58.265900982853907,59.595636407368659,60.92537183188341,62.255107256398162,63.584842680912914,64.914578105427665,66.244313529942389,67.57404895445714,68.903784378971892,70.233519803486644,71.563255228001395,72.892990652516147,74.222726077030899,75.55246150154565,76.882196926060402,78.211932350575154,79.541667775089905,80.871403199604657,82.201138624119409,83.530874048634161,84.860609473148912,86.190344897663664,87.520080322178416,88.849815746693167,90.179551171207919],[-20.619709973068055,-19.289974548553303,-17.960239124038551,-16.6305036995238,-15.300768275009048,-13.971032850494296,-12.641297425979545,-11.311562001464793,-9.9818265769500414,-8.6520911524352897,-7.322355727920538,-5.9926203034057863,-4.6628848788910346,-3.333149454376283,-2.0034140298615313,-0.67367860534677959,0.65605681916797209,1.9857922436827238,3.3155276681974755,4.6452630927122271,5.9749985172269788,7.3047339417417305,8.6344693662564822,9.9642047907712339,11.293940215285986,12.623675639800737,13.953411064315489,15.283146488830241,16.612881913344992,17.942617337859744,19.272352762374496,20.602088186889247,21.931823611403999,23.261559035918722,24.591294460433474,25.921029884948226,27.250765309462977,28.580500733977729,29.910236158492481,31.239971583007232,32.569707007521984,33.899442432036736,35.229177856551487,36.558913281066239,37.888648705580991,39.218384130095743,40.548119554610494,41.877854979125246,43.207590403639998,44.537325828154749,45.867061252669501,47.196796677184253,48.526532101699004,49.856267526213756,51.186002950728508,52.515738375243259,53.845473799758011,55.175209224272763,56.504944648787514,57.834680073302266,59.164415497817018,60.494150922331769,61.823886346846521,63.153621771361273,64.483357195875996,65.813092620390748,67.142828044905499,68.472563469420251,69.802298893935003,71.132034318449755,72.461769742964506,73.791505167479258,75.12124059199401,76.450976016508761,77.780711441023513,79.110446865538265,80.440182290053016,81.769917714567768,83.09965313908252,84.429388563597271,85.759123988112023,87.088859412626775,88.418594837141526],[-22.380666307134444,-21.050930882619692,-19.72119545810494,-18.391460033590189,-17.061724609075437,-15.731989184560685,-14.402253760045934,-13.072518335531182,-11.74278291101643,-10.413047486501679,-9.083312061986927,-7.7535766374721753,-6.4238412129574236,-5.0941057884426719,-3.7643703639279202,-2.4346349394131686,-1.1048995148984169,0.22483590961633482,1.5545713341310865,2.8843067586458382,4.2140421831605899,5.5437776076753416,6.8735130321900932,8.2032484567048449,9.5329838812195966,10.862719305734348,12.1924547302491,13.522190154763852,14.851925579278603,16.181661003793355,17.511396428308107,18.841131852822858,20.17086727733761,21.500602701852333,22.830338126367085,24.160073550881837,25.489808975396588,26.81954439991134,28.149279824426092,29.479015248940843,30.808750673455595,32.138486097970343,33.468221522485095,34.797956946999847,36.127692371514598,37.45742779602935,38.787163220544102,40.116898645058853,41.446634069573605,42.776369494088357,44.106104918603108,45.43584034311786,46.765575767632612,48.095311192147363,49.425046616662115,50.754782041176867,52.084517465691619,53.41425289020637,54.743988314721122,56.073723739235874,57.403459163750625,58.733194588265377,60.062930012780129,61.39266543729488,62.722400861809604,64.052136286324355,65.381871710839107,66.711607135353859,68.04134255986861,69.371077984383362,70.700813408898114,72.030548833412865,73.360284257927617,74.690019682442369,76.01975510695712,77.349490531471872,78.679225955986624,80.008961380501376,81.338696805016127,82.668432229530879,83.998167654045631,85.327903078560382,86.657638503075134]],"text":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153"],"mode":"markers","type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Here is a second view of this same regression with what is called a
contour plot, contour map, or density plot.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a>mycolorpalette <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;skyblue2&quot;</span>, <span class="st">&quot;orange&quot;</span>))</span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a><span class="fu">filled.contour</span>(<span class="at">x=</span>axis_x, <span class="at">y=</span>axis_y, <span class="at">z=</span><span class="fu">matrix</span>(air_surface<span class="sc">$</span>Z, <span class="fu">length</span>(axis_x), <span class="fu">length</span>(axis_y)), <span class="at">col=</span><span class="fu">mycolorpalette</span>(<span class="dv">26</span>))</span></code></pre></div>
<p><strong>Including the Interaction Term</strong></p>
<p>Here is what a 3D regression looks like when the interaction term is
present. The two x-variables of <code>Month</code> and <code>Temp</code>
are being used to predict the y-variable of <code>Ozone</code>.</p>
<p><span class="math display">\[
  \underbrace{Y_i}_\text{Ozone} \underbrace{=}_{\sim}
\overbrace{\beta_0}^{\stackrel{\text{y-int}}{\text{baseline}}} +
\overbrace{\beta_1}^{\stackrel{\text{slope}}{\text{baseline}}}
\underbrace{X_{1i}}_\text{Temp} +
\overbrace{\beta_2}^{\stackrel{\text{change
in}}{\text{y-int}}}  \underbrace{X_{2i}}_\text{Month} +
\overbrace{\beta_3}^{\stackrel{\text{change in}}{\text{slope}}}
\underbrace{X_{1i}X_{2i}}_\text{Temp:Month} + \epsilon_i
\]</span></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a>air_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ozone <span class="sc">~</span> Temp <span class="sc">+</span> Month <span class="sc">+</span> Temp<span class="sc">:</span>Month, <span class="at">data=</span> airquality)</span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a><span class="fu">pander</span>(air_lm<span class="sc">$</span>coefficients)</span></code></pre></div>
<table style="width:60%;">
<colgroup>
<col width="19%" />
<col width="9%" />
<col width="12%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">(Intercept)</th>
<th align="center">Temp</th>
<th align="center">Month</th>
<th align="center">Temp:Month</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">-3.915</td>
<td align="center">0.77</td>
<td align="center">-23.01</td>
<td align="center">0.2678</td>
</tr>
</tbody>
</table>
<p>Notice how all coefficient estimates have changed. The y-intercept,
<span class="math inline">\(\beta_0\)</span> is now estimated to be
<span class="math inline">\(-3.915\)</span>. The slope term, <span
class="math inline">\(\beta_1\)</span>, in the Temp-direction is
estimated as <span class="math inline">\(0.77\)</span>, while the slope
term, <span class="math inline">\(\beta_2\)</span>, in the
Month-direction is estimated to be <span
class="math inline">\(-23.01\)</span>. This change in estimated
coefficiets is due to the presence of the interaction term’s
coefficient, <span class="math inline">\(\beta_3\)</span>, which is
estimated to be <span class="math inline">\(0.2678\)</span>. As you
should notice in the graphic, the interaction model allows the “slopes”
in each direction to change, creating a “curved” surface for the
regression surface instead of a flat surface.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="co">#Perform the multiple regression</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>air_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ozone <span class="sc">~</span> Temp <span class="sc">+</span> Month <span class="sc">+</span> Temp<span class="sc">:</span>Month, <span class="at">data=</span> airquality)</span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a><span class="co">#Graph Resolution (more important for more complex shapes)</span></span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>graph_reso <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a></span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a><span class="co">#Setup Axis</span></span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a>axis_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(airquality<span class="sc">$</span>Temp), <span class="fu">max</span>(airquality<span class="sc">$</span>Temp), <span class="at">by =</span> graph_reso)</span>
<span id="cb95-9"><a href="#cb95-9" tabindex="-1"></a>axis_y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(airquality<span class="sc">$</span>Month), <span class="fu">max</span>(airquality<span class="sc">$</span>Month), <span class="at">by =</span> graph_reso)</span>
<span id="cb95-10"><a href="#cb95-10" tabindex="-1"></a></span>
<span id="cb95-11"><a href="#cb95-11" tabindex="-1"></a><span class="co">#Sample points</span></span>
<span id="cb95-12"><a href="#cb95-12" tabindex="-1"></a>air_surface <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">Temp =</span> axis_x, <span class="at">Month =</span> axis_y, <span class="at">KEEP.OUT.ATTRS=</span>F)</span>
<span id="cb95-13"><a href="#cb95-13" tabindex="-1"></a>air_surface <span class="ot">&lt;-</span> air_surface <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Z=</span><span class="fu">predict.lm</span>(air_lm, <span class="at">newdata =</span> air_surface))</span>
<span id="cb95-14"><a href="#cb95-14" tabindex="-1"></a>air_surface <span class="ot">&lt;-</span> <span class="fu">acast</span>(air_surface, Month <span class="sc">~</span> Temp, <span class="at">value.var =</span> <span class="st">&quot;Z&quot;</span>) <span class="co">#y ~ x</span></span>
<span id="cb95-15"><a href="#cb95-15" tabindex="-1"></a></span>
<span id="cb95-16"><a href="#cb95-16" tabindex="-1"></a><span class="co">#Create scatterplot</span></span>
<span id="cb95-17"><a href="#cb95-17" tabindex="-1"></a><span class="fu">plot_ly</span>(airquality, </span>
<span id="cb95-18"><a href="#cb95-18" tabindex="-1"></a>        <span class="at">x =</span> <span class="sc">~</span>Temp, </span>
<span id="cb95-19"><a href="#cb95-19" tabindex="-1"></a>        <span class="at">y =</span> <span class="sc">~</span>Month, </span>
<span id="cb95-20"><a href="#cb95-20" tabindex="-1"></a>        <span class="at">z =</span> <span class="sc">~</span>Ozone,</span>
<span id="cb95-21"><a href="#cb95-21" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">rownames</span>(airquality), </span>
<span id="cb95-22"><a href="#cb95-22" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;scatter3d&quot;</span>, </span>
<span id="cb95-23"><a href="#cb95-23" tabindex="-1"></a>        <span class="at">mode =</span> <span class="st">&quot;markers&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-24"><a href="#cb95-24" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">z =</span> air_surface,</span>
<span id="cb95-25"><a href="#cb95-25" tabindex="-1"></a>            <span class="at">x =</span> axis_x,</span>
<span id="cb95-26"><a href="#cb95-26" tabindex="-1"></a>            <span class="at">y =</span> axis_y,</span>
<span id="cb95-27"><a href="#cb95-27" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&quot;surface&quot;</span>)</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-3622e086f559e1d49cab" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-3622e086f559e1d49cab">{"x":{"visdat":{"30a8713639c":["function () ","plotlyVisDat"]},"cur_data":"30a8713639c","attrs":{"30a8713639c":{"x":{},"y":{},"z":{},"text":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153"],"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"},"30a8713639c.1":{"x":[56,56.5,57,57.5,58,58.5,59,59.5,60,60.5,61,61.5,62,62.5,63,63.5,64,64.5,65,65.5,66,66.5,67,67.5,68,68.5,69,69.5,70,70.5,71,71.5,72,72.5,73,73.5,74,74.5,75,75.5,76,76.5,77,77.5,78,78.5,79,79.5,80,80.5,81,81.5,82,82.5,83,83.5,84,84.5,85,85.5,86,86.5,87,87.5,88,88.5,89,89.5,90,90.5,91,91.5,92,92.5,93,93.5,94,94.5,95,95.5,96,96.5,97],"y":[5,5.5,6,6.5,7,7.5,8,8.5,9],"z":[[-0.83442089392809748,0.22012837686894215,1.2746776476659818,2.3292269184630072,3.3837761892600753,4.4383254600571007,5.4928747308541404,6.54742400165118,7.6019732724482196,8.6565225432452735,9.7110718140422989,10.765621084839339,11.820170355636392,12.874719626433418,13.929268897230472,14.983818168027497,16.038367438824551,17.092916709621591,18.147465980418616,19.202015251215684,20.25656452201271,21.311113792809749,22.365663063606789,23.420212334403828,24.474761605200882,25.529310875997908,26.583860146794947,27.638409417592001,28.692958688389027,29.74750795918608,30.802057229983106,31.85660650078016,32.911155771577199,33.965705042374232,35.020254313171272,36.074803583968318,37.129352854765358,38.18390212556239,39.238451396359444,40.293000667156484,41.347549937953517,42.402099208750556,43.456648479547603,44.511197750344643,45.565747021141682,46.620296291938715,47.674845562735769,48.729394833532801,49.783944104329841,50.83849337512688,51.893042645923927,52.947591916720967,54.002141187517999,55.056690458315053,56.111239729112093,57.165788999909125,58.220338270706165,59.274887541503219,60.329436812300244,61.383986083097284,62.438535353894324,63.493084624691377,64.547633895488417,65.602183166285442,66.656732437082482,67.711281707879536,68.765830978676576,69.820380249473615,70.874929520270641,71.929478791067694,72.984028061864734,74.038577332661774,75.093126603458828,76.147675874255853,77.202225145052893,78.256774415849932,79.311323686646986,80.365872957444026,81.420422228241051,82.474971499038091,83.529520769835131,84.58407004063217,85.638619311429238],[-4.8386227932523695,-3.7171209728019647,-2.5956191523515741,-1.4741173319011978,-0.35261551145077874,0.76888630899959765,1.8903881294499882,3.011889949900393,4.1333917703507694,5.2548935908011742,6.3763954112515506,7.4978972317019554,8.619399052152346,9.7409008726027224,10.862402693053141,11.983904513503518,13.105406333953908,14.226908154404299,15.34840997485469,16.469911795305094,17.591413615755471,18.712915436205876,19.834417256656266,20.955919077106643,22.077420897557047,23.198922718007438,24.320424538457829,25.441926358908219,26.56342817935861,27.684929999809015,28.806431820259391,29.927933640709782,31.049435461160186,32.170937281610563,33.292439102060968,34.413940922511358,35.535442742961749,36.656944563412139,37.77844638386253,38.899948204312935,40.021450024763311,41.142951845213702,42.264453665664107,43.385955486114483,44.507457306564888,45.628959127015278,46.750460947465669,47.87196276791606,48.993464588366436,50.114966408816855,51.236468229267231,52.357970049717622,53.479471870168027,54.600973690618403,55.722475511068808,56.843977331519184,57.965479151969589,59.08698097241998,60.208482792870356,61.329984613320761,62.451486433771151,63.572988254221542,64.694490074671933,65.815991895122323,66.937493715572728,68.058995536023104,69.180497356473509,70.301999176923886,71.423500997374276,72.545002817824681,73.666504638275057,74.788006458725462,75.909508279175867,77.031010099626229,78.152511920076634,79.274013740527039,80.395515560977415,81.51701738142782,82.638519201878211,83.760021022328587,84.881522842778992,86.003024663229368,87.124526483679773],[-8.8428246925766274,-7.6543703224728716,-6.4659159523691301,-5.2774615822654027,-4.0890072121616328,-2.9005528420579054,-1.7120984719541639,-0.52364410185040811,0.66481026825331924,1.853264638357075,3.0417190084608166,4.2301733785645581,5.4186277486682997,6.6070821187720412,7.795536488875797,8.9839908589795243,10.172445229083266,11.360899599187022,12.549353969290749,13.737808339394505,14.926262709498246,16.114717079601988,17.303171449705729,18.491625819809471,19.680080189913227,20.868534560016954,22.05698893012071,23.245443300224451,24.433897670328179,25.622352040431949,26.810806410535676,27.999260780639418,29.187715150743173,30.376169520846901,31.564623890950656,32.753078261054398,33.94153263115814,35.129987001261881,36.318441371365608,37.506895741469378,38.695350111573106,39.883804481676847,41.072258851780603,42.26071322188433,43.449167591988086,44.637621962091828,45.826076332195569,47.014530702299311,48.202985072403038,49.391439442506794,50.57989381261055,51.768348182714291,52.956802552818033,54.14525692292176,55.333711293025516,56.522165663129243,57.710620033233013,58.899074403336755,60.087528773440482,61.275983143544224,62.464437513647965,63.652891883751707,64.841346253855477,66.029800623959204,67.218254994062946,68.406709364166687,69.595163734270429,70.78361810437417,71.972072474477898,73.160526844581668,74.348981214685409,75.537435584789151,76.725889954892892,77.91434432499662,79.102798695100361,80.291253065204131,81.479707435307873,82.668161805411614,83.856616175515342,85.045070545619083,86.233524915722825,87.421979285826595,88.610433655930336],[-12.847026591900914,-11.591619672143807,-10.336212752386714,-9.0808058326296361,-7.8253989128725152,-6.5699919931154369,-5.3145850733583444,-4.0591781536012377,-2.8037712338441594,-1.5483643140870527,-0.29295739432996015,0.96244952542713236,2.2178564451842391,3.4732633649413174,4.7286702846984241,5.9840772044555166,7.2394841242126091,8.4948910439697016,9.7502979637267941,11.005704883483901,12.261111803240979,13.516518722998086,14.771925642755178,16.027332562512257,17.282739482269378,18.538146402026456,19.793553321783548,21.048960241540655,22.304367161297733,23.55977408105484,24.815181000811933,26.070587920569025,27.325994840326118,28.58140176008321,29.836808679840317,31.092215599597395,32.347622519354488,33.603029439111594,34.858436358868687,36.113843278625779,37.369250198382872,38.624657118139979,39.880064037897057,41.13547095765415,42.39087787741127,43.646284797168335,44.901691716925441,46.157098636682548,47.412505556439612,48.667912476196733,49.923319395953826,51.178726315710904,52.434133235468011,53.689540155225103,54.944947074982196,56.200353994739288,57.455760914496395,58.711167834253473,59.966574754010566,61.221981673767672,62.477388593524751,63.732795513281857,64.988202433038964,66.243609352796028,67.499016272553135,68.754423192310242,70.009830112067348,71.265237031824427,72.520643951581519,73.776050871338626,75.031457791095704,76.286864710852811,77.542271630609918,78.797678550366982,80.053085470124088,81.308492389881195,82.563899309638273,83.81930622939538,85.074713149152473,86.330120068909551,87.585526988666658,88.840933908423764,90.096340828180843],[-16.851228491225172,-15.528869021814714,-14.20650955240427,-12.884150082993841,-11.561790613583369,-10.23943114417294,-8.9170716747624823,-7.5947122053520388,-6.2723527359416096,-4.9499932665311377,-3.6276337971207084,-2.305274327710265,-0.98291485829980729,0.33944461111062196,1.6618040805210939,2.9841635499315231,4.3065230193419666,5.6288824887524243,6.9512419581628535,8.2736014275733112,9.5959608969837547,10.918320366394198,12.240679835804642,13.563039305215085,14.885398774625543,16.207758244035972,17.530117713446415,18.852477182856887,20.174836652267317,21.497196121677774,22.819555591088204,24.141915060498647,25.464274529909119,26.786633999319548,28.108993468730006,29.431352938140435,30.753712407550879,32.07607187696135,33.39843134637178,34.720790815782237,36.043150285192667,37.36550975460311,38.687869224013554,40.010228693424011,41.332588162834469,42.654947632244898,43.977307101655342,45.299666571065785,46.622026040476243,47.9443855098867,49.26674497929713,50.589104448707573,51.911463918118017,53.233823387528446,54.556182856938932,55.878542326349361,57.200901795759805,58.523261265170248,59.845620734580677,61.167980203991149,62.490339673401593,63.812699142812036,65.13505861222248,66.457418081632909,67.779777551043352,69.102137020453824,70.424496489864268,71.746855959274711,73.069215428685141,74.391574898095584,75.713934367506056,77.036293836916499,78.358653306326943,79.681012775737372,81.003372245147816,82.325731714558287,83.648091183968731,84.970450653379174,86.292810122789604,87.615169592200047,88.937529061610491,90.259888531020962,91.582248000431406],[-20.855430390549458,-19.466118371485635,-18.076806352421855,-16.687494333358075,-15.298182314294252,-13.908870295230471,-12.519558276166649,-11.130246257102868,-9.7409342380390882,-8.3516222189752654,-6.9623101999114851,-5.5729981808476623,-4.1836861617838821,-2.7943741427201019,-1.405062123656279,-0.015750104592498815,1.3735619144712956,2.7628739335351042,4.1521859525988987,5.5414979716626931,6.9308099907264875,8.3201220097902961,9.7094340288540764,11.098746047917871,12.488058066981694,13.877370086045488,15.266682105109268,16.655994124173077,18.045306143236871,19.434618162300666,20.82393018136446,22.213242200428269,23.602554219492049,24.991866238555843,26.381178257619666,27.770490276683461,29.159802295747241,30.54911431481105,31.938426333874844,33.327738352938638,34.717050372002433,36.106362391066241,37.495674410130022,38.884986429193816,40.274298448257639,41.663610467321433,43.052922486385214,44.442234505449022,45.831546524512817,47.220858543576611,48.610170562640405,49.999482581704214,51.388794600767994,52.778106619831789,54.167418638895612,55.556730657959406,56.946042677023186,58.335354696086995,59.724666715150789,61.113978734214569,62.503290753278378,63.892602772342187,65.281914791405967,66.671226810469761,68.06053882953357,69.449850848597379,70.839162867661159,72.228474886724968,73.617786905788762,75.007098924852542,76.396410943916351,77.785722962980159,79.17503498204394,80.564347001107734,81.953659020171543,83.342971039235323,84.732283058299132,86.12159507736294,87.510907096426735,88.900219115490515,90.289531134554323,91.678843153618132,93.068155172681912],[-24.859632289873716,-23.403367721156542,-21.947103152439411,-20.490838583722265,-19.034574015005106,-17.578309446287975,-16.122044877570801,-14.66578030885367,-13.209515740136538,-11.75325117141935,-10.296986602702219,-8.8407220339850596,-7.3844574652679285,-5.9281928965507973,-4.4719283278336093,-3.0156637591164781,-1.5593991903993185,-0.10313462168218734,1.3531299470349438,2.8093945157521318,4.265659084469263,5.7219236531864226,7.1781882219035538,8.6344527906206849,10.090717359337873,11.546981928055004,13.003246496772164,14.459511065489295,15.915775634206454,17.372040202923614,18.828304771640745,20.284569340357905,21.740833909075036,23.197098477792196,24.653363046509355,26.109627615226486,27.565892183943646,29.022156752660777,30.478421321377937,31.934685890095096,33.390950458812227,34.847215027529387,36.303479596246518,37.759744164963678,39.216008733680837,40.672273302397969,42.128537871115114,43.584802439832288,45.041067008549419,46.497331577266579,47.95359614598371,49.409860714700855,50.866125283418029,52.32238985213516,53.77865442085232,55.234918989569451,56.691183558286596,58.14744812700377,59.603712695720901,61.059977264438047,62.516241833155192,63.972506401872337,65.428770970589511,66.885035539306642,68.341300108023788,69.797564676740933,71.253829245458107,72.710093814175252,74.166358382892383,75.622622951609529,77.078887520326674,78.535152089043848,79.991416657760993,81.447681226478124,82.90394579519527,84.360210363912415,85.816474932629589,87.272739501346734,88.729004070063866,90.185268638781011,91.641533207498156,93.09779777621533,94.554062344932476],[-28.863834189197974,-27.340617070827449,-25.817399952456952,-24.294182834086484,-22.77096571571596,-21.247748597345463,-19.724531478974967,-18.201314360604471,-16.678097242233974,-15.15488012386345,-13.631663005492982,-12.108445887122457,-10.585228768751961,-9.0620116503814643,-7.5387945320109679,-6.0155774136404716,-4.4923602952699468,-2.9691431768994789,-1.4459260585289826,0.077291059841542165,1.6005081782120385,3.1237252965825348,4.6469424149530312,6.1701595333235275,7.6933766516940238,9.2165937700645202,10.739810888435045,12.263028006805541,13.786245125176009,15.309462243546534,16.83267936191703,18.355896480287555,19.879113598658023,21.402330717028519,22.925547835399044,24.448764953769512,25.971982072140037,27.495199190510533,29.018416308881029,30.541633427251526,32.064850545622022,33.588067663992547,35.111284782363043,36.634501900733511,38.157719019104036,39.680936137474532,41.204153255845029,42.727370374215525,44.250587492586021,45.773804610956546,47.297021729327014,48.820238847697539,50.343455966068035,51.866673084438503,53.389890202809028,54.913107321179524,56.436324439550049,57.959541557920517,59.482758676291013,61.005975794661509,62.529192913032034,64.05241003140253,65.575627149773027,67.098844268143523,68.622061386513991,70.145278504884516,71.668495623255041,73.191712741625537,74.714929859996005,76.238146978366501,77.761364096737026,79.284581215107551,80.807798333478019,82.331015451848515,83.854232570219025,85.377449688589508,86.900666806960018,88.423883925330529,89.947101043701025,91.470318162071507,92.993535280442018,94.516752398812528,96.03996951718301],[-32.868036088522246,-31.277866420498412,-29.687696752474551,-28.097527084450718,-26.507357416426828,-24.917187748402995,-23.327018080379162,-21.7368484123553,-20.146678744331467,-18.556509076307577,-16.966339408283744,-15.376169740259911,-13.78600007223605,-12.195830404212188,-10.605660736188327,-9.0154910681644935,-7.4253214001406604,-5.8351517321167705,-4.2449820640929374,-2.6548123960690759,-1.0646427280452428,0.52552693997861866,2.1156966080024802,3.7058662760263132,5.2960359440501747,6.8862056120740363,8.4763752800978693,10.066544948121731,11.656714616145564,13.246884284169425,14.837053952193287,16.42722362021712,18.017393288240982,19.607562956264815,21.197732624288705,22.787902292312538,24.378071960336371,25.968241628360232,27.558411296384094,29.148580964407955,30.738750632431788,32.328920300455621,33.919089968479511,35.509259636503344,37.099429304527206,38.689598972551039,40.279768640574872,41.869938308598762,43.460107976622595,45.050277644646457,46.64044731267029,48.230616980694151,49.820786648718013,51.410956316741846,53.001125984765707,54.591295652789569,56.181465320813402,57.771634988837263,59.361804656861096,60.951974324884986,62.542143992908819,64.132313660932653,65.722483328956514,67.312652996980376,68.902822665004237,70.49299233302807,72.083162001051903,73.673331669075765,75.263501337099626,76.853671005123488,78.443840673147321,80.034010341171154,81.624180009195044,83.214349677218877,84.804519345242738,86.394689013266571,87.984858681290433,89.575028349314294,91.165198017338128,92.755367685361989,94.345537353385851,95.935707021409684,97.525876689433545]],"text":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153"],"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Temp"},"yaxis":{"title":"Month"},"zaxis":{"title":"Ozone"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[67,72,74,62,66,65,59,61,74,69,66,68,58,64,66,57,68,62,59,73,61,61,67,81,79,76,82,90,87,82,77,72,65,73,76,84,85,81,83,83,88,92,92,89,73,81,80,81,82,84,87,85,74,86,85,82,86,88,86,83,81,81,81,82,86,85,87,89,90,90,86,82,80,77,79,76,78,78,77,72,79,81,86,97,94,96,94,91,92,93,93,87,84,80,78,75,73,81,76,77,71,71,78,67,76,68,82,64,71,81,69,63,70,75,76,68],"y":[5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],"z":[41,36,12,18,28,23,19,8,7,16,11,14,18,14,34,6,30,11,1,11,4,32,23,45,115,37,29,71,39,23,21,37,20,12,13,135,49,32,64,40,77,97,97,85,10,27,7,48,35,61,79,63,16,80,108,20,52,82,50,64,59,39,9,16,78,35,66,122,89,110,44,28,65,22,59,23,31,44,21,9,45,168,73,76,118,84,85,96,78,73,91,47,32,20,23,21,24,44,21,28,9,13,46,18,13,24,16,13,23,36,7,14,30,14,18,20],"text":["1","2","3","4","6","7","8","9","11","12","13","14","15","16","17","18","19","20","21","22","23","24","28","29","30","31","38","40","41","44","47","48","49","50","51","62","63","64","66","67","68","69","70","71","73","74","76","77","78","79","80","81","82","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","104","105","106","108","109","110","111","112","113","114","116","117","118","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","151","152","153"],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"colorbar":{"title":"Ozone","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333334","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[56,56.5,57,57.5,58,58.5,59,59.5,60,60.5,61,61.5,62,62.5,63,63.5,64,64.5,65,65.5,66,66.5,67,67.5,68,68.5,69,69.5,70,70.5,71,71.5,72,72.5,73,73.5,74,74.5,75,75.5,76,76.5,77,77.5,78,78.5,79,79.5,80,80.5,81,81.5,82,82.5,83,83.5,84,84.5,85,85.5,86,86.5,87,87.5,88,88.5,89,89.5,90,90.5,91,91.5,92,92.5,93,93.5,94,94.5,95,95.5,96,96.5,97],"y":[5,5.5,6,6.5,7,7.5,8,8.5,9],"z":[[-0.83442089392809748,0.22012837686894215,1.2746776476659818,2.3292269184630072,3.3837761892600753,4.4383254600571007,5.4928747308541404,6.54742400165118,7.6019732724482196,8.6565225432452735,9.7110718140422989,10.765621084839339,11.820170355636392,12.874719626433418,13.929268897230472,14.983818168027497,16.038367438824551,17.092916709621591,18.147465980418616,19.202015251215684,20.25656452201271,21.311113792809749,22.365663063606789,23.420212334403828,24.474761605200882,25.529310875997908,26.583860146794947,27.638409417592001,28.692958688389027,29.74750795918608,30.802057229983106,31.85660650078016,32.911155771577199,33.965705042374232,35.020254313171272,36.074803583968318,37.129352854765358,38.18390212556239,39.238451396359444,40.293000667156484,41.347549937953517,42.402099208750556,43.456648479547603,44.511197750344643,45.565747021141682,46.620296291938715,47.674845562735769,48.729394833532801,49.783944104329841,50.83849337512688,51.893042645923927,52.947591916720967,54.002141187517999,55.056690458315053,56.111239729112093,57.165788999909125,58.220338270706165,59.274887541503219,60.329436812300244,61.383986083097284,62.438535353894324,63.493084624691377,64.547633895488417,65.602183166285442,66.656732437082482,67.711281707879536,68.765830978676576,69.820380249473615,70.874929520270641,71.929478791067694,72.984028061864734,74.038577332661774,75.093126603458828,76.147675874255853,77.202225145052893,78.256774415849932,79.311323686646986,80.365872957444026,81.420422228241051,82.474971499038091,83.529520769835131,84.58407004063217,85.638619311429238],[-4.8386227932523695,-3.7171209728019647,-2.5956191523515741,-1.4741173319011978,-0.35261551145077874,0.76888630899959765,1.8903881294499882,3.011889949900393,4.1333917703507694,5.2548935908011742,6.3763954112515506,7.4978972317019554,8.619399052152346,9.7409008726027224,10.862402693053141,11.983904513503518,13.105406333953908,14.226908154404299,15.34840997485469,16.469911795305094,17.591413615755471,18.712915436205876,19.834417256656266,20.955919077106643,22.077420897557047,23.198922718007438,24.320424538457829,25.441926358908219,26.56342817935861,27.684929999809015,28.806431820259391,29.927933640709782,31.049435461160186,32.170937281610563,33.292439102060968,34.413940922511358,35.535442742961749,36.656944563412139,37.77844638386253,38.899948204312935,40.021450024763311,41.142951845213702,42.264453665664107,43.385955486114483,44.507457306564888,45.628959127015278,46.750460947465669,47.87196276791606,48.993464588366436,50.114966408816855,51.236468229267231,52.357970049717622,53.479471870168027,54.600973690618403,55.722475511068808,56.843977331519184,57.965479151969589,59.08698097241998,60.208482792870356,61.329984613320761,62.451486433771151,63.572988254221542,64.694490074671933,65.815991895122323,66.937493715572728,68.058995536023104,69.180497356473509,70.301999176923886,71.423500997374276,72.545002817824681,73.666504638275057,74.788006458725462,75.909508279175867,77.031010099626229,78.152511920076634,79.274013740527039,80.395515560977415,81.51701738142782,82.638519201878211,83.760021022328587,84.881522842778992,86.003024663229368,87.124526483679773],[-8.8428246925766274,-7.6543703224728716,-6.4659159523691301,-5.2774615822654027,-4.0890072121616328,-2.9005528420579054,-1.7120984719541639,-0.52364410185040811,0.66481026825331924,1.853264638357075,3.0417190084608166,4.2301733785645581,5.4186277486682997,6.6070821187720412,7.795536488875797,8.9839908589795243,10.172445229083266,11.360899599187022,12.549353969290749,13.737808339394505,14.926262709498246,16.114717079601988,17.303171449705729,18.491625819809471,19.680080189913227,20.868534560016954,22.05698893012071,23.245443300224451,24.433897670328179,25.622352040431949,26.810806410535676,27.999260780639418,29.187715150743173,30.376169520846901,31.564623890950656,32.753078261054398,33.94153263115814,35.129987001261881,36.318441371365608,37.506895741469378,38.695350111573106,39.883804481676847,41.072258851780603,42.26071322188433,43.449167591988086,44.637621962091828,45.826076332195569,47.014530702299311,48.202985072403038,49.391439442506794,50.57989381261055,51.768348182714291,52.956802552818033,54.14525692292176,55.333711293025516,56.522165663129243,57.710620033233013,58.899074403336755,60.087528773440482,61.275983143544224,62.464437513647965,63.652891883751707,64.841346253855477,66.029800623959204,67.218254994062946,68.406709364166687,69.595163734270429,70.78361810437417,71.972072474477898,73.160526844581668,74.348981214685409,75.537435584789151,76.725889954892892,77.91434432499662,79.102798695100361,80.291253065204131,81.479707435307873,82.668161805411614,83.856616175515342,85.045070545619083,86.233524915722825,87.421979285826595,88.610433655930336],[-12.847026591900914,-11.591619672143807,-10.336212752386714,-9.0808058326296361,-7.8253989128725152,-6.5699919931154369,-5.3145850733583444,-4.0591781536012377,-2.8037712338441594,-1.5483643140870527,-0.29295739432996015,0.96244952542713236,2.2178564451842391,3.4732633649413174,4.7286702846984241,5.9840772044555166,7.2394841242126091,8.4948910439697016,9.7502979637267941,11.005704883483901,12.261111803240979,13.516518722998086,14.771925642755178,16.027332562512257,17.282739482269378,18.538146402026456,19.793553321783548,21.048960241540655,22.304367161297733,23.55977408105484,24.815181000811933,26.070587920569025,27.325994840326118,28.58140176008321,29.836808679840317,31.092215599597395,32.347622519354488,33.603029439111594,34.858436358868687,36.113843278625779,37.369250198382872,38.624657118139979,39.880064037897057,41.13547095765415,42.39087787741127,43.646284797168335,44.901691716925441,46.157098636682548,47.412505556439612,48.667912476196733,49.923319395953826,51.178726315710904,52.434133235468011,53.689540155225103,54.944947074982196,56.200353994739288,57.455760914496395,58.711167834253473,59.966574754010566,61.221981673767672,62.477388593524751,63.732795513281857,64.988202433038964,66.243609352796028,67.499016272553135,68.754423192310242,70.009830112067348,71.265237031824427,72.520643951581519,73.776050871338626,75.031457791095704,76.286864710852811,77.542271630609918,78.797678550366982,80.053085470124088,81.308492389881195,82.563899309638273,83.81930622939538,85.074713149152473,86.330120068909551,87.585526988666658,88.840933908423764,90.096340828180843],[-16.851228491225172,-15.528869021814714,-14.20650955240427,-12.884150082993841,-11.561790613583369,-10.23943114417294,-8.9170716747624823,-7.5947122053520388,-6.2723527359416096,-4.9499932665311377,-3.6276337971207084,-2.305274327710265,-0.98291485829980729,0.33944461111062196,1.6618040805210939,2.9841635499315231,4.3065230193419666,5.6288824887524243,6.9512419581628535,8.2736014275733112,9.5959608969837547,10.918320366394198,12.240679835804642,13.563039305215085,14.885398774625543,16.207758244035972,17.530117713446415,18.852477182856887,20.174836652267317,21.497196121677774,22.819555591088204,24.141915060498647,25.464274529909119,26.786633999319548,28.108993468730006,29.431352938140435,30.753712407550879,32.07607187696135,33.39843134637178,34.720790815782237,36.043150285192667,37.36550975460311,38.687869224013554,40.010228693424011,41.332588162834469,42.654947632244898,43.977307101655342,45.299666571065785,46.622026040476243,47.9443855098867,49.26674497929713,50.589104448707573,51.911463918118017,53.233823387528446,54.556182856938932,55.878542326349361,57.200901795759805,58.523261265170248,59.845620734580677,61.167980203991149,62.490339673401593,63.812699142812036,65.13505861222248,66.457418081632909,67.779777551043352,69.102137020453824,70.424496489864268,71.746855959274711,73.069215428685141,74.391574898095584,75.713934367506056,77.036293836916499,78.358653306326943,79.681012775737372,81.003372245147816,82.325731714558287,83.648091183968731,84.970450653379174,86.292810122789604,87.615169592200047,88.937529061610491,90.259888531020962,91.582248000431406],[-20.855430390549458,-19.466118371485635,-18.076806352421855,-16.687494333358075,-15.298182314294252,-13.908870295230471,-12.519558276166649,-11.130246257102868,-9.7409342380390882,-8.3516222189752654,-6.9623101999114851,-5.5729981808476623,-4.1836861617838821,-2.7943741427201019,-1.405062123656279,-0.015750104592498815,1.3735619144712956,2.7628739335351042,4.1521859525988987,5.5414979716626931,6.9308099907264875,8.3201220097902961,9.7094340288540764,11.098746047917871,12.488058066981694,13.877370086045488,15.266682105109268,16.655994124173077,18.045306143236871,19.434618162300666,20.82393018136446,22.213242200428269,23.602554219492049,24.991866238555843,26.381178257619666,27.770490276683461,29.159802295747241,30.54911431481105,31.938426333874844,33.327738352938638,34.717050372002433,36.106362391066241,37.495674410130022,38.884986429193816,40.274298448257639,41.663610467321433,43.052922486385214,44.442234505449022,45.831546524512817,47.220858543576611,48.610170562640405,49.999482581704214,51.388794600767994,52.778106619831789,54.167418638895612,55.556730657959406,56.946042677023186,58.335354696086995,59.724666715150789,61.113978734214569,62.503290753278378,63.892602772342187,65.281914791405967,66.671226810469761,68.06053882953357,69.449850848597379,70.839162867661159,72.228474886724968,73.617786905788762,75.007098924852542,76.396410943916351,77.785722962980159,79.17503498204394,80.564347001107734,81.953659020171543,83.342971039235323,84.732283058299132,86.12159507736294,87.510907096426735,88.900219115490515,90.289531134554323,91.678843153618132,93.068155172681912],[-24.859632289873716,-23.403367721156542,-21.947103152439411,-20.490838583722265,-19.034574015005106,-17.578309446287975,-16.122044877570801,-14.66578030885367,-13.209515740136538,-11.75325117141935,-10.296986602702219,-8.8407220339850596,-7.3844574652679285,-5.9281928965507973,-4.4719283278336093,-3.0156637591164781,-1.5593991903993185,-0.10313462168218734,1.3531299470349438,2.8093945157521318,4.265659084469263,5.7219236531864226,7.1781882219035538,8.6344527906206849,10.090717359337873,11.546981928055004,13.003246496772164,14.459511065489295,15.915775634206454,17.372040202923614,18.828304771640745,20.284569340357905,21.740833909075036,23.197098477792196,24.653363046509355,26.109627615226486,27.565892183943646,29.022156752660777,30.478421321377937,31.934685890095096,33.390950458812227,34.847215027529387,36.303479596246518,37.759744164963678,39.216008733680837,40.672273302397969,42.128537871115114,43.584802439832288,45.041067008549419,46.497331577266579,47.95359614598371,49.409860714700855,50.866125283418029,52.32238985213516,53.77865442085232,55.234918989569451,56.691183558286596,58.14744812700377,59.603712695720901,61.059977264438047,62.516241833155192,63.972506401872337,65.428770970589511,66.885035539306642,68.341300108023788,69.797564676740933,71.253829245458107,72.710093814175252,74.166358382892383,75.622622951609529,77.078887520326674,78.535152089043848,79.991416657760993,81.447681226478124,82.90394579519527,84.360210363912415,85.816474932629589,87.272739501346734,88.729004070063866,90.185268638781011,91.641533207498156,93.09779777621533,94.554062344932476],[-28.863834189197974,-27.340617070827449,-25.817399952456952,-24.294182834086484,-22.77096571571596,-21.247748597345463,-19.724531478974967,-18.201314360604471,-16.678097242233974,-15.15488012386345,-13.631663005492982,-12.108445887122457,-10.585228768751961,-9.0620116503814643,-7.5387945320109679,-6.0155774136404716,-4.4923602952699468,-2.9691431768994789,-1.4459260585289826,0.077291059841542165,1.6005081782120385,3.1237252965825348,4.6469424149530312,6.1701595333235275,7.6933766516940238,9.2165937700645202,10.739810888435045,12.263028006805541,13.786245125176009,15.309462243546534,16.83267936191703,18.355896480287555,19.879113598658023,21.402330717028519,22.925547835399044,24.448764953769512,25.971982072140037,27.495199190510533,29.018416308881029,30.541633427251526,32.064850545622022,33.588067663992547,35.111284782363043,36.634501900733511,38.157719019104036,39.680936137474532,41.204153255845029,42.727370374215525,44.250587492586021,45.773804610956546,47.297021729327014,48.820238847697539,50.343455966068035,51.866673084438503,53.389890202809028,54.913107321179524,56.436324439550049,57.959541557920517,59.482758676291013,61.005975794661509,62.529192913032034,64.05241003140253,65.575627149773027,67.098844268143523,68.622061386513991,70.145278504884516,71.668495623255041,73.191712741625537,74.714929859996005,76.238146978366501,77.761364096737026,79.284581215107551,80.807798333478019,82.331015451848515,83.854232570219025,85.377449688589508,86.900666806960018,88.423883925330529,89.947101043701025,91.470318162071507,92.993535280442018,94.516752398812528,96.03996951718301],[-32.868036088522246,-31.277866420498412,-29.687696752474551,-28.097527084450718,-26.507357416426828,-24.917187748402995,-23.327018080379162,-21.7368484123553,-20.146678744331467,-18.556509076307577,-16.966339408283744,-15.376169740259911,-13.78600007223605,-12.195830404212188,-10.605660736188327,-9.0154910681644935,-7.4253214001406604,-5.8351517321167705,-4.2449820640929374,-2.6548123960690759,-1.0646427280452428,0.52552693997861866,2.1156966080024802,3.7058662760263132,5.2960359440501747,6.8862056120740363,8.4763752800978693,10.066544948121731,11.656714616145564,13.246884284169425,14.837053952193287,16.42722362021712,18.017393288240982,19.607562956264815,21.197732624288705,22.787902292312538,24.378071960336371,25.968241628360232,27.558411296384094,29.148580964407955,30.738750632431788,32.328920300455621,33.919089968479511,35.509259636503344,37.099429304527206,38.689598972551039,40.279768640574872,41.869938308598762,43.460107976622595,45.050277644646457,46.64044731267029,48.230616980694151,49.820786648718013,51.410956316741846,53.001125984765707,54.591295652789569,56.181465320813402,57.771634988837263,59.361804656861096,60.951974324884986,62.542143992908819,64.132313660932653,65.722483328956514,67.312652996980376,68.902822665004237,70.49299233302807,72.083162001051903,73.673331669075765,75.263501337099626,76.853671005123488,78.443840673147321,80.034010341171154,81.624180009195044,83.214349677218877,84.804519345242738,86.394689013266571,87.984858681290433,89.575028349314294,91.165198017338128,92.755367685361989,94.345537353385851,95.935707021409684,97.525876689433545]],"text":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153"],"mode":"markers","type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>And here is that same plot as a contour plot.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a>air_surface <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">Temp =</span> axis_x, <span class="at">Month =</span> axis_y, <span class="at">KEEP.OUT.ATTRS=</span>F)</span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>air_surface<span class="sc">$</span>Z <span class="ot">&lt;-</span> <span class="fu">predict.lm</span>(air_lm, <span class="at">newdata =</span> air_surface)</span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>mycolorpalette <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;skyblue2&quot;</span>, <span class="st">&quot;orange&quot;</span>))</span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a><span class="fu">filled.contour</span>(<span class="at">x=</span>axis_x, <span class="at">y=</span>axis_y, <span class="at">z=</span><span class="fu">matrix</span>(air_surface<span class="sc">$</span>Z, <span class="fu">length</span>(axis_x), <span class="fu">length</span>(axis_y)), <span class="at">col=</span><span class="fu">mycolorpalette</span>(<span class="dv">27</span>))</span></code></pre></div>
</p>
</div>
<div id="LearnMoreHDModel" class="tabcontent" style="display:none;">
<p>
<table>
<tr>
<td>
<p><img src="index_files/figure-html/unnamed-chunk-120-1.png" width="144" /></p>
</td>
<td style="text-align: center;padding-left:15px;">
<p><span class="math display">\[
  Y_i = \overbrace{\underbrace{\beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i}
+ \ldots + \beta_{p-1}X_{p-1,i}}_{E\{Y_i\}}}^\text{&quot;High
Dimensional Models&quot;} + \epsilon_i
\]</span></p>
</td>
</tr>
</table>
<p>The so called “HD”, or “High Dimensional”, regression model uses
three or more different quantitative x-variables, an <span
class="math inline">\(X_{1i}\)</span>, an <span
class="math inline">\(X_{2i}\)</span>, and at least an <span
class="math inline">\(X_{3i}\)</span>, but could use many, many other
variables as well. Unlike the 3D model where the final regression could
be shown as either a contour plot or a 3D-graphic, the high dimensional
model exists in 4 or more dimensions. Thus, it is impossible to graph
this model in its full form. Further, it isn’t really even possible to
“mentally connect” with this type of model is it exists beyond what our
3D minds can really comprehend.</p>
<table>
<colgroup>
<col width="12%" />
<col width="87%" />
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\beta_0\)</span></td>
<td>Y-intercept of the Model</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_1\)</span></td>
<td>Slope of the line in the <span class="math inline">\(X_1\)</span>
direction.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\beta_2\)</span></td>
<td>Slope of the line in the <span class="math inline">\(X_2\)</span>
direction.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(...\)</span></td>
<td>Slopes in other directions depending on how many other variables are
included in the model.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\beta_{p-1}\)</span></td>
<td>Final term in the model where there are <span
class="math inline">\(p\)</span> total <span
class="math inline">\(\beta\)</span>’s. The reason for the <span
class="math inline">\(p-1\)</span> on the last term is because we
started with <span class="math inline">\(\beta_0\)</span> for the first
term, leaving <span class="math inline">\(\beta_{p-1}\)</span> as the
last term.</td>
</tr>
</tbody>
</table>
<p><strong>An Example</strong></p>
<p>Suppose we used three x-variables of <code>Wind</code>,
<code>Temp</code>, and <code>Solar.R</code> to predict the y-variable of
<code>Ozone</code>.</p>
<p><span class="math display">\[
  \underbrace{Y_i}_\text{Ozone} \underbrace{=}_{\sim}
\overbrace{\beta_0}^{\stackrel{\text{y-int}}{\text{baseline}}} +
\overbrace{\beta_1}^{\stackrel{\text{slope in}}{\text{Wind Direction}}}
\underbrace{X_{1i}}_\text{Wind} +
\overbrace{\beta_2}^{\stackrel{\text{slope in}}{\text{Temp
Direction}}}  \underbrace{X_{2i}}_\text{Temp} +
\overbrace{\beta_3}^{\stackrel{\text{slope in}}{\text{Solar.R
Direction}}}  \underbrace{X_{3i}}_\text{Solar.R} + \epsilon_i
\]</span></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a>air_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ozone <span class="sc">~</span> Wind <span class="sc">+</span> Temp <span class="sc">+</span> Solar.R, <span class="at">data=</span> airquality)</span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a><span class="fu">pander</span>(air_lm<span class="sc">$</span>coefficients)</span></code></pre></div>
<table style="width:57%;">
<colgroup>
<col width="19%" />
<col width="12%" />
<col width="11%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">(Intercept)</th>
<th align="center">Wind</th>
<th align="center">Temp</th>
<th align="center">Solar.R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">-64.34</td>
<td align="center">-3.334</td>
<td align="center">1.652</td>
<td align="center">0.05982</td>
</tr>
</tbody>
</table>
<p>Notice how the slope, <span class="math inline">\(\beta_1\)</span>,
in the “Wind” direction is estimated to be -3.334. The slope in the
“Temp” direction, <span class="math inline">\(\beta_2\)</span>, is
estimated to be 1.652. The slope in the “Solar.R” direction, <span
class="math inline">\(\beta_3\)</span>, is estimated to be 0.05982.
Also, the y-intercept, <span class="math inline">\(\beta_0\)</span>, is
estimated to be -64.34.</p>
<p>Visualizing this model is not really possible in its full form.
However, we can draw the regression from three different angles or
vantage points. This is a limited view of the full regression model, but
at least provides some visual understanding. To do this, we draw <span
class="math inline">\(Y\)</span> against each <span
class="math inline">\(X\)</span>-variable in separate scatterplots, one
for each <span class="math inline">\(X\)</span>-variable used in our
model.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(air_lm)</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>  <span class="fu">plot</span>(Ozone <span class="sc">~</span> Wind, <span class="at">data=</span>airquality)</span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>  <span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span><span class="dv">79</span> <span class="sc">+</span> b[<span class="dv">4</span>]<span class="sc">*</span><span class="dv">205</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a>  <span class="co"># The x-variable of this plot is &quot;Wind&quot;</span></span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a>  <span class="co"># The values of Temp=79 and Solar.R=205 are fixed at some interesting value,</span></span>
<span id="cb98-9"><a href="#cb98-9" tabindex="-1"></a>  <span class="co"># in this case, their respective medians.</span></span>
<span id="cb98-10"><a href="#cb98-10" tabindex="-1"></a></span>
<span id="cb98-11"><a href="#cb98-11" tabindex="-1"></a>  <span class="fu">plot</span>(Ozone <span class="sc">~</span> Temp, <span class="at">data=</span>airquality)</span>
<span id="cb98-12"><a href="#cb98-12" tabindex="-1"></a>  <span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span><span class="fl">9.7</span> <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span>x <span class="sc">+</span> b[<span class="dv">4</span>]<span class="sc">*</span><span class="dv">205</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>)</span>
<span id="cb98-13"><a href="#cb98-13" tabindex="-1"></a>  <span class="co"># The x-variable of this plot is &quot;Temp&quot;</span></span>
<span id="cb98-14"><a href="#cb98-14" tabindex="-1"></a>  <span class="co"># The values of Wind=9.7 and Solar.R=205 are fixed at some interesting value,</span></span>
<span id="cb98-15"><a href="#cb98-15" tabindex="-1"></a>  <span class="co"># in this case, their respective medians.</span></span>
<span id="cb98-16"><a href="#cb98-16" tabindex="-1"></a>  </span>
<span id="cb98-17"><a href="#cb98-17" tabindex="-1"></a>  <span class="fu">plot</span>(Ozone <span class="sc">~</span> Solar.R, <span class="at">data=</span>airquality)</span>
<span id="cb98-18"><a href="#cb98-18" tabindex="-1"></a>  <span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span><span class="fl">9.7</span> <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span><span class="dv">79</span> <span class="sc">+</span> b[<span class="dv">4</span>]<span class="sc">*</span>x, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-122-1.png" width="672" /></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a>  <span class="co"># The x-variable of this plot is &quot;Solar.R&quot;</span></span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>  <span class="co"># The values of Wind = 9.7 and Temp=79 are fixed at some interesting value,</span></span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>  <span class="co"># in this case, their respective medians.</span></span></code></pre></div>
</p>
</div>
<hr />
<p>The coefficient <span class="math inline">\(\beta_j\)</span> is
interpreted as the change in the expected value of <span
class="math inline">\(Y\)</span> for a unit increase in <span
class="math inline">\(X_{j}\)</span>, holding all other variables
constant, for <span class="math inline">\(j=1,\ldots,p-1\)</span>.
However, this interpretation breaks down when higher order terms (like
<span class="math inline">\(X^2\)</span>) or interaction terms (like
<span class="math inline">\(X1:X2\)</span>) are included in the
model.</p>
<p>See the <strong>Explanation</strong> tab for details about possible
hypotheses here.</p>
<hr />
</div>
</div>
<div id="r-instructions-10" class="section level6">
<h6>R Instructions</h6>
<div style="padding-left:125px;">
<p><strong>NOTE</strong>: These are general R Commands for <em>all</em>
types of multiple linear regressions. See the “Overview” section for R
Commands details about a specific multiple linear regression model.</p>
<p><strong>Console</strong> Help Command: <code>?lm()</code></p>
<p><strong>Finding Variables</strong></p>
<a href="javascript:showhide('PairsPlot')">
<div class="hoverchunk">
<p><span class="tooltipr"> pairs( <span class="tooltiprtext">A function
in R that creates all possible two-variable scatterplots from a data
set. It requires that all columns of the data set be either numeric or
factor classes. (Character classes will throw an error.)</span>
</span><span class="tooltipr"> cbind( <span class="tooltiprtext">This is
the “column (c) bind” function and it joins together things as
columns.</span> </span><span class="tooltipr"> Res =  <span
class="tooltiprtext">This is just any name you come up with, but Res is
a good abbreviation for Residuals.</span> </span><span class="tooltipr">
mylm$residuals,  <span class="tooltiprtext">This pulls out the residuals
from the current regression and adds them as a new column inside the
cbind data set.</span> </span><span class="tooltipr"> YourDataSet),
<span class="tooltiprtext">This puts the original data set along side
the residuals.</span> </span><span class="tooltipr">
 panel=panel.smooth,  <span class="tooltiprtext">This places a lowess
smoothing line on each scatterplot.</span> </span><span
class="tooltipr"> col =  <span class="tooltiprtext">specifies the colors
of the dots.</span> </span><span class="tooltipr">
as.factor(YourDataSet$Xvar) <span class="tooltiprtext">This causes the
coloring of the points in the plot to be colored according to the groups
found in Xvar. Using palette(c(“color1”,“color2”, and so on)) prior to
the plotting code allows you to specify the colors pairs will pick from
when choosing colors.</span> </span><span class="tooltipr"> ) <span
class="tooltiprtext">Closing parenthesis for the pairs function.</span>
</span></p>
</div>
<p></a></p>
<div id="PairsPlot" style="display:none;">
<p><img src="index_files/figure-html/unnamed-chunk-123-1.png" width="672" /></p>
</div>
<p><strong>Perform the Regression</strong></p>
<p>Everything is the same as in simple linear regression except that
more variables are allowed in the call to <code>lm()</code>.</p>
<a href="javascript:showhide('multiplelm')">
<div class="hoverchunk">
<p><span class="tooltipr"> mylm &lt;- lm( <span
class="tooltiprtext"><code>mylm</code> is some name you come up with to
store the results of the <code>lm()</code> test. Note that
<code>lm()</code> stands for “linear model.”</span> </span><span
class="tooltipr"> Y <span class="tooltiprtext"><code>Y</code> must be a
“numeric” vector of the quantitative response variable.</span>
</span><span class="tooltipr">  ~  <span class="tooltiprtext">Formula
operator in R.</span> </span><span class="tooltipr"> X1 + X2 <span
class="tooltiprtext"><code>X1</code> and <code>X2</code> are the
explanatory variables. These can either be quantitative or qualitative.
Note that R treats “numeric” variables as quantitative and “character”
or “factor” variables as qualitative. R will automatcially recode
qualitative variables to become “numeric” variables using a 0,1
encoding. See the Explanation tab for details.</span> </span><span
class="tooltipr">  + X1:X2 <span class="tooltiprtext"><code>X1:X2</code>
is called the interaction term. See the Explanation tab for
details.</span> </span><span class="tooltipr">  + …, <span
class="tooltiprtext">* <code>...</code> emphasizes that as many
explanatory variables as are desired can be included in the
model.</span> </span><span class="tooltipr">  data = YourDataSet) <span
class="tooltiprtext"><code>YourDataSet</code> is the name of your data
set.</span> </span><br/><span class="tooltipr"> summary( <span
class="tooltiprtext">The summary(…) function displays the results of an
lm(…) in R.</span> </span><span class="tooltipr"> mylm <span
class="tooltiprtext">The name of your lm that was performed
earlier.</span> </span><span class="tooltipr"> ) <span
class="tooltiprtext">Closing parenthesis for summary(…) function.</span>
</span></p>
</div>
<p></a></p>
<div id="multiplelm" style="display:none;">
<p>Example output from a regression. Hover each piece to learn more.</p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Call:<br/> lm(formula = mpg ~ hp + am +
hp:am, data = mtcars) <span class="tooltiprouttext">This is simply a
statement of your original lm(…) “call” that you made when performing
your regression. It allows you to verify that you ran what you thought
you ran in the lm(…).</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td colspan="2">
<span class="tooltiprout"> Residuals: <span
class="tooltiprouttext">Residuals are the vertical difference between
each point and the line, <span class="math inline">\(Y_i -
\hat{Y}_i\)</span>. The residuals are supposed to be normally
distributed, so a quick glance at their five-number summary can give us
insight about any skew present in the residuals. </span>
</td>
</tr>
<tr>
<td align="right">
<span class="tooltiprout"> min<br/>   -4.3818 <span
class="tooltiprouttext">“min” gives the value of the residual that is
furthest below the regression line. Ideally, the magnitude of this value
would be about equal to the magnitude of the largest positive residual
(the max) because the hope is that the residuals are normally
distributed around the line.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 1Q<br/>   -2.2696 <span
class="tooltiprouttext">“1Q” gives the first quartile of the residuals,
which will always be negative, and ideally would be about equal in
magnitude to the third quartile.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> Median<br/>   0.1344 <span
class="tooltiprouttext">“Median” gives the median of the residuals,
which would ideally would be about equal to zero. Note that because the
regression line is the least squares line, the mean of the residuals
will ALWAYS be zero, so it is never included in the output summary. This
particular median value of -0.0191 is a little smaller than zero than we
would hope for and suggests a right skew in the data because the mean
(0) is greater than the median (-0.0191) witnessing the residuals are
right skewed. This can also be seen in the maximum being much larger in
magnitude than the minimum.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 3Q<br/>   1.7058 <span
class="tooltiprouttext">“3Q” gives the third quartile of the residuals,
which would ideally would be about equal in magnitude to the first
quartile. In this case, it is pretty close, which helps us see that the
first quartile of residuals on either side of the line is behaving
fairly normally.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> Max</br>   5.8752 <span
class="tooltiprouttext">“Max” gives the maximum positive residuals,
which would ideally would be about equal in magnitude to the minimum
residual. In this case, it is much larger than the minimum, which helps
us see that the residuals are likely right skewed.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td colspan="2">
<span class="tooltiprout"> Coefficients: <span
class="tooltiprouttext">Notice that in your lm(…) you used only <span
class="math inline">\(Y\)</span> and <span
class="math inline">\(X\)</span>. You did type out any coefficients,
i.e., the <span class="math inline">\(\beta_0\)</span> or <span
class="math inline">\(\beta_1\)</span> of the regression model. These
coefficients are estimated by the lm(…) function and displayed in this
part of the output along with standard errors, t-values, and
p-values.</span> </span>
</td>
</tr>
<tr>
<td align="left">
</td>
<td align="right">
<span class="tooltiprout">   Estimate <span class="tooltiprouttext">To
learn more about the “Estimates” of the “Coefficients” see the
“Explanation” tab, “Estimating the Model Parameters” section for
details.</span>
</td>
<td align="right">
<span class="tooltiprout">   Std. Error <span class="tooltiprouttext">To
learn more about the “Standard Errors” of the “Coefficients” see the
“Explanation” tab, “Inference for the Model Parameters” section.</span>
</span>
</td>
<td align="right">
<span class="tooltiprout">   t value <span class="tooltiprouttext">To
learn more about the “t value” of the “Coefficients” see the
“Explanation” tab, “Inference for the Model Parameters” section.</span>
</span>
</td>
<td align="right">
<span class="tooltiprout">   Pr(&gt;|t|) <span
class="tooltiprouttext">The “Pr” stands for “Probability” and the “(&gt;
|t|)” stands for “more extreme than the observed t-value”. Thus, this is
the p-value for the hypothesis test of each coefficient being zero.<br/>
To learn more about the “p-value” of the “Coefficients” see the
“Explanation” tab, “Inference for the Model Parameters” section. </span>
</span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> (Intercept) <span
class="tooltiprouttext">This always says “Intercept” for any lm(…) you
run in R. That is because R always assumes there is a y-intercept for
your regression function.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   26.6248479 <span
class="tooltiprouttext">This is the estimate of the y-intercept, <span
class="math inline">\(\beta_0\)</span>. It is called <span
class="math inline">\(b_0\)</span>. It is the average y-value when all
X-variables are zero.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   2.1829432 <span
class="tooltiprouttext">This is the standard error of <span
class="math inline">\(b_0\)</span>. It estimates how much <span
class="math inline">\(b_0\)</span> varies from sample to sample. The
closer to zero, the more reliable the estimate of the intercept.</span>
</span>
</td>
<td align="right">
<span class="tooltiprout"> 12.197 <span class="tooltiprouttext">This is
the test statistic t for the test of <span class="math inline">\(\beta_0
= 0\)</span>. It is calculated by dividing the “Estimate” of the
intercept (26.6248479) by its standard error (2.1829432). It gives the
“number of standard errors” away from zero that the “estimate” has
landed. In this case, the estimate of 26.6248479 is t=12.197 standard
errors away from zero, which is a fairly surprising distance as shown by
the p-value.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 1.01e-12 <span class="tooltiprouttext">This
is the p-value of the test of the hypothesis that <span
class="math inline">\(\beta_0 = 0\)</span>. It measures the probability
of observing a t-value as extreme as the one observed. To compute it
yourself in R, use
<code>pt(-abs(your t-value), df of your regression)*2</code>.</span>
</span>
</td>
<td align="left">
<span class="tooltiprout"> *** <span class="tooltiprouttext">This is
called a “star”. Three stars means significant at the 0 level of <span
class="math inline">\(\alpha\)</span>.</span> </span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> hp <span class="tooltiprouttext">This is
always the name of your first X-variable in your lm(Y ~ X1 + …).</span>
</span>
</td>
<td align="right">
<span class="tooltiprout">   -0.0591370 <span
class="tooltiprouttext">This is the estimate of <span
class="math inline">\(\beta_1\)</span> in the regression model. It is
called <span class="math inline">\(b_1\)</span>. Interpreting this value
depends on your choice of regression model.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   0.0129449 <span
class="tooltiprouttext">This is the standard error of <span
class="math inline">\(b_1\)</span>. It estimates how much <span
class="math inline">\(b_1\)</span> varies from sample to sample. The
closer to zero, the more precise the estimate.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> -4.568 <span class="tooltiprouttext">This is
the test statistic t for the test of <span class="math inline">\(\beta_1
= 0\)</span>. It is calculated by dividing the “Estimate” by its
standard error. It gives the “number of standard errors” away from zero
that the “estimate” has landed.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 9.02e-05 <span class="tooltiprouttext">This
is the p-value of the test of the hypothesis that <span
class="math inline">\(\beta_1 = 0\)</span>. To compute it yourself in R,
use <code>pt(-abs(your t-value), df of your regression)*2</code></span>
</span>
</td>
<td align="left">
<span class="tooltiprout"> *** <span class="tooltiprouttext">This is
called a “star”. Three stars means significant at the 0.01 level of
<span class="math inline">\(\alpha\)</span>.</span> </span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> am <span class="tooltiprouttext">This is the
second X-variable of your regression model in lm(Y ~ X1 + X2 +
…).</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   5.2176534 <span
class="tooltiprouttext">This is the estimated value for <span
class="math inline">\(\beta_2\)</span> and is called <span
class="math inline">\(b_2\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   2.6650931 <span
class="tooltiprouttext">This is the standard error of <span
class="math inline">\(b_2\)</span>. It estimates how much <span
class="math inline">\(b_2\)</span> will vary from sample to
sample.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 1.958 <span class="tooltiprouttext">Test
statistic (t) for the test of <span class="math inline">\(\beta_2 =
0\)</span>. It represents the number of standard errors that <span
class="math inline">\(b_2\)</span> is from 0.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 0.0603 <span class="tooltiprouttext">The
p-value for the test of <span class="math inline">\(\beta_2 =
0\)</span>.</span> </span>
</td>
<td align="left">
<span class="tooltiprout"> . <span class="tooltiprouttext">The dot “.”
implies the result is significant at the 0.1 level.</span> </span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> hp:am <span class="tooltiprouttext">This is
the interaction of <span class="math inline">\(X1\)</span> and <span
class="math inline">\(X2\)</span>. Not all regression models require an
interaction term, and they can include more than one interaction term.
This is just an example of what an interaction term would look
like.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   0.0004029 <span
class="tooltiprouttext">This is the estimate of the coefficient of the
interaction term.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   0.0164602 <span
class="tooltiprouttext">Estimated standard error of the interaction
term.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 0.024 <span class="tooltiprouttext">Test
statistic for the test that <span class="math inline">\(\beta_3 =
0\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 0.9806 <span class="tooltiprouttext">P-value
for the test that <span class="math inline">\(\beta_3 =
0\)</span>.</span> </span>
</td>
</tr>
</table>
<table class="rconsole">
<tr>
<td>
<span> --- </span>
</td>
</tr>
</table>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ’*’
0.05 ‘.’ 0.1 ‘ ’ 1 <span class="tooltiprouttext">These “codes” explain
what significance level the p-value is smaller than based on how many
“stars” * the p-value is labeled with in the Coefficients table
above.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Residual standard error: <span
class="tooltiprouttext">This is the estimate of <span
class="math inline">\(\sigma\)</span> in the regression model <span
class="math inline">\(Y_i = \beta_0 + \beta_1 X_i + \epsilon_i\)</span>
where <span class="math inline">\(\epsilon_i \sim
N(0,\sigma^2)\)</span>. It is the square root of the MSE.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  2.939 <span class="tooltiprouttext">For this
particular regression, the estimate of <span
class="math inline">\(\sigma\)</span> is 2.939. Squaring this number
gives you the MSE, which is the estimate of <span
class="math inline">\(\sigma^2\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  on 28 degrees of freedom <span
class="tooltiprouttext">This is <span class="math inline">\(n-p\)</span>
where <span class="math inline">\(n\)</span> is the sample size and
<span class="math inline">\(p\)</span> is the number of parameters in
the regression model. In this case, there is a sample size of 32 and two
parameters, <span class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span>, so 32-4 = 28.</span> </span>
</td>
</tr>
</table>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Multiple R-squared: <span
class="tooltiprouttext">This is <span
class="math inline">\(R^2\)</span>, the percentage of variation in <span
class="math inline">\(Y\)</span> that is explained by the regression
model. It is equal to the SSR/SSTO or, equivalently, 1 -
SSE/SSTO.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  0.7852, <span class="tooltiprouttext">In
this particular regression, 78.52% of the variation in stopping distance
<code>dist</code> is explained by the regression model using speed of
the car.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  Adjusted R-squared: <span
class="tooltiprouttext">The adjusted R-squared will always be at least
slightly smaller than <span class="math inline">\(R^2\)</span>. The
closer to R-squared that it is, the better. When it differs dramatically
from <span class="math inline">\(R^2\)</span>, it is a sign that the
regression model is over-fitting the data.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  0.7621 <span class="tooltiprouttext">In this
case, the value of 0.7621 is quite close to the original <span
class="math inline">\(R^2\)</span> value, so there is no fear of
over-fitting with this particular model. That is good.</span> </span>
</td>
</tr>
</table>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> F-statistic: <span
class="tooltiprouttext">The F-statistic is the test statistic for the
test of <span class="math inline">\(\beta_1 = \beta_2 = \beta_3 = \ldots
= 0\)</span>. In other words, it tests that ALL coefficients are zero
against the alternative that “at least one is not.”</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  34.11 <span class="tooltiprouttext">This is
the value of the F-statistic that should be compared to an
F-distribution with 3 and 28 degrees of freedom.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  on 3 and 28 DF, <span
class="tooltiprouttext">These two numbers give the two parameters
(degrees of freedom 1 and degrees of freedom 2) of the F-distribution.
Knowing these parameters and the value of the F-statistic allows the
computation of the p-value for the test that all regression coefficients
are zero.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  p-value: 1.73e-09 <span
class="tooltiprouttext">The p-value of the test that all regression
coefficients are zero. If this p-value is significant, then it can be
determined that “at least one” of the variables included in the
regression gives significant insight about the average y-value.</span>
</span>
</td>
</tr>
</table>
</div>
<p><br/></p>
<p><strong>Plotting the Regression Lines</strong></p>
<p>See each of the “Overview” sections for details on how to plot the
various types of multiple linear regression models.</p>
<p><br/></p>
<p><strong>Making Predictions</strong></p>
<a href="javascript:showhide('predict2')">
<div class="hoverchunk">
<p><span class="tooltipr"> predict( <span class="tooltiprtext">The R
function predict(…) allows you to use an lm(…) object to make
predictions for specified x-values.</span> </span><span
class="tooltipr"> mylm, <span class="tooltiprtext">This is the name of a
previously performed lm(…) that was saved into the name
<code>mylm &lt;- lm(...)</code>.</span> </span><span class="tooltipr">
newdata = data.frame( <span class="tooltiprtext">To specify the values
of <span class="math inline">\(x\)</span> that you want to use in the
prediction, you have to put those x-values into a data set, or more
specifally, a data.frame(…).</span> </span><span class="tooltipr"> <span
class="math inline">\(X_1\)</span>= <span class="tooltiprtext">The value
for <code>X=</code> should be whatever x-variable name was used in the
original regression. For example, if
<code>mylm &lt;- lm(mpg ~ hp + am + hp:am, data=mtcars)</code> was the
original regression, then this code would read <code>hp =</code> instead
of <code>X1 =</code>… Further, the value of <span
class="math inline">\(X_{1h}\)</span> should be some specific number,
like <code>hp=123</code> for example.</span> </span><span
class="tooltipr"> <span class="math inline">\(X_{1h}\)</span>, <span
class="tooltiprtext">The value of <span
class="math inline">\(X_{1h}\)</span> should be some specific number,
like <code>123</code>, as in <code>hp=123</code> for example.</span>
</span><span class="tooltipr"> <span class="math inline">\(X_2\)</span>=
<span class="tooltiprtext">This is the value of the second x-variable,
say <code>am</code>.</span> </span><span class="tooltipr"> <span
class="math inline">\(X_{2h}\)</span>) <span class="tooltiprtext">Since
the <code>am</code> column can only be a 1 or 0, we would try
<code>am=1</code> for example, or <code>am=0</code>.</span> </span><span
class="tooltipr"> ) <span class="tooltiprtext">Closing
parenthesis.</span> </span></p>
</div>
<p></a></p>
<div id="predict2" style="display:none;">
<p><code>mylm &lt;- lm(mpg ~ hp + am + hp:am, data = mtcars)</code></p>
<p><code>predict(mylm, data.frame(hp = 120, am = 1), data = mtcars, type = "response")</code></p>
<pre><code>##        1 
## 24.79441</code></pre>
<p>The value given is the “fitted-value” or “predicted-value” for the
specified x-value. In this case, a car with a speed of 12 is predicted
to have a stopping distance of 29.60981 feet.</p>
</div>
<a href="javascript:showhide('predict2Interval')">
<div class="hoverchunk">
<p><span class="tooltipr"> predict( <span class="tooltiprtext">The R
function predict(…) allows you to use an lm(…) object to make
predictions for specified x-values.</span> </span><span
class="tooltipr"> mylm, <span class="tooltiprtext">This is the name of a
previously performed lm(…) that was saved into the name
<code>mylm &lt;- lm(...)</code>.</span> </span><span class="tooltipr">
 newdata=data.frame( <span class="tooltiprtext">To specify the values of
<span class="math inline">\(x\)</span> that you want to use in the
prediction, you have to put those x-values into a data set, or more
specifally, a data.frame(…).</span> </span><span class="tooltipr"> X1=
<span class="tooltiprtext">The <code>X1=</code> should be replaced with
whatever x-variable name was used in the original regression. For
example, if <code>mylm &lt;- lm(dist ~ speed, data=cars)</code> was the
original regression, then this code would read <code>speed =</code>
instead of <code>X1=</code>… Further, the value of <span
class="math inline">\(X_{1h}\)</span> should be some specific number,
like <code>12</code> so that it reads <code>speed=12</code>, for
example.</span> </span><span class="tooltipr"> <span
class="math inline">\(X_{1h}\)</span>, <span class="tooltiprtext">The
value of <span class="math inline">\(X_{1h}\)</span> should be some
specific number, like <code>12</code>, as in <code>speed=12</code> for
example.</span> </span><span class="tooltipr"> X2= <span
class="tooltiprtext">If a regression of lm(Y ~ X1 + X2 + …) was
performed, then X2 is the name of the second x-variable used in the
regression.</span> </span><span class="tooltipr"> <span
class="math inline">\(X_{2h}\)</span>), <span class="tooltiprtext">A
number should be specified for <span
class="math inline">\(X_{2h}\)</span>, something that would be
meaningful for X2 to be equal to.</span> </span><span class="tooltipr">
interval = “prediction”) <span class="tooltiprtext">This causes the
prediction to include the lower bound and upper bound of the prediction
interval for <span class="math inline">\(Y_i\)</span> for the given X1,
X2, and so on values that have been specified.</span> </span></p>
</div>
<p></a></p>
<div id="predict2Interval" style="display:none;">
<p><code>mylm &lt;- lm(mpg ~ hp + am + hp:am, data = mtcars)</code></p>
<p><code>predict(mylm, data.frame(hp = 120, am = 1), data = mtcars, interval = "prediction")</code></p>
<div class="sourceCode" id="cb101"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> am <span class="sc">+</span> hp<span class="sc">:</span>am, <span class="at">data =</span> mtcars)</span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a><span class="fu">predict</span>(mylm, <span class="fu">data.frame</span>(<span class="at">hp =</span> <span class="dv">120</span>, <span class="at">am =</span> <span class="dv">1</span>), <span class="at">data =</span> mtcars, <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
<pre><code>##        fit      lwr      upr
## 1 24.79441 18.49923 31.08959</code></pre>
<p>The “fit” is the predicted value. The “lwr” is the lower bound. The
“upr” is the upper bound.</p>
<p>In this case, a car with a speed of 12 mph is predicted to have a
stopping distance of 29.60981 feet. However, we are wise enough to
recognize that the stopping distance for individual cars will vary
anywhere from -1.749529 (or 0 because distance can’t go negative) feet
to 60.96915 feet.</p>
</div>
<a href="javascript:showhide('predict2Confidence')">
<div class="hoverchunk">
<p><span class="tooltipr"> predict( <span class="tooltiprtext">The R
function predict(…) allows you to use an lm(…) object to make
predictions for specified x-values.</span> </span><span
class="tooltipr"> mylm, <span class="tooltiprtext">This is the name of a
previously performed lm(…) that was saved into the name
<code>mylm &lt;- lm(...)</code>.</span> </span><span class="tooltipr">
data.frame( <span class="tooltiprtext">To specify the values of <span
class="math inline">\(x\)</span> that you want to use in the prediction,
you have to put those x-values into a data set, or more specifally, a
data.frame(…).</span> </span><span class="tooltipr"> X1= <span
class="tooltiprtext">The <code>X1=</code> should be replaced with
whatever x-variable name was used in the original regression. For
example, if <code>mylm &lt;- lm(dist ~ speed, data=cars)</code> was the
original regression, then this code would read <code>speed =</code>
instead of <code>X1=</code>… Further, the value of <span
class="math inline">\(X_{1h}\)</span> should be some specific number,
like <code>12</code> so that it reads <code>speed=12</code>, for
example.</span> </span><span class="tooltipr"> <span
class="math inline">\(X_{1h}\)</span>, <span class="tooltiprtext">The
value of <span class="math inline">\(X_{1h}\)</span> should be some
specific number, like <code>12</code>, as in <code>speed=12</code> for
example.</span> </span><span class="tooltipr"> X2= <span
class="tooltiprtext">If a regression of lm(Y ~ X1 + X2 + …) was
performed, then X2 is the name of the second x-variable used in the
regression.</span> </span><span class="tooltipr"> <span
class="math inline">\(X_{2h}\)</span>), <span class="tooltiprtext">A
number should be specified for <span
class="math inline">\(X_{2h}\)</span>, something that would be
meaningful for X2 to be equal to.</span> </span><span class="tooltipr">
interval = “confidence”) <span class="tooltiprtext">This causes the
prediction to include the lower and upper bound of a confidence interval
for <span class="math inline">\(E{Y_i}\)</span> for the given <span
class="math inline">\(X\)</span>-values.</span> </span></p>
</div>
<p></a></p>
<div id="predict2Confidence" style="display:none;">
<p><code>mylm &lt;- lm(mpg ~ hp + am + hp:am, data = mtcars)</code></p>
<p><code>predict(mylm, data.frame(hp = 120, am = 1), data = mtcars, interval = "confidence")</code></p>
<div class="sourceCode" id="cb103"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> am <span class="sc">+</span> hp<span class="sc">:</span>am, <span class="at">data =</span> mtcars)</span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a><span class="fu">predict</span>(mylm, <span class="fu">data.frame</span>(<span class="at">hp =</span> <span class="dv">120</span>, <span class="at">am =</span> <span class="dv">1</span>), <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>)</span></code></pre></div>
<pre><code>##        fit      lwr      upr
## 1 24.79441 23.10635 26.48247</code></pre>
<p>The “fit” is the predicted value. The “lwr” is the lower bound. The
“upr” is the upper bound.</p>
<p>In this case, cars with a speed of 12 mph are predicted to have an
average stopping distance of 29.60981 feet, where the average could be
anywhere from 24.39514 feet to 34.82448 feet.</p>
</div>
<hr />
</div>
</div>
<div id="explanation-9" class="section level6">
<h6>Explanation</h6>
<div style="padding-left:125px;">
<p><strong><em>Assessing the Model Fit
<a href="javascript:showhide('assessingFit2')" style="font-size:.6em;color:skyblue;">(Expand)</a></em></strong></p>
<p><span class="expand-caption"><span
class="math inline">\(R^2\)</span>, adjusted <span
class="math inline">\(R^2\)</span>, AIC, BIC…</span></p>
<div id="assessingFit2" style="display:none;">
<p>There are many measures of the quality of a regression model. One of
the most popular measurements is the <span
class="math inline">\(R^2\)</span> value (“R-squared”). The <span
class="math inline">\(R^2\)</span> value is a measure of the proportion
of variation of the <span class="math inline">\(Y\)</span>-variable that
is explained by the model. Specifically, <span class="math display">\[
  R^2 = \frac{\text{SSR}}{\text{SSTO}} =
1-\frac{\text{SSE}}{\text{SSTO}}
\]</span> The range of <span class="math inline">\(R^2\)</span> is
between 0 and 1. Values close to 1 imply a very good model. Values close
to 0 imply a very poor model.</p>
<p>One difficulty of <span class="math inline">\(R^2\)</span> in
multiple regression is that it will always get larger when more
variables are included in the regression model. Thus, in multiple linear
regression, it is best to make an adjustment to the <span
class="math inline">\(R^2\)</span> value to protect against this
difficulty. The value of the adjusted <span
class="math inline">\(R^2\)</span> is given by <span
class="math display">\[
  R^2_{adj} = 1 - \frac{(n-1)}{(n-p)}\frac{\text{SSE}}{\text{SSTO}}
\]</span> The interpretation of <span
class="math inline">\(R^2_{adj}\)</span> is essentially the same as the
interpretation of <span class="math inline">\(R^2\)</span>, with the
understanding that a correction has been made for the number of
parameters included in the model, <span
class="math inline">\((n-p)\)</span>.</p>
<p>Consider the models below. The value of <span
class="math inline">\(R^2\)</span> always gets higher as the model adds
more parameters. However, the value of <span
class="math inline">\(R^2_{adj}\)</span> sometimes goes down,
emphasizing the idea that the model is becoming more complex than needed
to capture the pattern in Y.</p>
<div class="sourceCode" id="cb105"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>), <span class="at">mai=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">1</span>,.<span class="dv">4</span>,.<span class="dv">1</span>))</span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a><span class="fu">plot</span>(dist <span class="sc">~</span> speed, <span class="at">data=</span>cars, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">27</span>), <span class="at">main=</span><span class="st">&quot;Simple Linear&quot;</span>)</span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed, <span class="at">data=</span>cars)</span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm1)</span>
<span id="cb105-5"><a href="#cb105-5" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb105-6"><a href="#cb105-6" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>,<span class="dv">110</span>,<span class="fu">bquote</span>(R<span class="sc">^</span><span class="dv">2</span> <span class="sc">==</span>  .(<span class="fu">round</span>(<span class="fu">summary</span>(lm1)<span class="sc">$</span>r.squared,<span class="dv">3</span>))),<span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb105-7"><a href="#cb105-7" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="fu">bquote</span>(R[adj]<span class="sc">^</span><span class="dv">2</span> <span class="sc">==</span> .(<span class="fu">round</span>(<span class="fu">summary</span>(lm1)<span class="sc">$</span>adj.r.squared,<span class="dv">3</span>))),<span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb105-8"><a href="#cb105-8" tabindex="-1"></a></span>
<span id="cb105-9"><a href="#cb105-9" tabindex="-1"></a></span>
<span id="cb105-10"><a href="#cb105-10" tabindex="-1"></a><span class="fu">plot</span>(dist <span class="sc">~</span> speed, <span class="at">data=</span>cars, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">27</span>), <span class="at">main=</span><span class="st">&quot;Quadratic&quot;</span>)</span>
<span id="cb105-11"><a href="#cb105-11" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed <span class="sc">+</span> <span class="fu">I</span>(speed<span class="sc">^</span><span class="dv">2</span>), <span class="at">data=</span>cars)</span>
<span id="cb105-12"><a href="#cb105-12" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm1)</span>
<span id="cb105-13"><a href="#cb105-13" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb105-14"><a href="#cb105-14" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>,<span class="dv">110</span>,<span class="fu">bquote</span>(R<span class="sc">^</span><span class="dv">2</span> <span class="sc">==</span>  .(<span class="fu">round</span>(<span class="fu">summary</span>(lm1)<span class="sc">$</span>r.squared,<span class="dv">3</span>))),<span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb105-15"><a href="#cb105-15" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="fu">bquote</span>(R[adj]<span class="sc">^</span><span class="dv">2</span> <span class="sc">==</span> .(<span class="fu">round</span>(<span class="fu">summary</span>(lm1)<span class="sc">$</span>adj.r.squared,<span class="dv">3</span>))),<span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb105-16"><a href="#cb105-16" tabindex="-1"></a></span>
<span id="cb105-17"><a href="#cb105-17" tabindex="-1"></a></span>
<span id="cb105-18"><a href="#cb105-18" tabindex="-1"></a><span class="fu">plot</span>(dist <span class="sc">~</span> speed, <span class="at">data=</span>cars, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">27</span>), <span class="at">main=</span><span class="st">&quot;Cubic&quot;</span>)</span>
<span id="cb105-19"><a href="#cb105-19" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed <span class="sc">+</span> <span class="fu">I</span>(speed<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(speed<span class="sc">^</span><span class="dv">3</span>), <span class="at">data=</span>cars)</span>
<span id="cb105-20"><a href="#cb105-20" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm1)</span>
<span id="cb105-21"><a href="#cb105-21" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b[<span class="dv">4</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb105-22"><a href="#cb105-22" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>,<span class="dv">110</span>,<span class="fu">bquote</span>(R<span class="sc">^</span><span class="dv">2</span> <span class="sc">==</span>  .(<span class="fu">round</span>(<span class="fu">summary</span>(lm1)<span class="sc">$</span>r.squared,<span class="dv">3</span>))),<span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb105-23"><a href="#cb105-23" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="fu">bquote</span>(R[adj]<span class="sc">^</span><span class="dv">2</span> <span class="sc">==</span> .(<span class="fu">round</span>(<span class="fu">summary</span>(lm1)<span class="sc">$</span>adj.r.squared,<span class="dv">3</span>))),<span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb105-24"><a href="#cb105-24" tabindex="-1"></a></span>
<span id="cb105-25"><a href="#cb105-25" tabindex="-1"></a></span>
<span id="cb105-26"><a href="#cb105-26" tabindex="-1"></a><span class="fu">plot</span>(dist <span class="sc">~</span> speed, <span class="at">data=</span>cars, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">27</span>), <span class="at">main=</span><span class="st">&quot;Quartic&quot;</span>)</span>
<span id="cb105-27"><a href="#cb105-27" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed <span class="sc">+</span> <span class="fu">I</span>(speed<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(speed<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(speed<span class="sc">^</span><span class="dv">4</span>), <span class="at">data=</span>cars)</span>
<span id="cb105-28"><a href="#cb105-28" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm1)</span>
<span id="cb105-29"><a href="#cb105-29" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b[<span class="dv">4</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> b[<span class="dv">5</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">4</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb105-30"><a href="#cb105-30" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>,<span class="dv">110</span>,<span class="fu">bquote</span>(R<span class="sc">^</span><span class="dv">2</span> <span class="sc">==</span>  .(<span class="fu">round</span>(<span class="fu">summary</span>(lm1)<span class="sc">$</span>r.squared,<span class="dv">3</span>))),<span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb105-31"><a href="#cb105-31" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="fu">bquote</span>(R[adj]<span class="sc">^</span><span class="dv">2</span> <span class="sc">==</span> .(<span class="fu">round</span>(<span class="fu">summary</span>(lm1)<span class="sc">$</span>adj.r.squared,<span class="dv">3</span>))),<span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb105-32"><a href="#cb105-32" tabindex="-1"></a></span>
<span id="cb105-33"><a href="#cb105-33" tabindex="-1"></a></span>
<span id="cb105-34"><a href="#cb105-34" tabindex="-1"></a><span class="fu">plot</span>(dist <span class="sc">~</span> speed, <span class="at">data=</span>cars, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">27</span>), <span class="at">main=</span><span class="st">&quot;Quintic&quot;</span>)</span>
<span id="cb105-35"><a href="#cb105-35" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed <span class="sc">+</span> <span class="fu">I</span>(speed<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(speed<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(speed<span class="sc">^</span><span class="dv">4</span>) <span class="sc">+</span> <span class="fu">I</span>(speed<span class="sc">^</span><span class="dv">5</span>), <span class="at">data=</span>cars)</span>
<span id="cb105-36"><a href="#cb105-36" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm1)</span>
<span id="cb105-37"><a href="#cb105-37" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b[<span class="dv">4</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> b[<span class="dv">5</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">4</span> <span class="sc">+</span> b[<span class="dv">6</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">5</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb105-38"><a href="#cb105-38" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>,<span class="dv">110</span>,<span class="fu">bquote</span>(R<span class="sc">^</span><span class="dv">2</span> <span class="sc">==</span>  .(<span class="fu">round</span>(<span class="fu">summary</span>(lm1)<span class="sc">$</span>r.squared,<span class="dv">3</span>))),<span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb105-39"><a href="#cb105-39" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="fu">bquote</span>(R[adj]<span class="sc">^</span><span class="dv">2</span> <span class="sc">==</span> .(<span class="fu">round</span>(<span class="fu">summary</span>(lm1)<span class="sc">$</span>adj.r.squared,<span class="dv">3</span>))),<span class="at">pos=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-127-1.png" width="672" /></p>
<p><br/></p>
<p>The “simplest” but “best” model of those shown above would be the
Quadratic. This is because it has the best <span
class="math inline">\(R^2_{adj}\)</span> (0.653) other than the far more
complicated Quartic model (0.655). But the <span
class="math inline">\(R^2_{adj}\)</span> for the Quadratic model is a
good improvement over that of the <span
class="math inline">\(R^2_{adj}\)</span> for the Simple Linear model,
with a value of 0.653 compared to 0.644, respectively. So moving to the
complexity of the Quadratic model is justified over the Simple Linear
Model. But there is not enough of an improvement in the <span
class="math inline">\(R^2_{adj}\)</span> to warrant moving to the
complexity of the Quartic Model. Further, the pattern in the Quadratic
seems to generalize better to data outside the range of the current data
than does the Quartic model.</p>
<p><span class="math display">\[
  \text{\emph{Quadratic Model}:}\quad Y_i = \beta_0 + \beta_1 X_i +
\beta_2 X_i^2 + \epsilon_i
\]</span></p>
<p><span class="math display">\[
  \text{\emph{Quartic Model}:}\quad Y_i = \beta_0 + \beta_1 X_i +
\beta_2 X_i^2 + \underbrace{\beta_3 X_i^3 + \beta_4 X_i^4}_\text{Cubic
and Quartic Terms} + \epsilon_i
\]</span></p>
<p><strong>AIC and BIC</strong></p>
<p>Two other measurements, or information criterion, are popular for use
in the model selection process. These are the Akaike Information
Criterion (AIC) and the Bayesian Information Criterion (BIC). These are
easily computed in R using <code>AIC(yourlm)</code> and
<code>BIC(yourlm)</code>.</p>
<p>The formula for each are given in different, but equivalent ways
depending on which source you obtain the equation. Perhaps the easiest
formulation to understand is that given by Kutner, Nachtsheim, and Neter
in their book <em>Applied Linear Regression Models</em> (4th edition,
page 360)</p>
<p><span class="math display">\[
\text{AIC:} \quad n \ln(SSE) - n \ln(n) + 2p
\]</span> where SSE is the usual <span
class="math inline">\(\sum_{i=1}^n (Y_i - \hat{Y}_i)^2\)</span> of the
current regression model under consideration, <span
class="math inline">\(n\)</span> is the sample size, and <span
class="math inline">\(p\)</span> is the number of parameters in the
current regression model.</p>
<p><span class="math display">\[
\text{BIC:} \quad n \ln(SSE) - n \ln(n) + p\ln(n)
\]</span></p>
<p>This shows how the BIC differs only from the AIC in the final term,
where AIC uses <span class="math inline">\(2p\)</span> and BIC uses
<span class="math inline">\(p\ln(n)\)</span>. Since <span
class="math inline">\(\ln(n) \geq 2\)</span> for <span
class="math inline">\(n\geq8\)</span>, then BIC enforces a larger
penalty than the AIC for extra model parameters (<span
class="math inline">\(p\)</span>) when the sample size is 8 or larger,
i.e., most data sets.</p>
<p>The AIC was formulated by <a
href="https://www.ism.ac.jp/editsec/aism/pdf/023_2_0163.pdf">Hirotugu
Akaike in 1971</a>. (Here is a <a
href="http://www.garfield.library.upenn.edu/classics1981/A1981MS54100001.pdf">short
commentary</a> by Akaike about how he developed this information
criterion. Note that he named it “an information criterion (AIC)” when
he published the method and other people later began calling it the
“Akaike Information Criterion.”)</p>
</div>
<p><br/></p>
<hr />
<p><strong><em>Model Selection
<a href="javascript:showhide('modelselection')" style="font-size:.6em;color:skyblue;">(Expand)</a></em></strong></p>
<p><span class="expand-caption">pairs plots, added variable plots, and
pattern recognition…</span></p>
<div id="modelselection" style="display:none;">
<p>Model selection is an exploratory analysis tool that is useful for
proposing possible regression models for a given response variable <span
class="math inline">\(Y\)</span>. They should always be followed up by
confirmatory analysis that tests the theories proposed by the selected
model. However, when confirmatory studies are not possible, model
validation is a meaningful tool that can be used to attempt to confirm
the utility of a model.</p>
<hr />
<p><strong><em>Pairs Plots {.tabset .tabset-pills}</em></strong></p>
<p>A useful visualization tool for model selection is the “pairs plot.”
This plot shows all possible 2D scatterplots that can be created from a
given dataset.</p>
<p>Here is a pairs plot of the <code>mtcars</code> data set in R.</p>
<hr />
<p><strong><em>Basic View</em></strong></p>
<div class="sourceCode" id="cb106"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="fu">pairs</span>(mtcars, <span class="at">panel=</span>panel.smooth)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-128-1.png" width="672" /></p>
<hr />
<p><strong><em>More Detailed View</em></strong></p>
<div class="sourceCode" id="cb107"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="fu">pairs</span>(mtcars, <span class="at">panel=</span>panel.smooth)</span></code></pre></div>
<p><img src="Images/pairsPlotGuidance.png" /></p>
<div id="section-3" class="section level5">
<h5></h5>
<p>Notice that…</p>
<ul>
<li>the y-axis of each plot is found by locating the variable name (like
“mpg”) that is found to the left or right of the current plot.</li>
<li>the x-axis of each plot is found by locating the variable name (like
“disp”) that is found above or below each plot.</li>
<li>the LOWESS curves have been added to each plot to visualize the type
of regression model that would best fit each plot.</li>
</ul>
<hr />
<p><strong><em>Selecting a Model {.tabset
.tabset-pills}</em></strong></p>
<p>Suppose now that we are trying to come up with a good regression
model for predicting the gas mileage of a car, <span
class="math inline">\(Y=\)</span><code>mpg</code>.</p>
<p><span class="math display">\[
  \underbrace{Y_i}_\text{mpg} = \underbrace{?}_\text{Our model} +
\  \epsilon_i \quad \text{where} \ \epsilon_i \sim N(0, \sigma^2)
\]</span> To find meaningful x-variables that could predict our chosen
y-variable of <code>mpg</code>, we look at all plots that have
<code>mpg</code> as the y-axis of the plot. This happens to be the first
row of the pairs plot.</p>
<p>When looking at the graph, we are looking for variables that show a
strong change in the average y-value (i.e., the LOWESS curve should show
steep slope or a meaningful trend). While all variables in the
<code>mtcars</code> data set seem to have some relationship with
<code>mpg</code>, the strongest relationships appear to e with
<code>cyl</code>, <code>disp</code>, <code>hp</code>, <code>wt</code>,
<code>vs</code>, <code>am</code>, and <code>gear</code>.</p>
<hr />
<p><strong><em>Basic View</em></strong></p>
<div class="sourceCode" id="cb108"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="fu">pairs</span>(mtcars, <span class="at">panel=</span>panel.smooth)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-130-1.png" width="672" /></p>
<hr />
<p><strong><em>More Detailed View</em></strong></p>
<div class="sourceCode" id="cb109"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="fu">pairs</span>(mtcars, <span class="at">panel=</span>panel.smooth)</span></code></pre></div>
<p><img src="Images/pairsPossibleX.png" /></p>
</div>
<div id="section-4" class="section level5">
<h5></h5>
<p>Also worth noting is that the relationship of <code>mpg</code> with
each of <code>disp</code>, <code>hp</code>, and <code>wt</code> are all
similar, they each look to be an exponential decay type of model. This
tells us that we had better check to see if <code>disp</code>,
<code>hp</code>, and <code>wt</code> are related to each other. If they
are, then we should only use one of them in the regression model as the
other two likely wouldn’t give any new information about
<code>mpg</code>.</p>
<p>Sure enough, the pairs plot shows that there is a fairly strong
relationship between <code>disp</code> and <code>hp</code>,
<code>hp</code> and <code>wt</code>, and <code>disp</code> and
<code>wt</code>.</p>
<p><img src="Images/pairsPossibleRelatedX.png" /></p>
<p>Now, with all of this in mind, we could start looking at a few
possible regression models. Let’s start with perhaps the simplest and
strongest trend we saw with <code>mpg</code> and any of the x-variables,
<code>wt</code>.</p>
<div class="sourceCode" id="cb110"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="fu">plot</span>(mpg <span class="sc">~</span> wt, <span class="at">data=</span>mtcars)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-132-1.png" width="672" /></p>
<div class="sourceCode" id="cb111"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a>lm.wt <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> wt, <span class="at">data=</span>mtcars)</span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a><span class="fu">summary</span>(lm.wt) <span class="sc">%&gt;%</span> <span class="fu">pander</span>()</span></code></pre></div>
<table style="width:89%;">
<colgroup>
<col width="25%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">37.29</td>
<td align="center">1.878</td>
<td align="center">19.86</td>
<td align="center">8.242e-19</td>
</tr>
<tr class="even">
<td align="center"><strong>wt</strong></td>
<td align="center">-5.344</td>
<td align="center">0.5591</td>
<td align="center">-9.559</td>
<td align="center">1.294e-10</td>
</tr>
</tbody>
</table>
<table style="width:88%;">
<caption>Fitting linear model: mpg ~ wt</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="12%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span
class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">32</td>
<td align="center">3.046</td>
<td align="center">0.7528</td>
<td align="center">0.7446</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br/></p>
<hr />
<p><strong><em>Model Validation
<a href="javascript:showhide('validation')" style="font-size:.6em;color:skyblue;">(Expand)</a></em></strong></p>
<p><span class="expand-caption">Verifying a model’s ability to
generalize to new data…</span></p>
<div id="validation" style="display:none;">
<p>The following graph shows three things: (1) a true regression model,
(2) a simple linear regression model that doesn’t quite capture the full
pattern in the data, and (3) a complicated model that seems to overly
fit the data as it fits better than even the true model.</p>
<div class="sourceCode" id="cb112"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co">#gives us the same randomness </span></span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co">#sample size</span></span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">3.8</span>) <span class="co">#uniform X from -1.5 to 3.8</span></span>
<span id="cb112-4"><a href="#cb112-4" tabindex="-1"></a><span class="co"># Coefficients for the true model:</span></span>
<span id="cb112-5"><a href="#cb112-5" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb112-6"><a href="#cb112-6" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.5</span></span>
<span id="cb112-7"><a href="#cb112-7" tabindex="-1"></a>beta2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb112-8"><a href="#cb112-8" tabindex="-1"></a>beta3 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb112-9"><a href="#cb112-9" tabindex="-1"></a>beta4 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.8</span></span>
<span id="cb112-10"><a href="#cb112-10" tabindex="-1"></a><span class="co"># Get y-value using a true model</span></span>
<span id="cb112-11"><a href="#cb112-11" tabindex="-1"></a>y <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> beta1<span class="sc">*</span>x <span class="sc">+</span> beta2<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> beta3<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> beta4<span class="sc">*</span>x<span class="sc">^</span><span class="dv">4</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.5</span>) <span class="co">#normal errors</span></span>
<span id="cb112-12"><a href="#cb112-12" tabindex="-1"></a></span>
<span id="cb112-13"><a href="#cb112-13" tabindex="-1"></a>thedata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y, x)</span>
<span id="cb112-14"><a href="#cb112-14" tabindex="-1"></a></span>
<span id="cb112-15"><a href="#cb112-15" tabindex="-1"></a><span class="co"># Plot it</span></span>
<span id="cb112-16"><a href="#cb112-16" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mai=</span><span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">5</span>,.<span class="dv">2</span>,.<span class="dv">1</span>))</span>
<span id="cb112-17"><a href="#cb112-17" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">data=</span>thedata, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">col=</span><span class="st">&quot;lightgray&quot;</span>, <span class="at">bg=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">22</span>), <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb112-18"><a href="#cb112-18" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">text=</span><span class="st">&quot;Original Data (Training Data)&quot;</span>, <span class="at">cex=</span><span class="fl">0.7</span>, <span class="at">at=</span><span class="sc">-</span>.<span class="dv">8</span>, <span class="at">line=</span>.<span class="dv">1</span>)</span>
<span id="cb112-19"><a href="#cb112-19" tabindex="-1"></a></span>
<span id="cb112-20"><a href="#cb112-20" tabindex="-1"></a><span class="co"># Draw true model</span></span>
<span id="cb112-21"><a href="#cb112-21" tabindex="-1"></a><span class="fu">curve</span>(beta0 <span class="sc">+</span> beta1<span class="sc">*</span>x <span class="sc">+</span> beta2<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> beta3<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> beta4<span class="sc">*</span>x<span class="sc">^</span><span class="dv">4</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.2745098</span>, <span class="fl">0.5098039</span>, <span class="fl">0.7058824</span>, .<span class="dv">5</span>), <span class="at">lwd=</span><span class="dv">4</span>)</span>
<span id="cb112-22"><a href="#cb112-22" tabindex="-1"></a>lmt <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">4</span>), <span class="at">data=</span>thedata) <span class="co">#for later</span></span>
<span id="cb112-23"><a href="#cb112-23" tabindex="-1"></a></span>
<span id="cb112-24"><a href="#cb112-24" tabindex="-1"></a><span class="co"># Draw simple linear model</span></span>
<span id="cb112-25"><a href="#cb112-25" tabindex="-1"></a>lms <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data=</span>thedata)</span>
<span id="cb112-26"><a href="#cb112-26" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(lms)</span>
<span id="cb112-27"><a href="#cb112-27" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="fl">0.6470588</span>,<span class="dv">0</span>, .<span class="dv">3</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb112-28"><a href="#cb112-28" tabindex="-1"></a></span>
<span id="cb112-29"><a href="#cb112-29" tabindex="-1"></a><span class="co"># Draw overly complicated model</span></span>
<span id="cb112-30"><a href="#cb112-30" tabindex="-1"></a>lmo <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">4</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">5</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">6</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">7</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">8</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">9</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">10</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">11</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">12</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">13</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">14</span>), <span class="at">data=</span>thedata)</span>
<span id="cb112-31"><a href="#cb112-31" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(lmo)</span>
<span id="cb112-32"><a href="#cb112-32" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b[<span class="dv">4</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> b[<span class="dv">5</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">4</span> <span class="sc">+</span> b[<span class="dv">6</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">5</span> <span class="sc">+</span> b[<span class="dv">7</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">6</span> <span class="sc">+</span> b[<span class="dv">8</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">7</span> <span class="sc">+</span> b[<span class="dv">9</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">8</span> <span class="sc">+</span> b[<span class="dv">10</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">9</span> <span class="sc">+</span> b[<span class="dv">11</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">10</span> <span class="sc">+</span> b[<span class="dv">12</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">11</span> <span class="sc">+</span> b[<span class="dv">13</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">12</span> <span class="sc">+</span> b[<span class="dv">14</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">13</span> <span class="sc">+</span> b[<span class="dv">15</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">14</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.6980392</span>, <span class="fl">0.133333</span>, <span class="fl">0.133333</span>, .<span class="dv">2</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb112-33"><a href="#cb112-33" tabindex="-1"></a></span>
<span id="cb112-34"><a href="#cb112-34" tabindex="-1"></a><span class="co"># Add legend</span></span>
<span id="cb112-35"><a href="#cb112-35" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;True Model&quot;</span>, <span class="st">&quot;Simple Model&quot;</span>, <span class="st">&quot;Complicated Model&quot;</span>), <span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="fu">rgb</span>(<span class="fl">0.2745098</span>, <span class="fl">0.5098039</span>, <span class="fl">0.7058824</span>, .<span class="dv">5</span>), <span class="fu">rgb</span>(<span class="dv">1</span>,<span class="fl">0.6470588</span>,<span class="dv">0</span>, .<span class="dv">3</span>), <span class="fu">rgb</span>(<span class="fl">0.6980392</span>, <span class="fl">0.133333</span>, <span class="fl">0.133333</span>, .<span class="dv">2</span>)), <span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/problem-1.png" width="480" /></p>
<div class="sourceCode" id="cb113"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a>my_output_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;True&quot;</span>, <span class="st">&quot;Simple&quot;</span>, <span class="st">&quot;Complicated&quot;</span>), <span class="st">`</span><span class="at">R^2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">summary</span>(lmt)<span class="sc">$</span>r.squared, <span class="fu">summary</span>(lms)<span class="sc">$</span>r.squared, <span class="fu">summary</span>(lmo)<span class="sc">$</span>r.squared), <span class="st">`</span><span class="at">Adjusted R^2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">summary</span>(lmt)<span class="sc">$</span>adj.r.squared, <span class="fu">summary</span>(lms)<span class="sc">$</span>adj.r.squared, <span class="fu">summary</span>(lmo)<span class="sc">$</span>adj.r.squared))</span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a><span class="fu">colnames</span>(my_output_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Model&quot;</span>, <span class="st">&quot;$R^2$&quot;</span>, <span class="st">&quot;Adjusted $R^2$&quot;</span>)</span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(my_output_table)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="right"><span class="math inline">\(R^2\)</span></th>
<th align="right">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">True</td>
<td align="right">0.9958725</td>
<td align="right">0.9947718</td>
</tr>
<tr class="even">
<td align="left">Simple</td>
<td align="right">0.8114836</td>
<td align="right">0.8010105</td>
</tr>
<tr class="odd">
<td align="left">Complicated</td>
<td align="right">0.9984527</td>
<td align="right">0.9941204</td>
</tr>
</tbody>
</table>
<p>Now, let’s remind ourselves why we use regression models in the first
place. The main goal is to capture the “essence” of the data. In other
words, the general pattern is what we are after. We want a model that
tells us how “all such” data is created, not just the specific data we
have sampled. So, the great test of a model is to see how well it works
on a new sample of data.</p>
<p>This is precisely <strong>model validation</strong>, the verification
that a model fit on one sample of data, continues to perform well on a
new sample of data.</p>
<div class="sourceCode" id="cb114"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">14551</span>) <span class="co">#get same random sample</span></span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a><span class="co"># Get a new sample of data from the true model</span></span>
<span id="cb114-3"><a href="#cb114-3" tabindex="-1"></a>Xnew <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="fl">1.4</span>, <span class="fl">3.7</span>) <span class="co">#uniform X from -1.5 to 3.8</span></span>
<span id="cb114-4"><a href="#cb114-4" tabindex="-1"></a>Ynew <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> beta1<span class="sc">*</span>Xnew <span class="sc">+</span> beta2<span class="sc">*</span>Xnew<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> beta3<span class="sc">*</span>Xnew<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> beta4<span class="sc">*</span>Xnew<span class="sc">^</span><span class="dv">4</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.5</span>) <span class="co">#normal errors</span></span>
<span id="cb114-5"><a href="#cb114-5" tabindex="-1"></a></span>
<span id="cb114-6"><a href="#cb114-6" tabindex="-1"></a>thedata2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y=</span>Ynew, <span class="at">x=</span>Xnew)</span>
<span id="cb114-7"><a href="#cb114-7" tabindex="-1"></a></span>
<span id="cb114-8"><a href="#cb114-8" tabindex="-1"></a><span class="co"># Plot it</span></span>
<span id="cb114-9"><a href="#cb114-9" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mai=</span><span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">5</span>,.<span class="dv">2</span>,.<span class="dv">1</span>))</span>
<span id="cb114-10"><a href="#cb114-10" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">data=</span>thedata, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">col=</span><span class="fu">rgb</span>(.<span class="dv">827451</span>,.<span class="dv">827451</span>,.<span class="dv">827451</span>, .<span class="dv">1</span>), <span class="at">bg=</span><span class="fu">rgb</span>(.<span class="dv">2745098</span>,.<span class="dv">5098039</span>,.<span class="dv">7058824</span>, .<span class="dv">2</span>), <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">22</span>), <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb114-11"><a href="#cb114-11" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">text=</span><span class="st">&quot;New Data (Testing Data)&quot;</span>, <span class="at">cex=</span><span class="fl">0.7</span>, <span class="at">at=</span><span class="sc">-</span>.<span class="dv">8</span>, <span class="at">line=</span>.<span class="dv">1</span>)</span>
<span id="cb114-12"><a href="#cb114-12" tabindex="-1"></a></span>
<span id="cb114-13"><a href="#cb114-13" tabindex="-1"></a><span class="co"># Draw true model</span></span>
<span id="cb114-14"><a href="#cb114-14" tabindex="-1"></a><span class="fu">curve</span>(beta0 <span class="sc">+</span> beta1<span class="sc">*</span>x <span class="sc">+</span> beta2<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> beta3<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> beta4<span class="sc">*</span>x<span class="sc">^</span><span class="dv">4</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.2745098</span>, <span class="fl">0.5098039</span>, <span class="fl">0.7058824</span>, .<span class="dv">5</span>), <span class="at">lwd=</span><span class="dv">4</span>)</span>
<span id="cb114-15"><a href="#cb114-15" tabindex="-1"></a>lmt <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">4</span>), <span class="at">data=</span>thedata) <span class="co">#for later</span></span>
<span id="cb114-16"><a href="#cb114-16" tabindex="-1"></a></span>
<span id="cb114-17"><a href="#cb114-17" tabindex="-1"></a><span class="co"># Draw simple linear model</span></span>
<span id="cb114-18"><a href="#cb114-18" tabindex="-1"></a>lms <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data=</span>thedata)</span>
<span id="cb114-19"><a href="#cb114-19" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(lms)</span>
<span id="cb114-20"><a href="#cb114-20" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="fl">0.6470588</span>,<span class="dv">0</span>, .<span class="dv">3</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb114-21"><a href="#cb114-21" tabindex="-1"></a></span>
<span id="cb114-22"><a href="#cb114-22" tabindex="-1"></a><span class="co"># Draw overly complicated model</span></span>
<span id="cb114-23"><a href="#cb114-23" tabindex="-1"></a>lmc <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">4</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">5</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">6</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">7</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">8</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">9</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">10</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">11</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">12</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">13</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">14</span>), <span class="at">data=</span>thedata)</span>
<span id="cb114-24"><a href="#cb114-24" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(lmc)</span>
<span id="cb114-25"><a href="#cb114-25" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b[<span class="dv">4</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> b[<span class="dv">5</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">4</span> <span class="sc">+</span> b[<span class="dv">6</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">5</span> <span class="sc">+</span> b[<span class="dv">7</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">6</span> <span class="sc">+</span> b[<span class="dv">8</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">7</span> <span class="sc">+</span> b[<span class="dv">9</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">8</span> <span class="sc">+</span> b[<span class="dv">10</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">9</span> <span class="sc">+</span> b[<span class="dv">11</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">10</span> <span class="sc">+</span> b[<span class="dv">12</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">11</span> <span class="sc">+</span> b[<span class="dv">13</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">12</span> <span class="sc">+</span> b[<span class="dv">14</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">13</span> <span class="sc">+</span> b[<span class="dv">15</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">14</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.6980392</span>, <span class="fl">0.133333</span>, <span class="fl">0.133333</span>, .<span class="dv">2</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb114-26"><a href="#cb114-26" tabindex="-1"></a></span>
<span id="cb114-27"><a href="#cb114-27" tabindex="-1"></a><span class="co"># Add new data to plot</span></span>
<span id="cb114-28"><a href="#cb114-28" tabindex="-1"></a><span class="fu">points</span>(y <span class="sc">~</span> x, <span class="at">data=</span>thedata2, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">col=</span><span class="fu">rgb</span>(.<span class="dv">827451</span>,.<span class="dv">827451</span>,.<span class="dv">827451</span>, .<span class="dv">5</span>), <span class="at">bg=</span><span class="st">&quot;orange&quot;</span>, <span class="at">cex=</span><span class="fl">1.3</span>)</span>
<span id="cb114-29"><a href="#cb114-29" tabindex="-1"></a></span>
<span id="cb114-30"><a href="#cb114-30" tabindex="-1"></a><span class="co"># Add legend</span></span>
<span id="cb114-31"><a href="#cb114-31" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;True Model&quot;</span>, <span class="st">&quot;Simple Model&quot;</span>, <span class="st">&quot;Complicated Model&quot;</span>), <span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="fu">rgb</span>(<span class="fl">0.2745098</span>, <span class="fl">0.5098039</span>, <span class="fl">0.7058824</span>, .<span class="dv">5</span>), <span class="fu">rgb</span>(<span class="dv">1</span>,<span class="fl">0.6470588</span>,<span class="dv">0</span>, .<span class="dv">3</span>), <span class="fu">rgb</span>(<span class="fl">0.6980392</span>, <span class="fl">0.133333</span>, <span class="fl">0.133333</span>, .<span class="dv">2</span>)), <span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb114-32"><a href="#cb114-32" tabindex="-1"></a></span>
<span id="cb114-33"><a href="#cb114-33" tabindex="-1"></a><span class="co"># Add dot legend</span></span>
<span id="cb114-34"><a href="#cb114-34" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Original Sample&quot;</span>, <span class="st">&quot;New Sample&quot;</span>), <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="fu">rgb</span>(.<span class="dv">2745098</span>,.<span class="dv">5098039</span>,.<span class="dv">7058824</span>, .<span class="dv">2</span>),<span class="st">&quot;orange&quot;</span>), <span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-133-1.png" width="480" /></p>
<div class="sourceCode" id="cb115"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="co"># Compute R-squared for each validation</span></span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" tabindex="-1"></a>  <span class="co"># Get y-hat for each model on new data.</span></span>
<span id="cb115-4"><a href="#cb115-4" tabindex="-1"></a>  yht <span class="ot">&lt;-</span> <span class="fu">predict</span>(lmt, <span class="at">newdata=</span>thedata2)</span>
<span id="cb115-5"><a href="#cb115-5" tabindex="-1"></a>  yhs <span class="ot">&lt;-</span> <span class="fu">predict</span>(lms, <span class="at">newdata=</span>thedata2)</span>
<span id="cb115-6"><a href="#cb115-6" tabindex="-1"></a>  yhc <span class="ot">&lt;-</span> <span class="fu">predict</span>(lmc, <span class="at">newdata=</span>thedata2)</span>
<span id="cb115-7"><a href="#cb115-7" tabindex="-1"></a>  </span>
<span id="cb115-8"><a href="#cb115-8" tabindex="-1"></a>  <span class="co"># Compute y-bar</span></span>
<span id="cb115-9"><a href="#cb115-9" tabindex="-1"></a>  ybar <span class="ot">&lt;-</span> <span class="fu">mean</span>(thedata2<span class="sc">$</span>y) <span class="co">#Yi is given by Ynew from the new sample of data</span></span>
<span id="cb115-10"><a href="#cb115-10" tabindex="-1"></a>  </span>
<span id="cb115-11"><a href="#cb115-11" tabindex="-1"></a>  <span class="co"># Compute SSTO</span></span>
<span id="cb115-12"><a href="#cb115-12" tabindex="-1"></a>  SSTO <span class="ot">&lt;-</span> <span class="fu">sum</span>( (thedata2<span class="sc">$</span>y <span class="sc">-</span> ybar)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb115-13"><a href="#cb115-13" tabindex="-1"></a>  </span>
<span id="cb115-14"><a href="#cb115-14" tabindex="-1"></a>  <span class="co"># Compute SSE for each model using y - yhat</span></span>
<span id="cb115-15"><a href="#cb115-15" tabindex="-1"></a>  SSEt <span class="ot">&lt;-</span> <span class="fu">sum</span>( (thedata2<span class="sc">$</span>y <span class="sc">-</span> yht)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb115-16"><a href="#cb115-16" tabindex="-1"></a>  SSEs <span class="ot">&lt;-</span> <span class="fu">sum</span>( (thedata2<span class="sc">$</span>y <span class="sc">-</span> yhs)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb115-17"><a href="#cb115-17" tabindex="-1"></a>  SSEc <span class="ot">&lt;-</span> <span class="fu">sum</span>( (thedata2<span class="sc">$</span>y <span class="sc">-</span> yhc)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb115-18"><a href="#cb115-18" tabindex="-1"></a>  </span>
<span id="cb115-19"><a href="#cb115-19" tabindex="-1"></a>  <span class="co"># Compute R-squared for each</span></span>
<span id="cb115-20"><a href="#cb115-20" tabindex="-1"></a>  rst <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SSEt<span class="sc">/</span>SSTO</span>
<span id="cb115-21"><a href="#cb115-21" tabindex="-1"></a>  rss <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SSEs<span class="sc">/</span>SSTO</span>
<span id="cb115-22"><a href="#cb115-22" tabindex="-1"></a>  rsc <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SSEc<span class="sc">/</span>SSTO</span>
<span id="cb115-23"><a href="#cb115-23" tabindex="-1"></a>  </span>
<span id="cb115-24"><a href="#cb115-24" tabindex="-1"></a>  <span class="co"># Compute adjusted R-squared for each</span></span>
<span id="cb115-25"><a href="#cb115-25" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(thedata2<span class="sc">$</span>y) <span class="co">#sample size</span></span>
<span id="cb115-26"><a href="#cb115-26" tabindex="-1"></a>  pt <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(lmt)) <span class="co">#num. parameters in model</span></span>
<span id="cb115-27"><a href="#cb115-27" tabindex="-1"></a>  ps <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(lms)) <span class="co">#num. parameters in model</span></span>
<span id="cb115-28"><a href="#cb115-28" tabindex="-1"></a>  pc <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(lmc)) <span class="co">#num. parameters in model</span></span>
<span id="cb115-29"><a href="#cb115-29" tabindex="-1"></a>  rsta <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (n<span class="dv">-1</span>)<span class="sc">/</span>(n<span class="sc">-</span>pt)<span class="sc">*</span>SSEt<span class="sc">/</span>SSTO</span>
<span id="cb115-30"><a href="#cb115-30" tabindex="-1"></a>  rssa <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (n<span class="dv">-1</span>)<span class="sc">/</span>(n<span class="sc">-</span>ps)<span class="sc">*</span>SSEs<span class="sc">/</span>SSTO</span>
<span id="cb115-31"><a href="#cb115-31" tabindex="-1"></a>  rsca <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (n<span class="dv">-1</span>)<span class="sc">/</span>(n<span class="sc">-</span>pc)<span class="sc">*</span>SSEc<span class="sc">/</span>SSTO</span>
<span id="cb115-32"><a href="#cb115-32" tabindex="-1"></a>  </span>
<span id="cb115-33"><a href="#cb115-33" tabindex="-1"></a></span>
<span id="cb115-34"><a href="#cb115-34" tabindex="-1"></a>my_output_table2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;True&quot;</span>, <span class="st">&quot;Simple&quot;</span>, <span class="st">&quot;Complicated&quot;</span>), <span class="st">`</span><span class="at">Original R2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">summary</span>(lmt)<span class="sc">$</span>r.squared, <span class="fu">summary</span>(lms)<span class="sc">$</span>r.squared, <span class="fu">summary</span>(lmo)<span class="sc">$</span>r.squared), <span class="st">`</span><span class="at">Orig. Adj. R-squared</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">summary</span>(lmt)<span class="sc">$</span>adj.r.squared, <span class="fu">summary</span>(lms)<span class="sc">$</span>adj.r.squared, <span class="fu">summary</span>(lmo)<span class="sc">$</span>adj.r.squared), <span class="st">`</span><span class="at">Validation R-squared</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(rst, rss, rsc), <span class="st">`</span><span class="at">Validation Adj. R^2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(rsta, rssa, rsca))</span>
<span id="cb115-35"><a href="#cb115-35" tabindex="-1"></a></span>
<span id="cb115-36"><a href="#cb115-36" tabindex="-1"></a><span class="fu">colnames</span>(my_output_table2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Model&quot;</span>, <span class="st">&quot;Original $R^2$&quot;</span>, <span class="st">&quot;Original Adj. $R^2$&quot;</span>, <span class="st">&quot;Validation $R^2$&quot;</span>, <span class="st">&quot;Validation Adj. $R^2$&quot;</span>)</span>
<span id="cb115-37"><a href="#cb115-37" tabindex="-1"></a></span>
<span id="cb115-38"><a href="#cb115-38" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(my_output_table2, <span class="at">escape=</span><span class="cn">TRUE</span>, <span class="at">digits=</span><span class="dv">4</span>)</span></code></pre></div>
<table>
<colgroup>
<col width="13%" />
<col width="17%" />
<col width="23%" />
<col width="19%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="right">Original <span class="math inline">\(R^2\)</span></th>
<th align="right">Original Adj. <span
class="math inline">\(R^2\)</span></th>
<th align="right">Validation <span
class="math inline">\(R^2\)</span></th>
<th align="right">Validation Adj. <span
class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">True</td>
<td align="right">0.9959</td>
<td align="right">0.9948</td>
<td align="right">0.9928</td>
<td align="right">0.9908</td>
</tr>
<tr class="even">
<td align="left">Simple</td>
<td align="right">0.8115</td>
<td align="right">0.8010</td>
<td align="right">0.8002</td>
<td align="right">0.7891</td>
</tr>
<tr class="odd">
<td align="left">Complicated</td>
<td align="right">0.9985</td>
<td align="right">0.9941</td>
<td align="right">0.8686</td>
<td align="right">0.5008</td>
</tr>
</tbody>
</table>
<p>Notice how the <span class="math inline">\(R^2\)</span> for the
complicated model dropped fairly dramatically from its original value of
0.9985 to 0.8686, and the adjusted <span
class="math inline">\(R^2\)</span> dropped from 0.994 to 0.501! On the
other hand, the <span class="math inline">\(R^2\)</span> and adjusted
<span class="math inline">\(R^2\)</span> values for the True and Simple
model were relatively unchanged. This is clear evidence that the
“complicated model” is overfitting the original data. It does not
capture the “essence” of the data, so it is not a generalizable model.
It does not fit new data very well, even though it fit the original
sample of data quite well. This is what we mean by <strong>over
fitting</strong> a model to a particular sample of data.</p>
</div>
<p><br/></p>
<hr />
<p><strong><em>Interpretation
<a href="javascript:showhide('interpretationMultiple')" style="font-size:.6em;color:skyblue;">(Expand)</a></em></strong></p>
<p><span class="expand-caption"><span
class="math inline">\(\beta_j\)</span> is the change in the average
y-value…</span></p>
<div id="interpretationMultiple" style="display:none;">
<p>The only change to interpretation from the simple linear regression
model is that each coefficient, <span
class="math inline">\(\beta_j\)</span> <span
class="math inline">\(j=1,\ldots,p\)</span>, represents the change in
the <span class="math inline">\(E\{Y\}\)</span> for a unit change in
<span class="math inline">\(X_j\)</span>, <em>holding all other
variables constant.</em></p>
</div>
<p><br /></p>
<hr />
<p><strong><em>Added Variable Plots
<a href="javascript:showhide('addedVariablePlots')" style="font-size:.6em;color:skyblue;">(Expand)</a></em></strong></p>
<p><span class="expand-caption">When to add another <span
class="math inline">\(X\)</span>-variable to the model…</span></p>
<div id="addedVariablePlots" style="display:none;">
<p>The assumptions of multiple linear regression are nearly identical to
simple linear regression, with the addition of one new assumption.</p>
<ol style="list-style-type: decimal">
<li>The regression relation between <span
class="math inline">\(Y\)</span> and <span
class="math inline">\(X\)</span> is linear.</li>
<li>The error terms are normally distributed with <span
class="math inline">\(E\{\epsilon_i\}=0\)</span>.</li>
<li>The variance of the error terms is constant over all <span
class="math inline">\(X\)</span> values.</li>
<li>The <span class="math inline">\(X\)</span> values can be considered
fixed and measured without error.</li>
<li>The error terms are independent.</li>
<li>All important variables are included in the model.</li>
</ol>
<p><br /></p>
<hr />
<p><strong><em>Checking the Assumptions{#check}</em></strong></p>
<p>The process of checking assumptions is the same for multiple linear
regression as it is for simple linear regression, with the addition of
one more tool, the added variable plot. Added variable plots can be used
to determine if a new variable should be included in the model.</p>
<table width="90%">
<tr>
<td with="15%">
<img src="index_files/figure-html/unnamed-chunk-134-1.png" width="144" />
</td>
<td width="75%">
<p>Let <span class="math inline">\(X_{new}\)</span> be a new explanatory
variable that could be added to the current multiple regression model.
Plotting the residuals from the current linear regression against <span
class="math inline">\(X_{new}\)</span> allows us to determine if <span
class="math inline">\(X_{new}\)</span> has any information to add to the
current model. If there is a trend in the plot, then <span
class="math inline">\(X_{new}\)</span> should be added to the model. If
there is no trend in the plot, then the <span
class="math inline">\(X_{new}\)</span> should be left out.</p>
<p>|
<a href="javascript:showhide('addedvariableplots')" style="font-size:.8em;color:steelblue2;">Show
Examples</a> |</p>
</td>
</tr>
</table>
<div id="addedvariableplots" style="display:none;">
<p><a href="javascript:showhide('addedvariableplotsread')" style="font-size:.8em;color:skyblue;">(Read
more…)</a></p>
<div id="addedvariableplotsread" style="display:none;">
<p>An added variable plot checks to see if a new variable has any
information to add to the current multiple regression model.</p>
<p>The plot is made by taking the residuals from the current multiple
regression model (<span class="math inline">\(y\)</span>-axis) and
plotting them against the new explanatory variable (<span
class="math inline">\(x\)</span>-axis).</p>
<ul>
<li><p>If there is a trend in the added variable plot, then the new
explanatory variable contains extra information that is not already
contained in the current multiple regression. The new variable should be
included in the model.</p></li>
<li><p>If there is no trend in the added variable plot, then the
information provided by the new explanatory variable is already
contained in the current multiple regression model. The new variable
should continue to be left out of the model.</p></li>
</ul>
<p>The left column of plots below show scenarios where the new
explanatory variable should be included in the model. The right column
of plots show scenarios where the new explanatory variable should not be
included in the model.</p>
</div>
<p><img src="index_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
<p>tmp &lt;- lm(circumference ~ age, data=Orange) plot(tmp$residuals ~
age, data=Orange, pch=20, xlab=expression(X[new]), ylab=“Residuals”,
main=““, cex.main=0.95, xaxt=‘n’, yaxt=‘n’, col=”firebrick”)
abline(h=0)</p>
<p>tmp &lt;- lm(salary ~ yrs.since.phd, data=Salaries)
plot(tmp$residuals ~ yrs.service, data=Salaries, pch=20, cex=0.8,
xlab=expression(X[new]), ylab=“Residuals”, main=““, cex.main=0.95,
xaxt=‘n’, yaxt=‘n’, col=”firebrick”) abline(h=0)</p>
<p><img src="index_files/figure-html/unnamed-chunk-136-1.png" width="672" /><img src="index_files/figure-html/unnamed-chunk-136-2.png" width="672" /><img src="index_files/figure-html/unnamed-chunk-136-3.png" width="672" /><img src="index_files/figure-html/unnamed-chunk-136-4.png" width="672" /><img src="index_files/figure-html/unnamed-chunk-136-5.png" width="672" /><img src="index_files/figure-html/unnamed-chunk-136-6.png" width="672" /></p>
</div>
</div>
<p><br /></p>
<hr />
<p><strong><em>Outlier Analysis
<a href="javascript:showhide('outlierAnalysis')" style="font-size:.6em;color:skyblue;">(Expand)</a></em></strong></p>
<p><span class="expand-caption">Cook’s Distances and Leverage
Values…</span></p>
<div id="outlierAnalysis" style="display:none;">
<p>The presence of outlying points in a regression can bias the
regression estimates substantially. In simple linear regressions, the
outlier are usually quite visible in a residuals vs. fitted-values plot.
However, in higher dimensional regression models, it can become very
difficult to locate points that are negatively effecting the regression.
Here are two measurements that are helpful in identifying points that
are negatively impacting an estimated regression model.</p>
<hr />
<p><strong><em>Cook’s Distances</em></strong></p>
<p>The idea behind Cook’s Distance is to measure the impact each
individual point has on the regression estimates <span
class="math inline">\(b_i\)</span> for each <span
class="math inline">\(\beta_i\)</span>. As found in the original article
<a
href="http://www.stat.ucla.edu/~nchristo/statistics100C/1268249.pdf">“Detection
of Influential Observation in Linear Regression” (Dennis Cook, 1977)</a>
the formula Cook developed for measuring this effect is given by (when
adapted to fit the notation of this book)</p>
<p><span class="math display">\[
  D_i = \frac{\sum_{j=1}^n (\widehat{Y}_{j} -
\widehat{Y}_{j(i)})^2}{p\cdot MSE}
\]</span></p>
<p>where <span class="math inline">\(p\)</span> is the number of
parameters in the regression model, <span
class="math inline">\(MSE\)</span> is the estimate of <span
class="math inline">\(\sigma^2\)</span> (the mean squared error), and
<span class="math inline">\(\hat{Y}_{j(i)}\)</span> represents the
residual for point <span class="math inline">\(j\)</span> when the <span
class="math inline">\(i\)</span>th point was removed from the
regression.</p>
<p>To understand this formula, let’s focus first on the numerator: <span
class="math inline">\(\sum_{j=1}^n \widehat{Y}_j -
\widehat{Y}_{j(i)}\)</span>. Here, we are comparing the residual from
the original regression for point <span
class="math inline">\(j\)</span>, <span
class="math inline">\(\widehat{Y}_j\)</span> to the modified value of
that same residual when point <span class="math inline">\(i\)</span> is
removed from the regression. See the image below for a visual
explanation.</p>
<div class="sourceCode" id="cb116"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">13</span>)</span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">8</span>,<span class="dv">12</span>)</span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" tabindex="-1"></a><span class="fu">plot</span>(Y <span class="sc">~</span> X, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">14</span>))</span>
<span id="cb116-5"><a href="#cb116-5" tabindex="-1"></a><span class="fu">points</span>(X[<span class="dv">4</span>],Y[<span class="dv">4</span>], <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">1.1</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>)</span>
<span id="cb116-6"><a href="#cb116-6" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb116-7"><a href="#cb116-7" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">w=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb116-8"><a href="#cb116-8" tabindex="-1"></a><span class="fu">abline</span>(lm1, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb116-9"><a href="#cb116-9" tabindex="-1"></a><span class="fu">abline</span>(lm2, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb116-10"><a href="#cb116-10" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;All Points Included&quot;</span>, <span class="st">&quot;Orange Point Removed&quot;</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;skyblue&quot;</span>,<span class="st">&quot;orange&quot;</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb116-11"><a href="#cb116-11" tabindex="-1"></a></span>
<span id="cb116-12"><a href="#cb116-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>){</span>
<span id="cb116-13"><a href="#cb116-13" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">c</span>(X[i]<span class="sc">+</span>.<span class="dv">03</span>,X[i]<span class="sc">+</span>.<span class="dv">03</span>), <span class="fu">c</span>(Y[i], lm1<span class="sc">$</span>fit[i]), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb116-14"><a href="#cb116-14" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">c</span>(X[i]<span class="sc">-</span>.<span class="dv">03</span>,X[i]<span class="sc">-</span>.<span class="dv">03</span>), <span class="fu">c</span>(Y[i], lm2<span class="sc">$</span>fit[i]), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>)</span>
<span id="cb116-15"><a href="#cb116-15" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-137-1.png" width="672" /></p>
<div class="sourceCode" id="cb117"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">round</span>(<span class="fu">rbind</span>(<span class="st">`</span><span class="at">Original Residuals</span><span class="st">`</span> <span class="ot">=</span> lm1<span class="sc">$</span>residuals, <span class="st">`</span><span class="at">Orange Point Removed</span><span class="st">`</span> <span class="ot">=</span> lm2<span class="sc">$</span>residuals, <span class="at">Difference =</span> lm1<span class="sc">$</span>residuals <span class="sc">-</span> lm2<span class="sc">$</span>residuals),<span class="dv">2</span>))</span></code></pre></div>
<table>
<colgroup>
<col width="36%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
<th align="center">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Original Residuals</strong></td>
<td align="center">-1.23</td>
<td align="center">0.02</td>
<td align="center">0.53</td>
<td align="center">1.79</td>
<td align="center">-0.7</td>
<td align="center">-0.42</td>
</tr>
<tr class="even">
<td align="center"><strong>Orange Point Removed</strong></td>
<td align="center">-0.86</td>
<td align="center">0.4</td>
<td align="center">0.9</td>
<td align="center">2.15</td>
<td align="center">-0.35</td>
<td align="center">-0.09</td>
</tr>
<tr class="odd">
<td align="center"><strong>Difference</strong></td>
<td align="center">-0.38</td>
<td align="center">-0.37</td>
<td align="center">-0.36</td>
<td align="center">-0.36</td>
<td align="center">-0.35</td>
<td align="center">-0.33</td>
</tr>
</tbody>
</table>
<p>Squaring the sum of the “differences” in the residuals from the
original regression and the one where point <span
class="math inline">\(i\)</span> (the orange dot) has been removed gives
<span class="math inline">\(0.77186\)</span>. Then, noting that the MSE
for the original regression was <span
class="math inline">\(1.418605\)</span>, and that <span
class="math inline">\(p=2\)</span> because there were two parameters, we
find the Cook’s Distance for Point #4 comes out to be</p>
<p><span class="math display">\[
  D_4 = \frac{\sum_{j=1}^n (\widehat{Y}_{j} -
\widehat{Y}_{j(4)})^2}{p\cdot MSE} \approx \frac{0.77186}{2\cdot
1.418605} \approx 0.272
\]</span></p>
<p>Similar calculations show the Cook’s Distances for each point to
be</p>
<div class="sourceCode" id="cb118"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">round</span>(<span class="fu">cooks.distance</span>(lm1),<span class="dv">3</span>), <span class="at">caption=</span><span class="st">&quot;Cook&#39;s Distances for each Point 1, ..., 6&quot;</span>)</span></code></pre></div>
<table style="width:61%;">
<colgroup>
<col width="11%" />
<col width="5%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
<th align="center">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.551</td>
<td align="center">0</td>
<td align="center">0.028</td>
<td align="center">0.272</td>
<td align="center">0.057</td>
<td align="center">0.807</td>
</tr>
</tbody>
</table>
<p>In R, it is simple to calculate Cook’s Distances using the code
<code>cooks.distance(lmObject)</code>. Also, a graph of Cook’s Distances
can be obtained using <code>plot(lmObject, which=4)</code> as shown
here:</p>
<div class="sourceCode" id="cb119"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="fu">plot</span>(lm1, <span class="at">which=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-139-1.png" width="672" /></p>
<hr />
<p><strong><em>Leverage Values</em></strong></p>
<p>The leverage value of a point is a measurement that lives between 0
and 1 where values close to 1 imply the point has a lot of “leverage”
and is “pulling” the regression toward itself. A value near 0 implies
the point is just “one of many” and that it is not unduly influencing
the regression line.</p>
<p>It is difficult to understand leverage values mathematically unless
we look at regression from a linear algebra (matrix) perspective.</p>
<p>To do this, first recall the simple linear regression model</p>
<p><span class="math display">\[
  Y_i = \beta_0 + \beta_1 X_i + \epsilon_i
\]</span></p>
<p>This could be expanded to explicity list out each value of <span
class="math inline">\(i\)</span> in the model using vector notation:</p>
<p><span class="math display">\[
  \left[ \begin{array}{c} Y_1 \\ Y_2 \\ \vdots \\ Y_n\end{array}\right]
= \beta_0 \left[ \begin{array}{c} 1  \\
  1  \\
  \vdots \\ 1  \end{array}\right] + \beta_1 \left[\begin{array}{c} X_1
\\ X_2 \\ \vdots \\ X_n  \end{array}\right] + \left[\begin{array}{c}
\epsilon_1 \\ \epsilon_2 \\ \vdots \\ \epsilon_n \end{array}\right]
\]</span></p>
<p>We could then rewrite this in matrix notation using</p>
<p><span class="math display">\[
  \left[ \begin{array}{c} Y_1 \\ Y_2 \\ \vdots \\ Y_n\end{array}\right]
=  \left[ \begin{array}{cc} 1 &amp; X_1\\
  1  &amp; X_2 \\
  \vdots &amp; \vdots \\
  1 &amp; X_n \end{array}\right] \left[\begin{array}{c} \beta_0 \\
\beta_1 \end{array}\right] + \left[\begin{array}{c} \epsilon_1 \\
\epsilon_2 \\ \vdots \\ \epsilon_n \end{array}\right]
\]</span></p>
<p>Or, more concisely as</p>
<p><span class="math display">\[
  \vec{Y} = \mathbf{X}\vec{\beta} + \vec{\epsilon}
\]</span></p>
<p>The goal of regression is to choose values for <span
class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span> that “minimize” the sum of the
squared errors. Mathematically this would be written as</p>
<p><span class="math display">\[
  \sum_{i=1}^n \epsilon_i ^2
\]</span></p>
<p>If you are familiar with vectors then you would see that this could
be written with the notation</p>
<p><span class="math display">\[
  \vec{\epsilon}^t \vec{\epsilon} = \sum_{i=1}^n \epsilon_i ^2
\]</span></p>
<p>And since we can also write</p>
<p><span class="math display">\[
  \vec{\epsilon} = \vec{Y} - \mathbf{X}\vec{\beta}
\]</span></p>
<p>then we have</p>
<p><span class="math display">\[
\sum_{i=1}^n \epsilon_i^2 = \vec{\epsilon}^t \vec{\epsilon} = (\vec{Y} -
\mathbf{X}\vec{\beta})^t (\vec{Y} - \mathbf{X}\vec{\beta})
\]</span></p>
<p>To choose the values of <span
class="math inline">\(\vec{\beta}\)</span> that minimize the above
equation, we will take the derivative with respect to <span
class="math inline">\(\vec{\beta}\)</span> which turns out to give</p>
<p><span class="math display">\[
\frac{d}{d\vec{\beta}}(\vec{Y} - \mathbf{X}\vec{\beta})^t (\vec{Y} -
\mathbf{X}\vec{\beta}) = -2\mathbf{X}^t(\vec{Y} - \mathbf{X}\vec{\beta})
\]</span></p>
<p>Setting the derivative equal to the zero vector <span
class="math inline">\(\vec{0}\)</span> and solving, we obtain</p>
<p><span class="math display">\[
-2\mathbf{X}^t(\vec{Y} - \mathbf{X}\vec{\beta}) = \vec{0} \\
-2\mathbf{X}^t\vec{Y} = -2\mathbf{X}^t\mathbf{X}\vec{\beta}) \\
\mathbf{X}^t\vec{Y} = \mathbf{X}^t\mathbf{X}\vec{\beta}
\]</span></p>
<p>Since <span class="math inline">\(\mathbf{X}^t\mathbf{X}\)</span> is
a square matrix, it is invertible. This allows us to solve for <span
class="math inline">\(\vec{\beta}\)</span> by</p>
<p><span class="math display">\[
(\mathbf{X}^t\mathbf{X})^{-1}\mathbf{X}^t\vec{Y} = \vec{\beta}
\]</span></p>
<p>However, at this point istead of pretending we have found the true
<span class="math inline">\(\beta\)</span>’s, we change the equation
to</p>
<p><span class="math display">\[
\vec{b} = (\mathbf{X}^t\mathbf{X})^{-1}\mathbf{X}^t\vec{Y}
\]</span></p>
<p>Then, if we use the equation for <span
class="math inline">\(\hat{Y}_i\)</span> in vector notation, we get</p>
<p><span class="math display">\[
  \hat{\vec{Y}} = \mathbf{X}\vec{b}
\]</span></p>
<p>and substituting into <span class="math inline">\(\vec{b}\)</span>
gives</p>
<p><span class="math display">\[
  \hat{\vec{Y}} =
\mathbf{X}(\mathbf{X}^t\mathbf{X})^{-1}\mathbf{X}^t\vec{Y}
\]</span></p>
<p>This shows the <span class="math inline">\(\hat{Y}\)</span> values
are a matrix transformation of the <span
class="math inline">\(Y\)</span> values, often called a projection of
<span class="math inline">\(Y\)</span> onto the <span
class="math inline">\(\hat{Y}\)</span> surface. But now we have arrived
at the thing we wanted to look at in order to talk about leverage, the
“hat matrix” <span class="math inline">\(\mathbf{H}\)</span>:</p>
<p><span class="math display">\[
  \mathbf{H} = \mathbf{X}(\mathbf{X}^t\mathbf{X})^{-1}\mathbf{X}^t
\]</span></p>
<p>This allows us to write</p>
<p><span class="math display">\[
\hat{\vec{Y}} = \mathbf{H}\vec{Y}
\]</span></p>
<p>The diagonal elements of <span
class="math inline">\(\mathbf{H}\)</span> are the “leverage values” and
are notated as the <span class="math inline">\(h_{ii}\)</span> values.
Essentially each of these values explain how much <span
class="math inline">\(\hat{Y}_i\)</span> is being pulled towards <span
class="math inline">\(Y_i\)</span> by each <span
class="math inline">\(Y_i\)</span>, where values of <span
class="math inline">\(h_{ii}\)</span> close to 1 represent a “lot of
pull,” and values close to 0 represent “little pull.”</p>
<p>In R these values are obtained by the <code>hatvalues(...)</code>
function:</p>
<div class="sourceCode" id="cb120"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="fu">hatvalues</span>(lm1) <span class="sc">%&gt;%</span> <span class="fu">pander</span>()</span></code></pre></div>
<table style="width:74%;">
<colgroup>
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="11%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
<th align="center">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.3869</td>
<td align="center">0.2939</td>
<td align="center">0.1839</td>
<td align="center">0.167</td>
<td align="center">0.2093</td>
<td align="center">0.759</td>
</tr>
</tbody>
</table>
<p>Or, graphically depicted by <code>plot(lmObject, which=5)</code></p>
<div class="sourceCode" id="cb121"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="fu">plot</span>(lm1, <span class="at">which=</span><span class="dv">5</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
<p>Points with “lots of leverage” and a large “Cook’s Distance” are
points that should be investigated for accuracy and possibly removed (or
downweighted) in the regression.</p>
</div>
<p><br /></p>
<hr />
<p><strong><em>Inference for the Model Parameters
<a href="javascript:showhide('inferenceMultiple')" style="font-size:.6em;color:skyblue;">(Expand)</a></em></strong></p>
<p><span class="expand-caption">t Tests and F tests in multiple
regression…</span></p>
<div id="inferenceMultiple" style="display:none;">
<p>Inference in the multiple regression model can be for any of the
model coefficients, <span class="math inline">\(\beta_0\)</span>, <span
class="math inline">\(\beta_1\)</span>, <span
class="math inline">\(\ldots\)</span>, <span
class="math inline">\(\beta_p\)</span> or for several coefficients
simultaneously.</p>
<p><br /></p>
<hr />
<p><strong><em>t Tests</em></strong></p>
<p>The most typical tests for multiple regression are t Tests for a
single coefficient. The hypotheses for these t Tests are written as
<span class="math display">\[
  H_0: \beta_j = 0
\]</span> <span class="math display">\[
  H_a: \beta_j \neq 0
\]</span> Note that these hypotheses assume that all other variables
(and coefficients) are already in the model. The significance of the
single variable is thus assessed after accounting for the effect of all
other variables. If a t Test of a single coefficient is significant,
then that variable should remain in the model. If the t Test for a
single coefficient is not significant, then the other variables in the
model provide the same information that the variable being tested
provides. Removing it from the model may be appropriate. However,
whenever a single variable is removed from the model the other variables
can change in their significance.</p>
<p><br /></p>
<hr />
<p><strong><em>F Tests</em></strong></p>
<p>Another approach to testing hypotheses about coefficients is to use
an F Test. The F Test allows a single test for any group of hypotheses
simultaneously.</p>
<p>The most commonly used F Test is the one given by the hypotheses
<span class="math display">\[
  H_0: \beta_1 = \cdots = \beta_p = 0
\]</span> <span class="math display">\[
  H_a: \beta_j \neq 0 \ \text{for at least one}\ j \in \{1,\ldots,p\}
\]</span> However, any subset of coefficients could be tested in a
similar way using a customized F Test. The details of how to do this are
somewhat involved and are beyond the scope of this class.</p>
</div>
<p><br /> <br /></p>
<hr />
</div>
</div>
</div>
<div id="section-5" class="section level2">
<h2></h2>
<div style="padding-left:125px;">
<p><strong>Examples:</strong> <a
href="./Analyses/Linear%20Regression/Examples/CivicVsCorollaMLR.html">Civic
Vs Corolla</a> <a
href="./Analyses/Linear%20Regression/Examples/cadillacsMLR.html">cadillacs</a></p>
</div>
<hr />
<!--- End of Add content area.  ------------------>
</div>
</div>
</div>
</div>
<div id="section-6" class="section level1">
<h1></h1>
<div style="clear:both;">

</div>
<div id="binomial-y-quantitative-x"
class="section level3 tabset tabset-fade">
<h3 class="tabset tabset-fade">Binomial Y | Quantitative X</h3>
<div id="graphics-6" class="section level4">
<h4>Graphics</h4>
<div class="tooltipimage" style="float:left;width:125px;"
align="center">
<p><img src="Images/BinomYQuantX.png" width=59px;> <span
class="tooltipimagetext">Y is a single categorical (qualitative)
variable of interest where 1 (success) or 0 (failure) are the only
possible values for Y. This would be like “getting an A in Math 325”
where 1 means you got an A and 0 means you didn’t. We might use an
explanatory variable X of “height” to see if taller students are more
likely to get an A in Math 325 than shorter students. (They aren’t, if
you were wondering.)</span></p>
</div>
<div style="padding-left:125px;color:black;">
<!-- Add your customizations in the area below: -->
<p><strong>Test(s) used for this category:</strong></p>
<ul>
<li><p><strong>Simple Logistic Regression Model</strong></p>
<ul>
<li>Analysis: <a
href="file:///C:/Users/paige/OneDrive/Documents/Fall%20Semester%202024/MATH%20325/Statistics-Notebook-master/Analyses/Logistic%20Regression/MyLogisticRegression.html">Logistic
Regression - Cat Adoptions</a></li>
</ul></li>
</ul>
<p><br></p>
<p><strong>Used for predicting something given a certain scenario with
1’s and 0’s (this does happen or this doesn’t happen): </strong></p>
<ul>
<li><p>Does the width of a child’s foot predict whether or not they are
right-handed?</p></li>
<li><p>What is the probability the cat adopted is a male based on how
many days it took them to get adopted?</p></li>
</ul>
<p><a href="GraphicalSummaries.html#scatterplots">
<img class="myhover" src="Images/scatterplotbinomY.png" alt="Scatterplot with Binomial Y" title="Scatterplot with Binomial Y">
</a></p>
<p><em>Examples:</em></p>
<ul>
<li>What is the probability the cat adopted is a male based on how many
days it took them to get adopted? (<strong>Simple Logistic
Regression</strong>)</li>
</ul>
<div class="sourceCode" id="cb122"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a>catadoptions <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;C:/Users/paige/OneDrive/Documents/Fall Semester 2024/MATH 325/Statistics-Notebook-master/Data/catadoptions.csv&quot;</span>)</span>
<span id="cb122-2"><a href="#cb122-2" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" tabindex="-1"></a>adoptions <span class="ot">&lt;-</span> catadoptions <span class="sc">%&gt;%</span></span>
<span id="cb122-4"><a href="#cb122-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Gender =</span> <span class="fu">ifelse</span>(Sex <span class="sc">==</span> <span class="st">&quot;M&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb122-5"><a href="#cb122-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Age, Gender, Posted, Adopted, DaysListed)</span>
<span id="cb122-6"><a href="#cb122-6" tabindex="-1"></a></span>
<span id="cb122-7"><a href="#cb122-7" tabindex="-1"></a>catgraph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>adoptions, <span class="fu">aes</span>(<span class="at">x=</span>DaysListed, <span class="at">y=</span>Gender, <span class="at">color =</span> DaysListed)) <span class="sc">+</span></span>
<span id="cb122-8"><a href="#cb122-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="fu">aes</span>(</span>
<span id="cb122-9"><a href="#cb122-9" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">paste</span>(</span>
<span id="cb122-10"><a href="#cb122-10" tabindex="-1"></a>      <span class="st">&quot;Age (Months):&quot;</span>, Age, <span class="st">&quot;&lt;br&gt;&quot;</span>,</span>
<span id="cb122-11"><a href="#cb122-11" tabindex="-1"></a>      <span class="st">&quot;Listed:&quot;</span>, DaysListed, <span class="st">&quot;days&lt;br&gt;&quot;</span>))) <span class="sc">+</span></span>
<span id="cb122-12"><a href="#cb122-12" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>,</span>
<span id="cb122-13"><a href="#cb122-13" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family=</span><span class="st">&quot;binomial&quot;</span>), <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;steelblue1&quot;</span>)<span class="sc">+</span></span>
<span id="cb122-14"><a href="#cb122-14" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">&quot;steelblue1&quot;</span>, <span class="at">high =</span> <span class="st">&quot;royalblue4&quot;</span>) <span class="sc">+</span></span>
<span id="cb122-15"><a href="#cb122-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Idaho Falls Animals Shelter Cat Adoptions&quot;</span>, </span>
<span id="cb122-16"><a href="#cb122-16" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Days Listed&quot;</span>,</span>
<span id="cb122-17"><a href="#cb122-17" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Gender&quot;</span>) <span class="sc">+</span></span>
<span id="cb122-18"><a href="#cb122-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb122-19"><a href="#cb122-19" tabindex="-1"></a>    <span class="fu">theme</span>( </span>
<span id="cb122-20"><a href="#cb122-20" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>), </span>
<span id="cb122-21"><a href="#cb122-21" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>)</span>
<span id="cb122-22"><a href="#cb122-22" tabindex="-1"></a>  )</span>
<span id="cb122-23"><a href="#cb122-23" tabindex="-1"></a>  </span>
<span id="cb122-24"><a href="#cb122-24" tabindex="-1"></a><span class="fu">ggplotly</span>(catgraph, <span class="at">tooltip=</span><span class="st">&quot;text&quot;</span>)</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-e7368bf574834e9f4db8" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-e7368bf574834e9f4db8">{"x":{"data":[{"x":[1,1,1,1,3,1,0,1,4,4,1,1,1,1,0,5,1,2,3,3,10,3,1,1,1,4,1,5,8,9,5,6,1,0,0,1,15,3,4,2,2,5,5,5,5,9,14,13,14,3,3,13,3,32,20,34,0,13,8,8,13,8,18,2,2,2,2,2,2,4,2,3,1,3,1,3,3,0,0,0,12,1,1,1,6,29,1,6,16,4,4,4,2,0,5,5,10,4,1,4,2,1,1,9,7,2,1,2,1,5,4,7,6,6,6,6,1,10,11,0,7,5,3,2,2,37,13,14,2,5,7,7,7,2,3,1,28,5,1,1,10,17,12,12,17,3,9,7,0,0],"y":[1,0,0,0,0,1,1,0,1,0,1,1,1,1,1,0,0,0,0,0,0,1,0,1,0,0,0,0,1,1,1,0,1,1,1,1,0,0,0,1,1,0,1,0,1,0,0,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,1,1,1,0,0,1,0,0,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,0,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,0,0,0,1,0,0,1,0,0,0,1,1,1,1,1,0,1,1,1,0,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,0,0,1,0,0,1,0],"text":["Age (Months): 2 <br> Listed: 1 days<br>","Age (Months): 2 <br> Listed: 1 days<br>","Age (Months): 2 <br> Listed: 1 days<br>","Age (Months): 2 <br> Listed: 1 days<br>","Age (Months): 2 <br> Listed: 3 days<br>","Age (Months): 2 <br> Listed: 1 days<br>","Age (Months): 2 <br> Listed: 0 days<br>","Age (Months): 2 <br> Listed: 1 days<br>","Age (Months): 1 <br> Listed: 4 days<br>","Age (Months): 1 <br> Listed: 4 days<br>","Age (Months): 1 <br> Listed: 1 days<br>","Age (Months): 1 <br> Listed: 1 days<br>","Age (Months): 1 <br> Listed: 1 days<br>","Age (Months): 1 <br> Listed: 1 days<br>","Age (Months): 36 <br> Listed: 0 days<br>","Age (Months): 3 <br> Listed: 5 days<br>","Age (Months): 2 <br> Listed: 1 days<br>","Age (Months): 3 <br> Listed: 2 days<br>","Age (Months): 2 <br> Listed: 3 days<br>","Age (Months): 2 <br> Listed: 3 days<br>","Age (Months): 2 <br> Listed: 10 days<br>","Age (Months): 2 <br> Listed: 3 days<br>","Age (Months): 2 <br> Listed: 1 days<br>","Age (Months): 2 <br> Listed: 1 days<br>","Age (Months): 2 <br> Listed: 1 days<br>","Age (Months): 2 <br> Listed: 4 days<br>","Age (Months): 2 <br> Listed: 1 days<br>","Age (Months): 2 <br> Listed: 5 days<br>","Age (Months): 2 <br> Listed: 8 days<br>","Age (Months): 2 <br> Listed: 9 days<br>","Age (Months): 2 <br> Listed: 5 days<br>","Age (Months): 2 <br> Listed: 6 days<br>","Age (Months): 2 <br> Listed: 1 days<br>","Age (Months): 2 <br> Listed: 0 days<br>","Age (Months): 2 <br> Listed: 0 days<br>","Age (Months): 36 <br> Listed: 1 days<br>","Age (Months): 120 <br> Listed: 15 days<br>","Age (Months): 24 <br> Listed: 3 days<br>","Age (Months): 12 <br> Listed: 4 days<br>","Age (Months): 2 <br> Listed: 2 days<br>","Age (Months): 2 <br> Listed: 2 days<br>","Age (Months): 2 <br> Listed: 5 days<br>","Age (Months): 2 <br> Listed: 5 days<br>","Age (Months): 2 <br> Listed: 5 days<br>","Age (Months): 36 <br> Listed: 5 days<br>","Age (Months): 6 <br> Listed: 9 days<br>","Age (Months): 2 <br> Listed: 14 days<br>","Age (Months): 2 <br> Listed: 13 days<br>","Age (Months): 2 <br> Listed: 14 days<br>","Age (Months): 2 <br> Listed: 3 days<br>","Age (Months): 2 <br> Listed: 3 days<br>","Age (Months): 2 <br> Listed: 13 days<br>","Age (Months): 1 <br> Listed: 3 days<br>","Age (Months): 120 <br> Listed: 32 days<br>","Age (Months): 2 <br> Listed: 20 days<br>","Age (Months): 48 <br> Listed: 34 days<br>","Age (Months): 3 <br> Listed: 0 days<br>","Age (Months): 1 <br> Listed: 13 days<br>","Age (Months): 1 <br> Listed: 8 days<br>","Age (Months): 1 <br> Listed: 8 days<br>","Age (Months): 1 <br> Listed: 13 days<br>","Age (Months): 1 <br> Listed: 8 days<br>","Age (Months): 2 <br> Listed: 18 days<br>","Age (Months): 2 <br> Listed: 2 days<br>","Age (Months): 1 <br> Listed: 2 days<br>","Age (Months): 1 <br> Listed: 2 days<br>","Age (Months): 1 <br> Listed: 2 days<br>","Age (Months): 1 <br> Listed: 2 days<br>","Age (Months): 1 <br> Listed: 2 days<br>","Age (Months): 3 <br> Listed: 4 days<br>","Age (Months): 2 <br> Listed: 2 days<br>","Age (Months): 2 <br> Listed: 3 days<br>","Age (Months): 2 <br> Listed: 1 days<br>","Age (Months): 2 <br> Listed: 3 days<br>","Age (Months): 2 <br> Listed: 1 days<br>","Age (Months): 2 <br> Listed: 3 days<br>","Age (Months): 2 <br> Listed: 3 days<br>","Age (Months): 3 <br> Listed: 0 days<br>","Age (Months): 3 <br> Listed: 0 days<br>","Age (Months): 3 <br> Listed: 0 days<br>","Age (Months): 36 <br> Listed: 12 days<br>","Age (Months): 3 <br> Listed: 1 days<br>","Age (Months): 3 <br> Listed: 1 days<br>","Age (Months): 3 <br> Listed: 1 days<br>","Age (Months): 108 <br> Listed: 6 days<br>","Age (Months): 84 <br> Listed: 29 days<br>","Age (Months): 2 <br> Listed: 1 days<br>","Age (Months): 2 <br> Listed: 6 days<br>","Age (Months): 168 <br> Listed: 16 days<br>","Age (Months): 96 <br> Listed: 4 days<br>","Age (Months): 3 <br> Listed: 4 days<br>","Age (Months): 2 <br> Listed: 4 days<br>","Age (Months): 3 <br> Listed: 2 days<br>","Age (Months): 3 <br> Listed: 0 days<br>","Age (Months): 2 <br> Listed: 5 days<br>","Age (Months): 12 <br> Listed: 5 days<br>","Age (Months): 144 <br> Listed: 10 days<br>","Age (Months): 3 <br> Listed: 4 days<br>","Age (Months): 3 <br> Listed: 1 days<br>","Age (Months): 3 <br> Listed: 4 days<br>","Age (Months): 3 <br> Listed: 2 days<br>","Age (Months): 36 <br> Listed: 1 days<br>","Age (Months): 36 <br> Listed: 1 days<br>","Age (Months): 4 <br> Listed: 9 days<br>","Age (Months): 3 <br> Listed: 7 days<br>","Age (Months): 2 <br> Listed: 2 days<br>","Age (Months): 2 <br> Listed: 1 days<br>","Age (Months): 2 <br> Listed: 2 days<br>","Age (Months): 2 <br> Listed: 1 days<br>","Age (Months): 36 <br> Listed: 5 days<br>","Age (Months): 3 <br> Listed: 4 days<br>","Age (Months): 3 <br> Listed: 7 days<br>","Age (Months): 4 <br> Listed: 6 days<br>","Age (Months): 4 <br> Listed: 6 days<br>","Age (Months): 4 <br> Listed: 6 days<br>","Age (Months): 4 <br> Listed: 6 days<br>","Age (Months): 4 <br> Listed: 1 days<br>","Age (Months): 3 <br> Listed: 10 days<br>","Age (Months): 96 <br> Listed: 11 days<br>","Age (Months): 1 <br> Listed: 0 days<br>","Age (Months): 4 <br> Listed: 7 days<br>","Age (Months): 4 <br> Listed: 5 days<br>","Age (Months): 2 <br> Listed: 3 days<br>","Age (Months): 96 <br> Listed: 2 days<br>","Age (Months): 72 <br> Listed: 2 days<br>","Age (Months): 24 <br> Listed: 37 days<br>","Age (Months): 96 <br> Listed: 13 days<br>","Age (Months): 3 <br> Listed: 14 days<br>","Age (Months): 12 <br> Listed: 2 days<br>","Age (Months): 2 <br> Listed: 5 days<br>","Age (Months): 2 <br> Listed: 7 days<br>","Age (Months): 2 <br> Listed: 7 days<br>","Age (Months): 2 <br> Listed: 7 days<br>","Age (Months): 2 <br> Listed: 2 days<br>","Age (Months): 2 <br> Listed: 3 days<br>","Age (Months): 48 <br> Listed: 1 days<br>","Age (Months): 192 <br> Listed: 28 days<br>","Age (Months): 192 <br> Listed: 5 days<br>","Age (Months): 3 <br> Listed: 1 days<br>","Age (Months): 3 <br> Listed: 1 days<br>","Age (Months): 3 <br> Listed: 10 days<br>","Age (Months): 3 <br> Listed: 17 days<br>","Age (Months): 3 <br> Listed: 12 days<br>","Age (Months): 3 <br> Listed: 12 days<br>","Age (Months): 36 <br> Listed: 17 days<br>","Age (Months): 2 <br> Listed: 3 days<br>","Age (Months): 2 <br> Listed: 9 days<br>","Age (Months): 2 <br> Listed: 7 days<br>","Age (Months): 2 <br> Listed: 0 days<br>","Age (Months): 2 <br> Listed: 0 days<br>"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":["rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(94,174,245,1)","rgba(97,181,252,1)","rgba(99,184,255,1)","rgba(97,181,252,1)","rgba(93,170,242,1)","rgba(93,170,242,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(99,184,255,1)","rgba(91,167,239,1)","rgba(97,181,252,1)","rgba(96,177,248,1)","rgba(94,174,245,1)","rgba(94,174,245,1)","rgba(84,150,223,1)","rgba(94,174,245,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(93,170,242,1)","rgba(97,181,252,1)","rgba(91,167,239,1)","rgba(87,157,229,1)","rgba(85,153,226,1)","rgba(91,167,239,1)","rgba(90,163,235,1)","rgba(97,181,252,1)","rgba(99,184,255,1)","rgba(99,184,255,1)","rgba(97,181,252,1)","rgba(76,133,207,1)","rgba(94,174,245,1)","rgba(93,170,242,1)","rgba(96,177,248,1)","rgba(96,177,248,1)","rgba(91,167,239,1)","rgba(91,167,239,1)","rgba(91,167,239,1)","rgba(91,167,239,1)","rgba(85,153,226,1)","rgba(77,136,210,1)","rgba(79,140,213,1)","rgba(77,136,210,1)","rgba(94,174,245,1)","rgba(94,174,245,1)","rgba(79,140,213,1)","rgba(94,174,245,1)","rgba(48,79,154,1)","rgba(68,117,191,1)","rgba(44,73,148,1)","rgba(99,184,255,1)","rgba(79,140,213,1)","rgba(87,157,229,1)","rgba(87,157,229,1)","rgba(79,140,213,1)","rgba(87,157,229,1)","rgba(71,123,197,1)","rgba(96,177,248,1)","rgba(96,177,248,1)","rgba(96,177,248,1)","rgba(96,177,248,1)","rgba(96,177,248,1)","rgba(96,177,248,1)","rgba(93,170,242,1)","rgba(96,177,248,1)","rgba(94,174,245,1)","rgba(97,181,252,1)","rgba(94,174,245,1)","rgba(97,181,252,1)","rgba(94,174,245,1)","rgba(94,174,245,1)","rgba(99,184,255,1)","rgba(99,184,255,1)","rgba(99,184,255,1)","rgba(81,143,216,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(90,163,235,1)","rgba(53,88,163,1)","rgba(97,181,252,1)","rgba(90,163,235,1)","rgba(74,130,203,1)","rgba(93,170,242,1)","rgba(93,170,242,1)","rgba(93,170,242,1)","rgba(96,177,248,1)","rgba(99,184,255,1)","rgba(91,167,239,1)","rgba(91,167,239,1)","rgba(84,150,223,1)","rgba(93,170,242,1)","rgba(97,181,252,1)","rgba(93,170,242,1)","rgba(96,177,248,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(85,153,226,1)","rgba(88,160,232,1)","rgba(96,177,248,1)","rgba(97,181,252,1)","rgba(96,177,248,1)","rgba(97,181,252,1)","rgba(91,167,239,1)","rgba(93,170,242,1)","rgba(88,160,232,1)","rgba(90,163,235,1)","rgba(90,163,235,1)","rgba(90,163,235,1)","rgba(90,163,235,1)","rgba(97,181,252,1)","rgba(84,150,223,1)","rgba(82,146,219,1)","rgba(99,184,255,1)","rgba(88,160,232,1)","rgba(91,167,239,1)","rgba(94,174,245,1)","rgba(96,177,248,1)","rgba(96,177,248,1)","rgba(39,64,139,1)","rgba(79,140,213,1)","rgba(77,136,210,1)","rgba(96,177,248,1)","rgba(91,167,239,1)","rgba(88,160,232,1)","rgba(88,160,232,1)","rgba(88,160,232,1)","rgba(96,177,248,1)","rgba(94,174,245,1)","rgba(97,181,252,1)","rgba(55,91,166,1)","rgba(91,167,239,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(84,150,223,1)","rgba(73,127,200,1)","rgba(81,143,216,1)","rgba(81,143,216,1)","rgba(73,127,200,1)","rgba(94,174,245,1)","rgba(85,153,226,1)","rgba(88,160,232,1)","rgba(99,184,255,1)","rgba(99,184,255,1)"],"opacity":0.80000000000000004,"size":15.118110236220474,"symbol":"circle","line":{"width":1.8897637795275593,"color":["rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(94,174,245,1)","rgba(97,181,252,1)","rgba(99,184,255,1)","rgba(97,181,252,1)","rgba(93,170,242,1)","rgba(93,170,242,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(99,184,255,1)","rgba(91,167,239,1)","rgba(97,181,252,1)","rgba(96,177,248,1)","rgba(94,174,245,1)","rgba(94,174,245,1)","rgba(84,150,223,1)","rgba(94,174,245,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(93,170,242,1)","rgba(97,181,252,1)","rgba(91,167,239,1)","rgba(87,157,229,1)","rgba(85,153,226,1)","rgba(91,167,239,1)","rgba(90,163,235,1)","rgba(97,181,252,1)","rgba(99,184,255,1)","rgba(99,184,255,1)","rgba(97,181,252,1)","rgba(76,133,207,1)","rgba(94,174,245,1)","rgba(93,170,242,1)","rgba(96,177,248,1)","rgba(96,177,248,1)","rgba(91,167,239,1)","rgba(91,167,239,1)","rgba(91,167,239,1)","rgba(91,167,239,1)","rgba(85,153,226,1)","rgba(77,136,210,1)","rgba(79,140,213,1)","rgba(77,136,210,1)","rgba(94,174,245,1)","rgba(94,174,245,1)","rgba(79,140,213,1)","rgba(94,174,245,1)","rgba(48,79,154,1)","rgba(68,117,191,1)","rgba(44,73,148,1)","rgba(99,184,255,1)","rgba(79,140,213,1)","rgba(87,157,229,1)","rgba(87,157,229,1)","rgba(79,140,213,1)","rgba(87,157,229,1)","rgba(71,123,197,1)","rgba(96,177,248,1)","rgba(96,177,248,1)","rgba(96,177,248,1)","rgba(96,177,248,1)","rgba(96,177,248,1)","rgba(96,177,248,1)","rgba(93,170,242,1)","rgba(96,177,248,1)","rgba(94,174,245,1)","rgba(97,181,252,1)","rgba(94,174,245,1)","rgba(97,181,252,1)","rgba(94,174,245,1)","rgba(94,174,245,1)","rgba(99,184,255,1)","rgba(99,184,255,1)","rgba(99,184,255,1)","rgba(81,143,216,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(90,163,235,1)","rgba(53,88,163,1)","rgba(97,181,252,1)","rgba(90,163,235,1)","rgba(74,130,203,1)","rgba(93,170,242,1)","rgba(93,170,242,1)","rgba(93,170,242,1)","rgba(96,177,248,1)","rgba(99,184,255,1)","rgba(91,167,239,1)","rgba(91,167,239,1)","rgba(84,150,223,1)","rgba(93,170,242,1)","rgba(97,181,252,1)","rgba(93,170,242,1)","rgba(96,177,248,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(85,153,226,1)","rgba(88,160,232,1)","rgba(96,177,248,1)","rgba(97,181,252,1)","rgba(96,177,248,1)","rgba(97,181,252,1)","rgba(91,167,239,1)","rgba(93,170,242,1)","rgba(88,160,232,1)","rgba(90,163,235,1)","rgba(90,163,235,1)","rgba(90,163,235,1)","rgba(90,163,235,1)","rgba(97,181,252,1)","rgba(84,150,223,1)","rgba(82,146,219,1)","rgba(99,184,255,1)","rgba(88,160,232,1)","rgba(91,167,239,1)","rgba(94,174,245,1)","rgba(96,177,248,1)","rgba(96,177,248,1)","rgba(39,64,139,1)","rgba(79,140,213,1)","rgba(77,136,210,1)","rgba(96,177,248,1)","rgba(91,167,239,1)","rgba(88,160,232,1)","rgba(88,160,232,1)","rgba(88,160,232,1)","rgba(96,177,248,1)","rgba(94,174,245,1)","rgba(97,181,252,1)","rgba(55,91,166,1)","rgba(91,167,239,1)","rgba(97,181,252,1)","rgba(97,181,252,1)","rgba(84,150,223,1)","rgba(73,127,200,1)","rgba(81,143,216,1)","rgba(81,143,216,1)","rgba(73,127,200,1)","rgba(94,174,245,1)","rgba(85,153,226,1)","rgba(88,160,232,1)","rgba(99,184,255,1)","rgba(99,184,255,1)"]}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.46835443037974683,0.93670886075949367,1.4050632911392404,1.8734177215189873,2.3417721518987342,2.8101265822784809,3.278481012658228,3.7468354430379747,4.2151898734177218,4.6835443037974684,5.1518987341772151,5.6202531645569618,6.0886075949367084,6.556962025316456,7.0253164556962027,7.4936708860759493,7.962025316455696,8.4303797468354436,8.8987341772151893,9.3670886075949369,9.8354430379746827,10.30379746835443,10.772151898734178,11.240506329113924,11.708860759493671,12.177215189873417,12.645569620253164,13.113924050632912,13.582278481012658,14.050632911392405,14.518987341772151,14.987341772151899,15.455696202531646,15.924050632911392,16.39240506329114,16.860759493670887,17.329113924050631,17.797468354430379,18.265822784810126,18.734177215189874,19.202531645569621,19.670886075949365,20.139240506329113,20.60759493670886,21.075949367088608,21.544303797468356,22.0126582278481,22.481012658227847,22.949367088607595,23.417721518987342,23.88607594936709,24.354430379746834,24.822784810126581,25.291139240506329,25.759493670886076,26.227848101265824,26.696202531645568,27.164556962025316,27.632911392405063,28.101265822784811,28.569620253164558,29.037974683544302,29.50632911392405,29.974683544303797,30.443037974683545,30.911392405063292,31.379746835443036,31.848101265822784,32.316455696202532,32.784810126582279,33.253164556962027,33.721518987341774,34.189873417721522,34.658227848101262,35.12658227848101,35.594936708860757,36.063291139240505,36.531645569620252,37],"y":[0.63222911516975988,0.62079161439966035,0.60921827198019662,0.59752071511810789,0.58571112150863036,0.57380217311267012,0.56180700522263016,0.54973915121125372,0.53761248342701085,0.52544115076265763,0.51323951347904262,0.50102207591264836,0.4888034177315454,0.4765981244294531,0.46442071776079641,0.45228558682067477,0.44020692046248111,0.42819864172283051,0.4162743448890821,0.40444723579995873,0.39273007591573456,0.38113513063254917,0.36967412224712598,0.35835818790519258,0.34719784279090266,0.33620294873725909,0.32538268836059525,0.31474554474713712,0.30429928664798217,0.29405095907173928,0.284006879102636,0.27417263671697051,0.26455310032298995,0.25515242670902433,0.24597407505219268,0.23702082461522911,0.22829479574176559,0.21979747375042202,0.21152973532482672,0.20349187699964905,0.19568364535121568,0.18810426851461542,0.18075248866662999,0.17362659513463527,0.16672445781508011,0.16004356061056627,0.1535810346212946,0.14733369085409267,0.14129805223988734,0.13547038477784565,0.12984672765108213,0.12442292218449014,0.11919463953961895,0.11415740706437816,0.10930663323655952,0.10463763115961272,0.10014564058674334,0.095825848465203242,0.091673408006631957,0.08768345630152713,0.083851130506445395,0.080171582641448066,0.076639993042707494,0.073251582521192529,0.07000162328307101,0.066885448671016978,0.06389846178811609,0.06103614306763433,0.058294056852666837,0.055667857049723123,0.053153291919731879,0.050746208068856546,0.048442553699988858,0.046238381183911721,0.044129849006962471,0.042113223149653115,0.040184877948166733,0.038341296488000838,0.036579070576315403,0.03489490033679838],"text":"","type":"scatter","mode":"lines","name":"fitted values","line":{"width":3.7795275590551185,"color":"rgba(99,184,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0],"y":[0],"name":"a7610eff20926533caadd704008989de","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#63B8FF"],[0.0033444816053511705,"#63B8FF"],[0.006688963210702341,"#63B7FE"],[0.01003344481605351,"#62B7FE"],[0.013377926421404682,"#62B6FD"],[0.016722408026755852,"#62B6FD"],[0.02006688963210702,"#62B5FD"],[0.023411371237458192,"#62B5FC"],[0.026755852842809364,"#61B5FC"],[0.030100334448160532,"#61B4FB"],[0.033444816053511704,"#61B4FB"],[0.036789297658862873,"#61B3FB"],[0.040133779264214041,"#61B3FA"],[0.043478260869565216,"#61B2FA"],[0.046822742474916385,"#60B2F9"],[0.05016722408026756,"#60B2F9"],[0.053511705685618728,"#60B1F9"],[0.056856187290969903,"#60B1F8"],[0.060200668896321065,"#60B0F8"],[0.06354515050167224,"#5FB0F7"],[0.066889632107023408,"#5FAFF7"],[0.070234113712374577,"#5FAFF6"],[0.073578595317725745,"#5FAFF6"],[0.076923076923076927,"#5FAEF6"],[0.080267558528428082,"#5EAEF5"],[0.083612040133779264,"#5EADF5"],[0.086956521739130432,"#5EADF4"],[0.090301003344481615,"#5EACF4"],[0.093645484949832769,"#5EACF4"],[0.096989966555183951,"#5EACF3"],[0.10033444816053512,"#5DABF3"],[0.10367892976588629,"#5DABF2"],[0.10702341137123746,"#5DAAF2"],[0.11036789297658864,"#5DAAF2"],[0.11371237458193981,"#5DA9F1"],[0.11705685618729098,"#5CA9F1"],[0.12040133779264213,"#5CA9F0"],[0.12374581939799331,"#5CA8F0"],[0.12709030100334448,"#5CA8F0"],[0.13043478260869565,"#5CA7EF"],[0.13377926421404682,"#5BA7EF"],[0.13712374581939801,"#5BA6EE"],[0.14046822742474915,"#5BA6EE"],[0.14381270903010032,"#5BA6EE"],[0.14715719063545149,"#5BA5ED"],[0.15050167224080269,"#5BA5ED"],[0.15384615384615385,"#5AA4EC"],[0.15719063545150502,"#5AA4EC"],[0.16053511705685616,"#5AA4EC"],[0.16387959866220736,"#5AA3EB"],[0.16722408026755853,"#5AA3EB"],[0.1705685618729097,"#59A2EA"],[0.17391304347826086,"#59A2EA"],[0.17725752508361206,"#59A1EA"],[0.18060200668896323,"#59A1E9"],[0.18394648829431437,"#59A1E9"],[0.18729096989966554,"#58A0E8"],[0.19063545150501673,"#58A0E8"],[0.1939799331103679,"#589FE8"],[0.19732441471571907,"#589FE7"],[0.20066889632107024,"#589EE7"],[0.20401337792642141,"#579EE6"],[0.20735785953177258,"#579EE6"],[0.21070234113712374,"#579DE6"],[0.21404682274247491,"#579DE5"],[0.21739130434782608,"#579CE5"],[0.22073578595317728,"#569CE4"],[0.22408026755852842,"#569CE4"],[0.22742474916387961,"#569BE4"],[0.23076923076923075,"#569BE3"],[0.23411371237458195,"#569AE3"],[0.23745819397993312,"#569AE2"],[0.24080267558528426,"#5599E2"],[0.24414715719063546,"#5599E2"],[0.24749163879598662,"#5599E1"],[0.25083612040133779,"#5598E1"],[0.25418060200668896,"#5598E0"],[0.25752508361204013,"#5497E0"],[0.2608695652173913,"#5497E0"],[0.26421404682274247,"#5497DF"],[0.26755852842809363,"#5496DF"],[0.2709030100334448,"#5496DE"],[0.27424749163879603,"#5395DE"],[0.27759197324414714,"#5395DE"],[0.28093645484949831,"#5394DD"],[0.28428093645484953,"#5394DD"],[0.28762541806020064,"#5394DC"],[0.29096989966555187,"#5293DC"],[0.29431438127090298,"#5293DC"],[0.2976588628762542,"#5292DB"],[0.30100334448160537,"#5292DB"],[0.30434782608695649,"#5292DA"],[0.30769230769230771,"#5291DA"],[0.31103678929765888,"#5191DA"],[0.31438127090301005,"#5190D9"],[0.31772575250836121,"#5190D9"],[0.32107023411371233,"#518FD9"],[0.32441471571906355,"#518FD8"],[0.32775919732441472,"#508FD8"],[0.33110367892976589,"#508ED7"],[0.33444816053511706,"#508ED7"],[0.33779264214046822,"#508DD7"],[0.34113712374581939,"#508DD6"],[0.34448160535117056,"#4F8DD6"],[0.34782608695652173,"#4F8CD5"],[0.3511705685618729,"#4F8CD5"],[0.35451505016722412,"#4F8BD5"],[0.35785953177257523,"#4F8BD4"],[0.36120401337792646,"#4E8BD4"],[0.36454849498327757,"#4E8AD3"],[0.36789297658862874,"#4E8AD3"],[0.37123745819397996,"#4E89D3"],[0.37458193979933108,"#4E89D2"],[0.3779264214046823,"#4D88D2"],[0.38127090301003347,"#4D88D1"],[0.38461538461538464,"#4D88D1"],[0.38795986622073581,"#4D87D1"],[0.39130434782608692,"#4D87D0"],[0.39464882943143814,"#4C86D0"],[0.39799331103678931,"#4C86CF"],[0.40133779264214048,"#4C86CF"],[0.40468227424749165,"#4C85CF"],[0.40802675585284282,"#4C85CE"],[0.41137123745819398,"#4B84CE"],[0.41471571906354515,"#4B84CD"],[0.41806020066889632,"#4B84CD"],[0.42140468227424749,"#4B83CD"],[0.42474916387959871,"#4B83CC"],[0.42809364548494983,"#4B82CC"],[0.43143812709030099,"#4A82CC"],[0.43478260869565216,"#4A82CB"],[0.43812709030100339,"#4A81CB"],[0.44147157190635455,"#4A81CA"],[0.44481605351170567,"#4A80CA"],[0.44816053511705684,"#4980CA"],[0.451505016722408,"#4980C9"],[0.45484949832775923,"#497FC9"],[0.4581939799331104,"#497FC8"],[0.46153846153846151,"#497EC8"],[0.46488294314381268,"#487EC8"],[0.4682274247491639,"#487EC7"],[0.47157190635451507,"#487DC7"],[0.47491638795986624,"#487DC6"],[0.47826086956521741,"#487CC6"],[0.48160535117056852,"#477CC6"],[0.4849498327759198,"#477BC5"],[0.48829431438127091,"#477BC5"],[0.49163879598662208,"#477BC5"],[0.49498327759197325,"#477AC4"],[0.49832775919732436,"#467AC4"],[0.50167224080267558,"#4679C3"],[0.50501672240802675,"#4679C3"],[0.50836120401337792,"#4679C3"],[0.51170568561872909,"#4678C2"],[0.51505016722408026,"#4578C2"],[0.51839464882943143,"#4577C1"],[0.52173913043478259,"#4577C1"],[0.52508361204013376,"#4577C1"],[0.52842809364548493,"#4576C0"],[0.53177257525083621,"#4476C0"],[0.53511705685618727,"#4475BF"],[0.53846153846153844,"#4475BF"],[0.5418060200668896,"#4475BF"],[0.54515050167224077,"#4474BE"],[0.54849498327759205,"#4374BE"],[0.55183946488294322,"#4373BE"],[0.55518394648829428,"#4373BD"],[0.55852842809364545,"#4373BD"],[0.56187290969899661,"#4372BC"],[0.56521739130434789,"#4272BC"],[0.56856187290969906,"#4271BC"],[0.57190635451505012,"#4271BB"],[0.57525083612040129,"#4271BB"],[0.57859531772575246,"#4270BA"],[0.58193979933110374,"#4170BA"],[0.5852842809364549,"#416FBA"],[0.58862876254180596,"#416FB9"],[0.59197324414715713,"#416FB9"],[0.59531772575250841,"#416EB9"],[0.59866220735785958,"#406EB8"],[0.60200668896321075,"#406EB8"],[0.60535117056856191,"#406DB7"],[0.60869565217391297,"#406DB7"],[0.61204013377926425,"#406CB7"],[0.61538461538461542,"#3F6CB6"],[0.61872909698996659,"#3F6CB6"],[0.62207357859531776,"#3F6BB5"],[0.62541806020066881,"#3F6BB5"],[0.62876254180602009,"#3F6AB5"],[0.63210702341137126,"#3E6AB4"],[0.63545150501672243,"#3E6AB4"],[0.6387959866220736,"#3E69B4"],[0.64214046822742465,"#3E69B3"],[0.64548494983277593,"#3E68B3"],[0.6488294314381271,"#3D68B2"],[0.65217391304347827,"#3D68B2"],[0.65551839464882944,"#3D67B2"],[0.65886287625418061,"#3D67B1"],[0.66220735785953178,"#3D66B1"],[0.66555183946488294,"#3C66B0"],[0.66889632107023411,"#3C66B0"],[0.67224080267558528,"#3C65B0"],[0.67558528428093645,"#3C65AF"],[0.67892976588628762,"#3C64AF"],[0.68227424749163879,"#3B64AF"],[0.68561872909698995,"#3B64AE"],[0.68896321070234112,"#3B63AE"],[0.69230769230769229,"#3B63AD"],[0.69565217391304346,"#3B63AD"],[0.69899665551839463,"#3A62AD"],[0.7023411371237458,"#3A62AC"],[0.70568561872909707,"#3A61AC"],[0.70903010033444824,"#3A61AC"],[0.7123745819397993,"#3A61AB"],[0.71571906354515047,"#3960AB"],[0.71906354515050164,"#3960AA"],[0.72240802675585292,"#395FAA"],[0.72575250836120409,"#395FAA"],[0.72909698996655514,"#385FA9"],[0.73244147157190631,"#385EA9"],[0.73578595317725748,"#385EA8"],[0.73913043478260876,"#385DA8"],[0.74247491638795993,"#385DA8"],[0.74581939799331098,"#375DA7"],[0.74916387959866215,"#375CA7"],[0.75250836120401332,"#375CA7"],[0.7558528428093646,"#375CA6"],[0.75919732441471577,"#375BA6"],[0.76254180602006694,"#365BA5"],[0.76588628762541799,"#365AA5"],[0.76923076923076927,"#365AA5"],[0.77257525083612044,"#365AA4"],[0.77591973244147161,"#3659A4"],[0.77926421404682278,"#3559A4"],[0.78260869565217384,"#3558A3"],[0.78595317725752512,"#3558A3"],[0.78929765886287628,"#3558A2"],[0.79264214046822745,"#3557A2"],[0.79598662207357862,"#3457A2"],[0.79933110367892968,"#3457A1"],[0.80267558528428096,"#3456A1"],[0.80602006688963213,"#3456A1"],[0.80936454849498329,"#3355A0"],[0.81270903010033446,"#3355A0"],[0.81605351170568563,"#33559F"],[0.8193979933110368,"#33549F"],[0.82274247491638797,"#33549F"],[0.82608695652173914,"#32539E"],[0.8294314381270903,"#32539E"],[0.83277591973244147,"#32539E"],[0.83612040133779264,"#32529D"],[0.83946488294314381,"#32529D"],[0.84280936454849498,"#31529C"],[0.84615384615384615,"#31519C"],[0.84949832775919742,"#31519C"],[0.85284280936454848,"#31509B"],[0.85618729096989965,"#30509B"],[0.85953177257525082,"#30509B"],[0.86287625418060199,"#304F9A"],[0.86622073578595327,"#304F9A"],[0.86956521739130432,"#304F99"],[0.87290969899665549,"#2F4E99"],[0.87625418060200677,"#2F4E99"],[0.87959866220735783,"#2F4D98"],[0.88294314381270911,"#2F4D98"],[0.88628762541806017,"#2F4D98"],[0.88963210702341133,"#2E4C97"],[0.89297658862876261,"#2E4C97"],[0.89632107023411367,"#2E4C96"],[0.89966555183946495,"#2E4B96"],[0.90301003344481601,"#2D4B96"],[0.90635451505016718,"#2D4A95"],[0.90969899665551845,"#2D4A95"],[0.91304347826086951,"#2D4A95"],[0.91638795986622079,"#2D4994"],[0.91973244147157196,"#2C4994"],[0.92307692307692302,"#2C4993"],[0.9264214046822743,"#2C4893"],[0.92976588628762535,"#2C4893"],[0.93311036789297663,"#2B4792"],[0.9364548494983278,"#2B4792"],[0.93979933110367886,"#2B4792"],[0.94314381270903014,"#2B4691"],[0.9464882943143812,"#2B4691"],[0.94983277591973247,"#2A4691"],[0.95317725752508375,"#2A4590"],[0.95652173913043481,"#2A4590"],[0.95986622073578598,"#2A448F"],[0.96321070234113704,"#29448F"],[0.96655518394648832,"#29448F"],[0.9698996655518396,"#29438E"],[0.97324414715719065,"#29438E"],[0.97658862876254182,"#29438E"],[0.97993311036789288,"#28428D"],[0.98327759197324416,"#28428D"],[0.98662207357859544,"#28418C"],[0.98996655518394649,"#28418C"],[0.99331103678929766,"#27418C"],[0.99665551839464872,"#27408B"],[1,"#27408B"]],"colorbar":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"thickness":23.039999999999996,"title":"DaysListed","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"tickmode":"array","ticktext":["0","10","20","30"],"tickvals":[0.0016666666666666668,0.27103603603603599,0.54040540540540538,0.80977477477477477],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":48.949771689497723},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Idaho Falls Animals Shelter Cat Adoptions","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.8500000000000001,38.850000000000001],"tickmode":"array","ticktext":["0","10","20","30"],"tickvals":[0,10.000000000000002,20,30],"categoryorder":"array","categoryarray":["0","10","20","30"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Days Listed","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.050000000000000003,1.05],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Gender","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"DaysListed","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"30a8750d5291":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"},"30a854ff1bb3":{"x":{},"y":{},"colour":{}}},"cur_data":"30a8750d5291","visdat":{"30a8750d5291":["function (y) ","x"],"30a854ff1bb3":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<!--- End of Add content area.  ------------------>
</div>
</div>
<div id="tests-6" class="section level4">
<h4>Tests</h4>
<div style="padding-left:125px;color:black;">
<!-- Add your customizations in the area below: -->
<hr />
<div id="simple-logistic-regression-model"
class="section level5 tabset tabset-pills tabset-fade">
<h5 class="tabset tabset-pills tabset-fade">Simple Logistic Regression
Model</h5>
<div style="float:left;width:125px;" align="center">
<p><img src="Images/BinomYQuantX.png" width=58px;></p>
</div>
<p>Regression for a qualitative binary response variable <span
class="math inline">\((Y_i = 0\)</span> or <span
class="math inline">\(1)\)</span> using a single (typically
quantitative) explanatory variable.</p>
<div id="overview-11" class="section level6">
<h6>Overview</h6>
<div style="padding-left:125px;">
<p>The probability that <span class="math inline">\(Y_i = 1\)</span>
given the observed value of <span class="math inline">\(x_i\)</span> is
called <span class="math inline">\(\pi_i\)</span> and is modeled by the
equation:</p>
<div
style="float:right;font-size:.8em;background-color:lightgray;padding:5px;border-radius:4px;">
<a style="color:darkgray;" href="javascript:showhide('simplelogisticlatexrcode')">Math
Code</a>
</div>
<div id="simplelogisticlatexrcode" style="display:none;">
<pre><code>$$
  P(Y_i = 1|\, x_i) = \frac{e^{\beta_0 + \beta_1 x_i}}{1+e^{\beta_0 + \beta_1 x_i}} = \pi_i
$$</code></pre>
</div>
<center>
<span class="tooltipr"> <span class="math inline">\(P(\)</span> <span
class="tooltiprtext">The “P” stands for “Probability that…”</span>
</span><span class="tooltipr"> <span class="math inline">\(Y_i\)</span>
<span class="tooltiprtext">The response variable. The “i” denotes that
this is the y-value for individual “i”, where “i” is 1, 2, 3,… and so on
up to <span class="math inline">\(n\)</span>, the sample size.</span>
</span><span class="tooltipr"> <span class="math inline">\(= 1\)</span>
<span class="tooltiprtext">Equals 1… This states that we are assuming
that the probability that the response variable <span
class="math inline">\(Y_i\)</span> is a 1 for the current
individual.</span> </span><span class="tooltipr"> <span
class="math inline">\(| x_i)\)</span> <span class="tooltiprtext">Given
<span class="math inline">\(x_i\)</span>… in other words, the “|” says
“given” and <span class="math inline">\(x_i\)</span> means the x-value
of the current individual.</span> </span><span class="tooltipr"> <span
class="math inline">\(=\)</span> <span class="tooltiprtext">Equals
sign.</span> </span><span class="tooltipr"> <span
class="math inline">\(\displaystyle\frac{e^{\beta_0 + \beta_1 x_i}}{1 +
e^{\beta_0 + \beta_1 x_i}}\)</span> <span class="tooltiprtext">The
logistic regression equation where <span
class="math inline">\(e=2.71828...\)</span> is the “natural constant”
number and <span class="math inline">\(\beta_0\)</span> is the
y-intercept and <span class="math inline">\(\beta_1\)</span> is teh
slope.</span> </span><span class="tooltipr"> <span
class="math inline">\(= \pi_i\)</span> <span class="tooltiprtext">The
<span class="math inline">\(\pi_i\)</span> stands for the probability of
individual <span class="math inline">\(i\)</span> having a y-value equal
to 1 given their <span class="math inline">\(x_i\)</span> value. It is
the short hand notation for <span class="math inline">\(P(Y_i = 1
|x_i)\)</span>. (It is NOT the number 3.14…)</span> </span>
</center>
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>Part</th>
<th>What it means</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(P(Y_i = 1| x_i)\)</span></td>
<td>- The probability of a success <span class="math inline">\(Y_i =
1\)</span> given the information contained in the explanatory
variable(s) <br> - The symbol used to represent the notation in logisitc
regression is <span class="math inline">\(\pi_i\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(Y_i\)</span> (<strong>Responsive
Variable</strong>)</td>
<td>Describes the probability of $Y_i = $ 1 or 0 for a given
scenario.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x_i\)</span> (<strong>Explanatory
variable</strong>)</td>
<td>Describes the observed value and how it effects the <span
class="math inline">\(Y_i\)</span></td>
</tr>
<tr class="even">
<td><span
class="math inline">\(\frac{e^{\text{stuff}}}{1+e^{\text{stuff}}}\)</span></td>
<td>The content for “stuff” being <strong>simple linear regression of
the form</strong> <span class="math inline">\(\beta_0 +
\beta_{1x_i}\)</span></td>
</tr>
</tbody>
</table>
<p><br/></p>
<p>The coefficents <span class="math inline">\(\beta_0\)</span> and
<span class="math inline">\(\beta_1\)</span> are difficult to interpret
directly. Typicall <span class="math inline">\(e^{\beta_0}\)</span> and
<span class="math inline">\(e^{\beta_1}\)</span> are interpreted
instead. The value of <span class="math inline">\(e^{\beta_0}\)</span>
or <span class="math inline">\(e^{\beta_1}\)</span> denotes the relative
change in the odds that <span class="math inline">\(Y_i=1\)</span>. The
odds that <span class="math inline">\(Y_i=1\)</span> are <span
class="math inline">\(\frac{\pi_i}{1-\pi_i}\)</span>.</p>
<hr />
<p><strong>Examples:</strong> <a
href="./Analyses/Logistic%20Regression/Examples/challengerLogisticReg.html">challenger</a>
| <a
href="./Analyses/Logistic%20Regression/Examples/mouseLogisticReg.html">mouse</a></p>
<hr />
</div>
</div>
<div id="r-instructions-11" class="section level6">
<h6>R Instructions</h6>
<div style="padding-left:125px;">
<p><strong>Console</strong> Help Command: <code>?glm()</code></p>
<hr />
<p><strong><em>Perform a Logistic Regression</em></strong></p>
<a href="javascript:showhide('logistic1')">
<div class="hoverchunk">
<p><span class="tooltipr"> YourGlmName <span class="tooltiprtext">This
is some name you come up with that will become the R object that stores
the results of your logistic regression <code>glm()</code>
command.</span> </span><span class="tooltipr">  &lt;-  <span
class="tooltiprtext">This is the “left arrow” assignment operator that
stores the results of your <code>glm()</code> code into
<code>YourGlmName</code>.</span> </span><span class="tooltipr"> glm(
<span class="tooltiprtext">glm( is an R function that stands for
“General Linear Model”. It works in a similar way that the
<code>lm(</code> function works except that it requires a
<code>family=</code> option to be specified at the end of the
command.</span> </span><span class="tooltipr"> Y  <span
class="tooltiprtext">Y is your binary response variable. It must consist
of only 0’s and 1’s. Since TRUE’s = 1’s and FALSE’s = 0’s in R, Y could
be a logical statement like (Price &gt; 100) or (Animal == “Cat”) if
your Y-variable wasn’t currently coded as 0’s and 1’s.</span>
</span><span class="tooltipr"> ~  <span class="tooltiprtext">The tilde
symbol ~ is used to tell R that Y should be treated as a function of the
explanatory variable X.</span> </span><span class="tooltipr"> X, <span
class="tooltiprtext">X is the explanatory variable (typically
quantitative) that will be used to explain the probability that the
response variable Y is a 1.</span> </span><span class="tooltipr">  data
= NameOfYourDataset,<br />
<span class="tooltiprtext">NameOfYourDataset is the name of the dataset
that contains Y and X. In other words, one column of your dataset would
be called Y and another column would be called X.</span> </span><span
class="tooltipr">  family=binomial) <span class="tooltiprtext">The
family=binomial command tells the <code>glm(</code> function to perform
a logistic regression. It turns out that <code>glm</code> can perform
many different types of regressions, but we only study it as a tool to
perform a logistic regression in this course.</span> </span><br/><span
class="tooltipr"> summary(YourGlmName) <span class="tooltiprtext">The
<code>summary</code> command allows you to print the results of your
logistic regression that were previously saved in
<code>YourGlmName</code>.</span> </span></p>
</div>
<p></a></p>
<div id="logistic1" style="display:none;">
<p>Example output from a regression. Hover each piece to learn more.</p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Call:<br/> glm(formula = am ~ disp, family =
binomial, data = mtcars) <span class="tooltiprouttext">This is simply a
statement of your original glm(…) “call” that you made when performing
your regression. It allows you to verify that you ran what you thought
you ran in the glm(…).</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td colspan="2">
<span class="tooltiprout"> Deviance Residuals: <span
class="tooltiprouttext">Deviance residuals are a measure of how far the
fitted probability for <span class="math inline">\(\pi_i\)</span> has
differed from the actual outcome of <span
class="math inline">\(Y_i\)</span> in terms of the log of the fitted
probability space. (This is a fairly complicated idea.) </span>
</td>
</tr>
<tr>
<td align="right">
<span class="tooltiprout"> Min<br/>   -1.5651 <span
class="tooltiprouttext">“min” gives the value of the residual that is
furthest below the regression line. Ideally, the magnitude of this value
would be about equal to the magnitude of the largest positive residual
(the max) because the hope is that the residuals are normally
distributed around the line.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 1Q<br/>   -0.6648 <span
class="tooltiprouttext">“1Q” gives the first quartile of the residuals,
which will always be negative, and ideally would be about equal in
magnitude to the third quartile.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> Median<br/>   -0.2460 <span
class="tooltiprouttext">“Median” gives the median of the residuals,
which would ideally would be about equal to zero. Note that because the
regression line is the least squares line, the mean of the residuals
will ALWAYS be zero, so it is never included in the output summary. This
particular median value of -0.2460 is a little smaller than zero than we
would hope for and suggests a right skew in the data because the mean
(0) is greater than the median (-0.2460) witnessing the residuals are
right skewed. This can also be seen in the maximum being much larger in
magnitude than the minimum.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 3Q<br/>   0.7276 <span
class="tooltiprouttext">“3Q” gives the third quartile of the residuals,
which would ideally would be about equal in magnitude to the first
quartile. In this case, it is pretty close, which helps us see that the
first quartile of residuals on either side of the line is behaving
fairly normally.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> Max</br>   2.2691 <span
class="tooltiprouttext">“Max” gives the maximum positive residuals,
which would ideally would be about equal in magnitude to the minimum
residual. In this case, it is much larger than the minimum, which helps
us see that the residuals are likely right skewed.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td colspan="2">
<span class="tooltiprout"> Coefficients: <span
class="tooltiprouttext">Notice that in your glm(…) you used only <span
class="math inline">\(Y\)</span> and <span
class="math inline">\(X\)</span>. You did type out any coefficients,
i.e., the <span class="math inline">\(\beta_0\)</span> or <span
class="math inline">\(\beta_1\)</span> of the regression model. These
coefficients are estimated by the glm(…) function and displayed in this
part of the output along with standard errors, t-values, and
p-values.</span> </span>
</td>
</tr>
<tr>
<td align="left">
</td>
<td align="right">
<span class="tooltiprout">   Estimate <span class="tooltiprouttext">To
learn more about the “Estimates” of the “Coefficients” see the
“Explanation” tab, “Estimating the Model Parameters” section for
details.</span>
</td>
<td align="right">
<span class="tooltiprout">   Std. Error <span class="tooltiprouttext">To
learn more about the “Standard Errors” of the “Coefficients” see the
“Explanation” tab, “Inference for the Model Parameters” section.</span>
</span>
</td>
<td align="right">
<span class="tooltiprout">   z value <span class="tooltiprouttext">The
test statistic is a regular old z-score. It is most reliable when the
sample size is “large.” It is a measurement of the number of standard
errors the estimate is from 0.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   Pr(&gt;|z|) <span
class="tooltiprouttext">This is the p-value, the probability of
observing a test statistic more extreme than Z. </span> </span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> (Intercept) <span
class="tooltiprouttext">This always says “Intercept” for any glm(…) you
run in R. That is because R always assumes there is a y-intercept for
your regression function.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   2.630849 <span class="tooltiprouttext">This
is the estimate of the y-intercept, <span
class="math inline">\(\beta_0\)</span>. It is called <span
class="math inline">\(b_0\)</span>. It is the value of the log of the
odds that <span class="math inline">\(Y_i=1\)</span> when <span
class="math inline">\(x_i\)</span> is zero. Remember to use <span
class="math inline">\(e^{b_0}\)</span> to interpret this values actual
effect on the odds.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   1.050170 <span class="tooltiprouttext">This
is the standard error of <span class="math inline">\(b_0\)</span>. It
tells you how much <span class="math inline">\(b_0\)</span> varies from
sample to sample. The closer to zero, the better.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 2.505 <span class="tooltiprouttext">The test
statistic for testing the hypothesis that <span
class="math inline">\(\beta_0 = 0\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 0.01224 <span class="tooltiprouttext">This is
the p-value of the test of the hypothesis that <span
class="math inline">\(\beta_0 = 0\)</span>. It measures the probability
of observing a z-score as extreme as the one observed. To compute it
yourself in R, use <code>pnorm(-abs(your z-value))*2</code>.</span>
</span>
</td>
<td align="left">
<span class="tooltiprout"> * <span class="tooltiprouttext">This is
called a “star”. One star means significant at the 0.1 level of <span
class="math inline">\(\alpha\)</span>.</span> </span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> disp <span class="tooltiprouttext">This is
always the name of your X-variable in your glm(Y ~ X, …).</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   -0.014604 <span
class="tooltiprouttext">This is the estimate of the slope, <span
class="math inline">\(\beta_1\)</span>. It is called <span
class="math inline">\(b_1\)</span>. It is the change in the log of the
odds that <span class="math inline">\(Y_i = 1\)</span> as X is increased
by 1 unit. Remember to use <span class="math inline">\(e^{b_1}\)</span>
to compute the actual effect on the odds.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   0.005168 <span class="tooltiprouttext">This
is the standard error of <span class="math inline">\(b_1\)</span>. It
tells you how much <span class="math inline">\(b_1\)</span> varies from
sample to sample. The closer to zero, the better.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> -2.826 <span class="tooltiprouttext">This is
the test statistic for testing the hypothesis that <span
class="math inline">\(\beta_1 = 0\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 0.00471 <span class="tooltiprouttext">This is
the p-value of the test of the hypothesis that <span
class="math inline">\(\beta_1 = 0\)</span>. To compute it yourself in R,
use <code>pnorm(-abs(your z-value))*2</code></span> </span>
</td>
<td align="left">
<span class="tooltiprout"> ** <span class="tooltiprouttext">This is
called a “star”. Three stars means significant at the 0.001 level of
<span class="math inline">\(\alpha\)</span>.</span> </span>
</td>
</tr>
</table>
<table class="rconsole">
<tr>
<td>
<span> --- </span>
</td>
</tr>
</table>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ’*’
0.05 ‘.’ 0.1 ‘ ’ 1 <span class="tooltiprouttext">These “codes” explain
what significance level the p-value is smaller than based on how many
“stars” * the p-value is labeled with in the Coefficients table
above.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> (Dispersion parameter for binomial family
taken to be 1) <span class="tooltiprouttext">This is a simplifying
assumption of the logistic regression. Overdispersion is a common
problem with logistic regression data, but is typically ignored. Unless
you become an expert in statistics, this is not something you need to
worry about.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout">   Null Deviance: <span
class="tooltiprouttext">The deviance of the null model. This is the
model that excludes any information from the x-variable, i.e., <span
class="math inline">\(\beta_1=0\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  43.230 <span class="tooltiprouttext"></span>
</span>
</td>
<td align="right">
<span class="tooltiprout">  on 31 degrees of freedom <span
class="tooltiprouttext">The residual degrees of freedom. The higher this
number, the more reliable the p-values will be from the logistic
regression.</span> </span>
</td>
</tr>
</table>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Residual deviance: <span
class="tooltiprouttext">The sum of log of the squared residuals.
Essentially the resulting statistic of a goodness of fit test measuring
how well the data works with the logistic regression model. Using
pchisq(residual deviance, df residual deviance, lower.tail=FALSE) gives
the p-value for this goodness of fit test. However, the residual
deviance only follows a chi-squared distribution with df residual
deviance when there are many repeated x-values, and all x-values have at
least a few replicates.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  29.732 <span class="tooltiprouttext">This
can be calculated by <code>sum(log(myglm$res^2))</code>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  on 30 degrees of freedom <span
class="tooltiprouttext">This is <span class="math inline">\(n-p\)</span>
where <span class="math inline">\(n\)</span> is the sample size and
<span class="math inline">\(p\)</span> is the number of parameters in
the regression model. In this case, there is a sample size of 32 and two
parameters, <span class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span>, so 32-2 = 30.</span> </span>
</td>
</tr>
</table>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> AIC: <span class="tooltiprouttext">As stated
in the R Help file for ?glm, “A version of Akaike’s An Information
Criterion…” The AIC is useful for comparing different models for the
same Y-variable. The glm model with the lowest AIC (which can go
negative) is the best model.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  33.732 <span class="tooltiprouttext">The AIC
for this particular model is 33.732. So if a different model (using the
same Y-variable as this model) can get a lower AIC, it is a better
model.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Number of Fisher Scoring iterations: <span
class="tooltiprouttext">If you have taken a class in Numerical Analysis,
this tells you how many iterations of the maximization algorithm were
required before converging to the “Estimates” of the parameters <span
class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span> found in the summary.</span>
</span>
</td>
<td align="right">
<span class="tooltiprout">  5 <span class="tooltiprouttext">This
implementation of glm required 5 Fisher Scoring iterations to converge.
Fewer iterations hints that the model is a better fit than when many
iterations are required.</span> </span>
</td>
</tr>
</table>
</div>
<p><br/></p>
<hr />
<p><strong><em>Diagnose the Goodness-of-Fit</em></strong></p>
<p>There are two ways to check the <strong>goodness of fit</strong> of a
logistic regression model.</p>
<div style="padding-left:25px;">
<p><strong>Option 1</strong>: Hosmer-Lemeshow Goodness-of-Fit Test (Most
Common)</p>
<p>To check the <strong>goodness of fit</strong> of a logistic
regression model where there are <strong>few or no replicated <span
class="math inline">\(x\)</span>-values</strong> use the Hosmer-Lemeshow
Test.</p>
<a href="javascript:showhide('goodnessoffit2')">
<div class="hoverchunk">
<p><span class="tooltipr"> library(ResourceSelection) <span
class="tooltiprtext">This loads the ResourceSelection R package so that
you can access the hoslem.test() function. You may need to run the code:
install.packages(“ResourceSelection”) first.</span> </span><br/><span
class="tooltipr"> hoslem.test( <span class="tooltiprtext">This R
function performs the Hosmer-Lemeshow Goodness of Fit Test. See the
“Explanation” file to learn about this test.</span> </span><span
class="tooltipr"> YourGlmName <span
class="tooltiprtext"><code>YourGlmName</code> is the name of your glm(…)
code that you created previously.</span> </span><span class="tooltipr">
$y,  <span class="tooltiprtext">ALWAYS type a “y” here. This gives you
the actual binary (0,1) y-values of your logistic regression. The
goodness of fit test will compare these actual values to your predicted
probabilities for each value in order to see if the model is a “good
fit.”</span> </span><span class="tooltipr"> YourGlmName <span
class="tooltiprtext"><code>YourGlmName</code> is the name you used to
save the results of your glm(…) code.</span> </span><span
class="tooltipr"> $fitted,  <span class="tooltiprtext">ALWAYS type
“fitted” here. This gives you the fitted probabilities <span
class="math inline">\(\pi_i\)</span> of your logistic regression.</span>
</span><span class="tooltipr"> g=10) <span class="tooltiprtext">The
“g=10” is the default option for the value of g. The g is the number of
groups to run the goodness of fit test on. Just leave it at 10 unless
you are told to do otherwise. Ask your teacher for more information if
you are interested.</span> </span></p>
</div>
<p></a></p>
<div id="goodnessoffit2" style="display:none;">
<pre><code>## 
##  Hosmer and Lemeshow goodness of fit (GOF)
##  test
## 
## data:  myglm$y, myglm$fitted
## X-squared = 5.7327, df = 8, p-value = 0.6771</code></pre>
<p>Note that the null hypothesis of the goodness-of-fit test is that
“the logistic regression is a good fit.” So we actually don’t want to
“reject the null” in this case. So a large p-value here means our
logistic regression fits the data satisfactorily. A small p-value
implies a poor fit and the results of the logistic regression should not
be fully trusted.</p>
</div>
<p><br/></p>
<p><strong>Option 2</strong>: Deviance Goodness-of-fit Test (Less
Common)</p>
<p>In some cases, there are <strong>many replicated <span
class="math inline">\(x\)</span>-values</strong> for
<strong>all</strong> x-values, i.e., each value of x is repeated more
than 50 times. Though this is rare, it is good to use the <em>deviance
goodness-of-fit test</em> whenever this happens.</p>
<a href="javascript:showhide('goodnessoffit1')">
<div class="hoverchunk">
<p><span class="tooltipr"> pchisq( <span class="tooltiprtext">The
<code>pchisq</code> command allows you to compute p-values from the
chi-squared distribution.</span> </span><span class="tooltipr"> residual
deviance,  <span class="tooltiprtext">The residual deviance is shown at
the bottom of the output of your <code>summary(YourGlmName)</code> and
should be typed in here as a number like 25.3.</span> </span><span
class="tooltipr"> df for residual deviance,  <span
class="tooltiprtext">The df for the residual deviance is also shown at
the bottom of the output of your
<code>summary(YourGlmName)</code>.</span> </span><span class="tooltipr">
lower.tail=FALSE) <span class="tooltiprtext">This command ensures you
find the probability of the chi-squared distribution being as extreme or
more extreme than the observed value of residual deviance.</span>
</span></p>
</div>
<p></a></p>
<div id="goodnessoffit1" style="display:none;">
<pre><code>## 
## Call:
## glm(formula = am ~ disp, family = binomial, data = mtcars)
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)  2.630849   1.050170   2.505  0.01224
## disp        -0.014604   0.005168  -2.826  0.00471
##               
## (Intercept) * 
## disp        **
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 43.230  on 31  degrees of freedom
## Residual deviance: 29.732  on 30  degrees of freedom
## AIC: 33.732
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<pre><code>## [1] 0.479439</code></pre>
<p>The null hypothesis of the goodness-of-fit test is that the logistic
regression is a good fit of the data. So a large p-value (like 0.479) is
good because it allows us to trust the results of our logistic
regression. When the p-value becomes very small, we must “reject the
null” and conclude a poor fit, which implies that we should not trust
the results of the logistic regression.</p>
</div>
</div>
<p><br/></p>
<hr />
<p><strong><em>Plot the Regression</em></strong></p>
<div class="tab">
<p><button class="tablinks" onclick="openTab(event, 'LogisticBaseplot')">Base
R</button>
<button class="tablinks" onclick="openTab(event, 'Logisticggplot')">ggplot2</button></p>
</div>
<div id="LogisticBaseplot" class="tabcontent">
<p>
<a href="javascript:showhide('LogisticBaseplot2')">
<div class="hoverchunk">
<p><span class="tooltipr"> plot( <span class="tooltiprtext">The plot
function allows us to draw a scatterplot where the y-axis is only 0’s or
1’s and the x-axis is quantitative.</span> </span><span
class="tooltipr"> Y <span class="tooltiprtext">Y should be some logical
statement like Fail &gt; 0 or sex == “B” or height &lt; 68. In other
words, Y needs to be a collection of 0’s and 1’s.</span> </span><span
class="tooltipr">  ~  <span class="tooltiprtext">The tilde is read “Y on
X.”</span> </span><span class="tooltipr"> X, <span
class="tooltiprtext">X is some quantitative variable.</span>
</span><span class="tooltipr">  data= <span class="tooltiprtext">Tell
the plot which data set to use. X and Y are columns of that data
set.</span> </span><span class="tooltipr"> YourDataSet <span
class="tooltiprtext">The name of your data set.</span> </span><span
class="tooltipr"> ) <span class="tooltiprtext">Closing parenthesis for
plot(…) function.</span> </span><br/><span class="tooltipr"> curve(
<span class="tooltiprtext">A function in R that draws a “curve” on a
plot. Using add=TRUE puts the curve onto the current plot.</span>
</span><span class="tooltipr"> exp( <span class="tooltiprtext">This
allows you to compute e to the power of something. So exp(1) = e, exp(2)
= e^2 and so on.</span> </span><span class="tooltipr"> <span
class="math inline">\(b_0\)</span> + <span class="tooltiprtext">This is
the “Intercept” estimate from your logistic regression summary
output.</span> </span><span class="tooltipr">  <span
class="math inline">\(b_1\)</span> <span class="tooltiprtext">This is
the slope estimate from your logistic regression summary output.</span>
</span><span class="tooltipr"> *x <span class="tooltiprtext">The curve
function demands you ALWAYS use a lower-case “x” in this
function.</span> </span><span class="tooltipr"> ) <span
class="tooltiprtext">Closing parenthesis.</span> </span><span
class="tooltipr"> / <span class="tooltiprtext">The division
symbol.</span> </span><span class="tooltipr"> (1 + <span
class="tooltiprtext">Required for the formula.</span>
</span><span class="tooltipr">  exp(<span
class="math inline">\(b_0\)</span> + <span
class="math inline">\(b_1\)</span>*x) <span class="tooltiprtext">This
needs to match exactly the first version of this statement.</span>
</span><span class="tooltipr"> ), <span class="tooltiprtext">Closing
parenthesis for the denominator.</span> </span><span class="tooltipr">
 add = TRUE) <span class="tooltiprtext">This makes the curve be added to
the current plot. If it is left out, the curve will be drawn in a new
plot.</span> </span></p>
</div>
<p></a></p>
<div id="LogisticBaseplot2" style="display:none;">
<p><img src="index_files/figure-html/unnamed-chunk-145-1.png" width="672" /></p>
</div>
</p>
</div>
<div id="Logisticggplot" class="tabcontent">
<p>
<a href="javascript:showhide('Logisticggplot2')">
<div class="hoverchunk">
<p><span class="tooltipr"> ggplot( <span class="tooltiprtext">The
ggplot(…) function is used to create a basic ggplot frame.</span>
</span><span class="tooltipr"> data=YourDataSetName, <span
class="tooltiprtext">Use this to specify the name of your data
set.</span> </span><span class="tooltipr">  aes( <span
class="tooltiprtext">The aes(…) function stands for “aesthetics” and
tells the ggplot which variables to match up with the x-axis and y-axis
of the graph as well as other visual things like the type of plotting
characters, size of plotting characters, color, fill, and so on.</span>
</span><span class="tooltipr"> x=X, <span class="tooltiprtext">Use
x=nameOfYourXvariable to declare the x-axis of your graph.</span>
</span><span class="tooltipr"> y=Y <span class="tooltiprtext">Use
y=nameOfYourYvariable to declare the y-axis of your graph. If your
y-variable is a logical expression, like height&gt;60 then you must use
y=as.numeric(height&gt;60).</span> </span><span class="tooltipr"> )
<span class="tooltiprtext">Closing parenthesis for aes(…)
function.</span> </span><span class="tooltipr"> ) <span
class="tooltiprtext">Closing parenthesis for ggplot(…) function.</span>
</span><span class="tooltipr">  + <span class="tooltiprtext">The plus
sign adds a new layer to the ggplot.</span> </span><br/><span
class="tooltipr">   geom_point( <span class="tooltiprtext">Tells the
plot to add the physical geometry of “points” to the plot.</span>
</span><span class="tooltipr"> ) <span class="tooltiprtext">Closing
parenthesis for the geom_point() function.</span> </span><span
class="tooltipr">  + <span class="tooltiprtext">Add another layer to the
plot.</span> </span><br/><span class="tooltipr">   geom_smooth( <span
class="tooltiprtext">Add a smoothing line to the graph.</span>
</span><span class="tooltipr"> method=“glm”, <span
class="tooltiprtext">This adds a general linear model to the
graph.</span> </span><span class="tooltipr"> method.args =
list(family=“binomial”), <span class="tooltiprtext">This tells the
method=“glm” to choose specifically the “binomial” model, otherwise
known as the “logistic regression” model.</span> </span><span
class="tooltipr">  se=FALSE <span class="tooltiprtext">Turn off the
displaying of the confidence band around the logistic regression. You
can turn this on if you know what it means.</span> </span><span
class="tooltipr"> ) <span class="tooltiprtext">Closing parenthesis for
the geom_smooth() function.</span> </span><span class="tooltipr">  +
<span class="tooltiprtext">Add another layer to the ggplot.</span>
</span><br/><span class="tooltipr">   theme_bw() <span
class="tooltiprtext">Give the graph a basic black and white theme. Other
themes are possible, see ?theme_ in your Console.</span> </span></p>
</div>
<p></a></p>
<div id="Logisticggplot2" style="display:none;">
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-146-1.png" width="672" /></p>
</div>
</p>
</div>
<p><br/></p>
<hr />
<p><strong><em>Predict Probabilities</em></strong></p>
<p>To predict the probability that <span
class="math inline">\(Y_i=1\)</span> for a given <span
class="math inline">\(x\)</span>-value, use the code</p>
<a href="javascript:showhide('LogisticPredict')">
<div class="hoverchunk">
<p><span class="tooltipr"> predict( <span class="tooltiprtext">The
predict() function allows us to use the regression model that was
obtained from glm() to predict the probability that <span
class="math inline">\(Y_i = 1\)</span> for a given <span
class="math inline">\(X_i\)</span>.</span> </span><span
class="tooltipr"> YourGlmName,  <span
class="tooltiprtext"><code>YourGlmName</code> is the name of the object
you created when you performed your logistic regression using
glm().</span> </span><span class="tooltipr"> newdata =  <span
class="tooltiprtext">The <code>newdata =</code> command allows you to
specify the x-values for which you want to obtain predicted
probabilities that <span class="math inline">\(Y_i=1\)</span>.</span>
</span><span class="tooltipr"> data.frame(xVariableName =
someNumericValue),  <span class="tooltiprtext">The xVariableName is the
same one you used in your glm(y ~ x, …) statement for “x”. Input any
desired value for the “someNumericValue” spot. Then, the predict code
uses the logistic regression model equation to calculate a predicted
probability that <span class="math inline">\(Y_i = 1\)</span> for the
given <span class="math inline">\(x_i\)</span> value that you
specify.</span> </span><span class="tooltipr"> type = “response”) <span
class="tooltiprtext">The type = “response” options specifies that you
want predicted probabilities. There are other options available. See
?predict.glm for details.</span> </span></p>
</div>
<p></a></p>
<div id="LogisticPredict" style="display:none;">
<div class="sourceCode" id="cb128"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a>myglm <span class="ot">&lt;-</span> <span class="fu">glm</span>(am <span class="sc">~</span> disp, <span class="at">data =</span> mtcars, <span class="at">family =</span> binomial)</span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a><span class="fu">predict</span>(myglm, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">disp =</span> <span class="dv">200</span>), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>##         1 
## 0.4280016</code></pre>
</div>
<hr />
</div>
</div>
<div id="explanation-10" class="section level6">
<h6>Explanation</h6>
<div style="padding-left:125px;">
<p>Simple Logistic Regression is used when</p>
<ul>
<li>the response variable is binary <span
class="math inline">\((Y_i=0\)</span> or <span
class="math inline">\(1)\)</span>, and</li>
<li>there is a single explanatory variable <span
class="math inline">\(X\)</span> that is typically quantitative but
could be qualitative (if <span class="math inline">\(X\)</span> is
binary or ordinal).</li>
</ul>
<hr />
<p><strong><em>The Model</em></strong></p>
<p>Since <span class="math inline">\(Y_i\)</span> is binary (can only be
0 or 1) the model focuses on describing the probability that <span
class="math inline">\(Y_i=1\)</span> for a given scenario. The
probability that <span class="math inline">\(Y_i = 1\)</span> given the
observed value of <span class="math inline">\(x_i\)</span> is called
<span class="math inline">\(\pi_i\)</span> and is modeled by the
equation</p>
<p><span class="math display">\[
  P(Y_i = 1|\, x_i) = \frac{e^{\beta_0 + \beta_1 x_i}}{1+e^{\beta_0 +
\beta_1 x_i}} = \pi_i
\]</span></p>
<p>The assumption is that for certain values of <span
class="math inline">\(X\)</span> the probability that <span
class="math inline">\(Y_i=1\)</span> is higher than for other values of
<span class="math inline">\(X\)</span>.</p>
<hr />
<p><strong><em>Interpretation</em></strong></p>
<p>This model for <span class="math inline">\(\pi_i\)</span> comes from
modeling the <em>log of the odds</em> that <span
class="math inline">\(Y_i=1\)</span> using a linear regression, i.e.,
<span class="math display">\[
  \log\underbrace{\left(\frac{\pi_i}{1-\pi_i}\right)}_{\text{Odds for}\
Y_i=1} = \underbrace{\beta_0 + \beta_1 x_i}_{\text{linear regression}}
\]</span> Beginning to solve this equation for <span
class="math inline">\(\pi_i\)</span> leads to the intermediate, but
important result that <span class="math display">\[
    \underbrace{\frac{\pi_i}{1-\pi_i}}_{\text{Odds for}\ Y_i=1} =
e^{\overbrace{\beta_0 + \beta_1 x_i}^{\text{linear regression}}} =
e^{\beta_0}e^{\beta_1 x_i}
\]</span> Thus, while the coefficients <span
class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span> are difficult to interpret
directly, <span class="math inline">\(e^{\beta_0}\)</span> and <span
class="math inline">\(e^{\beta_1}\)</span> have a valuable
interpretation. The value of <span
class="math inline">\(e^{\beta_0}\)</span> is interpreted as the odds
for <span class="math inline">\(Y_i=1\)</span> when <span
class="math inline">\(x_i = 0\)</span>. It may not be possible for a
given model to have <span class="math inline">\(x_i=0\)</span>, in which
case <span class="math inline">\(e^{\beta_0}\)</span> has no
interpretation. The value of <span
class="math inline">\(e^{\beta_1}\)</span> denotes the proportional
change in the odds that <span class="math inline">\(Y_i=1\)</span> for
every one unit increase in <span class="math inline">\(x_i\)</span>.</p>
<p>Notice that solving the last equation for <span
class="math inline">\(\pi_i\)</span> results in the logistic regression
model presented at the beginning of this page.</p>
<hr />
<p><strong><em>Hypothesis Testing</em></strong></p>
<p>Similar to linear regression, the hypothesis that <span
class="math display">\[
  H_0: \beta_1 = 0 \\
  H_a: \beta_1 \neq 0
\]</span> can be tested with a logistic regression. If <span
class="math inline">\(\beta_1 = 0\)</span>, then there is no
relationship between <span class="math inline">\(x_i\)</span> and the
log of the odds that <span class="math inline">\(Y_i = 1\)</span>. In
other words, <span class="math inline">\(x_i\)</span> is not useful in
predicting the probability that <span class="math inline">\(Y_i =
1\)</span>. If <span class="math inline">\(\beta_1 \neq 0\)</span>, then
there is information in <span class="math inline">\(x_i\)</span> that
can be utilized to predict the probability that <span
class="math inline">\(Y_i = 1\)</span>, i.e., the logistic regression is
meaningful.</p>
<hr />
<p><strong><em>Checking Model Assumptions
{#diagnostics}</em></strong></p>
<p>The model assumptions are not as clear in logistic regression as they
are in linear regression. For our purposes we will focus only on
considering the goodness of fit of the logistic regression model. If the
model appears to fit the data well, then it will be assumed to be
appropriate.</p>
<div style="padding-left:15px;">
<hr />
<p><strong><em>Deviance Goodness of Fit Test</em></strong></p>
<p>If there are replicated values of each <span
class="math inline">\(x_i\)</span>, then the deviance goodness of fit
test tests the hypotheses <span class="math display">\[
  H_0: \pi_i = \frac{e^{\beta_0 + \beta_1 x_i}}{1+e^{\beta_0 + \beta_1
x_i}}
\]</span> <span class="math display">\[
  H_a: \pi_i \neq \frac{e^{\beta_0 + \beta_1 x_i}}{1+e^{\beta_0 +
\beta_1 x_i}}
\]</span></p>
<hr />
<p><strong><em>Hosmer-Lemeshow Goodness of Fit Test</em></strong></p>
<p>If there are very few or no replicated values of each <span
class="math inline">\(x_i\)</span>, then the Hosmer-Lemeshow goodness of
fit test can be used to test these same hypotheses. In each case, the
null assumes that logistic regression is a good fit for the data while
the alternative is that logistic regression is not a good fit.</p>
</div>
<hr />
<p><strong><em>Prediction</em></strong></p>
<p>One of the great uses of Logistic Regression is that it provides an
estimate of the probability that <span
class="math inline">\(Y_i=1\)</span> for a given value of <span
class="math inline">\(x_i\)</span>. This probability is often referred
to as the <em>risk</em> that <span class="math inline">\(Y_i=1\)</span>
for a certain individual. For example, if <span
class="math inline">\(Y_i=1\)</span> implies a person has a disease,
then <span class="math inline">\(\pi_i=P(Y_i=1)\)</span> represents the
risk of individual <span class="math inline">\(i\)</span> having the
disease based on their value of <span
class="math inline">\(x_i\)</span>, perhaps a measure of their
cholesterol or some other predictor of the disease.</p>
</div>
<hr />
</div>
</div>
<div id="section-7" class="section level3">
<h3></h3>
<hr />
<!--- End of Add content area.  ------------------>
</div>
</div>
</div>
</div>
</div>
<div id="section-8" class="section level1">
<h1></h1>
<div style="clear:both;">

</div>
<div id="binomial-y-multiple-x"
class="section level3 tabset tabset-fade">
<h3 class="tabset tabset-fade">Binomial Y | Multiple X</h3>
<div id="graphics-7" class="section level4">
<h4>Graphics</h4>
<div class="tooltipimage" style="float:left;width:125px;"
align="center">
<p><img src="Images/BinomYMultX.png" width=100px;> <span
class="tooltipimagetext">Y is a single categorical (qualitative)
variable of interest where 1 (success) or 0 (failure) are the only
possible values for Y. This would be like “getting an A in Math 325”
where 1 means you got an A and 0 means you didn’t. We might use an
explanatory variable X1 of “height” and a second explanatory variable X2
of “gender” to try to predict whether or not a student will get an A in
Math 325.</span></p>
</div>
<div style="padding-left:125px;color:black;">
<!-- Add your customizations in the area below: -->
<p><strong>Test(s) used for this category:</strong></p>
<ul>
<li>Multiple Logistic Regression Model</li>
</ul>
<p><a href="GraphicalSummaries.html#scatterplots">
<img class="myhover" src="Images/scatterplotbinomYmult.png" alt="Scatterplot with Binomial Y" title="Scatterplot with Binomial Y, including coloring and shading">
</a></p>
<!--- End of Add content area.  ------------------>
</div>
</div>
<div id="tests-7" class="section level4">
<h4>Tests</h4>
<div style="padding-left:125px;color:black;">
<!-- Add your customizations in the area below: -->
<hr />
<div id="multiple-logistic-regression-model"
class="section level5 tabset tabset-pills tabset-fade">
<h5 class="tabset tabset-pills tabset-fade">Multiple Logistic Regression
Model</h5>
<div style="float:left;width:125px;" align="center">
<p><img src="Images/BinomYMultX.png" width=98px;></p>
</div>
<p>Logistic regression for multiple explanatory variables that can
either be quantitative or qualitative or a mixture of the two.</p>
<div id="overview-12" class="section level6">
<h6>Overview</h6>
<div style="padding-left:125px;">
<p>The probability that <span class="math inline">\(Y_i = 1\)</span>
given the observed data <span
class="math inline">\((x_{i1},\ldots,x_{ip})\)</span> is called <span
class="math inline">\(\pi_i\)</span> and is modeled by the equation</p>
<p><span class="math display">\[
  P(Y_i = 1|\, x_{i1},\ldots,x_{ip}) = \frac{e^{\beta_0 + \beta_1 x_{i1}
+ \ldots + \beta_p x_{ip}}}{1+e^{\beta_0 + \beta_1 x_{i1} + \ldots +
\beta_p x_{ip} }} = \pi_i
\]</span></p>
<p>The coefficents <span
class="math inline">\(\beta_0,\beta_1,\ldots,\beta_p\)</span> are
difficult to interpret directly. Typically <span
class="math inline">\(e^{\beta_k}\)</span> for <span
class="math inline">\(k=0,1,\ldots,p\)</span> is interpreted instead.
The value of <span class="math inline">\(e^{\beta_k}\)</span> denotes
the relative change in the odds that <span
class="math inline">\(Y_i=1\)</span>. The odds that <span
class="math inline">\(Y_i=1\)</span> are <span
class="math inline">\(\frac{\pi_i}{1-\pi_i}\)</span>.</p>
<hr />
<p><strong>Examples:</strong> <a
href="./Analyses/Logistic%20Regression/Examples/GSSMultipleLogisticReg.html">GSS</a></p>
<hr />
</div>
</div>
<div id="r-instructions-12" class="section level6">
<h6>R Instructions</h6>
<div style="padding-left:125px;">
<p><strong>Console</strong> Help Command: <code>?glm()</code></p>
<hr />
<p><strong><em>Perform the Logistic Regression</em></strong></p>
<p>To perform a logistic regression in R use the commands</p>
<a href="javascript:showhide('logistic2')">
<div class="hoverchunk">
<p><span class="tooltipr"> YourGlmName <span class="tooltiprtext">This
is some name you come up with that will become the R object that stores
the results of your logistic regression <code>glm()</code>
command.</span> </span><span class="tooltipr">  &lt;-  <span
class="tooltiprtext">This is the “left arrow” assignment operator that
stores the results of your <code>glm()</code> code into
<code>YourGlmName</code>.</span> </span><span class="tooltipr"> glm(
<span class="tooltiprtext">glm( is an R function that stands for
“General Linear Model”. It works in a similar way that the
<code>lm(</code> function works except that it requires a
<code>family=</code> option to be specified at the end of the
command.</span> </span><span class="tooltipr"> Y  <span
class="tooltiprtext">Y is your binary response variable. It must consist
of only 0’s and 1’s. Since TRUE’s = 1’s and FALSE’s = 0’s in R, Y could
be a logical statement like (Price &gt; 100) or (Animal == “Cat”) if
your Y-variable wasn’t currently coded as 0’s and 1’s.</span>
</span><span class="tooltipr"> ~  <span class="tooltiprtext">The tilde
symbol ~ is used to tell R that Y should be treated as a function of the
explanatory variable X.</span> </span><span class="tooltipr"> X1 <span
class="tooltiprtext">X1 is the first explanatory variable (typically
quantitative) that will be used to explain the probability that the
response variable Y is a 1.</span> </span><span class="tooltipr"> *
<span class="tooltiprtext">The times symbol allows a shortcut for
writing X1 + X2 + X1:X2 = X1*X2.</span> </span><span class="tooltipr">
X2  <span class="tooltiprtext">X2 is second the explanatory variable
either quantitative or qualitative that will be used to explain the
probability that the response variable Y is a 1.</span> </span><span
class="tooltipr"> …, <span class="tooltiprtext">In theory, you could
have many other explanatory variables, interaction terms, or even
squared, cubed, or other transformations of terms added to this
model.</span> </span><span class="tooltipr">  data =
NameOfYourDataset,<br />
<span class="tooltiprtext">NameOfYourDataset is the name of the dataset
that contains Y and X. In other words, one column of your dataset would
be called Y and another column would be called X.</span> </span><span
class="tooltipr">  family=binomial) <span class="tooltiprtext">The
family=binomial command tells the <code>glm(</code> function to perform
a logistic regression. It turns out that <code>glm</code> can perform
many different types of regressions, but we only study it as a tool to
perform a logistic regression in this course.</span> </span><br/><span
class="tooltipr"> summary(YourGlmName) <span class="tooltiprtext">The
<code>summary</code> command allows you to print the results of your
logistic regression that were previously saved in
<code>YourGlmName</code>.</span> </span></p>
</div>
<p></a></p>
<div id="logistic2" style="display:none;">
<p>Example output from a regression. Hover each piece to learn more.</p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Call:<br/> glm(formula = weight &gt; 100 ~
Time*Diet, family = binomial, data = ChickWeight) <span
class="tooltiprouttext">This is simply a statement of your original
glm(…) “call” that you made when performing your regression. It allows
you to verify that you ran what you thought you ran in the
glm(…).</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td colspan="2">
<span class="tooltiprout"> Deviance Residuals: <span
class="tooltiprouttext">Deviance residuals are a measure of how far the
fitted probability for <span class="math inline">\(\pi_i\)</span> has
differed from the actual outcome of <span
class="math inline">\(Y_i\)</span> in terms of the log of the fitted
probability space. (This is a fairly complicated idea.) </span>
</td>
</tr>
<tr>
<td align="right">
<span class="tooltiprout"> Min<br/>   -2.9446 <span
class="tooltiprouttext">“min” gives the value of the residual that is
furthest below the regression line. Ideally, the magnitude of this value
would be about equal to the magnitude of the largest positive residual
(the max) because the hope is that the residuals are normally
distributed around the line.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 1Q<br/>   -0.2364 <span
class="tooltiprouttext">“1Q” gives the first quartile of the residuals,
which will always be negative, and ideally would be about equal in
magnitude to the third quartile.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> Median<br/>   0.0000 <span
class="tooltiprouttext">“Median” gives the median of the residuals,
which would ideally would be about equal to zero. Note that because the
regression line is the least squares line, the mean of the residuals
will ALWAYS be zero, so it is never included in the output
summary.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 3Q<br/>   0.2776 <span
class="tooltiprouttext">“3Q” gives the third quartile of the residuals,
which would ideally would be about equal in magnitude to the first
quartile. In this case, it is pretty close, which helps us see that the
first quartile of residuals on either side of the line is behaving
fairly normally.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> Max</br>   1.9968 <span
class="tooltiprouttext">“Max” gives the maximum positive residuals,
which would ideally would be about equal in magnitude to the minimum
residual. In this case, it is much larger than the minimum, which helps
us see that the residuals are likely right skewed.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td colspan="2">
<span class="tooltiprout"> Coefficients: <span
class="tooltiprouttext">Notice that in your glm(…) you used only <span
class="math inline">\(Y\)</span> and <span
class="math inline">\(X\)</span>. You did type out any coefficients,
i.e., the <span class="math inline">\(\beta_0\)</span> or <span
class="math inline">\(\beta_1\)</span> of the regression model. These
coefficients are estimated by the glm(…) function and displayed in this
part of the output along with standard errors, t-values, and
p-values.</span> </span>
</td>
</tr>
<tr>
<td align="left">
</td>
<td align="right">
<span class="tooltiprout">   Estimate <span class="tooltiprouttext">To
learn more about the “Estimates” of the “Coefficients” see the
“Explanation” tab, “Estimating the Model Parameters” section for
details.</span>
</td>
<td align="right">
<span class="tooltiprout">   Std. Error <span class="tooltiprouttext">To
learn more about the “Standard Errors” of the “Coefficients” see the
“Explanation” tab, “Inference for the Model Parameters” section.</span>
</span>
</td>
<td align="right">
<span class="tooltiprout">   z value <span class="tooltiprouttext">The
Z-score testing the hypothesis that <span
class="math inline">\(\beta_j=0\)</span></span> </span>
</td>
<td align="right">
<span class="tooltiprout">   Pr(&gt;|z|) <span
class="tooltiprouttext">The p-value for the corresponding
Z-score.</span> </span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> (Intercept) <span
class="tooltiprouttext">This always says “Intercept” for any glm(…) you
run in R. That is because R always assumes there is a y-intercept for
your regression function.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   -4.97603 <span class="tooltiprouttext">This
is the estimate of the y-intercept, <span
class="math inline">\(\beta_0\)</span>. It is called <span
class="math inline">\(b_0\)</span>. It is the average y-value when X is
zero.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   0.65316 <span class="tooltiprouttext">This
is the standard error of <span class="math inline">\(b_0\)</span>. It
tells you how much <span class="math inline">\(b_0\)</span> varies from
sample to sample. The closer to zero, the better.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> -7.618 <span class="tooltiprouttext">Z-score
for <span class="math inline">\(b_0\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 2.57e-14 <span class="tooltiprouttext">This
is the p-value of the test of the hypothesis that <span
class="math inline">\(\beta_0 = 0\)</span>. It measures the probability
of observing a Z-value as extreme as the one observed. To compute it
yourself in R, use <code>pnorm(-abs(your z-value))*2</code>.</span>
</span>
</td>
<td align="left">
<span class="tooltiprout"> *** <span class="tooltiprouttext">This is
called a “star”. Three stars means significant at the 0.01 level of
<span class="math inline">\(\alpha\)</span>.</span> </span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> Time <span class="tooltiprouttext">This is
always the name of your X-variable in your glm(Y ~ X, …).</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   0.39111 <span class="tooltiprouttext">This
is the estimate of the slope, <span
class="math inline">\(\beta_1\)</span>. It is called <span
class="math inline">\(b_1\)</span>. It is the change in the average
y-value as X is increased by 1 unit.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   0.04979 <span class="tooltiprouttext">This
is the standard error of <span class="math inline">\(b_1\)</span>. It
tells you how much <span class="math inline">\(b_1\)</span> varies from
sample to sample. The closer to zero, the better.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 7.854 <span class="tooltiprouttext">Z-score
for <span class="math inline">\(b_1\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 4.02e-15 <span class="tooltiprouttext">This
is the p-value of the test of the hypothesis that <span
class="math inline">\(\beta_1 = 0\)</span>. To compute it yourself in R,
use <code>pt(-abs(your t-value), df of your regression)*2</code></span>
</span>
</td>
<td align="left">
<span class="tooltiprout"> *** <span class="tooltiprouttext">This is
called a “star”. Three stars means significant at the 0.01 level of
<span class="math inline">\(\alpha\)</span>.</span> </span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> Diet2 <span class="tooltiprouttext">This is
always the name of your X-variable in your glm(Y ~ X, …).</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   0.58283 <span class="tooltiprouttext">This
is the estimate of the change in the intercept, <span
class="math inline">\(\beta_2\)</span>. It is called <span
class="math inline">\(b_2\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   1.04061 <span class="tooltiprouttext">This
is the standard error of <span class="math inline">\(b_2\)</span>. It
tells you how much <span class="math inline">\(b_2\)</span> varies from
sample to sample. The closer to zero, the better.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 0.560 <span class="tooltiprouttext">Z-score
for <span class="math inline">\(b_2\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 0.5754 <span class="tooltiprouttext">This is
the p-value of the test of the hypothesis that <span
class="math inline">\(\beta_2 = 0\)</span>. To compute it yourself in R,
use <code>pt(-abs(your t-value), df of your regression)*2</code></span>
</span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> Diet3 <span class="tooltiprouttext">This is
always the name of your X-variable in your glm(Y ~ X, …).</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   -8.44476 <span class="tooltiprouttext">This
is the estimate of the change in the intercept, <span
class="math inline">\(\beta_3\)</span>. It is called <span
class="math inline">\(b_3\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   4.32324 <span class="tooltiprouttext">This
is the standard error of <span class="math inline">\(b_3\)</span>. It
tells you how much <span class="math inline">\(b_3\)</span> varies from
sample to sample. The closer to zero, the better.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> -1.953 <span class="tooltiprouttext">Z-score
for <span class="math inline">\(b_3\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 0.0508 <span class="tooltiprouttext">This is
the p-value of the test of the hypothesis that <span
class="math inline">\(\beta_3 = 0\)</span>. To compute it yourself in R,
use <code>pt(-abs(your t-value), df of your regression)*2</code></span>
</span>
</td>
<td align="left">
<span class="tooltiprout"> . <span class="tooltiprouttext">This is
called a period. It means significant at the 0.1 level of <span
class="math inline">\(\alpha\)</span>.</span> </span>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> Diet4 <span class="tooltiprouttext">This is
always the name of your X-variable in your glm(Y ~ X, …).</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   -67.41995 <span
class="tooltiprouttext">This is the estimate of the change in the
intercept, <span class="math inline">\(\beta_4\)</span>. It is called
<span class="math inline">\(b_4\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   3768.10023 <span
class="tooltiprouttext">This is the standard error of <span
class="math inline">\(b_4\)</span>. It tells you how much <span
class="math inline">\(b_4\)</span> varies from sample to sample. The
closer to zero, the better.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> -0.018 <span class="tooltiprouttext">Z-score
for <span class="math inline">\(b_4\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 0.9857 <span class="tooltiprouttext">This is
the p-value of the test of the hypothesis that <span
class="math inline">\(\beta_2 = 0\)</span>. To compute it yourself in R,
use <code>pt(-abs(your t-value), df of your regression)*2</code></span>
</span>
</td>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> Time:Diet2 <span class="tooltiprouttext">This
is always the name of your X-variable in your glm(Y ~ X, …).</span>
</span>
</td>
<td align="right">
<span class="tooltiprout">   0.02391 <span class="tooltiprouttext">This
is the estimate of the change in the slope, <span
class="math inline">\(\beta_5\)</span>. It is called <span
class="math inline">\(b_5\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   0.08679 <span class="tooltiprouttext">This
is the standard error of <span class="math inline">\(b_5\)</span>. It
tells you how much <span class="math inline">\(b_5\)</span> varies from
sample to sample. The closer to zero, the better.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 0.275 <span class="tooltiprouttext">Z-score
for <span class="math inline">\(b_5\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 0.7830 <span class="tooltiprouttext">This is
the p-value of the test of the hypothesis that <span
class="math inline">\(\beta_2 = 0\)</span>. To compute it yourself in R,
use <code>pt(-abs(your t-value), df of your regression)*2</code></span>
</span>
</td>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> Time:Diet3 <span class="tooltiprouttext">This
is always the name of your X-variable in your glm(Y ~ X, …).</span>
</span>
</td>
<td align="right">
<span class="tooltiprout">   1.20955 <span class="tooltiprouttext">This
is the estimate of the change in the slope, <span
class="math inline">\(\beta_6\)</span>. It is called <span
class="math inline">\(b_6\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   0.51249 <span class="tooltiprouttext">This
is the standard error of <span class="math inline">\(b_6\)</span>. It
tells you how much <span class="math inline">\(b_6\)</span> varies from
sample to sample. The closer to zero, the better.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 2.360 <span class="tooltiprouttext">Z-score
for <span class="math inline">\(b_6\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 0.0183 <span class="tooltiprouttext">This is
the p-value of the test of the hypothesis that <span
class="math inline">\(\beta_2 = 0\)</span>. To compute it yourself in R,
use <code>pt(-abs(your t-value), df of your regression)*2</code></span>
</span>
</td>
<td align="left">
<span class="tooltiprout"> * <span class="tooltiprouttext">This is
called a “star”. One star means significant at the 0.05 level of <span
class="math inline">\(\alpha\)</span>.</span> </span>
</td>
</td>
</tr>
<tr>
<td align="left">
<span class="tooltiprout"> Time:Diet4 <span class="tooltiprouttext">This
is always the name of your X-variable in your glm(Y ~ X, …).</span>
</span>
</td>
<td align="right">
<span class="tooltiprout">   8.83168 <span class="tooltiprouttext">This
is the estimate of the change in the slope, <span
class="math inline">\(\beta_7\)</span>. It is called <span
class="math inline">\(b_7\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">   471.01259 <span
class="tooltiprouttext">This is the standard error of <span
class="math inline">\(b_7\)</span>. It tells you how much <span
class="math inline">\(b_7\)</span> varies from sample to sample. The
closer to zero, the better.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 0.019 <span class="tooltiprouttext">Z-score
for <span class="math inline">\(b_7\)</span>.</span> </span>
</td>
<td align="right">
<span class="tooltiprout"> 0.9850 <span class="tooltiprouttext">This is
the p-value of the test of the hypothesis that <span
class="math inline">\(\beta_2 = 0\)</span>. To compute it yourself in R,
use <code>pt(-abs(your t-value), df of your regression)*2</code></span>
</span>
</td>
</td>
</tr>
</table>
<table class="rconsole">
<tr>
<td>
<span> --- </span>
</td>
</tr>
</table>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ’*’
0.05 ‘.’ 0.1 ‘ ’ 1 <span class="tooltiprouttext">These “codes” explain
what significance level the p-value is smaller than based on how many
“stars” * the p-value is labeled with in the Coefficients table
above.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> (Dispersion parameter for binomial family
taken to be 1) <span class="tooltiprouttext">A simplifying assumption of
the logistic regression. This can be changed if you know what you are
doing. See ?summary.glm and look at the dispersion option for details.
Unless you are pursuing an advanced degree in statistics, it is not
recommended that you explore this option.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout">   Null Deviance: <span
class="tooltiprouttext">The deviance of the null model.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  800.44 <span class="tooltiprouttext">In this
case, the null deviance is 800.44</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  on 577 degrees of freedom <span
class="tooltiprouttext">The residual degrees of freedom for the null
model.</span> </span>
</td>
</tr>
</table>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Residual deviance: <span
class="tooltiprouttext">The test statistic from the chi-squared goodness
of fit test of the logistic regression.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  256.30 <span class="tooltiprouttext">This is
computed by the sum(log(myglm$res^2)). As long as this value is similar
in size to the degrees of freedom, then the model is a good fit.</span>
</span>
</td>
<td align="right">
<span class="tooltiprout">  on 570 degrees of freedom <span
class="tooltiprouttext">This is <span class="math inline">\(n-p\)</span>
where <span class="math inline">\(n\)</span> is the sample size and
<span class="math inline">\(p\)</span> is the number of parameters in
the regression model. In this case, there is a sample size of 578 and
five parameters, <span class="math inline">\(\beta_0\)</span>, <span
class="math inline">\(\beta_1\)</span>, <span
class="math inline">\(\beta_2\)</span>, <span
class="math inline">\(\beta_3\)</span>, <span
class="math inline">\(\beta_4\)</span>, <span
class="math inline">\(\beta_5\)</span>,<span
class="math inline">\(\beta_6\)</span>, and <span
class="math inline">\(\beta_7\)</span> so 578-8 = 570.</span> </span>
</td>
</tr>
</table>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> AIC: <span class="tooltiprouttext">A form of
the Akiake Information Criterion. Smaller values of the AIC indicate a
better fitting model.</span> </span>
</td>
<td align="right">
<span class="tooltiprout">  272.3 <span class="tooltiprouttext">If a
model for the same Y-variable can be found with an AIC value lower than
272.3, then it is a better fit of the data.</span> </span>
</td>
</tr>
</table>
<p><br/></p>
<table class="rconsole">
<tr>
<td>
<span class="tooltiprout"> Number of Fisher Scoring iterations: <span
class="tooltiprouttext">If you have taken a class in Numerical Analysis,
this tells you how many iterations of the maximization algorithm were
required before converging to the “Estimates” of the parameters <span
class="math inline">\(\beta_0\)</span> and <span
class="math inline">\(\beta_1\)</span> found in the summary.</span>
</span>
</td>
<td align="right">
<span class="tooltiprout">  20 <span class="tooltiprouttext">This
implementation of glm required 20 Fisher Scoring iterations to converge.
Fewer iterations hints that the model is a better fit than when many
iterations are required.</span> </span>
</td>
</tr>
</table>
</div>
<p><br/></p>
<hr />
<p><strong><em>Diagnose the Goodness-of-Fit</em></strong></p>
<p>There are two ways to check the <strong>goodness of fit</strong> of a
logistic regression model.</p>
<div style="padding-left:25px;">
<p><strong>Option 1</strong>: Hosmer-Lemeshow Goodness-of-Fit Test</p>
<p>To check the <strong>goodness of fit</strong> of a logistic
regression model where there are <strong>few or no replicated <span
class="math inline">\(x\)</span>-values</strong> use the Hosmer-Lemeshow
Test.</p>
<a href="javascript:showhide('goodnessoffit2')">
<div class="hoverchunk">
<p><span class="tooltipr"> library(ResourceSelection) <span
class="tooltiprtext">This loads the ResourceSelection R package so that
you can access the hoslem.test() function. You may need to run the code:
install.packages(“ResourceSelection”) first.</span> </span><br/><span
class="tooltipr"> hoslem.test( <span class="tooltiprtext">This R
function performs the Hosmer-Lemeshow Goodness of Fit Test. See the
“Explanation” file to learn about this test.</span> </span><span
class="tooltipr"> YourGlmName <span
class="tooltiprtext"><code>YourGlmName</code> is the name of your glm(…)
code that you created previously.</span> </span><span class="tooltipr">
$y,  <span class="tooltiprtext">ALWAYS type a “y” here. This gives you
the actual binary (0,1) y-values of your logistic regression. The
goodness of fit test will compare these actual values to your predicted
probabilities for each value in order to see if the model is a “good
fit.”</span> </span><span class="tooltipr"> YourGlmName <span
class="tooltiprtext"><code>YourGlmName</code> is the name you used to
save the results of your glm(…) code.</span> </span><span
class="tooltipr"> $fitted,  <span class="tooltiprtext">ALWAYS type
“fitted” here. This gives you the fitted probabilities <span
class="math inline">\(\pi_i\)</span> of your logistic regression.</span>
</span><span class="tooltipr"> g=10) <span class="tooltiprtext">The
“g=10” is the default option for the value of g. The g is the number of
groups to run the goodness of fit test on. Just leave it at 10 unless
you are told to do otherwise. Ask your teacher for more information if
you are interested.</span> </span></p>
</div>
<p></a></p>
<div id="goodnessoffit2" style="display:none;">
<pre><code>## Warning: glm.fit: fitted probabilities
## numerically 0 or 1 occurred</code></pre>
<pre><code>## 
##  Hosmer and Lemeshow goodness of fit (GOF)
##  test
## 
## data:  myglm$y, myglm$fitted
## X-squared = 18.212, df = 8, p-value = 0.0197</code></pre>
<p>Note that the null hypothesis of the goodness-of-fit test is that
“the logistic regression is a good fit.” So we actually don’t want to
“reject the null” in this case. So a large p-value here means our
logistic regression fits the data satisfactorily. A small p-value
implies a poor fit and the results of the logistic regression should not
be fully trusted.</p>
</div>
<p><br/></p>
<p><strong>Option 2</strong>: Deviance Goodness-of-fit Test</p>
<p>In some cases, there are <strong>many replicated <span
class="math inline">\(x\)</span>-values</strong> for
<strong>all</strong> x-values. Though this is rare, it is good to use
the <em>deviance goodness-of-fit test</em> whenever this happens.</p>
<a href="javascript:showhide('goodnessoffit1')">
<div class="hoverchunk">
<p><span class="tooltipr"> pchisq( <span class="tooltiprtext">The
<code>pchisq</code> command allows you to compute p-values from the
chi-squared distribution.</span> </span><span class="tooltipr"> residual
deviance,  <span class="tooltiprtext">The residual deviance is shown at
the bottom of the output of your <code>summary(YourGlmName)</code> and
should be typed in here as a number like 25.3.</span> </span><span
class="tooltipr"> df for residual deviance,  <span
class="tooltiprtext">The df for the residual deviance is also shown at
the bottom of the output of your
<code>summary(YourGlmName)</code>.</span> </span><span class="tooltipr">
lower.tail=FALSE) <span class="tooltiprtext">This command ensures you
find the probability of the chi-squared distribution being as extreme or
more extreme than the observed value of residual deviance.</span>
</span></p>
</div>
<p></a></p>
<div id="multipleGOF2" style="display:none;">
<div class="sourceCode" id="cb132"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a>myglm <span class="ot">&lt;-</span> <span class="fu">glm</span>(weight<span class="sc">&gt;</span><span class="dv">100</span> <span class="sc">~</span> Time<span class="sc">*</span>Diet, <span class="at">data =</span> ChickWeight, <span class="at">family =</span> binomial)</span>
<span id="cb132-2"><a href="#cb132-2" tabindex="-1"></a><span class="fu">summary</span>(myglm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = weight &gt; 100 ~ Time * Diet, family = binomial, 
##     data = ChickWeight)
## 
## Coefficients:
##               Estimate Std. Error z value
## (Intercept)   -4.97603    0.65316  -7.618
## Time           0.39111    0.04979   7.854
## Diet2          0.58283    1.04061   0.560
## Diet3         -8.44476    4.32324  -1.953
## Diet4        -67.41995 3768.10023  -0.018
## Time:Diet2     0.02391    0.08679   0.275
## Time:Diet3     1.20955    0.51249   2.360
## Time:Diet4     8.83168  471.01259   0.019
##             Pr(&gt;|z|)    
## (Intercept) 2.57e-14 ***
## Time        4.02e-15 ***
## Diet2         0.5754    
## Diet3         0.0508 .  
## Diet4         0.9857    
## Time:Diet2    0.7830    
## Time:Diet3    0.0183 *  
## Time:Diet4    0.9850    
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 800.44  on 577  degrees of freedom
## Residual deviance: 256.30  on 570  degrees of freedom
## AIC: 272.3
## 
## Number of Fisher Scoring iterations: 20</code></pre>
<div class="sourceCode" id="cb134"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="fl">256.30</span>, <span class="dv">570</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 6.585816e-33</code></pre>
</div>
<p>The null hypothesis of the goodness-of-fit test is that the logistic
regression is a good fit of the data. So a large p-value (like 0.479) is
good because it allows us to trust the results of our logistic
regression. When the p-value becomes very small, we must “reject the
null” and conclude a poor fit, which implies that we should not trust
the results of the logistic regression.</p>
</div>
<p><br/></p>
<hr />
<p><strong><em>Predict Probabilities</em></strong></p>
<p>To predict the probability that <span
class="math inline">\(Y_i=1\)</span> for a given <span
class="math inline">\(x\)</span>-value, use the code</p>
<a href="javascript:showhide('MultipleLogisticPredict')">
<div class="hoverchunk">
<p><span class="tooltipr"> predict( <span class="tooltiprtext">The
predict() function allows us to use the regression model that was
obtained from glm() to predict the probability that <span
class="math inline">\(Y_i = 1\)</span> for a given <span
class="math inline">\(X_i\)</span>.</span> </span><span
class="tooltipr"> YourGlmName,  <span
class="tooltiprtext"><code>YourGlmName</code> is the name of the object
you created when you performed your logistic regression using
glm().</span> </span><span class="tooltipr"> newdata =  <span
class="tooltiprtext">The <code>newdata =</code> command allows you to
specify the x-values for which you want to obtain predicted
probabilities that <span class="math inline">\(Y_i=1\)</span>.</span>
</span><span class="tooltipr"> NewDataFrame,  <span
class="tooltiprtext">Typically, NewDataFrame is created in real time
using the data.frame( X1 = c(Value 1, Value 2, …), X2 = c(Value 1, Value
2, …), …) command. You should see the GSS example file for an example of
how to use this function.</span> </span><span class="tooltipr"> type =
“response”) <span class="tooltiprtext">The type = “response” options
specifies that you want predicted probabilities. There are other options
available. See ?predict.glm for details.</span> </span></p>
</div>
<p></a></p>
<div id="MultipleLogisticPredict" style="display:none;">
<pre><code>##         1 
## 0.7314498</code></pre>
</div>
<p><br/></p>
<hr />
<p><strong><em>Plot the Regression</em></strong></p>
<div class="tab">
<p><button class="tablinks" onclick="openTab(event, 'MultipleLogisticBaseplot')">Base
R</button>
<button class="tablinks" onclick="openTab(event, 'MultipleLogisticggplot')">ggplot2</button></p>
</div>
<div id="MultipleLogisticBaseplot" class="tabcontent">
<p>
<a href="javascript:showhide('MultipleLogisticBaseplot2')">
<div class="hoverchunk">
<p><span class="tooltipr"> b &lt;- coef(myglm) <span
class="tooltiprtext">This stores the estimated coefficients from the
regression into the “b” vector.</span> </span><br/><span
class="tooltipr"> palette( <span class="tooltiprtext">The palette()
function allows you to specify the colors R chooses for the plot.</span>
</span><span class="tooltipr"> c(“SomeColor”,“DifferentColor”,…) <span
class="tooltiprtext">Specify as many colors for the palette as you wish.
R will choose a color for each group that you specify later on in your
plot(…) code.</span> </span><span class="tooltipr"> )) <span
class="tooltiprtext">Closing parentheses.</span> </span><br/><span
class="tooltipr"> plot( <span class="tooltiprtext">Create the binary
scatterplot for the logistic regression.</span> </span><span
class="tooltipr"> Y <span class="tooltiprtext">Note that Y must be
binary (0,1) values. If it is not, use a logical statement to make it
binary, like height&gt;60 or sex==“B”.</span> </span><span
class="tooltipr">  ~  <span class="tooltiprtext">The formula operator in
R.</span> </span><span class="tooltipr"> X1, <span
class="tooltiprtext">The first x-variable in your glm code.</span>
</span><span class="tooltipr">  data = YourDataSet, <span
class="tooltiprtext">Specify the name of your data set.</span>
</span><span class="tooltipr">  pch = 16) <span
class="tooltiprtext">Select the type of plotting characters to use for
the plot.</span> </span><br/><span class="tooltipr"> curve( <span
class="tooltiprtext">Use the curve function to add the logistic
regression curve to the plot.</span> </span><span class="tooltipr"> exp(
<span class="tooltiprtext">The exp(…) function computes e^(stuff) in R
and stands for the “exponential function.”</span> </span><span
class="tooltipr"> (b[1]+ <span class="tooltiprtext">The first
coefficient found in b is the y-intercept.</span> </span><span
class="tooltipr"> b[2] <span class="tooltiprtext">The second coefficient
found in b is the slope term.</span> </span><span class="tooltipr"> *x)
<span class="tooltiprtext">The curve(…) function requires that you call
the x-variable “x” although you can change this behavior using
xname=“SomeOtherName” if you want.</span> </span><span class="tooltipr">
/ <span class="tooltiprtext">The logistic model is e^(stuff) / (1 +
e^(stuff)).</span> </span><span class="tooltipr">
(1+exp(b[1]+b[2]<em>x)) <span class="tooltiprtext">The denominator of
the logistic regression. Be careful to group the entire denominator
(1+exp(stuff)).</span> </span><span class="tooltipr">  col =
palette()[1], <span class="tooltiprtext">Pull the first color from the
color palette for the first curve.</span> </span><span class="tooltipr">
 add = TRUE) <span class="tooltiprtext">Add the curve to the current
plot.</span> </span><br/><span class="tooltipr">
curve(exp((b[1]+b[3])+(b[2]+b[4])</em>x) <span class="tooltiprtext">Note
how the numerator of this second logistic curve uses and adjusted
y-intercept (b[1]+b[3]) and an adjusted slope (b[2]+b[4])<em>x.</span>
</span><span class="tooltipr"> / <span class="tooltiprtext">Begin the
denominator.</span> </span><span class="tooltipr">
(1+exp((b[1]+b[3])+(b[2]+b[4])</em>x)) <span class="tooltiprtext">The
denominator consists of (1+exp(stuff)).</span> </span><span
class="tooltipr"> , <span class="tooltiprtext">Begin optional
parameters.</span> </span><span class="tooltipr">  col = palette()[2],
<span class="tooltiprtext">Set the color of this second curve to the
second color in the palette.</span> </span><span class="tooltipr">  add
= TRUE) <span class="tooltiprtext">Add the curve to the current
plot.</span> </span><br/><span class="tooltipr"> legend( <span
class="tooltiprtext">The legend function adds a legend to the current
plot.</span> </span><span class="tooltipr"> “topright”, <span
class="tooltiprtext">Typically the legend is placed in the top-right
corner of the graph. But it could be placed “top”, “topleft”, “left”,
“bottomleft”, “bottom”, “center”, “right”, or “bottomright”.</span>
</span><span class="tooltipr">  legend = <span class="tooltiprtext">Why
you have to write legend again, no one knows, but you do.</span>
</span><span class="tooltipr"> c(“Lable 1”, “Label 2”), <span
class="tooltiprtext">These are the values that will appear in the
legend, one entry on each line of the legend.</span> </span><span
class="tooltipr">  col = palette(), <span class="tooltiprtext">This
specifies the colors of the symbols in the legend. First color goes with
“Label 1”, and second goes with “Label 2” and so on.</span> </span><span
class="tooltipr">  lty = 1, <span class="tooltiprtext">Specifies that
solid lines should be used in the legend. If you wanted dots instead,
use pch=16. If you wanted dashed lines, use lty=2. Many other options
exist.</span> </span><span class="tooltipr">  bty = <span
class="tooltiprtext">Specifies the “box type” (bty) that should be drawn
around the legend.</span> </span><span class="tooltipr"> ‘n’) <span
class="tooltiprtext">By placing a “no” option (‘n’) here, no box is
drawn around the legend.</span> </span></p>
</div>
<p></a></p>
<div id="MultipleLogisticBaseplot2" style="display:none;">
<div class="sourceCode" id="cb137"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a>myglm <span class="ot">&lt;-</span> <span class="fu">glm</span>(weight<span class="sc">&gt;</span><span class="dv">100</span> <span class="sc">~</span> Time<span class="sc">*</span>Diet, <span class="at">data =</span> ChickWeight, <span class="at">family =</span> binomial)</span>
<span id="cb137-2"><a href="#cb137-2" tabindex="-1"></a><span class="fu">palette</span>(<span class="fu">c</span>(<span class="st">&quot;firebrick&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;skyblue&quot;</span>, <span class="st">&quot;darkorchid4&quot;</span>))</span>
<span id="cb137-3"><a href="#cb137-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> myglm<span class="sc">$</span>coefficients</span>
<span id="cb137-4"><a href="#cb137-4" tabindex="-1"></a><span class="fu">plot</span>(weight<span class="sc">&gt;</span><span class="dv">100</span> <span class="sc">~</span> Time, <span class="at">data =</span> ChickWeight, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb137-5"><a href="#cb137-5" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>(b[<span class="dv">1</span>]<span class="sc">+</span>b[<span class="dv">2</span>]<span class="sc">*</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(b[<span class="dv">1</span>]<span class="sc">+</span>b[<span class="dv">2</span>]<span class="sc">*</span>x)), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col =</span> <span class="fu">palette</span>()[<span class="dv">1</span>])</span>
<span id="cb137-6"><a href="#cb137-6" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>((b[<span class="dv">1</span>]<span class="sc">+</span>b[<span class="dv">3</span>])<span class="sc">+</span>(b[<span class="dv">2</span>]<span class="sc">+</span>b[<span class="dv">6</span>])<span class="sc">*</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>((b[<span class="dv">1</span>]<span class="sc">+</span>b[<span class="dv">3</span>])<span class="sc">+</span>(b[<span class="dv">2</span>]<span class="sc">+</span>b[<span class="dv">6</span>])<span class="sc">*</span>x)), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col =</span> <span class="fu">palette</span>()[<span class="dv">2</span>])</span>
<span id="cb137-7"><a href="#cb137-7" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>((b[<span class="dv">1</span>]<span class="sc">+</span>b[<span class="dv">4</span>])<span class="sc">+</span>(b[<span class="dv">2</span>]<span class="sc">+</span>b[<span class="dv">7</span>])<span class="sc">*</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>((b[<span class="dv">1</span>]<span class="sc">+</span>b[<span class="dv">4</span>])<span class="sc">+</span>(b[<span class="dv">2</span>]<span class="sc">+</span>b[<span class="dv">7</span>])<span class="sc">*</span>x)), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col =</span> <span class="fu">palette</span>()[<span class="dv">3</span>])</span>
<span id="cb137-8"><a href="#cb137-8" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>((b[<span class="dv">1</span>]<span class="sc">+</span>b[<span class="dv">5</span>])<span class="sc">+</span>(b[<span class="dv">2</span>]<span class="sc">+</span>b[<span class="dv">8</span>])<span class="sc">*</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>((b[<span class="dv">1</span>]<span class="sc">+</span>b[<span class="dv">5</span>])<span class="sc">+</span>(b[<span class="dv">2</span>]<span class="sc">+</span>b[<span class="dv">8</span>])<span class="sc">*</span>x)), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col =</span> <span class="fu">palette</span>()[<span class="dv">4</span>])</span>
<span id="cb137-9"><a href="#cb137-9" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Diet 1&quot;</span>, <span class="st">&quot;Diet 2&quot;</span>, <span class="st">&quot;Diet 3&quot;</span>, <span class="st">&quot;Diet 4&quot;</span>), <span class="at">col =</span> <span class="fu">palette</span>(), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">&#39;n&#39;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-151-1.png" width="672" /></p>
</div>
</p>
</div>
<div id="MultipleLogisticggplot" class="tabcontent">
<p>
<a href="javascript:showhide('MultipleLogisticggplot2')">
<div class="hoverchunk">
<p><span class="tooltipr"> ggplot(data=YourDataName, <span
class="tooltiprtext">Initialize a ggplot.</span> </span><span
class="tooltipr">  aes( <span class="tooltiprtext">Declare the
aesthetics of the graph.</span> </span><span class="tooltipr"> x=X1,
<span class="tooltiprtext">Set the x-axis to be your X1 variable.</span>
</span><span class="tooltipr"> y=Y <span class="tooltiprtext">Set the
y-axis to be your Y-variable.</span> </span><span class="tooltipr"> )
<span class="tooltiprtext">Closing parenthesis for aes(…)
function.</span> </span><span class="tooltipr"> ) <span
class="tooltiprtext">Closing parenthesis for ggplot(…) function.</span>
</span><span class="tooltipr">  + <span class="tooltiprtext">Add a layer
to the ggplot.</span> </span><br/><span class="tooltipr">   geom_point(
<span class="tooltiprtext">Add dots to the ggplot.</span> </span><span
class="tooltipr"> ) <span class="tooltiprtext">Closing parenthesis for
the geom_point() function.</span> </span><span class="tooltipr">  +
<span class="tooltiprtext">Add a layer to the ggplot.</span>
</span><br/><span class="tooltipr">   geom_smooth(method=“glm”,
method.args=list(family=“binomial”), se=FALSE, <span
class="tooltiprtext">Add the logistic regression curve to the
plot.</span> </span><span class="tooltipr">   aes(color=“X2) <span
class="tooltiprtext">Create a different logistic regression curve for
each group found in X2, and give each curve a different color.</span>
</span><span class="tooltipr"> ) <span class="tooltiprtext">Closing
parenthesis for the geom_smooth() function.</span> </span><span
class="tooltipr">  + <span class="tooltiprtext">Add a layer to the
plot.</span> </span><br/><span class="tooltipr">   theme_bw() <span
class="tooltiprtext">Add a black and white them to the plot.</span>
</span></p>
</div>
<p></a></p>
<div id="MultipleLogisticggplot2" style="display:none;">
<div class="sourceCode" id="cb138"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a><span class="fu">ggplot</span>(ChickWeight, <span class="fu">aes</span>(Time, <span class="fu">as.numeric</span>(weight<span class="sc">&gt;</span><span class="dv">100</span>))) <span class="sc">+</span></span>
<span id="cb138-2"><a href="#cb138-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb138-3"><a href="#cb138-3" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Diet), <span class="at">method =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>), <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb138-4"><a href="#cb138-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb138-5"><a href="#cb138-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;weight&gt;100&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-152-1.png" width="672" /></p>
</div>
</p>
</div>
<hr />
</div>
</div>
<div id="explanation-11" class="section level6">
<h6>Explanation</h6>
<div style="padding-left:125px;">
<p>Multiple Logistic Regression is used when</p>
<ul>
<li>the response variable is binary <span
class="math inline">\((Y_i=0\)</span> or <span
class="math inline">\(1)\)</span>, and</li>
<li>there are multiple explanatory variables <span
class="math inline">\(X_1,\ldots,X_p\)</span> that can be either
quantitative or qualitative.</li>
</ul>
<hr />
<p><strong><em>The Model</em></strong></p>
<p>Very little changes in multiple logistic regression from Simple
Logistic Regression. The probability that <span
class="math inline">\(Y_i = 1\)</span> given the observed data <span
class="math inline">\((x_{i1},\ldots,x_{ip})\)</span> is called <span
class="math inline">\(\pi_i\)</span> and is modeled by the expanded
equation</p>
<p><span class="math display">\[
  P(Y_i = 1|\, x_{i1},\ldots,x_{ip}) = \frac{e^{\beta_0 + \beta_1 x_{i1}
+ \ldots + \beta_p x_{ip}}}{1+e^{\beta_0 + \beta_1 x_{i1} + \ldots +
\beta_p x_{ip} }} = \pi_i
\]</span></p>
<p>The assumption is that for certain combinations of <span
class="math inline">\(X_1,\ldots,X_p\)</span> the probability that <span
class="math inline">\(Y_i=1\)</span> is higher than for other
combinations.</p>
<hr />
<p><strong><em>Interpretation</em></strong></p>
<p>The model for <span class="math inline">\(\pi_i\)</span> comes from
modeling the <em>log of the odds</em> that <span
class="math inline">\(Y_i=1\)</span> using a linear regression, i.e.,
<span class="math display">\[
  \log\underbrace{\left(\frac{\pi_i}{1-\pi_i}\right)}_{\text{Odds for}\
Y_i=1} = \underbrace{\beta_0 + \beta_1 x_{i1} + \ldots + \beta_p
x_{ip}}_{\text{linear regression}}
\]</span> Beginning to solve this equation for <span
class="math inline">\(\pi_i\)</span> leads to the intermediate, but
important result that <span class="math display">\[
    \underbrace{\frac{\pi_i}{1-\pi_i}}_{\text{Odds for}\ Y_i=1} =
e^{\overbrace{\beta_0 + \beta_1 x_{i1} + \ldots + \beta_p
x_{ip}}^{\text{liear regression}}} = e^{\beta_0}e^{\beta_1 x_{i1}}\cdots
e^{\beta_p x_{ip}}
\]</span> As in Simple Linear Regression, the values of <span
class="math inline">\(e^{\beta_0}\)</span>, <span
class="math inline">\(e^{\beta_1}\)</span>, <span
class="math inline">\(\ldots\)</span>, <span
class="math inline">\(e^{\beta_p}\)</span> are interpreted as the
proportional change in odds for <span
class="math inline">\(Y_i=1\)</span> when a given <span
class="math inline">\(x\)</span>-variable experiences a unit change,
<em>all other variables being held constant</em>.</p>
<hr />
<p><strong><em>Checking the Model Assumptions</em></strong></p>
<p>Diagnostics are the same in multiple logistic regression as they are
in simple logistic regression.</p>
<hr />
<p><strong><em>Prediction</em></strong></p>
<p>The idea behind prediction in multiple logistic regression is the
same as in simple logistic regression. The only difference is that more
than one explanatory variable is used to make the prediction of the
<em>risk</em> that <span class="math inline">\(Y_i=1\)</span>.</p>
<hr />
</div>
<!--- End of Add content area.  ------------------>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="section-9" class="section level1">
<h1></h1>
<div style="clear:both;">

</div>
<div id="categorical-y-categorical-x"
class="section level3 tabset tabset-fade">
<h3 class="tabset tabset-fade">Categorical Y | Categorical X</h3>
<div id="graphics-8" class="section level4">
<h4>Graphics</h4>
<div class="tooltipimage" style="float:left;width:125px;"
align="center">
<p><img src="Images/QualYQualX.png" width=59px;> <span
class="tooltipimagetext">Y is a single categorical variable of interest,
like gender. X is another categorical variable of interest, like “hair
color”. This type of data would help us understand if men or women are
more likely to have certain hair colors than the other
gender.</span></p>
</div>
<div style="padding-left:125px;color:black;">
<!-- Add your customizations in the area below: -->
<p><strong>Used to see if there is a independence or not independence on
two factors</strong>:</p>
<ul>
<li><p>Is one gender more likely to be born in certain seasons of the
year?</p></li>
<li><p>Whats the probability that you have brown hair and blue
eyes?</p></li>
</ul>
<p><a href="GraphicalSummaries.html#bar-charts">
<img class="myhover" src="Images/barplot.png" alt="Bar Chart" title="Bar Chart">
</a></p>
<!--- End of Add content area.  ------------------>
</div>
</div>
<div id="tests-8" class="section level4">
<h4>Tests</h4>
<div style="padding-left:125px;color:black;">
<!-- Add your customizations in the area below: -->
<p>Add your own notes about appropriate inferential procedures for this
type of data here.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
